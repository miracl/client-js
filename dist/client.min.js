var MIRACLTrust=function(){"use strict";function AES(){var AES=function(){this.Nk=0;this.Nr=0;this.mode=0;this.fkey=[];this.rkey=[];this.f=[]};AES.ECB=0;AES.CBC=1;AES.CFB1=2;AES.CFB2=3;AES.CFB4=5;AES.OFB1=14;AES.OFB2=15;AES.OFB4=17;AES.OFB8=21;AES.OFB16=29;AES.CTR1=30;AES.CTR2=31;AES.CTR4=33;AES.CTR8=37;AES.CTR16=45;AES.prototype={reset:function(m,iv){var i;this.mode=m;for(i=0;i<16;i++){this.f[i]=0}if(this.mode!=AES.ECB&&iv!==null){for(i=0;i<16;i++){this.f[i]=iv[i]}}},getreg:function(){var ir=[],i;for(i=0;i<16;i++){ir[i]=this.f[i]}return ir},increment:function(){var i;for(i=0;i<16;i++){this.f[i]++;if((this.f[i]&255)!=0){break}}},init:function(m,nk,key,iv){var CipherKey=[],b=[],i,j,k,N,nr;nk/=4;if(nk!=4&&nk!=6&&nk!=8){return false}nr=6+nk;this.Nk=nk;this.Nr=nr;this.reset(m,iv);N=4*(nr+1);for(i=j=0;i<nk;i++,j+=4){for(k=0;k<4;k++){b[k]=key[j+k]}CipherKey[i]=AES.pack(b)}for(i=0;i<nk;i++){this.fkey[i]=CipherKey[i]}for(j=nk,k=0;j<N;j+=nk,k++){this.fkey[j]=this.fkey[j-nk]^AES.SubByte(AES.ROTL24(this.fkey[j-1]))^AES.rco[k]&255;for(i=1;i<nk&&i+j<N;i++){this.fkey[i+j]=this.fkey[i+j-nk]^this.fkey[i+j-1]}}for(j=0;j<4;j++){this.rkey[j+N-4]=this.fkey[j]}for(i=4;i<N-4;i+=4){k=N-4-i;for(j=0;j<4;j++){this.rkey[k+j]=AES.InvMixCol(this.fkey[i+j])}}for(j=N-4;j<N;j++){this.rkey[j-N+4]=this.fkey[j]}},ecb_encrypt:function(buff){var b=[],p=[],q=[],t,i,j,k;for(i=j=0;i<4;i++,j+=4){for(k=0;k<4;k++){b[k]=buff[j+k]}p[i]=AES.pack(b);p[i]^=this.fkey[i]}k=4;for(i=1;i<this.Nr;i++){q[0]=this.fkey[k]^AES.ftable[p[0]&255]^AES.ROTL8(AES.ftable[p[1]>>>8&255])^AES.ROTL16(AES.ftable[p[2]>>>16&255])^AES.ROTL24(AES.ftable[p[3]>>>24&255]);q[1]=this.fkey[k+1]^AES.ftable[p[1]&255]^AES.ROTL8(AES.ftable[p[2]>>>8&255])^AES.ROTL16(AES.ftable[p[3]>>>16&255])^AES.ROTL24(AES.ftable[p[0]>>>24&255]);q[2]=this.fkey[k+2]^AES.ftable[p[2]&255]^AES.ROTL8(AES.ftable[p[3]>>>8&255])^AES.ROTL16(AES.ftable[p[0]>>>16&255])^AES.ROTL24(AES.ftable[p[1]>>>24&255]);q[3]=this.fkey[k+3]^AES.ftable[p[3]&255]^AES.ROTL8(AES.ftable[p[0]>>>8&255])^AES.ROTL16(AES.ftable[p[1]>>>16&255])^AES.ROTL24(AES.ftable[p[2]>>>24&255]);k+=4;for(j=0;j<4;j++){t=p[j];p[j]=q[j];q[j]=t}}q[0]=this.fkey[k]^AES.fbsub[p[0]&255]&255^AES.ROTL8(AES.fbsub[p[1]>>>8&255]&255)^AES.ROTL16(AES.fbsub[p[2]>>>16&255]&255)^AES.ROTL24(AES.fbsub[p[3]>>>24&255]&255);q[1]=this.fkey[k+1]^AES.fbsub[p[1]&255]&255^AES.ROTL8(AES.fbsub[p[2]>>>8&255]&255)^AES.ROTL16(AES.fbsub[p[3]>>>16&255]&255)^AES.ROTL24(AES.fbsub[p[0]>>>24&255]&255);q[2]=this.fkey[k+2]^AES.fbsub[p[2]&255]&255^AES.ROTL8(AES.fbsub[p[3]>>>8&255]&255)^AES.ROTL16(AES.fbsub[p[0]>>>16&255]&255)^AES.ROTL24(AES.fbsub[p[1]>>>24&255]&255);q[3]=this.fkey[k+3]^AES.fbsub[p[3]&255]&255^AES.ROTL8(AES.fbsub[p[0]>>>8&255]&255)^AES.ROTL16(AES.fbsub[p[1]>>>16&255]&255)^AES.ROTL24(AES.fbsub[p[2]>>>24&255]&255);for(i=j=0;i<4;i++,j+=4){b=AES.unpack(q[i]);for(k=0;k<4;k++){buff[j+k]=b[k]}}},ecb_decrypt:function(buff){var b=[],p=[],q=[],t,i,j,k;for(i=j=0;i<4;i++,j+=4){for(k=0;k<4;k++){b[k]=buff[j+k]}p[i]=AES.pack(b);p[i]^=this.rkey[i]}k=4;for(i=1;i<this.Nr;i++){q[0]=this.rkey[k]^AES.rtable[p[0]&255]^AES.ROTL8(AES.rtable[p[3]>>>8&255])^AES.ROTL16(AES.rtable[p[2]>>>16&255])^AES.ROTL24(AES.rtable[p[1]>>>24&255]);q[1]=this.rkey[k+1]^AES.rtable[p[1]&255]^AES.ROTL8(AES.rtable[p[0]>>>8&255])^AES.ROTL16(AES.rtable[p[3]>>>16&255])^AES.ROTL24(AES.rtable[p[2]>>>24&255]);q[2]=this.rkey[k+2]^AES.rtable[p[2]&255]^AES.ROTL8(AES.rtable[p[1]>>>8&255])^AES.ROTL16(AES.rtable[p[0]>>>16&255])^AES.ROTL24(AES.rtable[p[3]>>>24&255]);q[3]=this.rkey[k+3]^AES.rtable[p[3]&255]^AES.ROTL8(AES.rtable[p[2]>>>8&255])^AES.ROTL16(AES.rtable[p[1]>>>16&255])^AES.ROTL24(AES.rtable[p[0]>>>24&255]);k+=4;for(j=0;j<4;j++){t=p[j];p[j]=q[j];q[j]=t}}q[0]=this.rkey[k]^AES.rbsub[p[0]&255]&255^AES.ROTL8(AES.rbsub[p[3]>>>8&255]&255)^AES.ROTL16(AES.rbsub[p[2]>>>16&255]&255)^AES.ROTL24(AES.rbsub[p[1]>>>24&255]&255);q[1]=this.rkey[k+1]^AES.rbsub[p[1]&255]&255^AES.ROTL8(AES.rbsub[p[0]>>>8&255]&255)^AES.ROTL16(AES.rbsub[p[3]>>>16&255]&255)^AES.ROTL24(AES.rbsub[p[2]>>>24&255]&255);q[2]=this.rkey[k+2]^AES.rbsub[p[2]&255]&255^AES.ROTL8(AES.rbsub[p[1]>>>8&255]&255)^AES.ROTL16(AES.rbsub[p[0]>>>16&255]&255)^AES.ROTL24(AES.rbsub[p[3]>>>24&255]&255);q[3]=this.rkey[k+3]^AES.rbsub[p[3]&255]&255^AES.ROTL8(AES.rbsub[p[2]>>>8&255]&255)^AES.ROTL16(AES.rbsub[p[1]>>>16&255]&255)^AES.ROTL24(AES.rbsub[p[0]>>>24&255]&255);for(i=j=0;i<4;i++,j+=4){b=AES.unpack(q[i]);for(k=0;k<4;k++){buff[j+k]=b[k]}}},encrypt:function(buff){var st=[],bytes,fell_off,j;fell_off=0;switch(this.mode){case AES.ECB:this.ecb_encrypt(buff);return 0;case AES.CBC:for(j=0;j<16;j++){buff[j]^=this.f[j]}this.ecb_encrypt(buff);for(j=0;j<16;j++){this.f[j]=buff[j]}return 0;case AES.CFB1:case AES.CFB2:case AES.CFB4:bytes=this.mode-AES.CFB1+1;for(j=0;j<bytes;j++){fell_off=fell_off<<8|this.f[j]}for(j=0;j<16;j++){st[j]=this.f[j]}for(j=bytes;j<16;j++){this.f[j-bytes]=this.f[j]}this.ecb_encrypt(st);for(j=0;j<bytes;j++){buff[j]^=st[j];this.f[16-bytes+j]=buff[j]}return fell_off;case AES.OFB1:case AES.OFB2:case AES.OFB4:case AES.OFB8:case AES.OFB16:bytes=this.mode-AES.OFB1+1;this.ecb_encrypt(this.f);for(j=0;j<bytes;j++){buff[j]^=this.f[j]}return 0;case AES.CTR1:case AES.CTR2:case AES.CTR4:case AES.CTR8:case AES.CTR16:bytes=this.mode-AES.CTR1+1;for(j=0;j<16;j++){st[j]=this.f[j]}this.ecb_encrypt(st);for(j=0;j<bytes;j++){buff[j]^=st[j]}this.increment();return 0;default:return 0}},decrypt:function(buff){var st=[],bytes,fell_off,j;fell_off=0;switch(this.mode){case AES.ECB:this.ecb_decrypt(buff);return 0;case AES.CBC:for(j=0;j<16;j++){st[j]=this.f[j];this.f[j]=buff[j]}this.ecb_decrypt(buff);for(j=0;j<16;j++){buff[j]^=st[j];st[j]=0}return 0;case AES.CFB1:case AES.CFB2:case AES.CFB4:bytes=this.mode-AES.CFB1+1;for(j=0;j<bytes;j++){fell_off=fell_off<<8|this.f[j]}for(j=0;j<16;j++){st[j]=this.f[j]}for(j=bytes;j<16;j++){this.f[j-bytes]=this.f[j]}this.ecb_encrypt(st);for(j=0;j<bytes;j++){this.f[16-bytes+j]=buff[j];buff[j]^=st[j]}return fell_off;case AES.OFB1:case AES.OFB2:case AES.OFB4:case AES.OFB8:case AES.OFB16:bytes=this.mode-AES.OFB1+1;this.ecb_encrypt(this.f);for(j=0;j<bytes;j++){buff[j]^=this.f[j]}return 0;case AES.CTR1:case AES.CTR2:case AES.CTR4:case AES.CTR8:case AES.CTR16:bytes=this.mode-AES.CTR1+1;for(j=0;j<16;j++){st[j]=this.f[j]}this.ecb_encrypt(st);for(j=0;j<bytes;j++){buff[j]^=st[j]}this.increment();return 0;default:return 0}},end:function(){var i;for(i=0;i<4*(this.Nr+1);i++){this.fkey[i]=this.rkey[i]=0}for(i=0;i<16;i++){this.f[i]=0}}};AES.ROTL8=function(x){return x<<8|x>>>24};AES.ROTL16=function(x){return x<<16|x>>>16};AES.ROTL24=function(x){return x<<24|x>>>8};AES.pack=function(b){return(b[3]&255)<<24|(b[2]&255)<<16|(b[1]&255)<<8|b[0]&255};AES.unpack=function(a){var b=[];b[0]=a&255;b[1]=a>>>8&255;b[2]=a>>>16&255;b[3]=a>>>24&255;return b};AES.bmul=function(x,y){var ix=x&255,iy=y&255,lx=AES.ltab[ix]&255,ly=AES.ltab[iy]&255;if(x!==0&&y!==0){return AES.ptab[(lx+ly)%255]}else{return 0}};AES.SubByte=function(a){var b=AES.unpack(a);b[0]=AES.fbsub[b[0]&255];b[1]=AES.fbsub[b[1]&255];b[2]=AES.fbsub[b[2]&255];b[3]=AES.fbsub[b[3]&255];return AES.pack(b)};AES.product=function(x,y){var xb=AES.unpack(x),yb=AES.unpack(y);return(AES.bmul(xb[0],yb[0])^AES.bmul(xb[1],yb[1])^AES.bmul(xb[2],yb[2])^AES.bmul(xb[3],yb[3]))&255};AES.InvMixCol=function(x){var b=[],y,m;m=AES.pack(AES.InCo);b[3]=AES.product(m,x);m=AES.ROTL24(m);b[2]=AES.product(m,x);m=AES.ROTL24(m);b[1]=AES.product(m,x);m=AES.ROTL24(m);b[0]=AES.product(m,x);y=AES.pack(b);return y};AES.InCo=[11,13,9,14];AES.rco=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47];AES.ptab=[1,3,5,15,17,51,85,255,26,46,114,150,161,248,19,53,95,225,56,72,216,115,149,164,247,2,6,10,30,34,102,170,229,52,92,228,55,89,235,38,106,190,217,112,144,171,230,49,83,245,4,12,20,60,68,204,79,209,104,184,211,110,178,205,76,212,103,169,224,59,77,215,98,166,241,8,24,40,120,136,131,158,185,208,107,189,220,127,129,152,179,206,73,219,118,154,181,196,87,249,16,48,80,240,11,29,39,105,187,214,97,163,254,25,43,125,135,146,173,236,47,113,147,174,233,32,96,160,251,22,58,78,210,109,183,194,93,231,50,86,250,21,63,65,195,94,226,61,71,201,64,192,91,237,44,116,156,191,218,117,159,186,213,100,172,239,42,126,130,157,188,223,122,142,137,128,155,182,193,88,232,35,101,175,234,37,111,177,200,67,197,84,252,31,33,99,165,244,7,9,27,45,119,153,176,203,70,202,69,207,74,222,121,139,134,145,168,227,62,66,198,81,243,14,18,54,90,238,41,123,141,140,143,138,133,148,167,242,13,23,57,75,221,124,132,151,162,253,28,36,108,180,199,82,246,1];AES.ltab=[0,255,25,1,50,2,26,198,75,199,27,104,51,238,223,3,100,4,224,14,52,141,129,239,76,113,8,200,248,105,28,193,125,194,29,181,249,185,39,106,77,228,166,114,154,201,9,120,101,47,138,5,33,15,225,36,18,240,130,69,53,147,218,142,150,143,219,189,54,208,206,148,19,92,210,241,64,70,131,56,102,221,253,48,191,6,139,98,179,37,226,152,34,136,145,16,126,110,72,195,163,182,30,66,58,107,40,84,250,133,61,186,43,121,10,21,155,159,94,202,78,212,172,229,243,115,167,87,175,88,168,80,244,234,214,116,79,174,233,213,231,230,173,232,44,215,117,122,235,22,11,245,89,203,95,176,156,169,81,160,127,12,246,111,23,196,73,236,216,67,31,45,164,118,123,183,204,187,62,90,251,96,177,134,59,82,161,108,170,85,41,157,151,178,135,144,97,190,220,252,188,149,207,205,55,63,91,209,83,57,132,60,65,162,109,71,20,42,158,93,86,242,211,171,68,17,146,217,35,32,46,137,180,124,184,38,119,153,227,165,103,74,237,222,197,49,254,24,13,99,140,128,192,247,112,7];AES.fbsub=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];AES.rbsub=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];AES.ftable=[2774754246,2222750968,2574743534,2373680118,234025727,3177933782,2976870366,1422247313,1345335392,50397442,2842126286,2099981142,436141799,1658312629,3870010189,2591454956,1170918031,2642575903,1086966153,2273148410,368769775,3948501426,3376891790,200339707,3970805057,1742001331,4255294047,3937382213,3214711843,4154762323,2524082916,1539358875,3266819957,486407649,2928907069,1780885068,1513502316,1094664062,49805301,1338821763,1546925160,4104496465,887481809,150073849,2473685474,1943591083,1395732834,1058346282,201589768,1388824469,1696801606,1589887901,672667696,2711000631,251987210,3046808111,151455502,907153956,2608889883,1038279391,652995533,1764173646,3451040383,2675275242,453576978,2659418909,1949051992,773462580,756751158,2993581788,3998898868,4221608027,4132590244,1295727478,1641469623,3467883389,2066295122,1055122397,1898917726,2542044179,4115878822,1758581177,0,753790401,1612718144,536673507,3367088505,3982187446,3194645204,1187761037,3653156455,1262041458,3729410708,3561770136,3898103984,1255133061,1808847035,720367557,3853167183,385612781,3309519750,3612167578,1429418854,2491778321,3477423498,284817897,100794884,2172616702,4031795360,1144798328,3131023141,3819481163,4082192802,4272137053,3225436288,2324664069,2912064063,3164445985,1211644016,83228145,3753688163,3249976951,1977277103,1663115586,806359072,452984805,250868733,1842533055,1288555905,336333848,890442534,804056259,3781124030,2727843637,3427026056,957814574,1472513171,4071073621,2189328124,1195195770,2892260552,3881655738,723065138,2507371494,2690670784,2558624025,3511635870,2145180835,1713513028,2116692564,2878378043,2206763019,3393603212,703524551,3552098411,1007948840,2044649127,3797835452,487262998,1994120109,1004593371,1446130276,1312438900,503974420,3679013266,168166924,1814307912,3831258296,1573044895,1859376061,4021070915,2791465668,2828112185,2761266481,937747667,2339994098,854058965,1137232011,1496790894,3077402074,2358086913,1691735473,3528347292,3769215305,3027004632,4199962284,133494003,636152527,2942657994,2390391540,3920539207,403179536,3585784431,2289596656,1864705354,1915629148,605822008,4054230615,3350508659,1371981463,602466507,2094914977,2624877800,555687742,3712699286,3703422305,2257292045,2240449039,2423288032,1111375484,3300242801,2858837708,3628615824,84083462,32962295,302911004,2741068226,1597322602,4183250862,3501832553,2441512471,1489093017,656219450,3114180135,954327513,335083755,3013122091,856756514,3144247762,1893325225,2307821063,2811532339,3063651117,572399164,2458355477,552200649,1238290055,4283782570,2015897680,2061492133,2408352771,4171342169,2156497161,386731290,3669999461,837215959,3326231172,3093850320,3275833730,2962856233,1999449434,286199582,3417354363,4233385128,3602627437,974525996];AES.rtable=[1353184337,1399144830,3282310938,2522752826,3412831035,4047871263,2874735276,2466505547,1442459680,4134368941,2440481928,625738485,4242007375,3620416197,2151953702,2409849525,1230680542,1729870373,2551114309,3787521629,41234371,317738113,2744600205,3338261355,3881799427,2510066197,3950669247,3663286933,763608788,3542185048,694804553,1154009486,1787413109,2021232372,1799248025,3715217703,3058688446,397248752,1722556617,3023752829,407560035,2184256229,1613975959,1165972322,3765920945,2226023355,480281086,2485848313,1483229296,436028815,2272059028,3086515026,601060267,3791801202,1468997603,715871590,120122290,63092015,2591802758,2768779219,4068943920,2997206819,3127509762,1552029421,723308426,2461301159,4042393587,2715969870,3455375973,3586000134,526529745,2331944644,2639474228,2689987490,853641733,1978398372,971801355,2867814464,111112542,1360031421,4186579262,1023860118,2919579357,1186850381,3045938321,90031217,1876166148,4279586912,620468249,2548678102,3426959497,2006899047,3175278768,2290845959,945494503,3689859193,1191869601,3910091388,3374220536,0,2206629897,1223502642,2893025566,1316117100,4227796733,1446544655,517320253,658058550,1691946762,564550760,3511966619,976107044,2976320012,266819475,3533106868,2660342555,1338359936,2720062561,1766553434,370807324,179999714,3844776128,1138762300,488053522,185403662,2915535858,3114841645,3366526484,2233069911,1275557295,3151862254,4250959779,2670068215,3170202204,3309004356,880737115,1982415755,3703972811,1761406390,1676797112,3403428311,277177154,1076008723,538035844,2099530373,4164795346,288553390,1839278535,1261411869,4080055004,3964831245,3504587127,1813426987,2579067049,4199060497,577038663,3297574056,440397984,3626794326,4019204898,3343796615,3251714265,4272081548,906744984,3481400742,685669029,646887386,2764025151,3835509292,227702864,2613862250,1648787028,3256061430,3904428176,1593260334,4121936770,3196083615,2090061929,2838353263,3004310991,999926984,2809993232,1852021992,2075868123,158869197,4095236462,28809964,2828685187,1701746150,2129067946,147831841,3873969647,3650873274,3459673930,3557400554,3598495785,2947720241,824393514,815048134,3227951669,935087732,2798289660,2966458592,366520115,1251476721,4158319681,240176511,804688151,2379631990,1303441219,1414376140,3741619940,3820343710,461924940,3089050817,2136040774,82468509,1563790337,1937016826,776014843,1511876531,1389550482,861278441,323475053,2355222426,2047648055,2383738969,2302415851,3995576782,902390199,3991215329,1018251130,1507840668,1064563285,2043548696,3208103795,3939366739,1537932639,342834655,2262516856,2180231114,1053059257,741614648,1598071746,1925389590,203809468,2336832552,1100287487,1895934009,3736275976,2632234200,2428589668,1636092795,1890988757,1952214088,1113045200];return AES}function BIG(ctx){var BIG=function(x){this.w=new Array(BIG.NLEN);switch(typeof x){case"object":this.copy(x);break;case"number":this.zero();this.w[0]=x;break;default:this.zero()}};BIG.CHUNK=32;BIG.MODBYTES=ctx.config["@NB"];BIG.BASEBITS=ctx.config["@BASE"];BIG.NLEN=1+Math.floor((8*BIG.MODBYTES-1)/BIG.BASEBITS);BIG.DNLEN=2*BIG.NLEN;BIG.BMASK=(1<<BIG.BASEBITS)-1;BIG.BIGBITS=8*BIG.MODBYTES;BIG.NEXCESS=1<<BIG.CHUNK-BIG.BASEBITS-1;BIG.MODINV=Math.pow(2,-BIG.BASEBITS);BIG.prototype={zero:function(){var i;for(i=0;i<BIG.NLEN;i++){this.w[i]=0}return this},one:function(){var i;this.w[0]=1;for(i=1;i<BIG.NLEN;i++){this.w[i]=0}return this},get:function(i){return this.w[i]},set:function(i,x){this.w[i]=x},iszilch:function(){var i;for(i=0;i<BIG.NLEN;i++){if(this.w[i]!==0){return false}}return true},isunity:function(){var i;for(i=1;i<BIG.NLEN;i++){if(this.w[i]!==0){return false}}if(this.w[0]!=1){return false}return true},cswap:function(b,d){var c=d,t,i;c=~(c-1);for(i=0;i<BIG.NLEN;i++){t=c&(this.w[i]^b.w[i]);this.w[i]^=t;b.w[i]^=t}},cmove:function(b,d){var c=d,i;c=~(c-1);for(i=0;i<BIG.NLEN;i++){this.w[i]^=(this.w[i]^b.w[i])&c}},copy:function(y){var i;for(i=0;i<BIG.NLEN;i++){this.w[i]=y.w[i]}return this},hcopy:function(y){var i;for(i=0;i<BIG.NLEN;i++){this.w[i]=y.w[i]}return this},rcopy:function(y){var i;for(i=0;i<BIG.NLEN;i++){this.w[i]=y[i]}return this},xortop:function(x){this.w[BIG.NLEN-1]^=x},ortop:function(x){this.w[BIG.NLEN-1]|=x},norm:function(){var carry=0,d,i;for(i=0;i<BIG.NLEN-1;i++){d=this.w[i]+carry;this.w[i]=d&BIG.BMASK;carry=d>>BIG.BASEBITS}this.w[BIG.NLEN-1]=this.w[BIG.NLEN-1]+carry;return this.w[BIG.NLEN-1]>>8*BIG.MODBYTES%BIG.BASEBITS},fshr:function(k){var r,i;r=this.w[0]&(1<<k)-1;for(i=0;i<BIG.NLEN-1;i++){this.w[i]=this.w[i]>>k|this.w[i+1]<<BIG.BASEBITS-k&BIG.BMASK}this.w[BIG.NLEN-1]=this.w[BIG.NLEN-1]>>k;return r},shr:function(k){var n=k%BIG.BASEBITS,m=Math.floor(k/BIG.BASEBITS),i;for(i=0;i<BIG.NLEN-m-1;i++){this.w[i]=this.w[m+i]>>n|this.w[m+i+1]<<BIG.BASEBITS-n&BIG.BMASK}this.w[BIG.NLEN-m-1]=this.w[BIG.NLEN-1]>>n;for(i=BIG.NLEN-m;i<BIG.NLEN;i++){this.w[i]=0}return this},fshl:function(k){var i;this.w[BIG.NLEN-1]=this.w[BIG.NLEN-1]<<k|this.w[BIG.NLEN-2]>>BIG.BASEBITS-k;for(i=BIG.NLEN-2;i>0;i--){this.w[i]=this.w[i]<<k&BIG.BMASK|this.w[i-1]>>BIG.BASEBITS-k}this.w[0]=this.w[0]<<k&BIG.BMASK;return this.w[BIG.NLEN-1]>>8*BIG.MODBYTES%BIG.BASEBITS},shl:function(k){var n=k%BIG.BASEBITS,m=Math.floor(k/BIG.BASEBITS),i;this.w[BIG.NLEN-1]=this.w[BIG.NLEN-1-m]<<n;if(BIG.NLEN>m+2){this.w[BIG.NLEN-1]|=this.w[BIG.NLEN-m-2]>>BIG.BASEBITS-n}for(i=BIG.NLEN-2;i>m;i--){this.w[i]=this.w[i-m]<<n&BIG.BMASK|this.w[i-m-1]>>BIG.BASEBITS-n}this.w[m]=this.w[0]<<n&BIG.BMASK;for(i=0;i<m;i++){this.w[i]=0}return this},nbits:function(){var k=BIG.NLEN-1,bts,c;this.norm();while(k>=0&&this.w[k]===0){k--}if(k<0){return 0}bts=BIG.BASEBITS*k;c=this.w[k];while(c!==0){c=Math.floor(c/2);bts++}return bts},toString:function(){var s="",len=this.nbits(),b,i;if(len%4===0){len=Math.floor(len/4)}else{len=Math.floor(len/4);len++}if(len<BIG.MODBYTES*2){len=BIG.MODBYTES*2}for(i=len-1;i>=0;i--){b=new BIG(0);b.copy(this);b.shr(i*4);s+=(b.w[0]&15).toString(16)}return s},add:function(y){var i;for(i=0;i<BIG.NLEN;i++){this.w[i]+=y.w[i]}return this},or:function(y){var i;for(i=0;i<BIG.NLEN;i++){this.w[i]|=y.w[i]}return this},plus:function(x){var s=new BIG(0),i;for(i=0;i<BIG.NLEN;i++){s.w[i]=this.w[i]+x.w[i]}return s},inc:function(i){this.norm();this.w[0]+=i;return this},sub:function(y){var i;for(i=0;i<BIG.NLEN;i++){this.w[i]-=y.w[i]}return this},rsub:function(x){var i;for(i=0;i<BIG.NLEN;i++){this.w[i]=x.w[i]-this.w[i]}return this},dec:function(i){this.norm();this.w[0]-=i;return this},minus:function(x){var d=new BIG(0),i;for(i=0;i<BIG.NLEN;i++){d.w[i]=this.w[i]-x.w[i]}return d},imul:function(c){var i;for(i=0;i<BIG.NLEN;i++){this.w[i]*=c}return this},tobytearray:function(b,n){var c=new BIG(0),i;this.norm();c.copy(this);for(i=BIG.MODBYTES-1;i>=0;i--){b[i+n]=c.w[0]&255;c.fshr(8)}return this},toBytes:function(b){this.tobytearray(b,0)},muladd:function(x,y,c,i){var prod=x*y+c+this.w[i];this.w[i]=prod&BIG.BMASK;return(prod-this.w[i])*BIG.MODINV},pmul:function(c){var carry=0,ak,i;for(i=0;i<BIG.NLEN;i++){ak=this.w[i];this.w[i]=0;carry=this.muladd(ak,c,carry,i)}return carry},pxmul:function(c){var m=new ctx.DBIG(0),carry=0,j;for(j=0;j<BIG.NLEN;j++){carry=m.muladd(this.w[j],c,carry,j)}m.w[BIG.NLEN]=carry;return m},div3:function(){var carry=0,ak,base,i;this.norm();base=1<<BIG.BASEBITS;for(i=BIG.NLEN-1;i>=0;i--){ak=carry*base+this.w[i];this.w[i]=Math.floor(ak/3);carry=ak%3}return carry},mod2m:function(m){var i,wd,bt,msk;wd=Math.floor(m/BIG.BASEBITS);bt=m%BIG.BASEBITS;msk=(1<<bt)-1;this.w[wd]&=msk;for(i=wd+1;i<BIG.NLEN;i++){this.w[i]=0}},invmod2m:function(){var U=new BIG(0),b=new BIG(0),c=new BIG(0),i,t1,t2;U.inc(BIG.invmod256(this.lastbits(8)));for(i=8;i<BIG.BIGBITS;i<<=1){U.norm();b.copy(this);b.mod2m(i);t1=BIG.smul(U,b);t1.shr(i);c.copy(this);c.shr(i);c.mod2m(i);t2=BIG.smul(U,c);t2.mod2m(i);t1.add(t2);t1.norm();b=BIG.smul(t1,U);t1.copy(b);t1.mod2m(i);t2.one();t2.shl(i);t1.rsub(t2);t1.norm();t1.shl(i);U.add(t1)}U.mod2m(BIG.BIGBITS);this.copy(U);this.norm()},mod:function(m){var k=0,r=new BIG(0);this.norm();if(BIG.comp(this,m)<0){return}do{m.fshl(1);k++}while(BIG.comp(this,m)>=0);while(k>0){m.fshr(1);r.copy(this);r.sub(m);r.norm();this.cmove(r,1-(r.w[BIG.NLEN-1]>>BIG.CHUNK-1&1));k--}},div:function(m){var k=0,d=0,e=new BIG(1),b=new BIG(0),r=new BIG(0);this.norm();b.copy(this);this.zero();while(BIG.comp(b,m)>=0){e.fshl(1);m.fshl(1);k++}while(k>0){m.fshr(1);e.fshr(1);r.copy(b);r.sub(m);r.norm();d=1-(r.w[BIG.NLEN-1]>>BIG.CHUNK-1&1);b.cmove(r,d);r.copy(this);r.add(e);r.norm();this.cmove(r,d);k--}},parity:function(){return this.w[0]%2},bit:function(n){if((this.w[Math.floor(n/BIG.BASEBITS)]&1<<n%BIG.BASEBITS)>0){return 1}else{return 0}},lastbits:function(n){var msk=(1<<n)-1;this.norm();return this.w[0]&msk},isok:function(){var ok=true,i;for(i=0;i<BIG.NLEN;i++){if(this.w[i]>>BIG.BASEBITS!=0){ok=false}}return ok},jacobi:function(p){var m=0,t=new BIG(0),x=new BIG(0),n=new BIG(0),zilch=new BIG(0),one=new BIG(1),n8,k;if(p.parity()===0||BIG.comp(this,zilch)===0||BIG.comp(p,one)<=0){return 0}this.norm();x.copy(this);n.copy(p);x.mod(p);while(BIG.comp(n,one)>0){if(BIG.comp(x,zilch)===0){return 0}n8=n.lastbits(3);k=0;while(x.parity()===0){k++;x.shr(1)}if(k%2==1){m+=(n8*n8-1)/8}m+=(n8-1)*(x.lastbits(2)-1)/4;t.copy(n);t.mod(x);n.copy(x);x.copy(t);m%=2}if(m===0){return 1}else{return-1}},invmodp:function(p){var u=new BIG(0),v=new BIG(0),x1=new BIG(1),x2=new BIG(0),t=new BIG(0),one=new BIG(1);this.mod(p);u.copy(this);v.copy(p);while(BIG.comp(u,one)!==0&&BIG.comp(v,one)!==0){while(u.parity()===0){u.fshr(1);if(x1.parity()!==0){x1.add(p);x1.norm()}x1.fshr(1)}while(v.parity()===0){v.fshr(1);if(x2.parity()!==0){x2.add(p);x2.norm()}x2.fshr(1)}if(BIG.comp(u,v)>=0){u.sub(v);u.norm();if(BIG.comp(x1,x2)>=0){x1.sub(x2)}else{t.copy(p);t.sub(x2);x1.add(t)}x1.norm()}else{v.sub(u);v.norm();if(BIG.comp(x2,x1)>=0){x2.sub(x1)}else{t.copy(p);t.sub(x1);x2.add(t)}x2.norm()}}if(BIG.comp(u,one)===0){this.copy(x1)}else{this.copy(x2)}},powmod:function(e,m){var a=new BIG(1),z=new BIG(0),s=new BIG(0),bt;this.norm();e.norm();z.copy(e);s.copy(this);for(;;){bt=z.parity();z.fshr(1);if(bt==1){a=BIG.modmul(a,s,m)}if(z.iszilch()){break}s=BIG.modsqr(s,m)}return a}};BIG.frombytearray=function(b,n){var m=new BIG(0),i;for(i=0;i<BIG.MODBYTES;i++){m.fshl(8);m.w[0]+=b[i+n]&255}return m};BIG.fromBytes=function(b){return BIG.frombytearray(b,0)};BIG.smul=function(a,b){var c=new BIG(0),carry,i,j;for(i=0;i<BIG.NLEN;i++){carry=0;for(j=0;j<BIG.NLEN;j++){if(i+j<BIG.NLEN){carry=c.muladd(a.w[i],b.w[j],carry,i+j)}}}return c};BIG.comp=function(a,b){var i;for(i=BIG.NLEN-1;i>=0;i--){if(a.w[i]==b.w[i]){continue}if(a.w[i]>b.w[i]){return 1}else{return-1}}return 0};BIG.random=function(rng){var m=new BIG(0),j=0,r=0,i,b;for(i=0;i<8*BIG.MODBYTES;i++){if(j===0){r=rng.getByte()}else{r>>=1}b=r&1;m.shl(1);m.w[0]+=b;j++;j&=7}return m};BIG.randomnum=function(q,rng){var d=new ctx.DBIG(0),j=0,r=0,i,b,m;for(i=0;i<2*q.nbits();i++){if(j===0){r=rng.getByte()}else{r>>=1}b=r&1;d.shl(1);d.w[0]+=b;j++;j&=7}m=d.mod(q);return m};BIG.mul=function(a,b){var c=new ctx.DBIG(0),d=[],n,s,t,i,k,co;for(i=0;i<BIG.NLEN;i++){d[i]=a.w[i]*b.w[i]}s=d[0];t=s;c.w[0]=t;for(k=1;k<BIG.NLEN;k++){s+=d[k];t=s;for(i=k;i>=1+Math.floor(k/2);i--){t+=(a.w[i]-a.w[k-i])*(b.w[k-i]-b.w[i])}c.w[k]=t}for(k=BIG.NLEN;k<2*BIG.NLEN-1;k++){s-=d[k-BIG.NLEN];t=s;for(i=BIG.NLEN-1;i>=1+Math.floor(k/2);i--){t+=(a.w[i]-a.w[k-i])*(b.w[k-i]-b.w[i])}c.w[k]=t}co=0;for(i=0;i<BIG.DNLEN-1;i++){n=c.w[i]+co;c.w[i]=n&BIG.BMASK;co=(n-c.w[i])*BIG.MODINV}c.w[BIG.DNLEN-1]=co;return c};BIG.sqr=function(a){var c=new ctx.DBIG(0),n,t,j,i,co;c.w[0]=a.w[0]*a.w[0];for(j=1;j<BIG.NLEN-1;){t=a.w[j]*a.w[0];for(i=1;i<j+1>>1;i++){t+=a.w[j-i]*a.w[i]}t+=t;c.w[j]=t;j++;t=a.w[j]*a.w[0];for(i=1;i<j+1>>1;i++){t+=a.w[j-i]*a.w[i]}t+=t;t+=a.w[j>>1]*a.w[j>>1];c.w[j]=t;j++}for(j=BIG.NLEN-1+BIG.NLEN%2;j<BIG.DNLEN-3;){t=a.w[BIG.NLEN-1]*a.w[j-BIG.NLEN+1];for(i=j-BIG.NLEN+2;i<j+1>>1;i++){t+=a.w[j-i]*a.w[i]}t+=t;c.w[j]=t;j++;t=a.w[BIG.NLEN-1]*a.w[j-BIG.NLEN+1];for(i=j-BIG.NLEN+2;i<j+1>>1;i++){t+=a.w[j-i]*a.w[i]}t+=t;t+=a.w[j>>1]*a.w[j>>1];c.w[j]=t;j++}t=a.w[BIG.NLEN-2]*a.w[BIG.NLEN-1];t+=t;c.w[BIG.DNLEN-3]=t;t=a.w[BIG.NLEN-1]*a.w[BIG.NLEN-1];c.w[BIG.DNLEN-2]=t;co=0;for(i=0;i<BIG.DNLEN-1;i++){n=c.w[i]+co;c.w[i]=n&BIG.BMASK;co=(n-c.w[i])*BIG.MODINV}c.w[BIG.DNLEN-1]=co;return c};BIG.monty=function(m,nd,d){var b=new BIG(0),v=[],dd=[],s,c,t,i,k;t=d.w[0];v[0]=(t&BIG.BMASK)*nd&BIG.BMASK;t+=v[0]*m.w[0];c=d.w[1]+t*BIG.MODINV;s=0;for(k=1;k<BIG.NLEN;k++){t=c+s+v[0]*m.w[k];for(i=k-1;i>Math.floor(k/2);i--){t+=(v[k-i]-v[i])*(m.w[i]-m.w[k-i])}v[k]=(t&BIG.BMASK)*nd&BIG.BMASK;t+=v[k]*m.w[0];c=t*BIG.MODINV+d.w[k+1];dd[k]=v[k]*m.w[k];s+=dd[k]}for(k=BIG.NLEN;k<2*BIG.NLEN-1;k++){t=c+s;for(i=BIG.NLEN-1;i>=1+Math.floor(k/2);i--){t+=(v[k-i]-v[i])*(m.w[i]-m.w[k-i])}b.w[k-BIG.NLEN]=t&BIG.BMASK;c=(t-b.w[k-BIG.NLEN])*BIG.MODINV+d.w[k+1];s-=dd[k-BIG.NLEN+1]}b.w[BIG.NLEN-1]=c&BIG.BMASK;return b};BIG.modmul=function(a,b,m){var d;a.mod(m);b.mod(m);d=BIG.mul(a,b);return d.mod(m)};BIG.modsqr=function(a,m){var d;a.mod(m);d=BIG.sqr(a);return d.mod(m)};BIG.modneg=function(a,m){a.mod(m);return m.minus(a)};BIG.invmod256=function(a){var U,t1,t2,b,c;t1=0;c=a>>1&1;t1+=c;t1&=1;t1=2-t1;t1<<=1;U=t1+1;b=a&3;t1=U*b;t1>>=2;c=a>>2&3;t2=U*c&3;t1+=t2;t1*=U;t1&=3;t1=4-t1;t1<<=2;U+=t1;b=a&15;t1=U*b;t1>>=4;c=a>>4&15;t2=U*c&15;t1+=t2;t1*=U;t1&=15;t1=16-t1;t1<<=4;U+=t1;return U};return BIG}function DBIG(ctx){var DBIG=function(x){this.w=[];this.zero();this.w[0]=x};DBIG.prototype={zero:function(){for(var i=0;i<ctx.BIG.DNLEN;i++){this.w[i]=0}return this},copy:function(b){for(var i=0;i<ctx.BIG.DNLEN;i++){this.w[i]=b.w[i]}return this},hcopy:function(b){var i;for(i=0;i<ctx.BIG.NLEN;i++){this.w[i]=b.w[i]}for(i=ctx.BIG.NLEN;i<ctx.BIG.DNLEN;i++){this.w[i]=0}return this},ucopy:function(b){var i;for(i=0;i<ctx.BIG.NLEN;i++){this.w[i]=0}for(i=ctx.BIG.NLEN;i<ctx.BIG.DNLEN;i++){this.w[i]=b.w[i-ctx.BIG.NLEN]}return this},norm:function(){var carry=0,d,i;for(i=0;i<ctx.BIG.DNLEN-1;i++){d=this.w[i]+carry;this.w[i]=d&ctx.BIG.BMASK;carry=d>>ctx.BIG.BASEBITS}this.w[ctx.BIG.DNLEN-1]=this.w[ctx.BIG.DNLEN-1]+carry;return this},muladd:function(x,y,c,i){var prod=x*y+c+this.w[i];this.w[i]=prod&ctx.BIG.BMASK;return(prod-this.w[i])*ctx.BIG.MODINV},shr:function(k){var n=k%ctx.BIG.BASEBITS,m=Math.floor(k/ctx.BIG.BASEBITS),i;for(i=0;i<ctx.BIG.DNLEN-m-1;i++){this.w[i]=this.w[m+i]>>n|this.w[m+i+1]<<ctx.BIG.BASEBITS-n&ctx.BIG.BMASK}this.w[ctx.BIG.DNLEN-m-1]=this.w[ctx.BIG.DNLEN-1]>>n;for(i=ctx.BIG.DNLEN-m;i<ctx.BIG.DNLEN;i++){this.w[i]=0}return this},shl:function(k){var n=k%ctx.BIG.BASEBITS,m=Math.floor(k/ctx.BIG.BASEBITS),i;this.w[ctx.BIG.DNLEN-1]=this.w[ctx.BIG.DNLEN-1-m]<<n|this.w[ctx.BIG.DNLEN-m-2]>>ctx.BIG.BASEBITS-n;for(i=ctx.BIG.DNLEN-2;i>m;i--){this.w[i]=this.w[i-m]<<n&ctx.BIG.BMASK|this.w[i-m-1]>>ctx.BIG.BASEBITS-n}this.w[m]=this.w[0]<<n&ctx.BIG.BMASK;for(i=0;i<m;i++){this.w[i]=0}return this},cmove:function(b,d){var c=d,i;c=~(c-1);for(i=0;i<ctx.BIG.DNLEN;i++){this.w[i]^=(this.w[i]^b.w[i])&c}},add:function(x){for(var i=0;i<ctx.BIG.DNLEN;i++){this.w[i]+=x.w[i]}},sub:function(x){for(var i=0;i<ctx.BIG.DNLEN;i++){this.w[i]-=x.w[i]}},rsub:function(x){for(var i=0;i<ctx.BIG.DNLEN;i++){this.w[i]=x.w[i]-this.w[i]}},nbits:function(){var k=ctx.BIG.DNLEN-1,bts,c;this.norm();while(k>=0&&this.w[k]===0){k--}if(k<0){return 0}bts=ctx.BIG.BASEBITS*k;c=this.w[k];while(c!==0){c=Math.floor(c/2);bts++}return bts},toString:function(){var s="",len=this.nbits(),b,i;if(len%4===0){len=Math.floor(len/4)}else{len=Math.floor(len/4);len++}for(i=len-1;i>=0;i--){b=new DBIG(0);b.copy(this);b.shr(i*4);s+=(b.w[0]&15).toString(16)}return s},mod:function(c){var k=0,m=new DBIG(0),dr=new DBIG(0),r=new ctx.BIG(0);this.norm();m.hcopy(c);r.hcopy(this);if(DBIG.comp(this,m)<0){return r}do{m.shl(1);k++}while(DBIG.comp(this,m)>=0);while(k>0){m.shr(1);dr.copy(this);dr.sub(m);dr.norm();this.cmove(dr,1-(dr.w[ctx.BIG.DNLEN-1]>>ctx.BIG.CHUNK-1&1));k--}r.hcopy(this);return r},div:function(c){var d=0,k=0,m=new DBIG(0),dr=new DBIG(0),r=new ctx.BIG(0),a=new ctx.BIG(0),e=new ctx.BIG(1);m.hcopy(c);this.norm();while(DBIG.comp(this,m)>=0){e.fshl(1);m.shl(1);k++}while(k>0){m.shr(1);e.shr(1);dr.copy(this);dr.sub(m);dr.norm();d=1-(dr.w[ctx.BIG.DNLEN-1]>>ctx.BIG.CHUNK-1&1);this.cmove(dr,d);r.copy(a);r.add(e);r.norm();a.cmove(r,d);k--}return a},split:function(n){var t=new ctx.BIG(0),m=n%ctx.BIG.BASEBITS,carry=this.w[ctx.BIG.DNLEN-1]<<ctx.BIG.BASEBITS-m,nw,i;for(i=ctx.BIG.DNLEN-2;i>=ctx.BIG.NLEN-1;i--){nw=this.w[i]>>m|carry;carry=this.w[i]<<ctx.BIG.BASEBITS-m&ctx.BIG.BMASK;t.w[i-ctx.BIG.NLEN+1]=nw}this.w[ctx.BIG.NLEN-1]&=(1<<m)-1;return t}};DBIG.comp=function(a,b){var i;for(i=ctx.BIG.DNLEN-1;i>=0;i--){if(a.w[i]==b.w[i]){continue}if(a.w[i]>b.w[i]){return 1}else{return-1}}return 0};return DBIG}function ECDH(ctx){var ECDH={INVALID_PUBLIC_KEY:-2,ERROR:-3,INVALID:-4,EFS:ctx.BIG.MODBYTES,EGS:ctx.BIG.MODBYTES,SHA256:32,SHA384:48,SHA512:64,inttobytes:function(n,len){var b=[],i;for(i=0;i<len;i++){b[i]=0}i=len;while(n>0&&i>0){i--;b[i]=n&255;n=Math.floor(n/256)}return b},bytestostring:function(b){var s="",len=b.length,ch,i;for(i=0;i<len;i++){ch=b[i];s+=String.fromCharCode(ch)}return s},stringtobytes:function(s){var b=[],i;for(i=0;i<s.length;i++){b.push(s.charCodeAt(i))}return b},hashit:function(sha,A,n,B,pad){var R=[],H,W,i;if(sha==this.SHA256){H=new ctx.HASH256}else if(sha==this.SHA384){H=new ctx.HASH384}else if(sha==this.SHA512){H=new ctx.HASH512}if(n>0){H.process_num(n)}if(B!=null){H.process_array(B)}R=H.hash();if(R.length==0){return null}if(pad==0){return R}W=[];if(sha>=pad){for(i=0;i<pad;i++){W[i]=R[i]}}else{for(i=0;i<sha;i++){W[i+pad-sha]=R[i]}for(i=0;i<pad-sha;i++){W[i]=0}}return W},KDF1:function(sha,Z,olen){var hlen=sha,K=[],B=[],k=0,counter,cthreshold,i;for(i=0;i<K.length;i++){K[i]=0}cthreshold=Math.floor(olen/hlen);if(olen%hlen!==0){cthreshold++}for(counter=0;counter<cthreshold;counter++){B=this.hashit(sha,Z,counter,null,0);if(k+hlen>olen){for(i=0;i<olen%hlen;i++){K[k++]=B[i]}}else{for(i=0;i<hlen;i++){K[k++]=B[i]}}}return K},
KDF2:function(sha,Z,P,olen){var hlen=sha,K=[],B=[],k=0,counter,cthreshold,i;for(i=0;i<K.length;i++){K[i]=0}cthreshold=Math.floor(olen/hlen);if(olen%hlen!==0){cthreshold++}for(counter=1;counter<=cthreshold;counter++){B=this.hashit(sha,Z,counter,P,0);if(k+hlen>olen){for(i=0;i<olen%hlen;i++){K[k++]=B[i]}}else{for(i=0;i<hlen;i++){K[k++]=B[i]}}}return K},PBKDF2:function(sha,Pass,Salt,rep,olen){var F=new Array(sha),U=[],S=[],K=[],opt=0,i,j,k,d,N,key;d=Math.floor(olen/sha);if(olen%sha!==0){d++}opt=0;for(i=1;i<=d;i++){for(j=0;j<Salt.length;j++){S[j]=Salt[j]}N=this.inttobytes(i,4);for(j=0;j<4;j++){S[Salt.length+j]=N[j]}this.HMAC(sha,S,Pass,F);for(j=0;j<sha;j++){U[j]=F[j]}for(j=2;j<=rep;j++){this.HMAC(sha,U,Pass,U);for(k=0;k<sha;k++){F[k]^=U[k]}}for(j=0;j<sha;j++){K[opt++]=F[j]}}key=[];for(i=0;i<olen;i++){key[i]=K[i]}return key},HMAC:function(sha,M,K,tag){var olen=tag.length,B=[],b=64,K0,i;if(sha>32){b=128}K0=new Array(b);if(olen<4){return 0}for(i=0;i<b;i++){K0[i]=0}if(K.length>b){B=this.hashit(sha,K,0,null,0);for(i=0;i<sha;i++){K0[i]=B[i]}}else{for(i=0;i<K.length;i++){K0[i]=K[i]}}for(i=0;i<b;i++){K0[i]^=54}B=this.hashit(sha,K0,0,M,0);for(i=0;i<b;i++){K0[i]^=106}B=this.hashit(sha,K0,0,B,olen);for(i=0;i<olen;i++){tag[i]=B[i]}return 1},AES_CBC_IV0_ENCRYPT:function(K,M){var a=new ctx.AES,buff=[],C=[],fin,padlen,i,j,ipt,opt;a.init(ctx.AES.CBC,K.length,K,null);ipt=opt=0;fin=false;for(;;){for(i=0;i<16;i++){if(ipt<M.length){buff[i]=M[ipt++]}else{fin=true;break}}if(fin){break}a.encrypt(buff);for(i=0;i<16;i++){C[opt++]=buff[i]}}padlen=16-i;for(j=i;j<16;j++){buff[j]=padlen}a.encrypt(buff);for(i=0;i<16;i++){C[opt++]=buff[i]}a.end();return C},AES_CBC_IV0_DECRYPT:function(K,C){var a=new ctx.AES,buff=[],MM=[],ipt=0,opt=0,M,ch,fin,bad,padlen,i;a.init(ctx.AES.CBC,K.length,K,null);if(C.length===0){return[]}ch=C[ipt++];fin=false;for(;;){for(i=0;i<16;i++){buff[i]=ch;if(ipt>=C.length){fin=true;break}else{ch=C[ipt++]}}a.decrypt(buff);if(fin){break}for(i=0;i<16;i++){MM[opt++]=buff[i]}}a.end();bad=false;padlen=buff[15];if(i!=15||padlen<1||padlen>16){bad=true}if(padlen>=2&&padlen<=16){for(i=16-padlen;i<16;i++){if(buff[i]!=padlen){bad=true}}}if(!bad){for(i=0;i<16-padlen;i++){MM[opt++]=buff[i]}}M=[];if(bad){return M}for(i=0;i<opt;i++){M[i]=MM[i]}return M},KEY_PAIR_GENERATE:function(RNG,S,W){var res=0,r,s,G,WP;G=ctx.ECP.generator();r=new ctx.BIG(0);r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(RNG===null){s=ctx.BIG.fromBytes(S);s.mod(r)}else{s=ctx.BIG.randomnum(r,RNG)}s.toBytes(S);WP=G.mul(s);WP.toBytes(W,false);return res},PUBLIC_KEY_VALIDATE:function(W){var WP=ctx.ECP.fromBytes(W),res=0,r,q,nb,k;r=new ctx.BIG(0);r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(WP.is_infinity()){res=this.INVALID_PUBLIC_KEY}if(res===0){q=new ctx.BIG(0);q.rcopy(ctx.ROM_FIELD.Modulus);nb=q.nbits();k=new ctx.BIG(1);k.shl(Math.floor((nb+4)/2));k.add(q);k.div(r);while(k.parity()==0){k.shr(1);WP.dbl()}if(!k.isunity()){WP=WP.mul(k)}if(WP.is_infinity()){res=this.INVALID_PUBLIC_KEY}}return res},ECPSVDP_DH:function(S,WD,Z){var T=[],res=0,r,s,i,W;s=ctx.BIG.fromBytes(S);W=ctx.ECP.fromBytes(WD);if(W.is_infinity()){res=this.ERROR}if(res===0){r=new ctx.BIG(0);r.rcopy(ctx.ROM_CURVE.CURVE_Order);s.mod(r);W=W.mul(s);if(W.is_infinity()){res=this.ERROR}else{W.getX().toBytes(T);for(i=0;i<this.EFS;i++){Z[i]=T[i]}}}return res},ECPSP_DSA:function(sha,RNG,S,F,C,D){var T=[],i,r,s,f,c,d,u,vx,w,G,V,B;B=this.hashit(sha,F,0,null,ctx.BIG.MODBYTES);G=ctx.ECP.generator();r=new ctx.BIG(0);r.rcopy(ctx.ROM_CURVE.CURVE_Order);s=ctx.BIG.fromBytes(S);f=ctx.BIG.fromBytes(B);c=new ctx.BIG(0);d=new ctx.BIG(0);V=new ctx.ECP;do{u=ctx.BIG.randomnum(r,RNG);w=ctx.BIG.randomnum(r,RNG);V.copy(G);V=V.mul(u);vx=V.getX();c.copy(vx);c.mod(r);if(c.iszilch()){continue}u=ctx.BIG.modmul(u,w,r);u.invmodp(r);d=ctx.BIG.modmul(s,c,r);d.add(f);d=ctx.BIG.modmul(d,w,r);d=ctx.BIG.modmul(u,d,r)}while(d.iszilch());c.toBytes(T);for(i=0;i<this.EFS;i++){C[i]=T[i]}d.toBytes(T);for(i=0;i<this.EFS;i++){D[i]=T[i]}return 0},ECPVP_DSA:function(sha,W,F,C,D){var B=[],res=0,r,f,c,d,h2,G,WP,P;B=this.hashit(sha,F,0,null,ctx.BIG.MODBYTES);G=ctx.ECP.generator();r=new ctx.BIG(0);r.rcopy(ctx.ROM_CURVE.CURVE_Order);c=ctx.BIG.fromBytes(C);d=ctx.BIG.fromBytes(D);f=ctx.BIG.fromBytes(B);if(c.iszilch()||ctx.BIG.comp(c,r)>=0||d.iszilch()||ctx.BIG.comp(d,r)>=0){res=this.INVALID}if(res===0){d.invmodp(r);f=ctx.BIG.modmul(f,d,r);h2=ctx.BIG.modmul(c,d,r);WP=ctx.ECP.fromBytes(W);if(WP.is_infinity()){res=this.ERROR}else{P=new ctx.ECP;P.copy(WP);P=P.mul2(h2,G,f);if(P.is_infinity()){res=this.INVALID}else{d=P.getX();d.mod(r);if(ctx.BIG.comp(d,c)!==0){res=this.INVALID}}}}return res},ECIES_ENCRYPT:function(sha,P1,P2,RNG,W,M,V,T){var Z=[],VZ=[],K1=[],K2=[],U=[],C=[],K,L2,AC,i;if(this.KEY_PAIR_GENERATE(RNG,U,V)!==0){return C}if(this.ECPSVDP_DH(U,W,Z)!==0){return C}for(i=0;i<2*this.EFS+1;i++){VZ[i]=V[i]}for(i=0;i<this.EFS;i++){VZ[2*this.EFS+1+i]=Z[i]}K=this.KDF2(sha,VZ,P1,2*ctx.ECP.AESKEY);for(i=0;i<ctx.ECP.AESKEY;i++){K1[i]=K[i];K2[i]=K[ctx.ECP.AESKEY+i]}C=this.AES_CBC_IV0_ENCRYPT(K1,M);L2=this.inttobytes(P2.length,8);AC=[];for(i=0;i<C.length;i++){AC[i]=C[i]}for(i=0;i<P2.length;i++){AC[C.length+i]=P2[i]}for(i=0;i<8;i++){AC[C.length+P2.length+i]=L2[i]}this.HMAC(sha,AC,K2,T);return C},ECIES_DECRYPT:function(sha,P1,P2,V,C,T,U){var Z=[],VZ=[],K1=[],K2=[],TAG=new Array(T.length),M=[],K,L2,AC,same,i;if(this.ECPSVDP_DH(U,V,Z)!==0){return M}for(i=0;i<2*this.EFS+1;i++){VZ[i]=V[i]}for(i=0;i<this.EFS;i++){VZ[2*this.EFS+1+i]=Z[i]}K=this.KDF2(sha,VZ,P1,2*ctx.ECP.AESKEY);for(i=0;i<ctx.ECP.AESKEY;i++){K1[i]=K[i];K2[i]=K[ctx.ECP.AESKEY+i]}M=this.AES_CBC_IV0_DECRYPT(K1,C);if(M.length===0){return M}L2=this.inttobytes(P2.length,8);AC=[];for(i=0;i<C.length;i++){AC[i]=C[i]}for(i=0;i<P2.length;i++){AC[C.length+i]=P2[i]}for(i=0;i<8;i++){AC[C.length+P2.length+i]=L2[i]}this.HMAC(sha,AC,K2,TAG);same=true;for(i=0;i<T.length;i++){if(T[i]!=TAG[i]){same=false}}if(!same){return[]}return M}};return ECDH}function ECP(ctx){var ECP=function(){this.x=new ctx.FP(0);this.y=new ctx.FP(1);if(ECP.CURVETYPE!=ECP.EDWARDS){this.z=new ctx.FP(0)}else{this.z=new ctx.FP(1)}};ECP.WEIERSTRASS=0;ECP.EDWARDS=1;ECP.MONTGOMERY=2;ECP.NOT=0;ECP.BN=1;ECP.BLS=2;ECP.D_TYPE=0;ECP.M_TYPE=1;ECP.POSITIVEX=0;ECP.NEGATIVEX=1;ECP.CURVETYPE=ctx.config["@CT"];ECP.CURVE_PAIRING_TYPE=ctx.config["@PF"];ECP.SEXTIC_TWIST=ctx.config["@ST"];ECP.SIGN_OF_X=ctx.config["@SX"];ECP.HASH_TYPE=ctx.config["@HT"];ECP.AESKEY=ctx.config["@AK"];ECP.prototype={is_infinity:function(){this.x.reduce();this.z.reduce();if(ECP.CURVETYPE==ECP.EDWARDS){this.y.reduce();return this.x.iszilch()&&this.y.equals(this.z)}else if(ECP.CURVETYPE==ECP.WEIERSTRASS){this.y.reduce();return this.x.iszilch()&&this.z.iszilch()}else if(ECP.CURVETYPE==ECP.MONTGOMERY){return this.z.iszilch()}return true},cswap:function(Q,d){this.x.cswap(Q.x,d);if(ECP.CURVETYPE!=ECP.MONTGOMERY){this.y.cswap(Q.y,d)}this.z.cswap(Q.z,d)},cmove:function(Q,d){this.x.cmove(Q.x,d);if(ECP.CURVETYPE!=ECP.MONTGOMERY){this.y.cmove(Q.y,d)}this.z.cmove(Q.z,d)},select:function(W,b){var MP=new ECP,m=b>>31,babs=(b^m)-m;babs=(babs-1)/2;this.cmove(W[0],ECP.teq(babs,0));this.cmove(W[1],ECP.teq(babs,1));this.cmove(W[2],ECP.teq(babs,2));this.cmove(W[3],ECP.teq(babs,3));this.cmove(W[4],ECP.teq(babs,4));this.cmove(W[5],ECP.teq(babs,5));this.cmove(W[6],ECP.teq(babs,6));this.cmove(W[7],ECP.teq(babs,7));MP.copy(this);MP.neg();this.cmove(MP,m&1)},equals:function(Q){var a,b;a=new ctx.FP(0);b=new ctx.FP(0);a.copy(this.x);a.mul(Q.z);a.reduce();b.copy(Q.x);b.mul(this.z);b.reduce();if(!a.equals(b)){return false}if(ECP.CURVETYPE!=ECP.MONTGOMERY){a.copy(this.y);a.mul(Q.z);a.reduce();b.copy(Q.y);b.mul(this.z);b.reduce();if(!a.equals(b)){return false}}return true},copy:function(P){this.x.copy(P.x);if(ECP.CURVETYPE!=ECP.MONTGOMERY){this.y.copy(P.y)}this.z.copy(P.z)},neg:function(){if(ECP.CURVETYPE==ECP.WEIERSTRASS){this.y.neg();this.y.norm()}else if(ECP.CURVETYPE==ECP.EDWARDS){this.x.neg();this.x.norm()}return},inf:function(){this.x.zero();if(ECP.CURVETYPE!=ECP.MONTGOMERY){this.y.one()}if(ECP.CURVETYPE!=ECP.EDWARDS){this.z.zero()}else{this.z.one()}},setxy:function(ix,iy){var rhs,y2;this.x=new ctx.FP(0);this.x.bcopy(ix);this.y=new ctx.FP(0);this.y.bcopy(iy);this.z=new ctx.FP(1);rhs=ECP.RHS(this.x);if(ECP.CURVETYPE==ECP.MONTGOMERY){if(rhs.jacobi()!=1){this.inf()}}else{y2=new ctx.FP(0);y2.copy(this.y);y2.sqr();if(!y2.equals(rhs)){this.inf()}}},setxi:function(ix,s){var rhs,ny;this.x=new ctx.FP(0);this.x.bcopy(ix);rhs=ECP.RHS(this.x);this.z=new ctx.FP(1);if(rhs.jacobi()==1){ny=rhs.sqrt();if(ny.redc().parity()!=s){ny.neg()}this.y=ny}else{this.inf()}},setx:function(ix){var rhs;this.x=new ctx.FP(0);this.x.bcopy(ix);rhs=ECP.RHS(this.x);this.z=new ctx.FP(1);if(rhs.jacobi()==1){if(ECP.CURVETYPE!=ECP.MONTGOMERY){this.y=rhs.sqrt()}}else{this.inf()}},affine:function(){var one;if(this.is_infinity()){return}one=new ctx.FP(1);if(this.z.equals(one)){return}this.z.inverse();if(ECP.CURVETYPE==ECP.EDWARDS||ECP.CURVETYPE==ECP.WEIERSTRASS){this.x.mul(this.z);this.x.reduce();this.y.mul(this.z);this.y.reduce();this.z=one}if(ECP.CURVETYPE==ECP.MONTGOMERY){this.x.mul(this.z);this.x.reduce();this.z=one}},getX:function(){this.affine();return this.x.redc()},getY:function(){this.affine();return this.y.redc()},getS:function(){this.affine();var y=this.getY();return y.parity()},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},toBytes:function(b){var t=[],i;if(ECP.CURVETYPE!=ECP.MONTGOMERY){b[0]=4}else{b[0]=2}this.affine();this.x.redc().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+1]=t[i]}if(ECP.CURVETYPE!=ECP.MONTGOMERY){this.y.redc().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+ctx.BIG.MODBYTES+1]=t[i]}}},toString:function(){if(this.is_infinity()){return"infinity"}this.affine();if(ECP.CURVETYPE==ECP.MONTGOMERY){return"("+this.x.redc().toString()+")"}else{return"("+this.x.redc().toString()+","+this.y.redc().toString()+")"}},dbl:function(){var t0,t1,t2,t3,x3,y3,z3,b,C,D,H,J,A,B,AA,BB;if(ECP.CURVETYPE==ECP.WEIERSTRASS){if(ctx.ROM_CURVE.CURVE_A==0){t0=new ctx.FP(0);t0.copy(this.y);t0.sqr();t1=new ctx.FP(0);t1.copy(this.y);t1.mul(this.z);t2=new ctx.FP(0);t2.copy(this.z);t2.sqr();this.z.copy(t0);this.z.add(t0);this.z.norm();this.z.add(this.z);this.z.add(this.z);this.z.norm();t2.imul(3*ctx.ROM_CURVE.CURVE_B_I);x3=new ctx.FP(0);x3.copy(t2);x3.mul(this.z);y3=new ctx.FP(0);y3.copy(t0);y3.add(t2);y3.norm();this.z.mul(t1);t1.copy(t2);t1.add(t2);t2.add(t1);t0.sub(t2);t0.norm();y3.mul(t0);y3.add(x3);t1.copy(this.x);t1.mul(this.y);this.x.copy(t0);this.x.norm();this.x.mul(t1);this.x.add(this.x);this.x.norm();this.y.copy(y3);this.y.norm()}else{t0=new ctx.FP(0);t0.copy(this.x);t1=new ctx.FP(0);t1.copy(this.y);t2=new ctx.FP(0);t2.copy(this.z);t3=new ctx.FP(0);t3.copy(this.x);z3=new ctx.FP(0);z3.copy(this.z);y3=new ctx.FP(0);x3=new ctx.FP(0);b=new ctx.FP(0);if(ctx.ROM_CURVE.CURVE_B_I==0){b.rcopy(ctx.ROM_CURVE.CURVE_B)}t0.sqr();t1.sqr();t2.sqr();t3.mul(this.y);t3.add(t3);t3.norm();z3.mul(this.x);z3.add(z3);z3.norm();y3.copy(t2);if(ctx.ROM_CURVE.CURVE_B_I==0){y3.mul(b)}else{y3.imul(ctx.ROM_CURVE.CURVE_B_I)}y3.sub(z3);x3.copy(y3);x3.add(y3);x3.norm();y3.add(x3);x3.copy(t1);x3.sub(y3);x3.norm();y3.add(t1);y3.norm();y3.mul(x3);x3.mul(t3);t3.copy(t2);t3.add(t2);t2.add(t3);if(ctx.ROM_CURVE.CURVE_B_I==0){z3.mul(b)}else{z3.imul(ctx.ROM_CURVE.CURVE_B_I)}z3.sub(t2);z3.sub(t0);z3.norm();t3.copy(z3);t3.add(z3);z3.add(t3);z3.norm();t3.copy(t0);t3.add(t0);t0.add(t3);t0.sub(t2);t0.norm();t0.mul(z3);y3.add(t0);t0.copy(this.y);t0.mul(this.z);t0.add(t0);t0.norm();z3.mul(t0);x3.sub(z3);t0.add(t0);t0.norm();t1.add(t1);t1.norm();z3.copy(t0);z3.mul(t1);this.x.copy(x3);this.x.norm();this.y.copy(y3);this.y.norm();this.z.copy(z3);this.z.norm()}}if(ECP.CURVETYPE==ECP.EDWARDS){C=new ctx.FP(0);C.copy(this.x);D=new ctx.FP(0);D.copy(this.y);H=new ctx.FP(0);H.copy(this.z);J=new ctx.FP(0);this.x.mul(this.y);this.x.add(this.x);this.x.norm();C.sqr();D.sqr();if(ctx.ROM_CURVE.CURVE_A==-1){C.neg()}this.y.copy(C);this.y.add(D);this.y.norm();H.sqr();H.add(H);this.z.copy(this.y);J.copy(this.y);J.sub(H);J.norm();this.x.mul(J);C.sub(D);C.norm();this.y.mul(C);this.z.mul(J)}if(ECP.CURVETYPE==ECP.MONTGOMERY){A=new ctx.FP(0);A.copy(this.x);B=new ctx.FP(0);B.copy(this.x);AA=new ctx.FP(0);BB=new ctx.FP(0);C=new ctx.FP(0);A.add(this.z);A.norm();AA.copy(A);AA.sqr();B.sub(this.z);B.norm();BB.copy(B);BB.sqr();C.copy(AA);C.sub(BB);C.norm();this.x.copy(AA);this.x.mul(BB);A.copy(C);A.imul(ctx.ROM_CURVE.CURVE_A+2>>2);BB.add(A);BB.norm();this.z.copy(BB);this.z.mul(C)}return},add:function(Q){var b,t0,t1,t2,t3,t4,x3,y3,z3,A,B,C,D,E,F,G;if(ECP.CURVETYPE==ECP.WEIERSTRASS){if(ctx.ROM_CURVE.CURVE_A==0){b=3*ctx.ROM_CURVE.CURVE_B_I;t0=new ctx.FP(0);t0.copy(this.x);t0.mul(Q.x);t1=new ctx.FP(0);t1.copy(this.y);t1.mul(Q.y);t2=new ctx.FP(0);t2.copy(this.z);t2.mul(Q.z);t3=new ctx.FP(0);t3.copy(this.x);t3.add(this.y);t3.norm();t4=new ctx.FP(0);t4.copy(Q.x);t4.add(Q.y);t4.norm();t3.mul(t4);t4.copy(t0);t4.add(t1);t3.sub(t4);t3.norm();t4.copy(this.y);t4.add(this.z);t4.norm();x3=new ctx.FP(0);x3.copy(Q.y);x3.add(Q.z);x3.norm();t4.mul(x3);x3.copy(t1);x3.add(t2);t4.sub(x3);t4.norm();x3.copy(this.x);x3.add(this.z);x3.norm();y3=new ctx.FP(0);y3.copy(Q.x);y3.add(Q.z);y3.norm();x3.mul(y3);y3.copy(t0);y3.add(t2);y3.rsub(x3);y3.norm();x3.copy(t0);x3.add(t0);t0.add(x3);t0.norm();t2.imul(b);z3=new ctx.FP(0);z3.copy(t1);z3.add(t2);z3.norm();t1.sub(t2);t1.norm();y3.imul(b);x3.copy(y3);x3.mul(t4);t2.copy(t3);t2.mul(t1);x3.rsub(t2);y3.mul(t0);t1.mul(z3);y3.add(t1);t0.mul(t3);z3.mul(t4);z3.add(t0);this.x.copy(x3);this.x.norm();this.y.copy(y3);this.y.norm();this.z.copy(z3);this.z.norm()}else{t0=new ctx.FP(0);t0.copy(this.x);t1=new ctx.FP(0);t1.copy(this.y);t2=new ctx.FP(0);t2.copy(this.z);t3=new ctx.FP(0);t3.copy(this.x);t4=new ctx.FP(0);t4.copy(Q.x);z3=new ctx.FP(0);y3=new ctx.FP(0);y3.copy(Q.x);x3=new ctx.FP(0);x3.copy(Q.y);b=new ctx.FP(0);if(ctx.ROM_CURVE.CURVE_B_I==0){b.rcopy(ctx.ROM_CURVE.CURVE_B)}t0.mul(Q.x);t1.mul(Q.y);t2.mul(Q.z);t3.add(this.y);t3.norm();t4.add(Q.y);t4.norm();t3.mul(t4);t4.copy(t0);t4.add(t1);t3.sub(t4);t3.norm();t4.copy(this.y);t4.add(this.z);t4.norm();x3.add(Q.z);x3.norm();t4.mul(x3);x3.copy(t1);x3.add(t2);t4.sub(x3);t4.norm();x3.copy(this.x);x3.add(this.z);x3.norm();y3.add(Q.z);y3.norm();x3.mul(y3);y3.copy(t0);y3.add(t2);y3.rsub(x3);y3.norm();z3.copy(t2);if(ctx.ROM_CURVE.CURVE_B_I==0){z3.mul(b)}else{z3.imul(ctx.ROM_CURVE.CURVE_B_I)}x3.copy(y3);x3.sub(z3);x3.norm();z3.copy(x3);z3.add(x3);x3.add(z3);z3.copy(t1);z3.sub(x3);z3.norm();x3.add(t1);x3.norm();if(ctx.ROM_CURVE.CURVE_B_I==0){y3.mul(b)}else{y3.imul(ctx.ROM_CURVE.CURVE_B_I)}t1.copy(t2);t1.add(t2);t2.add(t1);y3.sub(t2);y3.sub(t0);y3.norm();t1.copy(y3);t1.add(y3);y3.add(t1);y3.norm();t1.copy(t0);t1.add(t0);t0.add(t1);t0.sub(t2);t0.norm();t1.copy(t4);t1.mul(y3);t2.copy(t0);t2.mul(y3);y3.copy(x3);y3.mul(z3);y3.add(t2);x3.mul(t3);x3.sub(t1);z3.mul(t4);t1.copy(t3);t1.mul(t0);z3.add(t1);this.x.copy(x3);this.x.norm();this.y.copy(y3);this.y.norm();this.z.copy(z3);this.z.norm()}}if(ECP.CURVETYPE==ECP.EDWARDS){A=new ctx.FP(0);A.copy(this.z);B=new ctx.FP(0);C=new ctx.FP(0);C.copy(this.x);D=new ctx.FP(0);D.copy(this.y);E=new ctx.FP(0);F=new ctx.FP(0);G=new ctx.FP(0);A.mul(Q.z);B.copy(A);B.sqr();C.mul(Q.x);D.mul(Q.y);E.copy(C);E.mul(D);if(ctx.ROM_CURVE.CURVE_B_I==0){b=new ctx.FP(0);b.rcopy(ctx.ROM_CURVE.CURVE_B);E.mul(b)}else{E.imul(ctx.ROM_CURVE.CURVE_B_I)}F.copy(B);F.sub(E);G.copy(B);G.add(E);if(ctx.ROM_CURVE.CURVE_A==1){E.copy(D);E.sub(C)}C.add(D);B.copy(this.x);B.add(this.y);D.copy(Q.x);D.add(Q.y);B.norm();D.norm();B.mul(D);B.sub(C);B.norm();F.norm();B.mul(F);this.x.copy(A);this.x.mul(B);G.norm();if(ctx.ROM_CURVE.CURVE_A==1){E.norm();C.copy(E);C.mul(G)}if(ctx.ROM_CURVE.CURVE_A==-1){C.norm();C.mul(G)}this.y.copy(A);this.y.mul(C);this.z.copy(F);this.z.mul(G)}return},dadd:function(Q,W){var A,B,C,D,DA,CB;A=new ctx.FP(0);A.copy(this.x);B=new ctx.FP(0);B.copy(this.x);C=new ctx.FP(0);C.copy(Q.x);D=new ctx.FP(0);D.copy(Q.x);DA=new ctx.FP(0);CB=new ctx.FP(0);A.add(this.z);B.sub(this.z);C.add(Q.z);D.sub(Q.z);D.norm();A.norm();DA.copy(D);DA.mul(A);C.norm();B.norm();CB.copy(C);CB.mul(B);A.copy(DA);A.add(CB);A.norm();A.sqr();B.copy(DA);B.sub(CB);B.norm();B.sqr();this.x.copy(A);this.z.copy(W.x);this.z.mul(B)},sub:function(Q){Q.neg();this.add(Q);Q.neg()},pinmul:function(e,bts){var i,b,P,R0,R1;if(ECP.CURVETYPE==ECP.MONTGOMERY){return this.mul(new ctx.BIG(e))}else{P=new ECP;R0=new ECP;R1=new ECP;R1.copy(this);for(i=bts-1;i>=0;i--){b=e>>i&1;P.copy(R1);P.add(R0);R0.cswap(R1,b);R1.copy(P);R0.dbl();R0.cswap(R1,b)}P.copy(R0);P.affine();return P}},cfp:function(){var cf=ctx.ROM_CURVE.CURVE_Cof_I,c=new ctx.BIG(0);if(cf==1){return}if(cf==4){this.dbl();this.dbl();this.affine();return}if(cf==8){this.dbl();this.dbl();this.dbl();this.affine();return}c.rcopy(ctx.ROM_CURVE.CURVE_Cof);this.copy(this.mul(c))},mul:function(e){var P,D,R0,R1,mt,t,Q,C,W,w,i,b,nb,s,ns;if(e.iszilch()||this.is_infinity()){return new ECP}P=new ECP;if(ECP.CURVETYPE==ECP.MONTGOMERY){D=new ECP;R0=new ECP;R0.copy(this);R1=new ECP;R1.copy(this);R1.dbl();D.copy(this);D.affine();nb=e.nbits();for(i=nb-2;i>=0;i--){b=e.bit(i);P.copy(R1);P.dadd(R0,D);R0.cswap(R1,b);R1.copy(P);R0.dbl();R0.cswap(R1,b)}P.copy(R0)}else{mt=new ctx.BIG;t=new ctx.BIG;Q=new ECP;C=new ECP;W=[];w=[];this.affine();Q.copy(this);Q.dbl();W[0]=new ECP;W[0].copy(this);for(i=1;i<8;i++){W[i]=new ECP;W[i].copy(W[i-1]);W[i].add(Q)}t.copy(e);s=t.parity();t.inc(1);t.norm();ns=t.parity();mt.copy(t);mt.inc(1);mt.norm();t.cmove(mt,s);Q.cmove(this,ns);C.copy(Q);nb=1+Math.floor((t.nbits()+3)/4);for(i=0;i<nb;i++){w[i]=t.lastbits(5)-16;t.dec(w[i]);t.norm();t.fshr(4)}w[nb]=t.lastbits(5);P.copy(W[Math.floor((w[nb]-1)/2)]);for(i=nb-1;i>=0;i--){Q.select(W,w[i]);P.dbl();P.dbl();P.dbl();P.dbl();P.add(Q)}P.sub(C)}P.affine();return P},mul2:function(e,Q,f){var te=new ctx.BIG,tf=new ctx.BIG,mt=new ctx.BIG,S=new ECP,T=new ECP,C=new ECP,W=[],w=[],i,s,ns,nb,a,b;this.affine();Q.affine();te.copy(e);tf.copy(f);W[1]=new ECP;W[1].copy(this);W[1].sub(Q);W[2]=new ECP;W[2].copy(this);W[2].add(Q);S.copy(Q);S.dbl();W[0]=new ECP;W[0].copy(W[1]);W[0].sub(S);W[3]=new ECP;W[3].copy(W[2]);W[3].add(S);T.copy(this);T.dbl();W[5]=new ECP;W[5].copy(W[1]);W[5].add(T);W[6]=new ECP;W[6].copy(W[2]);W[6].add(T);W[4]=new ECP;W[4].copy(W[5]);W[4].sub(S);W[7]=new ECP;W[7].copy(W[6]);W[7].add(S);s=te.parity();te.inc(1);te.norm();ns=te.parity();mt.copy(te);mt.inc(1);mt.norm();te.cmove(mt,s);T.cmove(this,ns);C.copy(T);s=tf.parity();tf.inc(1);tf.norm();ns=tf.parity();mt.copy(tf);mt.inc(1);mt.norm();tf.cmove(mt,s);S.cmove(Q,ns);C.add(S);mt.copy(te);mt.add(tf);mt.norm();nb=1+Math.floor((mt.nbits()+1)/2);for(i=0;i<nb;i++){a=te.lastbits(3)-4;te.dec(a);te.norm();te.fshr(2);b=tf.lastbits(3)-4;tf.dec(b);tf.norm();tf.fshr(2);w[i]=4*a+b}w[nb]=4*te.lastbits(3)+tf.lastbits(3);S.copy(W[Math.floor((w[nb]-1)/2)]);for(i=nb-1;i>=0;i--){T.select(W,w[i]);S.dbl();S.dbl();S.add(T)}S.sub(C);S.affine();return S}};ECP.generator=function(){var G=new ECP,gx=new ctx.BIG(0),gy=new ctx.BIG(0);gx.rcopy(ctx.ROM_CURVE.CURVE_Gx);if(ctx.ECP.CURVETYPE!=ctx.ECP.MONTGOMERY){gy.rcopy(ctx.ROM_CURVE.CURVE_Gy);G.setxy(gx,gy)}else{G.setx(gx)}return G};ECP.teq=function(b,c){var x=b^c;x-=1;return x>>31&1};ECP.fromBytes=function(b){var t=[],P=new ECP,p=new ctx.BIG(0),px,py,i;p.rcopy(ctx.ROM_FIELD.Modulus);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+1]}px=ctx.BIG.fromBytes(t);if(ctx.BIG.comp(px,p)>=0){return P}if(b[0]==4){for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+ctx.BIG.MODBYTES+1]}py=ctx.BIG.fromBytes(t);if(ctx.BIG.comp(py,p)>=0){return P}P.setxy(px,py);return P}else{P.setx(px);return P}};ECP.RHS=function(x){var r=new ctx.FP(0),b,cx,one,x3;x.norm();r.copy(x);r.sqr();if(ECP.CURVETYPE==ECP.WEIERSTRASS){b=new ctx.FP(0);b.rcopy(ctx.ROM_CURVE.CURVE_B);r.mul(x);if(ctx.ROM_CURVE.CURVE_A==-3){cx=new ctx.FP(0);cx.copy(x);cx.imul(3);cx.neg();cx.norm();r.add(cx)}r.add(b)}else if(ECP.CURVETYPE==ECP.EDWARDS){b=new ctx.FP(0);b.rcopy(ctx.ROM_CURVE.CURVE_B);one=new ctx.FP(1);b.mul(r);b.sub(one);b.norm();if(ctx.ROM_CURVE.CURVE_A==-1){r.neg()}r.sub(one);r.norm();b.inverse();r.mul(b)}else if(ECP.CURVETYPE==ECP.MONTGOMERY){x3=new ctx.FP(0);x3.copy(r);x3.mul(x);r.imul(ctx.ROM_CURVE.CURVE_A);r.add(x3);r.add(x)}r.reduce();return r};ECP.mapit=function(h){var q=new ctx.BIG(0),x=ctx.BIG.fromBytes(h),P=new ECP;q.rcopy(ctx.ROM_FIELD.Modulus);x.mod(q);for(;;){for(;;){if(ECP.CURVETYPE!=ECP.MONTGOMERY){P.setxi(x,0)}else{P.setx(x)}x.inc(1);x.norm();if(!P.is_infinity()){break}}P.cfp();if(!P.is_infinity()){break}}return P};return ECP}function ECP2(ctx){var ECP2=function(){this.x=new ctx.FP2(0);this.y=new ctx.FP2(1);this.z=new ctx.FP2(0)};ECP2.prototype={is_infinity:function(){this.x.reduce();this.y.reduce();this.z.reduce();return this.x.iszilch()&&this.z.iszilch()},copy:function(P){this.x.copy(P.x);this.y.copy(P.y);this.z.copy(P.z)},inf:function(){this.x.zero();this.y.one();this.z.zero()},cmove:function(Q,d){this.x.cmove(Q.x,d);this.y.cmove(Q.y,d);this.z.cmove(Q.z,d)},select:function(W,b){var MP=new ECP2,m,babs;m=b>>31,babs=(b^m)-m;babs=(babs-1)/2;this.cmove(W[0],ECP2.teq(babs,0));this.cmove(W[1],ECP2.teq(babs,1));this.cmove(W[2],ECP2.teq(babs,2));this.cmove(W[3],ECP2.teq(babs,3));this.cmove(W[4],ECP2.teq(babs,4));this.cmove(W[5],ECP2.teq(babs,5));this.cmove(W[6],ECP2.teq(babs,6));this.cmove(W[7],ECP2.teq(babs,7));MP.copy(this);MP.neg();this.cmove(MP,m&1)},equals:function(Q){var a,b;a=new ctx.FP2(0);a.copy(this.x);b=new ctx.FP2(0);b.copy(Q.x);a.copy(this.x);a.mul(Q.z);a.reduce();b.copy(Q.x);b.mul(this.z);b.reduce();if(!a.equals(b)){return false}a.copy(this.y);a.mul(Q.z);a.reduce();b.copy(Q.y);b.mul(this.z);b.reduce();if(!a.equals(b)){return false}return true},neg:function(){this.y.norm();this.y.neg();this.y.norm();return},affine:function(){var one;if(this.is_infinity()){return}one=new ctx.FP2(1);if(this.z.equals(one)){this.x.reduce();this.y.reduce();return}this.z.inverse();this.x.mul(this.z);this.x.reduce();this.y.mul(this.z);this.y.reduce();this.z.copy(one)},getX:function(){this.affine();return this.x},getY:function(){this.affine();return this.y},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},toBytes:function(b){var t=[],i;this.affine();this.x.getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i]=t[i]}this.x.getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+ctx.BIG.MODBYTES]=t[i]}this.y.getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+2*ctx.BIG.MODBYTES]=t[i]}this.y.getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+3*ctx.BIG.MODBYTES]=t[i]}},toString:function(){if(this.is_infinity()){return"infinity"}this.affine();return"("+this.x.toString()+","+this.y.toString()+")"},setxy:function(ix,iy){var rhs,y2;this.x.copy(ix);this.y.copy(iy);this.z.one();rhs=ECP2.RHS(this.x);y2=new ctx.FP2(this.y);y2.sqr();if(!y2.equals(rhs)){this.inf()}},setx:function(ix){var rhs;this.x.copy(ix);this.z.one();rhs=ECP2.RHS(this.x);if(rhs.sqrt()){this.y.copy(rhs)}else{this.inf()}},frob:function(X){var X2;X2=new ctx.FP2(X);X2.sqr();this.x.conj();this.y.conj();this.z.conj();this.z.reduce();this.x.mul(X2);this.y.mul(X2);this.y.mul(X)},dbl:function(){var iy,t0,t1,t2,x3,y3;iy=new ctx.FP2(0);iy.copy(this.y);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){iy.mul_ip();iy.norm()}t0=new ctx.FP2(0);t0.copy(this.y);t0.sqr();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t0.mul_ip()}t1=new ctx.FP2(0);t1.copy(iy);t1.mul(this.z);t2=new ctx.FP2(0);t2.copy(this.z);t2.sqr();this.z.copy(t0);this.z.add(t0);this.z.norm();this.z.add(this.z);this.z.add(this.z);this.z.norm();t2.imul(3*ctx.ROM_CURVE.CURVE_B_I);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){t2.mul_ip();t2.norm()}x3=new ctx.FP2(0);x3.copy(t2);x3.mul(this.z);y3=new ctx.FP2(0);y3.copy(t0);y3.add(t2);y3.norm();this.z.mul(t1);t1.copy(t2);t1.add(t2);t2.add(t1);t2.norm();t0.sub(t2);t0.norm();y3.mul(t0);y3.add(x3);t1.copy(this.x);t1.mul(iy);this.x.copy(t0);this.x.norm();this.x.mul(t1);this.x.add(this.x);this.x.norm();this.y.copy(y3);this.y.norm();return 1},add:function(Q){var b,t0,t1,t2,t3,t4,x3,y3,z3;b=3*ctx.ROM_CURVE.CURVE_B_I;t0=new ctx.FP2(0);t0.copy(this.x);t0.mul(Q.x);t1=new ctx.FP2(0);t1.copy(this.y);t1.mul(Q.y);t2=new ctx.FP2(0);t2.copy(this.z);t2.mul(Q.z);t3=new ctx.FP2(0);t3.copy(this.x);t3.add(this.y);t3.norm();t4=new ctx.FP2(0);t4.copy(Q.x);t4.add(Q.y);t4.norm();t3.mul(t4);t4.copy(t0);t4.add(t1);t3.sub(t4);t3.norm();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t3.mul_ip();t3.norm()}t4.copy(this.y);t4.add(this.z);t4.norm();x3=new ctx.FP2(0);x3.copy(Q.y);x3.add(Q.z);x3.norm();t4.mul(x3);x3.copy(t1);x3.add(t2);t4.sub(x3);t4.norm();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t4.mul_ip();t4.norm()}x3.copy(this.x);x3.add(this.z);x3.norm();y3=new ctx.FP2(0);y3.copy(Q.x);y3.add(Q.z);y3.norm();x3.mul(y3);y3.copy(t0);y3.add(t2);y3.rsub(x3);y3.norm();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t0.mul_ip();t0.norm();t1.mul_ip();t1.norm()}x3.copy(t0);x3.add(t0);t0.add(x3);t0.norm();t2.imul(b);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){t2.mul_ip()}z3=new ctx.FP2(0);z3.copy(t1);z3.add(t2);z3.norm();t1.sub(t2);t1.norm();y3.imul(b);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){y3.mul_ip();y3.norm()}x3.copy(y3);x3.mul(t4);t2.copy(t3);t2.mul(t1);x3.rsub(t2);y3.mul(t0);t1.mul(z3);y3.add(t1);t0.mul(t3);z3.mul(t4);z3.add(t0);this.x.copy(x3);this.x.norm();this.y.copy(y3);this.y.norm();this.z.copy(z3);this.z.norm();return 0},sub:function(Q){var D;Q.neg();D=this.add(Q);Q.neg();return D},mul:function(e){var mt=new ctx.BIG,t=new ctx.BIG,C=new ECP2,P=new ECP2,Q=new ECP2,W=[],w=[],i,nb,s,ns;if(this.is_infinity()){return new ECP2}this.affine();Q.copy(this);Q.dbl();W[0]=new ECP2;W[0].copy(this);for(i=1;i<8;i++){W[i]=new ECP2;W[i].copy(W[i-1]);W[i].add(Q)}t.copy(e);s=t.parity();t.inc(1);t.norm();ns=t.parity();mt.copy(t);mt.inc(1);mt.norm();t.cmove(mt,s);Q.cmove(this,ns);C.copy(Q);nb=1+Math.floor((t.nbits()+3)/4);for(i=0;i<nb;i++){w[i]=t.lastbits(5)-16;t.dec(w[i]);t.norm();t.fshr(4)}w[nb]=t.lastbits(5);P.copy(W[Math.floor((w[nb]-1)/2)]);for(i=nb-1;i>=0;i--){Q.select(W,w[i]);P.dbl();P.dbl();P.dbl();P.dbl();P.add(Q)}P.sub(C);P.affine();return P}};ECP2.generator=function(){var G=new ECP2,A=new ctx.BIG(0),B=new ctx.BIG(0),QX,QY;A.rcopy(ctx.ROM_CURVE.CURVE_Pxa);B.rcopy(ctx.ROM_CURVE.CURVE_Pxb);QX=new ctx.FP2(0);QX.bset(A,B);A.rcopy(ctx.ROM_CURVE.CURVE_Pya);B.rcopy(ctx.ROM_CURVE.CURVE_Pyb);QY=new ctx.FP2(0);QY.bset(A,B);G.setxy(QX,QY);return G};ECP2.fromBytes=function(b){var t=[],ra,rb,i,rx,ry,P;for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);rx=new ctx.FP2(ra,rb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+2*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+3*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);ry=new ctx.FP2(ra,rb);P=new ECP2;P.setxy(rx,ry);return P};ECP2.RHS=function(x){var r,c,b;x.norm();r=new ctx.FP2(x);r.sqr();c=new ctx.BIG(0);c.rcopy(ctx.ROM_CURVE.CURVE_B);b=new ctx.FP2(c);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){b.div_ip()}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){b.norm();b.mul_ip();b.norm()}r.mul(x);r.add(b);r.reduce();return r};ECP2.mul4=function(Q,u){var W=new ECP2,P=new ECP2,T=[],mt=new ctx.BIG,t=[],w=[],s=[],i,j,k,nb,bt,pb;for(i=0;i<4;i++){t[i]=new ctx.BIG(u[i]);t[i].norm();Q[i].affine()}T[0]=new ECP2;T[0].copy(Q[0]);T[1]=new ECP2;T[1].copy(T[0]);T[1].add(Q[1]);T[2]=new ECP2;T[2].copy(T[0]);T[2].add(Q[2]);T[3]=new ECP2;T[3].copy(T[1]);T[3].add(Q[2]);T[4]=new ECP2;T[4].copy(T[0]);T[4].add(Q[3]);T[5]=new ECP2;T[5].copy(T[1]);T[5].add(Q[3]);T[6]=new ECP2;T[6].copy(T[2]);T[6].add(Q[3]);T[7]=new ECP2;T[7].copy(T[3]);T[7].add(Q[3]);pb=1-t[0].parity();t[0].inc(pb);t[0].norm();mt.zero();for(i=0;i<4;i++){mt.or(t[i])}nb=1+mt.nbits();s[nb-1]=1;for(i=0;i<nb-1;i++){t[0].fshr(1);s[i]=2*t[0].parity()-1}for(i=0;i<nb;i++){w[i]=0;k=1;for(j=1;j<4;j++){bt=s[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w[i]+=bt*k;k*=2}}P.select(T,2*w[nb-1]+1);for(i=nb-2;i>=0;i--){P.dbl();W.select(T,2*w[i]+s[i]);P.add(W)}W.copy(P);W.sub(Q[0]);P.cmove(W,pb);P.affine();return P};ECP2.teq=function(b,c){var x=b^c;x-=1;return x>>31&1};ECP2.mapit=function(h){var fa=new ctx.BIG(0),fb=new ctx.BIG(0),q,x,one,Q,T,K,X,xQ,x2Q;q=new ctx.BIG(0);q.rcopy(ctx.ROM_FIELD.Modulus);x=ctx.BIG.fromBytes(h);one=new ctx.BIG(1);x.mod(q);for(;;){X=new ctx.FP2(one,x);Q=new ECP2;Q.setx(X);if(!Q.is_infinity()){break}x.inc(1);x.norm()}fa.rcopy(ctx.ROM_FIELD.Fra);fb.rcopy(ctx.ROM_FIELD.Frb);X=new ctx.FP2(fa,fb);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){X.inverse();X.norm()}x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);if(ctx.ECP.CURVE_PAIRING_TYPE==ctx.ECP.BN){T=new ECP2;T.copy(Q);T=T.mul(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){T.neg()}K=new ECP2;K.copy(T);K.dbl();K.add(T);K.frob(X);Q.frob(X);Q.frob(X);Q.frob(X);Q.add(T);Q.add(K);T.frob(X);T.frob(X);Q.add(T)}if(ctx.ECP.CURVE_PAIRING_TYPE==ctx.ECP.BLS){xQ=Q.mul(x);x2Q=xQ.mul(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){xQ.neg()}x2Q.sub(xQ);x2Q.sub(Q);xQ.sub(Q);xQ.frob(X);Q.dbl();Q.frob(X);Q.frob(X);Q.add(x2Q);Q.add(xQ)}Q.affine();return Q};return ECP2}function ECP4(ctx){var ECP4=function(){this.x=new ctx.FP4(0);this.y=new ctx.FP4(1);this.z=new ctx.FP4(0)};ECP4.prototype={is_infinity:function(){this.x.reduce();this.y.reduce();this.z.reduce();return this.x.iszilch()&&this.z.iszilch()},copy:function(P){this.x.copy(P.x);this.y.copy(P.y);this.z.copy(P.z)},inf:function(){this.x.zero();this.y.one();this.z.zero()},cmove:function(Q,d){this.x.cmove(Q.x,d);this.y.cmove(Q.y,d);this.z.cmove(Q.z,d)},select:function(W,b){var MP=new ECP4,m=b>>31,babs=(b^m)-m;babs=(babs-1)/2;this.cmove(W[0],ECP4.teq(babs,0));this.cmove(W[1],ECP4.teq(babs,1));this.cmove(W[2],ECP4.teq(babs,2));this.cmove(W[3],ECP4.teq(babs,3));this.cmove(W[4],ECP4.teq(babs,4));this.cmove(W[5],ECP4.teq(babs,5));this.cmove(W[6],ECP4.teq(babs,6));this.cmove(W[7],ECP4.teq(babs,7));MP.copy(this);MP.neg();this.cmove(MP,m&1)},equals:function(Q){var a,b;a=new ctx.FP4(this.x);b=new ctx.FP4(Q.x);a.mul(Q.z);b.mul(this.z);if(!a.equals(b)){return false}a.copy(this.y);a.mul(Q.z);b.copy(Q.y);b.mul(this.z);if(!a.equals(b)){return false}return true},neg:function(){this.y.norm();this.y.neg();this.y.norm();return},affine:function(){var one;if(this.is_infinity()){return}one=new ctx.FP4(1);if(this.z.equals(one)){this.x.reduce();this.y.reduce();return}this.z.inverse();this.x.mul(this.z);this.x.reduce();this.y.mul(this.z);this.y.reduce();this.z.copy(one)},getX:function(){this.affine();return this.x},getY:function(){this.affine();return this.y},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},toBytes:function(b){var t=[],i;this.affine();this.x.geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i]=t[i]}this.x.geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+ctx.BIG.MODBYTES]=t[i]}this.x.getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+2*ctx.BIG.MODBYTES]=t[i]}this.x.getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+3*ctx.BIG.MODBYTES]=t[i]}this.y.geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+4*ctx.BIG.MODBYTES]=t[i]}this.y.geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+5*ctx.BIG.MODBYTES]=t[i]}this.y.getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+6*ctx.BIG.MODBYTES]=t[i]}this.y.getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+7*ctx.BIG.MODBYTES]=t[i]}},toString:function(){if(this.is_infinity()){return"infinity"}this.affine();return"("+this.x.toString()+","+this.y.toString()+")"},setxy:function(ix,iy){var rhs,y2;this.x.copy(ix);this.y.copy(iy);this.z.one();rhs=ECP4.RHS(this.x);y2=new ctx.FP4(this.y);y2.sqr();if(!y2.equals(rhs)){this.inf()}},setx:function(ix){var rhs;this.x.copy(ix);this.z.one();rhs=ECP4.RHS(this.x);if(rhs.sqrt()){this.y.copy(rhs)}else{this.inf()}},frob:function(F,n){for(var i=0;i<n;i++){this.x.frob(F[2]);this.x.pmul(F[0]);this.y.frob(F[2]);this.y.pmul(F[1]);this.y.times_i();this.z.frob(F[2])}},dbl:function(){var iy,t0,t1,t2,x3,y3;iy=new ctx.FP4(this.y)
;if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){iy.times_i();iy.norm()}t0=new ctx.FP4(this.y);t0.sqr();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t0.times_i()}t1=new ctx.FP4(iy);t1.mul(this.z);t2=new ctx.FP4(this.z);t2.sqr();this.z.copy(t0);this.z.add(t0);this.z.norm();this.z.add(this.z);this.z.add(this.z);this.z.norm();t2.imul(3*ctx.ROM_CURVE.CURVE_B_I);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){t2.times_i()}x3=new ctx.FP4(t2);x3.mul(this.z);y3=new ctx.FP4(t0);y3.add(t2);y3.norm();this.z.mul(t1);t1.copy(t2);t1.add(t2);t2.add(t1);t2.norm();t0.sub(t2);t0.norm();y3.mul(t0);y3.add(x3);t1.copy(this.x);t1.mul(iy);this.x.copy(t0);this.x.norm();this.x.mul(t1);this.x.add(this.x);this.x.norm();this.y.copy(y3);this.y.norm();return 1},add:function(Q){var b,t0,t1,t2,t3,t4,x3,y3,z3;b=3*ctx.ROM_CURVE.CURVE_B_I;t0=new ctx.FP4(this.x);t0.mul(Q.x);t1=new ctx.FP4(this.y);t1.mul(Q.y);t2=new ctx.FP4(this.z);t2.mul(Q.z);t3=new ctx.FP4(this.x);t3.add(this.y);t3.norm();t4=new ctx.FP4(Q.x);t4.add(Q.y);t4.norm();t3.mul(t4);t4.copy(t0);t4.add(t1);t3.sub(t4);t3.norm();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t3.times_i()}t4.copy(this.y);t4.add(this.z);t4.norm();x3=new ctx.FP4(Q.y);x3.add(Q.z);x3.norm();t4.mul(x3);x3.copy(t1);x3.add(t2);t4.sub(x3);t4.norm();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t4.times_i()}x3.copy(this.x);x3.add(this.z);x3.norm();y3=new ctx.FP4(Q.x);y3.add(Q.z);y3.norm();x3.mul(y3);y3.copy(t0);y3.add(t2);y3.rsub(x3);y3.norm();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t0.times_i();t1.times_i()}x3.copy(t0);x3.add(t0);t0.add(x3);t0.norm();t2.imul(b);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){t2.times_i()}z3=new ctx.FP4(t1);z3.add(t2);z3.norm();t1.sub(t2);t1.norm();y3.imul(b);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){y3.times_i()}x3.copy(y3);x3.mul(t4);t2.copy(t3);t2.mul(t1);x3.rsub(t2);y3.mul(t0);t1.mul(z3);y3.add(t1);t0.mul(t3);z3.mul(t4);z3.add(t0);this.x.copy(x3);this.x.norm();this.y.copy(y3);this.y.norm();this.z.copy(z3);this.z.norm();return 0},sub:function(Q){var D;Q.neg();D=this.add(Q);Q.neg();return D},mul:function(e){var mt=new ctx.BIG,t=new ctx.BIG,C=new ECP4,P=new ECP4,Q=new ECP4,W=[],w=[],i,nb,s,ns;if(this.is_infinity()){return new ECP4}this.affine();Q.copy(this);Q.dbl();W[0]=new ECP4;W[0].copy(this);for(i=1;i<8;i++){W[i]=new ECP4;W[i].copy(W[i-1]);W[i].add(Q)}t.copy(e);s=t.parity();t.inc(1);t.norm();ns=t.parity();mt.copy(t);mt.inc(1);mt.norm();t.cmove(mt,s);Q.cmove(this,ns);C.copy(Q);nb=1+Math.floor((t.nbits()+3)/4);for(i=0;i<nb;i++){w[i]=t.lastbits(5)-16;t.dec(w[i]);t.norm();t.fshr(4)}w[nb]=t.lastbits(5);P.copy(W[Math.floor((w[nb]-1)/2)]);for(i=nb-1;i>=0;i--){Q.select(W,w[i]);P.dbl();P.dbl();P.dbl();P.dbl();P.add(Q)}P.sub(C);P.affine();return P}};ECP4.generator=function(){var G=new ECP4,A=new ctx.BIG(0),B=new ctx.BIG(0),XA,XB,X,YA,YB,Y;A.rcopy(ctx.ROM_CURVE.CURVE_Pxaa);B.rcopy(ctx.ROM_CURVE.CURVE_Pxab);XA=new ctx.FP2(A,B);A.rcopy(ctx.ROM_CURVE.CURVE_Pxba);B.rcopy(ctx.ROM_CURVE.CURVE_Pxbb);XB=new ctx.FP2(A,B);X=new ctx.FP4(XA,XB);A.rcopy(ctx.ROM_CURVE.CURVE_Pyaa);B.rcopy(ctx.ROM_CURVE.CURVE_Pyab);YA=new ctx.FP2(A,B);A.rcopy(ctx.ROM_CURVE.CURVE_Pyba);B.rcopy(ctx.ROM_CURVE.CURVE_Pybb);YB=new ctx.FP2(A,B);Y=new ctx.FP4(YA,YB);G.setxy(X,Y);return G};ECP4.fromBytes=function(b){var t=[],ra,rb,ra4,rb4,i,rx,ry,P;for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);ra4=new ctx.FP2(ra,rb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+2*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+3*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);rb4=new ctx.FP2(ra,rb);rx=new ctx.FP4(ra4,rb4);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+4*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+5*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);ra4=new ctx.FP2(ra,rb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+6*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+7*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);rb4=new ctx.FP2(ra,rb);ry=new ctx.FP4(ra4,rb4);P=new ECP4;P.setxy(rx,ry);return P};ECP4.RHS=function(x){var r,c,b;x.norm();r=new ctx.FP4(x);r.sqr();c=new ctx.BIG(0);c.rcopy(ctx.ROM_CURVE.CURVE_B);b=new ctx.FP4(c);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){b.div_i()}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){b.times_i()}r.mul(x);r.add(b);r.reduce();return r};ECP4.mul8=function(Q,u){var W=new ECP4,P=new ECP4,T1=[],T2=[],mt=new ctx.BIG,t=[],w1=[],s1=[],w2=[],s2=[],F=ECP4.frob_constants(),i,j,k,nb,bt,pb1,pb2;for(i=0;i<8;i++){t[i]=new ctx.BIG(u[i]);t[i].norm();Q[i].affine()}T1[0]=new ECP4;T1[0].copy(Q[0]);T1[1]=new ECP4;T1[1].copy(T1[0]);T1[1].add(Q[1]);T1[2]=new ECP4;T1[2].copy(T1[0]);T1[2].add(Q[2]);T1[3]=new ECP4;T1[3].copy(T1[1]);T1[3].add(Q[2]);T1[4]=new ECP4;T1[4].copy(T1[0]);T1[4].add(Q[3]);T1[5]=new ECP4;T1[5].copy(T1[1]);T1[5].add(Q[3]);T1[6]=new ECP4;T1[6].copy(T1[2]);T1[6].add(Q[3]);T1[7]=new ECP4;T1[7].copy(T1[3]);T1[7].add(Q[3]);for(i=0;i<8;i++){T2[i]=new ECP4;T2[i].copy(T1[i]);T2[i].frob(F,4)}pb1=1-t[0].parity();t[0].inc(pb1);t[0].norm();pb2=1-t[4].parity();t[4].inc(pb2);t[4].norm();mt.zero();for(i=0;i<8;i++){mt.or(t[i])}nb=1+mt.nbits();s1[nb-1]=1;s2[nb-1]=1;for(i=0;i<nb-1;i++){t[0].fshr(1);s1[i]=2*t[0].parity()-1;t[4].fshr(1);s2[i]=2*t[4].parity()-1}for(i=0;i<nb;i++){w1[i]=0;k=1;for(j=1;j<4;j++){bt=s1[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w1[i]+=bt*k;k*=2}w2[i]=0;k=1;for(j=5;j<8;j++){bt=s2[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w2[i]+=bt*k;k*=2}}P.select(T1,2*w1[nb-1]+1);W.select(T2,2*w2[nb-1]+1);P.add(W);for(i=nb-2;i>=0;i--){P.dbl();W.select(T1,2*w1[i]+s1[i]);P.add(W);W.select(T2,2*w2[i]+s2[i]);P.add(W)}W.copy(P);W.sub(Q[0]);P.cmove(W,pb1);W.copy(P);W.sub(Q[4]);P.cmove(W,pb2);P.affine();return P};ECP4.teq=function(b,c){var x=b^c;x-=1;return x>>31&1};ECP4.mapit=function(h){var F=ECP4.frob_constants(),q,x,one,Q,X,X2,xQ,x2Q,x3Q,x4Q;q=new ctx.BIG(0);q.rcopy(ctx.ROM_FIELD.Modulus);x=ctx.BIG.fromBytes(h);one=new ctx.BIG(1);x.mod(q);for(;;){X2=new ctx.FP2(one,x);X=new ctx.FP4(X2);Q=new ECP4;Q.setx(X);if(!Q.is_infinity()){break}x.inc(1);x.norm()}x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);xQ=Q.mul(x);x2Q=xQ.mul(x);x3Q=x2Q.mul(x);x4Q=x3Q.mul(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){xQ.neg();x3Q.neg()}x4Q.sub(x3Q);x4Q.sub(Q);x3Q.sub(x2Q);x3Q.frob(F,1);x2Q.sub(xQ);x2Q.frob(F,2);xQ.sub(Q);xQ.frob(F,3);Q.dbl();Q.frob(F,4);Q.add(x4Q);Q.add(x3Q);Q.add(x2Q);Q.add(xQ);Q.affine();return Q};ECP4.frob_constants=function(){var fa=new ctx.BIG(0),fb=new ctx.BIG(0),F=[],X,F0,F1,F2;fa.rcopy(ctx.ROM_FIELD.Fra);fb.rcopy(ctx.ROM_FIELD.Frb);X=new ctx.FP2(fa,fb);F0=new ctx.FP2(X);F0.sqr();F2=new ctx.FP2(F0);F2.mul_ip();F2.norm();F1=new ctx.FP2(F2);F1.sqr();F2.mul(F1);F1.copy(X);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){F1.mul_ip();F1.inverse();F0.copy(F1);F0.sqr()}F0.mul_ip();F0.norm();F1.mul(F0);F[0]=new ctx.FP2(F0);F[1]=new ctx.FP2(F1);F[2]=new ctx.FP2(F2);return F};return ECP4}function ECP8(ctx){var ECP8=function(){this.x=new ctx.FP8(0);this.y=new ctx.FP8(1);this.z=new ctx.FP8(0)};ECP8.prototype={is_infinity:function(){this.x.reduce();this.y.reduce();this.z.reduce();return this.x.iszilch()&&this.z.iszilch()},copy:function(P){this.x.copy(P.x);this.y.copy(P.y);this.z.copy(P.z)},inf:function(){this.x.zero();this.y.one();this.z.zero()},cmove:function(Q,d){this.x.cmove(Q.x,d);this.y.cmove(Q.y,d);this.z.cmove(Q.z,d)},select:function(W,b){var MP=new ECP8,m=b>>31,babs=(b^m)-m;babs=(babs-1)/2;this.cmove(W[0],ECP8.teq(babs,0));this.cmove(W[1],ECP8.teq(babs,1));this.cmove(W[2],ECP8.teq(babs,2));this.cmove(W[3],ECP8.teq(babs,3));this.cmove(W[4],ECP8.teq(babs,4));this.cmove(W[5],ECP8.teq(babs,5));this.cmove(W[6],ECP8.teq(babs,6));this.cmove(W[7],ECP8.teq(babs,7));MP.copy(this);MP.neg();this.cmove(MP,m&1)},equals:function(Q){var a,b;a=new ctx.FP8(this.x);b=new ctx.FP8(Q.x);a.mul(Q.z);b.mul(this.z);if(!a.equals(b)){return false}a.copy(this.y);a.mul(Q.z);b.copy(Q.y);b.mul(this.z);if(!a.equals(b)){return false}return true},neg:function(){this.y.norm();this.y.neg();this.y.norm();return},affine:function(){var one;if(this.is_infinity()){return}one=new ctx.FP8(1);if(this.z.equals(one)){this.x.reduce();this.y.reduce();return}this.z.inverse();this.x.mul(this.z);this.x.reduce();this.y.mul(this.z);this.y.reduce();this.z.copy(one)},getX:function(){this.affine();return this.x},getY:function(){this.affine();return this.y},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},toBytes:function(b){var t=[],i;this.affine();this.x.geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i]=t[i]}this.x.geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+ctx.BIG.MODBYTES]=t[i]}this.x.geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+2*ctx.BIG.MODBYTES]=t[i]}this.x.geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+3*ctx.BIG.MODBYTES]=t[i]}this.x.getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+4*ctx.BIG.MODBYTES]=t[i]}this.x.getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+5*ctx.BIG.MODBYTES]=t[i]}this.x.getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+6*ctx.BIG.MODBYTES]=t[i]}this.x.getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+7*ctx.BIG.MODBYTES]=t[i]}this.y.geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+8*ctx.BIG.MODBYTES]=t[i]}this.y.geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+9*ctx.BIG.MODBYTES]=t[i]}this.y.geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+10*ctx.BIG.MODBYTES]=t[i]}this.y.geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+11*ctx.BIG.MODBYTES]=t[i]}this.y.getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+12*ctx.BIG.MODBYTES]=t[i]}this.y.getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+13*ctx.BIG.MODBYTES]=t[i]}this.y.getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+14*ctx.BIG.MODBYTES]=t[i]}this.y.getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){b[i+15*ctx.BIG.MODBYTES]=t[i]}},toString:function(){if(this.is_infinity()){return"infinity"}this.affine();return"("+this.x.toString()+","+this.y.toString()+")"},setxy:function(ix,iy){var rhs,y2;this.x.copy(ix);this.y.copy(iy);this.z.one();rhs=ECP8.RHS(this.x);y2=new ctx.FP8(this.y);y2.sqr();if(!y2.equals(rhs)){this.inf()}},setx:function(ix){var rhs;this.x.copy(ix);this.z.one();rhs=ECP8.RHS(this.x);if(rhs.sqrt()){this.y.copy(rhs)}else{this.inf()}},frob:function(F,n){for(var i=0;i<n;i++){this.x.frob(F[2]);this.x.qmul(F[0]);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){this.x.div_i2()}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){this.x.times_i2()}this.y.frob(F[2]);this.y.qmul(F[1]);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){this.y.div_i()}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){this.y.times_i2();this.y.times_i2();this.y.times_i()}this.z.frob(F[2])}},dbl:function(){var iy,t0,t1,t2,x3,y3;iy=new ctx.FP8(this.y);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){iy.times_i();iy.norm()}t0=new ctx.FP8(this.y);t0.sqr();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t0.times_i()}t1=new ctx.FP8(iy);t1.mul(this.z);t2=new ctx.FP8(this.z);t2.sqr();this.z.copy(t0);this.z.add(t0);this.z.norm();this.z.add(this.z);this.z.add(this.z);this.z.norm();t2.imul(3*ctx.ROM_CURVE.CURVE_B_I);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){t2.times_i()}x3=new ctx.FP8(t2);x3.mul(this.z);y3=new ctx.FP8(t0);y3.add(t2);y3.norm();this.z.mul(t1);t1.copy(t2);t1.add(t2);t2.add(t1);t2.norm();t0.sub(t2);t0.norm();y3.mul(t0);y3.add(x3);t1.copy(this.x);t1.mul(iy);this.x.copy(t0);this.x.norm();this.x.mul(t1);this.x.add(this.x);this.x.norm();this.y.copy(y3);this.y.norm();return 1},add:function(Q){var b,t0,t1,t2,t3,t4,x3,y3,z3;b=3*ctx.ROM_CURVE.CURVE_B_I;t0=new ctx.FP8(this.x);t0.mul(Q.x);t1=new ctx.FP8(this.y);t1.mul(Q.y);t2=new ctx.FP8(this.z);t2.mul(Q.z);t3=new ctx.FP8(this.x);t3.add(this.y);t3.norm();t4=new ctx.FP8(Q.x);t4.add(Q.y);t4.norm();t3.mul(t4);t4.copy(t0);t4.add(t1);t3.sub(t4);t3.norm();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t3.times_i()}t4.copy(this.y);t4.add(this.z);t4.norm();x3=new ctx.FP8(Q.y);x3.add(Q.z);x3.norm();t4.mul(x3);x3.copy(t1);x3.add(t2);t4.sub(x3);t4.norm();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t4.times_i()}x3.copy(this.x);x3.add(this.z);x3.norm();y3=new ctx.FP8(Q.x);y3.add(Q.z);y3.norm();x3.mul(y3);y3.copy(t0);y3.add(t2);y3.rsub(x3);y3.norm();if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){t0.times_i();t1.times_i()}x3.copy(t0);x3.add(t0);t0.add(x3);t0.norm();t2.imul(b);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){t2.times_i()}z3=new ctx.FP8(t1);z3.add(t2);z3.norm();t1.sub(t2);t1.norm();y3.imul(b);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){y3.times_i()}x3.copy(y3);x3.mul(t4);t2.copy(t3);t2.mul(t1);x3.rsub(t2);y3.mul(t0);t1.mul(z3);y3.add(t1);t0.mul(t3);z3.mul(t4);z3.add(t0);this.x.copy(x3);this.x.norm();this.y.copy(y3);this.y.norm();this.z.copy(z3);this.z.norm();return 0},sub:function(Q){var D;Q.neg();D=this.add(Q);Q.neg();return D},mul:function(e){var mt=new ctx.BIG,t=new ctx.BIG,C=new ECP8,P=new ECP8,Q=new ECP8,W=[],w=[],i,nb,s,ns;if(this.is_infinity()){return new ECP8}this.affine();Q.copy(this);Q.dbl();W[0]=new ECP8;W[0].copy(this);for(i=1;i<8;i++){W[i]=new ECP8;W[i].copy(W[i-1]);W[i].add(Q)}t.copy(e);s=t.parity();t.inc(1);t.norm();ns=t.parity();mt.copy(t);mt.inc(1);mt.norm();t.cmove(mt,s);Q.cmove(this,ns);C.copy(Q);nb=1+Math.floor((t.nbits()+3)/4);for(i=0;i<nb;i++){w[i]=t.lastbits(5)-16;t.dec(w[i]);t.norm();t.fshr(4)}w[nb]=t.lastbits(5);P.copy(W[Math.floor((w[nb]-1)/2)]);for(i=nb-1;i>=0;i--){Q.select(W,w[i]);P.dbl();P.dbl();P.dbl();P.dbl();P.add(Q)}P.sub(C);P.affine();return P}};ECP8.generator=function(){var G=new ECP8,A=new ctx.BIG(0),B=new ctx.BIG(0),XAA,XAB,XA,XBA,XBB,XB,X,YAA,YAB,YA,YBA,YBB,YB,Y;A.rcopy(ctx.ROM_CURVE.CURVE_Pxaaa);B.rcopy(ctx.ROM_CURVE.CURVE_Pxaab);XAA=new ctx.FP2(A,B);A.rcopy(ctx.ROM_CURVE.CURVE_Pxaba);B.rcopy(ctx.ROM_CURVE.CURVE_Pxabb);XAB=new ctx.FP2(A,B);XA=new ctx.FP4(XAA,XAB);A.rcopy(ctx.ROM_CURVE.CURVE_Pxbaa);B.rcopy(ctx.ROM_CURVE.CURVE_Pxbab);XBA=new ctx.FP2(A,B);A.rcopy(ctx.ROM_CURVE.CURVE_Pxbba);B.rcopy(ctx.ROM_CURVE.CURVE_Pxbbb);XBB=new ctx.FP2(A,B);XB=new ctx.FP4(XBA,XBB);X=new ctx.FP8(XA,XB);A.rcopy(ctx.ROM_CURVE.CURVE_Pyaaa);B.rcopy(ctx.ROM_CURVE.CURVE_Pyaab);YAA=new ctx.FP2(A,B);A.rcopy(ctx.ROM_CURVE.CURVE_Pyaba);B.rcopy(ctx.ROM_CURVE.CURVE_Pyabb);YAB=new ctx.FP2(A,B);YA=new ctx.FP4(YAA,YAB);A.rcopy(ctx.ROM_CURVE.CURVE_Pybaa);B.rcopy(ctx.ROM_CURVE.CURVE_Pybab);YBA=new ctx.FP2(A,B);A.rcopy(ctx.ROM_CURVE.CURVE_Pybba);B.rcopy(ctx.ROM_CURVE.CURVE_Pybbb);YBB=new ctx.FP2(A,B);YB=new ctx.FP4(YBA,YBB);Y=new ctx.FP8(YA,YB);G.setxy(X,Y);return G};ECP8.fromBytes=function(b){var t=[],ra,rb,ra4,rb4,ra8,rb8,i,rx,ry,P;for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);ra4=new ctx.FP2(ra,rb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+2*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+3*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);rb4=new ctx.FP2(ra,rb);ra8=new ctx.FP4(ra4,rb4);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+4*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+5*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);ra4=new ctx.FP2(ra,rb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+6*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+7*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);rb4=new ctx.FP2(ra,rb);rb8=new ctx.FP4(ra4,rb4);rx=new ctx.FP8(ra8,rb8);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+8*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+9*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);ra4=new ctx.FP2(ra,rb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+10*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+11*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);rb4=new ctx.FP2(ra,rb);ra8=new ctx.FP4(ra4,rb4);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+12*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+13*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);ra4=new ctx.FP2(ra,rb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+14*ctx.BIG.MODBYTES]}ra=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=b[i+15*ctx.BIG.MODBYTES]}rb=ctx.BIG.fromBytes(t);rb4=new ctx.FP2(ra,rb);rb8=new ctx.FP4(ra4,rb4);ry=new ctx.FP8(ra8,rb8);P=new ECP8;P.setxy(rx,ry);return P};ECP8.RHS=function(x){var r,c,b;x.norm();r=new ctx.FP8(x);r.sqr();c=new ctx.BIG(0);c.rcopy(ctx.ROM_CURVE.CURVE_B);b=new ctx.FP8(c);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){b.div_i()}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){b.times_i()}r.mul(x);r.add(b);r.reduce();return r};ECP8.mul16=function(Q,u){var W=new ECP8,P=new ECP8,T1=[],T2=[],T3=[],T4=[],mt=new ctx.BIG,t=[],w1=[],s1=[],w2=[],s2=[],w3=[],s3=[],w4=[],s4=[],F=ECP8.frob_constants(),i,j,k,nb,bt,pb1,pb2,pb3,pb4;for(i=0;i<16;i++){t[i]=new ctx.BIG(u[i]);t[i].norm();Q[i].affine()}T1[0]=new ECP8;T1[0].copy(Q[0]);T1[1]=new ECP8;T1[1].copy(T1[0]);T1[1].add(Q[1]);T1[2]=new ECP8;T1[2].copy(T1[0]);T1[2].add(Q[2]);T1[3]=new ECP8;T1[3].copy(T1[1]);T1[3].add(Q[2]);T1[4]=new ECP8;T1[4].copy(T1[0]);T1[4].add(Q[3]);T1[5]=new ECP8;T1[5].copy(T1[1]);T1[5].add(Q[3]);T1[6]=new ECP8;T1[6].copy(T1[2]);T1[6].add(Q[3]);T1[7]=new ECP8;T1[7].copy(T1[3]);T1[7].add(Q[3]);for(i=0;i<8;i++){T2[i]=new ECP8;T2[i].copy(T1[i]);T2[i].frob(F,4);T3[i]=new ECP8;T3[i].copy(T2[i]);T3[i].frob(F,4);T4[i]=new ECP8;T4[i].copy(T3[i]);T4[i].frob(F,4)}pb1=1-t[0].parity();t[0].inc(pb1);t[0].norm();pb2=1-t[4].parity();t[4].inc(pb2);t[4].norm();pb3=1-t[8].parity();t[8].inc(pb3);t[8].norm();pb4=1-t[12].parity();t[12].inc(pb4);t[12].norm();mt.zero();for(i=0;i<16;i++){mt.or(t[i])}nb=1+mt.nbits();s1[nb-1]=1;s2[nb-1]=1;s3[nb-1]=1;s4[nb-1]=1;for(i=0;i<nb-1;i++){t[0].fshr(1);s1[i]=2*t[0].parity()-1;t[4].fshr(1);s2[i]=2*t[4].parity()-1;t[8].fshr(1);s3[i]=2*t[8].parity()-1;t[12].fshr(1);s4[i]=2*t[12].parity()-1}for(i=0;i<nb;i++){w1[i]=0;k=1;for(j=1;j<4;j++){bt=s1[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w1[i]+=bt*k;k*=2}w2[i]=0;k=1;for(j=5;j<8;j++){bt=s2[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w2[i]+=bt*k;k*=2}w3[i]=0;k=1;for(j=9;j<12;j++){bt=s3[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w3[i]+=bt*k;k*=2}w4[i]=0;k=1;for(j=13;j<16;j++){bt=s4[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w4[i]+=bt*k;k*=2}}P.select(T1,2*w1[nb-1]+1);W.select(T2,2*w2[nb-1]+1);P.add(W);W.select(T3,2*w3[nb-1]+1);P.add(W);W.select(T4,2*w4[nb-1]+1);P.add(W);for(i=nb-2;i>=0;i--){P.dbl();W.select(T1,2*w1[i]+s1[i]);P.add(W);W.select(T2,2*w2[i]+s2[i]);P.add(W);W.select(T3,2*w3[i]+s3[i]);P.add(W);W.select(T4,2*w4[i]+s4[i]);P.add(W)}W.copy(P);W.sub(Q[0]);P.cmove(W,pb1);W.copy(P);W.sub(Q[4]);P.cmove(W,pb2);W.copy(P);W.sub(Q[8]);P.cmove(W,pb3);W.copy(P);W.sub(Q[12]);P.cmove(W,pb4);P.affine();return P};ECP8.teq=function(b,c){var x=b^c;x-=1;return x>>31&1};ECP8.mapit=function(h){var F=ECP8.frob_constants(),q,x,one,Q,X,X2,X4,xQ,x2Q,x3Q,x4Q,x5Q,x6Q,x7Q,x8Q;q=new ctx.BIG(0);q.rcopy(ctx.ROM_FIELD.Modulus);x=ctx.BIG.fromBytes(h);one=new ctx.BIG(1);x.mod(q);for(;;){X2=new ctx.FP2(one,x);X4=new ctx.FP4(X2);X=new ctx.FP8(X4);Q=new ECP8;Q.setx(X);if(!Q.is_infinity()){break}x.inc(1);x.norm()}x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);xQ=Q.mul(x);x2Q=xQ.mul(x);x3Q=x2Q.mul(x);x4Q=x3Q.mul(x);x5Q=x4Q.mul(x);x6Q=x5Q.mul(x);x7Q=x6Q.mul(x);x8Q=x7Q.mul(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){xQ.neg();x3Q.neg();x5Q.neg();x7Q.neg()}x8Q.sub(x7Q);x8Q.sub(Q);x7Q.sub(x6Q);x7Q.frob(F,1);x6Q.sub(x5Q);x6Q.frob(F,2);x5Q.sub(x4Q);x5Q.frob(F,3);x4Q.sub(x3Q);x4Q.frob(F,4);x3Q.sub(x2Q);x3Q.frob(F,5);x2Q.sub(xQ);x2Q.frob(F,6);xQ.sub(Q);xQ.frob(F,7);Q.dbl();Q.frob(F,8);Q.add(x8Q);Q.add(x7Q);Q.add(x6Q);Q.add(x5Q);Q.add(x4Q);Q.add(x3Q);Q.add(x2Q);Q.add(xQ);Q.affine();return Q};ECP8.frob_constants=function(){var fa=new ctx.BIG(0),fb=new ctx.BIG(0),F=[],X,F0,F1,F2;fa.rcopy(ctx.ROM_FIELD.Fra);fb.rcopy(ctx.ROM_FIELD.Frb);X=new ctx.FP2(fa,fb);F0=new ctx.FP2(X);F0.sqr();F2=new ctx.FP2(F0);F2.mul_ip();F2.norm();F1=new ctx.FP2(F2);F1.sqr();F2.mul(F1);F2.mul_ip();F2.norm();F1.copy(X);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){F1.mul_ip();F1.inverse();F0.copy(F1);F0.sqr()}F0.mul_ip();F0.norm();F1.mul(F0);F[0]=new ctx.FP2(F0);F[1]=new ctx.FP2(F1);F[2]=new ctx.FP2(F2);return F};return ECP8}function FF(ctx){var FF=function(n){this.v=new Array(n);this.length=n;for(var i=0;i<n;i++){this.v[i]=new ctx.BIG(0)}};FF.FFLEN=ctx.config["@ML"];FF.P_MBITS=ctx.BIG.MODBYTES*8;FF.P_OMASK=-1<<FF.P_MBITS%ctx.BIG.BASEBITS;FF.P_FEXCESS=1<<ctx.BIG.BASEBITS*ctx.BIG.NLEN-FF.P_MBITS-1;FF.P_TBITS=FF.P_MBITS%ctx.BIG.BASEBITS;FF.FF_BITS=ctx.BIG.BIGBITS*FF.FFLEN;FF.HFLEN=FF.FFLEN/2;FF.prototype={P_EXCESS:function(){return((this.v[this.length-1].get(ctx.BIG.NLEN-1)&FF.P_OMASK)>>FF.P_TBITS)+1},zero:function(){for(var i=0;i<this.length;i++){this.v[i].zero()}return this},getlen:function(){return this.length},set:function(m){this.zero();this.v[0].set(0,m&ctx.BIG.BMASK);this.v[0].set(1,m>>ctx.BIG.BASEBITS)},copy:function(b){for(var i=0;i<this.length;i++){this.v[i].copy(b.v[i])}},rcopy:function(b){for(var i=0;i<this.length;i++){this.v[i].rcopy(b[i])}},dsucopy:function(b){for(var i=0;i<b.length;i++){this.v[b.length+i].copy(b.v[i]);this.v[i].zero()}},dscopy:function(b){for(var i=0;i<b.length;i++){this.v[i].copy(b.v[i]);this.v[b.length+i].zero()}},sducopy:function(b){for(var i=0;i<this.length;i++){this.v[i].copy(b.v[this.length+i])}},one:function(){this.v[0].one();for(var i=1;i<this.length;i++){this.v[i].zero()}},iszilch:function(){for(var i=0;i<this.length;i++){if(!this.v[i].iszilch()){return false}}return true},shrw:function(n){for(var i=0;i<n;i++){this.v[i].copy(this.v[i+n]);this.v[i+n].zero()}},shlw:function(n){for(var i=0;i<n;i++){this.v[n+i].copy(this.v[i]);this.v[i].zero()}},parity:function(){return this.v[0].parity()},lastbits:function(m){return this.v[0].lastbits(m)},radd:function(vp,x,xp,y,yp,n){for(var i=0;i<n;i++){this.v[vp+i].copy(x.v[xp+i]);this.v[vp+i].add(y.v[yp+i])}},rinc:function(vp,y,yp,n){for(var i=0;i<n;i++){this.v[vp+i].add(y.v[yp+i])}},rsub:function(vp,x,xp,y,yp,n){for(var i=0;i<n;i++){this.v[vp+i].copy(x.v[xp+i]);this.v[vp+i].sub(y.v[yp+i])}},rdec:function(vp,y,yp,n){for(var i=0;i<n;i++){this.v[vp+i].sub(y.v[yp+i])}},add:function(b){for(var i=0;i<this.length;i++){this.v[i].add(b.v[i])}},sub:function(b){for(var i=0;i<this.length;i++){this.v[i].sub(b.v[i])}},revsub:function(b){for(var i=0;i<this.length;i++){this.v[i].rsub(b.v[i])}},inc:function(m){this.v[0].inc(m);this.norm()},dec:function(m){this.v[0].dec(m);this.norm()},rnorm:function(vp,n){var trunc=false,i,carry;if(n<0){n=-n;trunc=true}for(i=0;i<n-1;i++){carry=this.v[vp+i].norm();this.v[vp+i].xortop(carry<<FF.P_TBITS);this.v[vp+i+1].inc(carry)}carry=this.v[vp+n-1].norm();if(trunc){this.v[vp+n-1].xortop(carry<<FF.P_TBITS)}return this},norm:function(){this.rnorm(0,this.length)},shl:function(){var delay_carry=0,i,carry;for(i=0;i<this.length-1;i++){carry=this.v[i].fshl(1);this.v[i].inc(delay_carry);this.v[i].xortop(carry<<FF.P_TBITS);delay_carry=carry}this.v[this.length-1].fshl(1);this.v[this.length-1].inc(delay_carry)},shr:function(){var i,carry;for(i=this.length-1;i>0;i--){carry=this.v[i].fshr(1);this.v[i-1].ortop(carry<<FF.P_TBITS)}this.v[0].fshr(1)},toString:function(){var s="",i;this.norm();for(i=this.length-1;i>=0;i--){s+=this.v[i].toString()}return s},toBytes:function(b){var i;for(i=0;i<this.length;i++){this.v[i].tobytearray(b,(this.length-i-1)*ctx.BIG.MODBYTES)}},karmul:function(vp,x,xp,y,yp,t,tp,n){var nd2,d;if(n===1){x.v[xp].norm();y.v[yp].norm();d=ctx.BIG.mul(x.v[xp],y.v[yp]);this.v[vp+1]=d.split(8*ctx.BIG.MODBYTES);this.v[vp].copy(d);return}nd2=n/2;this.radd(vp,x,xp,x,xp+nd2,nd2);this.rnorm(vp,nd2);this.radd(vp+nd2,y,yp,y,yp+nd2,nd2);this.rnorm(vp+nd2,nd2);t.karmul(tp,this,vp,this,vp+nd2,t,tp+n,nd2);this.karmul(vp,x,xp,y,yp,t,tp+n,nd2);this.karmul(vp+n,x,xp+nd2,y,yp+nd2,t,tp+n,nd2);t.rdec(tp,this,vp,n);t.rdec(tp,this,vp+n,n);this.rinc(vp+nd2,t,tp,n);this.rnorm(vp,2*n)},karsqr:function(vp,x,xp,t,tp,n){var nd2,d;if(n===1){x.v[xp].norm();d=ctx.BIG.sqr(x.v[xp]);this.v[vp+1].copy(d.split(8*ctx.BIG.MODBYTES));this.v[vp].copy(d);return}nd2=n/2;this.karsqr(vp,x,xp,t,tp+n,nd2);this.karsqr(vp+n,x,xp+nd2,t,tp+n,nd2);t.karmul(tp,x,xp,x,xp+nd2,t,tp+n,nd2);this.rinc(vp+nd2,t,tp,n);this.rinc(vp+nd2,t,tp,n);this.rnorm(vp+nd2,n)},karmul_lower:function(vp,x,xp,y,yp,t,tp,n){var nd2;if(n===1){this.v[vp].copy(ctx.BIG.smul(x.v[xp],y.v[yp]));return}nd2=n/2;this.karmul(vp,x,xp,y,yp,t,tp+n,nd2);t.karmul_lower(tp,x,xp+nd2,y,yp,t,tp+n,nd2);this.rinc(vp+nd2,t,tp,nd2);t.karmul_lower(tp,x,xp,y,yp+nd2,t,tp+n,nd2);this.rinc(vp+nd2,t,tp,nd2);this.rnorm(vp+nd2,-nd2)},karmul_upper:function(x,y,t,n){var nd2;nd2=n/2;this.radd(n,x,0,x,nd2,nd2);this.radd(n+nd2,y,0,y,nd2,nd2);this.rnorm(n,nd2);this.rnorm(n+nd2,nd2);t.karmul(0,this,n+nd2,this,n,t,n,nd2);this.karmul(n,x,nd2,y,nd2,t,n,nd2);t.rdec(0,this,n,n);this.rinc(nd2,this,0,nd2);this.rdec(nd2,t,0,nd2);this.rnorm(0,-n);t.rdec(0,this,0,n);this.rinc(nd2,t,0,n);this.rnorm(nd2,n)},lmul:function(y){var n=this.length,t=new FF(2*n),x=new FF(n);x.copy(this);this.karmul_lower(0,x,0,y,0,t,0,n)},mod:function(c){var k=0;this.norm();if(FF.comp(this,c)<0){return}do{c.shl();k++}while(FF.comp(this,c)>=0);while(k>0){c.shr();if(FF.comp(this,c)>=0){this.sub(c);this.norm()}k--}},reduce:function(N,ND){var n=N.length,t=new FF(2*n),r=new FF(n),m=new FF(n);r.sducopy(this);m.karmul_lower(0,this,0,ND,0,t,0,n);this.karmul_upper(N,m,t,n);m.sducopy(this);r.add(N);r.sub(m);r.norm();return r},dmod:function(b){var n=b.length,m=new FF(2*n),x=new FF(2*n),r=new FF(n),k;x.copy(this);x.norm();m.dsucopy(b);k=ctx.BIG.BIGBITS*n;while(FF.comp(x,m)>=0){x.sub(m);x.norm()}while(k>0){m.shr();if(FF.comp(x,m)>=0){x.sub(m);x.norm()}k--}r.copy(x);r.mod(b);return r},invmodp:function(p){var n=p.length,u=new FF(n),v=new FF(n),x1=new FF(n),x2=new FF(n),t=new FF(n),one=new FF(n);one.one();u.copy(this);v.copy(p);x1.copy(one);x2.zero();while(FF.comp(u,one)!==0&&FF.comp(v,one)!==0){while(u.parity()===0){u.shr();if(x1.parity()!==0){x1.add(p);x1.norm()}x1.shr()}while(v.parity()===0){v.shr();if(x2.parity()!==0){x2.add(p);x2.norm()}x2.shr()}if(FF.comp(u,v)>=0){u.sub(v);u.norm();if(FF.comp(x1,x2)>=0){x1.sub(x2)}else{t.copy(p);t.sub(x2);x1.add(t)}x1.norm()}else{v.sub(u);v.norm();if(FF.comp(x2,x1)>=0){x2.sub(x1)}else{t.copy(p);t.sub(x1);x2.add(t)}x2.norm()}}if(FF.comp(u,one)===0){this.copy(x1)}else{this.copy(x2)}},nres:function(m){var n=m.length,d;if(n===1){d=new ctx.DBIG(0);d.hcopy(this.v[0]);d.shl(ctx.BIG.NLEN*ctx.BIG.BASEBITS);this.v[0].copy(d.mod(m.v[0]))}else{d=new FF(2*n);d.dsucopy(this);this.copy(d.dmod(m))}},redc:function(m,ND){var n=m.length,d;if(n===1){d=new ctx.DBIG(0);d.hcopy(this.v[0]);this.v[0].copy(ctx.BIG.monty(m.v[0],(1<<ctx.BIG.BASEBITS)-ND.v[0].w[0],d))}else{d=new FF(2*n);this.mod(m);d.dscopy(this);this.copy(d.reduce(m,ND));this.mod(m)}},mod2m:function(m){for(var i=m;i<this.length;i++){this.v[i].zero()}},invmod2m:function(){var n=this.length,b=new FF(n),c=new FF(n),U=new FF(n),t,i;U.zero();U.v[0].copy(this.v[0]);U.v[0].invmod2m();for(i=1;i<n;i<<=1){b.copy(this);b.mod2m(i);t=FF.mul(U,b);t.shrw(i);b.copy(t);c.copy(this);c.shrw(i);c.mod2m(i);c.lmul(U);c.mod2m(i);b.add(c);b.norm();b.lmul(U);b.mod2m(i);c.one();c.shlw(i);b.revsub(c);b.norm();b.shlw(i);U.add(b)}U.norm();return U},random:function(rng){var n=this.length,i;for(i=0;i<n;i++){this.v[i].copy(ctx.BIG.random(rng))}while(this.v[n-1].nbits()<ctx.BIG.MODBYTES*8){this.v[n-1].copy(ctx.BIG.random(rng))}},randomnum:function(p,rng){var n=this.length,d=new FF(2*n),i;for(i=0;i<2*n;i++){d.v[i].copy(ctx.BIG.random(rng))}this.copy(d.dmod(p))},modmul:function(y,p,nd){var ex=this.P_EXCESS(),ey=y.P_EXCESS(),n=p.length,d;if(ex+1>=Math.floor((FF.P_FEXCESS-1)/(ey+1))){this.mod(p)}if(n===1){d=ctx.BIG.mul(this.v[0],y.v[0]);this.v[0].copy(ctx.BIG.monty(p.v[0],(1<<ctx.BIG.BASEBITS)-nd.v[0].w[0],d))}else{d=FF.mul(this,y);this.copy(d.reduce(p,nd))}},modsqr:function(p,nd){var ex=this.P_EXCESS(),n,d;if(ex+1>=Math.floor((FF.P_FEXCESS-1)/(ex+1))){this.mod(p)}n=p.length;if(n===1){d=ctx.BIG.sqr(this.v[0]);this.v[0].copy(ctx.BIG.monty(p.v[0],(1<<ctx.BIG.BASEBITS)-nd.v[0].w[0],d))}else{d=FF.sqr(this);this.copy(d.reduce(p,nd))}},skpow:function(e,p){var n=p.length,R0=new FF(n),R1=new FF(n),ND=p.invmod2m(),i,b;this.mod(p);R0.one();R1.copy(this);R0.nres(p);R1.nres(p);for(i=8*ctx.BIG.MODBYTES*n-1;i>=0;i--){b=e.v[Math.floor(i/ctx.BIG.BIGBITS)].bit(i%ctx.BIG.BIGBITS);this.copy(R0);this.modmul(R1,p,ND);FF.cswap(R0,R1,b);R0.modsqr(p,ND);R1.copy(this);FF.cswap(R0,R1,b)}this.copy(R0);this.redc(p,ND)},skspow:function(e,p){var n=p.length,R0=new FF(n),R1=new FF(n),ND=p.invmod2m(),i,b;this.mod(p);R0.one();R1.copy(this);R0.nres(p);R1.nres(p);for(i=8*ctx.BIG.MODBYTES-1;i>=0;i--){b=e.bit(i);this.copy(R0);this.modmul(R1,p,ND);FF.cswap(R0,R1,b);R0.modsqr(p,ND);R1.copy(this);FF.cswap(R0,R1,b)}this.copy(R0);this.redc(p,ND)},power:function(e,p){var n=p.length,f=true,w=new FF(n),ND=p.invmod2m();w.copy(this);w.nres(p);if(e==2){this.copy(w);this.modsqr(p,ND)}else{for(;;){if(e%2==1){if(f){this.copy(w)}else{this.modmul(w,p,ND)}f=false}e>>=1;if(e===0){break}w.modsqr(p,ND)}}this.redc(p,ND)},pow:function(e,p){var n=p.length,w=new FF(n),ND=p.invmod2m(),i,b;w.copy(this);this.one();this.nres(p);w.nres(p);for(i=8*ctx.BIG.MODBYTES*n-1;i>=0;i--){this.modsqr(p,ND);b=e.v[Math.floor(i/ctx.BIG.BIGBITS)].bit(i%ctx.BIG.BIGBITS);if(b===1){this.modmul(w,p,ND)}}this.redc(p,ND)},pow2:function(e,y,f,p){var n=p.length,xn=new FF(n),yn=new FF(n),xy=new FF(n),ND=p.invmod2m(),i,eb,fb;xn.copy(this);yn.copy(y);xn.nres(p);yn.nres(p);xy.copy(xn);xy.modmul(yn,p,ND);this.one();this.nres(p);for(i=8*ctx.BIG.MODBYTES-1;i>=0;i--){eb=e.bit(i);fb=f.bit(i);this.modsqr(p,ND);if(eb==1){if(fb==1){this.modmul(xy,p,ND)}else{this.modmul(xn,p,ND)}}else{if(fb==1){this.modmul(yn,p,ND)}}}this.redc(p,ND)},cfactor:function(s){var n=this.length,x=new FF(n),y=new FF(n),r,g;y.set(s);x.copy(this);x.norm();do{x.sub(y);x.norm();while(!x.iszilch()&&x.parity()===0){x.shr()}}while(FF.comp(x,y)>0);g=x.v[0].get(0);r=FF.igcd(s,g);if(r>1){return true}return false}};FF.comp=function(a,b){var i,j;for(i=a.length-1;i>=0;i--){j=ctx.BIG.comp(a.v[i],b.v[i]);if(j!==0){return j}}return 0};FF.fromBytes=function(x,b){var i;for(i=0;i<x.length;i++){x.v[i]=ctx.BIG.frombytearray(b,(x.length-i-1)*ctx.BIG.MODBYTES)}};FF.cswap=function(a,b,d){var i;for(i=0;i<a.length;i++){a.v[i].cswap(b.v[i],d)}};FF.mul=function(x,y){var n=x.length,z=new FF(2*n),t=new FF(2*n);z.karmul(0,x,0,y,0,t,0,n);return z};FF.sqr=function(x){var n=x.length,z=new FF(2*n),t=new FF(2*n);z.karsqr(0,x,0,t,0,n);return z};FF.igcd=function(x,y){var r;if(y===0){return x}while((r=x%y)!==0){x=y;y=r}return y};FF.prime=function(p,rng){var n=p.length,s=0,loop,d=new FF(n),x=new FF(n),unity=new FF(n),nm1=new FF(n),sf=4849845,i,j;p.norm();if(p.cfactor(sf)){return false}unity.one();nm1.copy(p);nm1.sub(unity);nm1.norm();d.copy(nm1);while(d.parity()===0){d.shr();s++}if(s===0){return false}for(i=0;i<10;i++){x.randomnum(p,rng);x.pow(d,p);if(FF.comp(x,unity)===0||FF.comp(x,nm1)===0){continue}loop=false;for(j=1;j<s;j++){x.power(2,p);if(FF.comp(x,unity)===0){return false}if(FF.comp(x,nm1)===0){loop=true;break}}if(loop){continue}return false}return true};return FF}function FP(ctx){var FP=function(x){if(x instanceof FP){this.f=new ctx.BIG(x.f);this.XES=x.XES}else{this.f=new ctx.BIG(x);this.nres()}};FP.NOT_SPECIAL=0;FP.PSEUDO_MERSENNE=1;FP.GENERALISED_MERSENNE=2;FP.MONTGOMERY_FRIENDLY=3;FP.MODBITS=ctx.config["@NBT"];FP.MOD8=ctx.config["@M8"];FP.MODTYPE=ctx.config["@MT"];FP.FEXCESS=1<<ctx.config["@SH"];FP.OMASK=-1<<FP.TBITS;FP.TBITS=FP.MODBITS%ctx.BIG.BASEBITS;FP.TMASK=(1<<FP.TBITS)-1;FP.prototype={zero:function(){this.XES=1;this.f.zero()},rcopy:function(y){this.f.rcopy(y);this.nres()},bcopy:function(y){this.f.copy(y);this.nres()},copy:function(y){this.XES=y.XES
;this.f.copy(y.f)},cswap:function(b,d){this.f.cswap(b.f,d);var t,c=d;c=~(c-1);t=c&(this.XES^b.XES);this.XES^=t;b.XES^=t},cmove:function(b,d){var c=d;c=~(c-1);this.f.cmove(b.f,d);this.XES^=(this.XES^b.XES)&c},nres:function(){var r,d;if(FP.MODTYPE!=FP.PSEUDO_MERSENNE&&FP.MODTYPE!=FP.GENERALISED_MERSENNE){r=new ctx.BIG;r.rcopy(ctx.ROM_FIELD.R2modp);d=ctx.BIG.mul(this.f,r);this.f.copy(FP.mod(d));this.XES=2}else{this.XES=1}return this},redc:function(){var r=new ctx.BIG(0),d,w;r.copy(this.f);if(FP.MODTYPE!=FP.PSEUDO_MERSENNE&&FP.MODTYPE!=FP.GENERALISED_MERSENNE){d=new ctx.DBIG(0);d.hcopy(this.f);w=FP.mod(d);r.copy(w)}return r},toString:function(){var s=this.redc().toString();return s},iszilch:function(){this.reduce();return this.f.iszilch()},reduce:function(){var p=new ctx.BIG(0);p.rcopy(ctx.ROM_FIELD.Modulus);this.f.mod(p);this.XES=1},one:function(){this.f.one();return this.nres()},norm:function(){return this.f.norm()},mul:function(b){var d;if(this.XES*b.XES>FP.FEXCESS){this.reduce()}d=ctx.BIG.mul(this.f,b.f);this.f.copy(FP.mod(d));this.XES=2;return this},imul:function(c){var s=false,d,n;if(c<0){c=-c;s=true}if(FP.MODTYPE==FP.PSEUDO_MERSENNE||FP.MODTYPE==FP.GENERALISED_MERSENNE){d=this.f.pxmul(c);this.f.copy(FP.mod(d));this.XES=2}else{if(this.XES*c<=FP.FEXCESS){this.f.pmul(c);this.XES*=c}else{n=new FP(c);this.mul(n)}}if(s){this.neg();this.norm()}return this},sqr:function(){var d,t;if(this.XES*this.XES>FP.FEXCESS){this.reduce()}d=ctx.BIG.sqr(this.f);t=FP.mod(d);this.f.copy(t);this.XES=2;return this},add:function(b){this.f.add(b.f);this.XES+=b.XES;if(this.XES>FP.FEXCESS){this.reduce()}return this},neg:function(){var m=new ctx.BIG(0),sb;m.rcopy(ctx.ROM_FIELD.Modulus);sb=FP.logb2(this.XES-1);m.fshl(sb);this.XES=1<<sb;this.f.rsub(m);if(this.XES>FP.FEXCESS){this.reduce()}return this},sub:function(b){var n=new FP(0);n.copy(b);n.neg();this.add(n);return this},rsub:function(b){var n=new FP(0);n.copy(this);n.neg();this.copy(b);this.add(n)},div2:function(){var p;if(this.f.parity()===0){this.f.fshr(1)}else{p=new ctx.BIG(0);p.rcopy(ctx.ROM_FIELD.Modulus);this.f.add(p);this.f.norm();this.f.fshr(1)}return this},inverse:function(){var m2=new ctx.BIG(0);m2.rcopy(ctx.ROM_FIELD.Modulus);m2.dec(2);m2.norm();this.copy(this.pow(m2));return this},equals:function(a){a.reduce();this.reduce();if(ctx.BIG.comp(a.f,this.f)===0){return true}return false},pow:function(e){var i,w=[],tb=[],t=new ctx.BIG(e),nb,lsbs,r;t.norm();nb=1+Math.floor((t.nbits()+3)/4);for(i=0;i<nb;i++){lsbs=t.lastbits(4);t.dec(lsbs);t.norm();w[i]=lsbs;t.fshr(4)}tb[0]=new FP(1);tb[1]=new FP(this);for(i=2;i<16;i++){tb[i]=new FP(tb[i-1]);tb[i].mul(this)}r=new FP(tb[w[nb-1]]);for(i=nb-2;i>=0;i--){r.sqr();r.sqr();r.sqr();r.sqr();r.mul(tb[w[i]])}r.reduce();return r},jacobi:function(){var p=new ctx.BIG(0),w=this.redc();p.rcopy(ctx.ROM_FIELD.Modulus);return w.jacobi(p)},sqrt:function(){var b=new ctx.BIG(0),i,v,r;this.reduce();b.rcopy(ctx.ROM_FIELD.Modulus);if(FP.MOD8==5){b.dec(5);b.norm();b.shr(3);i=new FP(0);i.copy(this);i.f.shl(1);v=i.pow(b);i.mul(v);i.mul(v);i.f.dec(1);r=new FP(0);r.copy(this);r.mul(v);r.mul(i);r.reduce();return r}else{b.inc(1);b.norm();b.shr(2);return this.pow(b)}}};FP.logb2=function(v){var r;v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;v=v-(v>>>1&1431655765);v=(v&858993459)+(v>>>2&858993459);r=(v+(v>>>4)&252645135)*16843009>>>24;return r};FP.mod=function(d){var b=new ctx.BIG(0),i,t,v,tw,tt,lo,carry,m,dd;if(FP.MODTYPE==FP.PSEUDO_MERSENNE){t=d.split(FP.MODBITS);b.hcopy(d);if(ctx.ROM_FIELD.MConst!=1){v=t.pmul(ctx.ROM_FIELD.MConst)}else{v=0}t.add(b);t.norm();tw=t.w[ctx.BIG.NLEN-1];t.w[ctx.BIG.NLEN-1]&=FP.TMASK;t.inc(ctx.ROM_FIELD.MConst*((tw>>FP.TBITS)+(v<<ctx.BIG.BASEBITS-FP.TBITS)));t.norm();return t}if(FP.MODTYPE==FP.MONTGOMERY_FRIENDLY){for(i=0;i<ctx.BIG.NLEN;i++){d.w[ctx.BIG.NLEN+i]+=d.muladd(d.w[i],ctx.ROM_FIELD.MConst-1,d.w[i],ctx.BIG.NLEN+i-1)}for(i=0;i<ctx.BIG.NLEN;i++){b.w[i]=d.w[ctx.BIG.NLEN+i]}b.norm()}if(FP.MODTYPE==FP.GENERALISED_MERSENNE){t=d.split(FP.MODBITS);b.hcopy(d);b.add(t);dd=new ctx.DBIG(0);dd.hcopy(t);dd.shl(FP.MODBITS/2);tt=dd.split(FP.MODBITS);lo=new ctx.BIG;lo.hcopy(dd);b.add(tt);b.add(lo);tt.shl(FP.MODBITS/2);b.add(tt);carry=b.w[ctx.BIG.NLEN-1]>>FP.TBITS;b.w[ctx.BIG.NLEN-1]&=FP.TMASK;b.w[0]+=carry;b.w[Math.floor(224/ctx.BIG.BASEBITS)]+=carry<<224%ctx.BIG.BASEBITS;b.norm()}if(FP.MODTYPE==FP.NOT_SPECIAL){m=new ctx.BIG(0);m.rcopy(ctx.ROM_FIELD.Modulus);b.copy(ctx.BIG.monty(m,ctx.ROM_FIELD.MConst,d))}return b};return FP}function FP12(ctx){var FP12=function(d,e,f){if(d instanceof FP12){this.a=new ctx.FP4(d.a);this.b=new ctx.FP4(d.b);this.c=new ctx.FP4(d.c)}else{this.a=new ctx.FP4(d);this.b=new ctx.FP4(e);this.c=new ctx.FP4(f)}};FP12.prototype={reduce:function(){this.a.reduce();this.b.reduce();this.c.reduce()},norm:function(){this.a.norm();this.b.norm();this.c.norm()},iszilch:function(){this.reduce();return this.a.iszilch()&&this.b.iszilch()&&this.c.iszilch()},isunity:function(){var one=new ctx.FP4(1);return this.a.equals(one)&&this.b.iszilch()&&this.c.iszilch()},cmove:function(g,d){this.a.cmove(g.a,d);this.b.cmove(g.b,d);this.c.cmove(g.c,d)},select:function(g,b){var invf=new FP12(0),m,babs;m=b>>31;babs=(b^m)-m;babs=(babs-1)/2;this.cmove(g[0],FP12.teq(babs,0));this.cmove(g[1],FP12.teq(babs,1));this.cmove(g[2],FP12.teq(babs,2));this.cmove(g[3],FP12.teq(babs,3));this.cmove(g[4],FP12.teq(babs,4));this.cmove(g[5],FP12.teq(babs,5));this.cmove(g[6],FP12.teq(babs,6));this.cmove(g[7],FP12.teq(babs,7));invf.copy(this);invf.conj();this.cmove(invf,m&1)},geta:function(){return this.a},getb:function(){return this.b},getc:function(){return this.c},equals:function(x){return this.a.equals(x.a)&&this.b.equals(x.b)&&this.c.equals(x.c)},copy:function(x){this.a.copy(x.a);this.b.copy(x.b);this.c.copy(x.c)},one:function(){this.a.one();this.b.zero();this.c.zero()},conj:function(){this.a.conj();this.b.nconj();this.c.conj()},set:function(d,e,f){this.a.copy(d);this.b.copy(e);this.c.copy(f)},seta:function(d){this.a.copy(d);this.b.zero();this.c.zero()},usqr:function(){var A=new ctx.FP4(this.a),B=new ctx.FP4(this.c),C=new ctx.FP4(this.b),D=new ctx.FP4(0);this.a.sqr();D.copy(this.a);D.add(this.a);this.a.add(D);A.nconj();A.add(A);this.a.add(A);B.sqr();B.times_i();D.copy(B);D.add(B);B.add(D);C.sqr();D.copy(C);D.add(C);C.add(D);this.b.conj();this.b.add(this.b);this.c.nconj();this.c.add(this.c);this.b.add(B);this.c.add(C);this.reduce()},sqr:function(){var A=new ctx.FP4(this.a),B=new ctx.FP4(this.b),C=new ctx.FP4(this.c),D=new ctx.FP4(this.a);A.sqr();B.mul(this.c);B.add(B);C.sqr();D.mul(this.b);D.add(D);this.c.add(this.a);this.c.add(this.b);this.c.norm();this.c.sqr();this.a.copy(A);A.add(B);A.add(C);A.add(D);A.neg();B.times_i();C.times_i();this.a.add(B);this.b.copy(C);this.b.add(D);this.c.add(A);this.norm()},mul:function(y){var z0=new ctx.FP4(this.a),z1=new ctx.FP4(0),z2=new ctx.FP4(this.b),z3=new ctx.FP4(0),t0=new ctx.FP4(this.a),t1=new ctx.FP4(y.a);z0.mul(y.a);z2.mul(y.b);t0.add(this.b);t1.add(y.b);t0.norm();t1.norm();z1.copy(t0);z1.mul(t1);t0.copy(this.b);t0.add(this.c);t1.copy(y.b);t1.add(y.c);t0.norm();t1.norm();z3.copy(t0);z3.mul(t1);t0.copy(z0);t0.neg();t1.copy(z2);t1.neg();z1.add(t0);this.b.copy(z1);this.b.add(t1);z3.add(t1);z2.add(t0);t0.copy(this.a);t0.add(this.c);t1.copy(y.a);t1.add(y.c);t0.norm();t1.norm();t0.mul(t1);z2.add(t0);t0.copy(this.c);t0.mul(y.c);t1.copy(t0);t1.neg();this.c.copy(z2);this.c.add(t1);z3.add(t1);t0.times_i();this.b.add(t0);z3.times_i();this.a.copy(z0);this.a.add(z3);this.norm()},smul:function(y,twist){var z0,z1,z2,z3,t0,t1;if(twist==ctx.ECP.D_TYPE){z0=new ctx.FP4(this.a);z2=new ctx.FP4(this.b);z3=new ctx.FP4(this.b);t0=new ctx.FP4(0);t1=new ctx.FP4(y.a);z0.mul(y.a);z2.pmul(y.b.real());this.b.add(this.a);t1.real().add(y.b.real());this.b.norm();t1.norm();this.b.mul(t1);z3.add(this.c);z3.norm();z3.pmul(y.b.real());t0.copy(z0);t0.neg();t1.copy(z2);t1.neg();this.b.add(t0);this.b.add(t1);z3.add(t1);z2.add(t0);t0.copy(this.a);t0.add(this.c);t0.norm();t0.mul(y.a);this.c.copy(z2);this.c.add(t0);z3.times_i();this.a.copy(z0);this.a.add(z3)}if(twist==ctx.ECP.M_TYPE){z0=new ctx.FP4(this.a);z1=new ctx.FP4(0);z2=new ctx.FP4(0);z3=new ctx.FP4(0);t0=new ctx.FP4(this.a);t1=new ctx.FP4(0);z0.mul(y.a);t0.add(this.b);t0.norm();z1.copy(t0);z1.mul(y.a);t0.copy(this.b);t0.add(this.c);t0.norm();z3.copy(t0);z3.pmul(y.c.getb());z3.times_i();t0.copy(z0);t0.neg();z1.add(t0);this.b.copy(z1);z2.copy(t0);t0.copy(this.a);t0.add(this.c);t1.copy(y.a);t1.add(y.c);t0.norm();t1.norm();t0.mul(t1);z2.add(t0);t0.copy(this.c);t0.pmul(y.c.getb());t0.times_i();t1.copy(t0);t1.neg();this.c.copy(z2);this.c.add(t1);z3.add(t1);t0.times_i();this.b.add(t0);z3.norm();z3.times_i();this.a.copy(z0);this.a.add(z3)}this.norm()},inverse:function(){var f0=new ctx.FP4(this.a),f1=new ctx.FP4(this.b),f2=new ctx.FP4(this.a),f3=new ctx.FP4(0);f0.sqr();f1.mul(this.c);f1.times_i();f0.sub(f1);f0.norm();f1.copy(this.c);f1.sqr();f1.times_i();f2.mul(this.b);f1.sub(f2);f1.norm();f2.copy(this.b);f2.sqr();f3.copy(this.a);f3.mul(this.c);f2.sub(f3);f2.norm();f3.copy(this.b);f3.mul(f2);f3.times_i();this.a.mul(f0);f3.add(this.a);this.c.mul(f1);this.c.times_i();f3.add(this.c);f3.norm();f3.inverse();this.a.copy(f0);this.a.mul(f3);this.b.copy(f1);this.b.mul(f3);this.c.copy(f2);this.c.mul(f3)},frob:function(f){var f2=new ctx.FP2(f),f3=new ctx.FP2(f);f2.sqr();f3.mul(f2);this.a.frob(f3);this.b.frob(f3);this.c.frob(f3);this.b.pmul(f);this.c.pmul(f2)},trace:function(){var t=new ctx.FP4(0);t.copy(this.a);t.imul(3);t.reduce();return t},toString:function(){return"["+this.a.toString()+","+this.b.toString()+","+this.c.toString()+"]"},toBytes:function(w){var t=[],i;this.a.geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i]=t[i]}this.a.geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+ctx.BIG.MODBYTES]=t[i]}this.a.getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+2*ctx.BIG.MODBYTES]=t[i]}this.a.getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+3*ctx.BIG.MODBYTES]=t[i]}this.b.geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+4*ctx.BIG.MODBYTES]=t[i]}this.b.geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+5*ctx.BIG.MODBYTES]=t[i]}this.b.getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+6*ctx.BIG.MODBYTES]=t[i]}this.b.getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+7*ctx.BIG.MODBYTES]=t[i]}this.c.geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+8*ctx.BIG.MODBYTES]=t[i]}this.c.geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+9*ctx.BIG.MODBYTES]=t[i]}this.c.getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+10*ctx.BIG.MODBYTES]=t[i]}this.c.getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+11*ctx.BIG.MODBYTES]=t[i]}},pow:function(e){var e3,w,nb,i,bt;this.norm();e.norm();e3=new ctx.BIG(e);e3.pmul(3);e3.norm();w=new FP12(this);nb=e3.nbits();for(i=nb-2;i>=1;i--){w.usqr();bt=e3.bit(i)-e.bit(i);if(bt==1){w.mul(this)}if(bt==-1){this.conj();w.mul(this);this.conj()}}w.reduce();return w},pinpow:function(e,bts){var R=[],i,b;R[0]=new FP12(1);R[1]=new FP12(this);for(i=bts-1;i>=0;i--){b=e>>i&1;R[1-b].mul(R[b]);R[b].usqr()}this.copy(R[0])},compow:function(e,r){var fa,fb,f,q,m,a,b,g1,g2,c,cp,cpm1,cpm2;fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);q=new ctx.BIG(0);q.rcopy(ctx.ROM_FIELD.Modulus);m=new ctx.BIG(q);m.mod(r);a=new ctx.BIG(e);a.mod(m);b=new ctx.BIG(e);b.div(m);g1=new FP12(0);g2=new FP12(0);g1.copy(this);c=g1.trace();if(b.iszilch()){c=c.xtr_pow(e);return c}g2.copy(g1);g2.frob(f);cp=g2.trace();g1.conj();g2.mul(g1);cpm1=g2.trace();g2.mul(g1);cpm2=g2.trace();c=c.xtr_pow2(cp,cpm1,cpm2,a,b);return c}};FP12.fromBytes=function(w){var t=[],i,a,b,c,d,e,f,g,r;for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+2*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+3*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);e=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+4*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+5*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+6*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+7*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);f=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+8*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+9*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+10*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+11*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);g=new ctx.FP4(c,d);r=new FP12(e,f,g);return r};FP12.teq=function(b,c){var x=b^c;x-=1;return x>>31&1};FP12.pow4=function(q,u){var g=[],r=new FP12(0),p=new FP12(0),t=[],mt=new ctx.BIG(0),w=[],s=[],i,j,k,nb,bt,pb;for(i=0;i<4;i++){t[i]=new ctx.BIG(u[i]);t[i].norm()}g[0]=new FP12(q[0]);g[1]=new FP12(g[0]);g[1].mul(q[1]);g[2]=new FP12(g[0]);g[2].mul(q[2]);g[3]=new FP12(g[1]);g[3].mul(q[2]);g[4]=new FP12(q[0]);g[4].mul(q[3]);g[5]=new FP12(g[1]);g[5].mul(q[3]);g[6]=new FP12(g[2]);g[6].mul(q[3]);g[7]=new FP12(g[3]);g[7].mul(q[3]);pb=1-t[0].parity();t[0].inc(pb);t[0].norm();mt.zero();for(i=0;i<4;i++){mt.or(t[i])}nb=1+mt.nbits();s[nb-1]=1;for(i=0;i<nb-1;i++){t[0].fshr(1);s[i]=2*t[0].parity()-1}for(i=0;i<nb;i++){w[i]=0;k=1;for(j=1;j<4;j++){bt=s[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w[i]+=bt*k;k*=2}}p.select(g,2*w[nb-1]+1);for(i=nb-2;i>=0;i--){p.usqr();r.select(g,2*w[i]+s[i]);p.mul(r)}r.copy(q[0]);r.conj();r.mul(p);p.cmove(r,pb);p.reduce();return p};return FP12}function FP16(ctx){var FP16=function(c,d){if(c instanceof FP16){this.a=new ctx.FP8(c.a);this.b=new ctx.FP8(c.b)}else{this.a=new ctx.FP8(c);this.b=new ctx.FP8(d)}};FP16.prototype={reduce:function(){this.a.reduce();this.b.reduce()},norm:function(){this.a.norm();this.b.norm()},iszilch:function(){this.reduce();return this.a.iszilch()&&this.b.iszilch()},isunity:function(){var one=new ctx.FP8(1);return this.a.equals(one)&&this.b.iszilch()},cmove:function(g,d){this.a.cmove(g.a,d);this.b.cmove(g.b,d)},isreal:function(){return this.b.iszilch()},real:function(){return this.a},geta:function(){return this.a},getb:function(){return this.b},equals:function(x){return this.a.equals(x.a)&&this.b.equals(x.b)},copy:function(x){this.a.copy(x.a);this.b.copy(x.b)},zero:function(){this.a.zero();this.b.zero()},one:function(){this.a.one();this.b.zero()},set:function(c,d){this.a.copy(c);this.b.copy(d)},seta:function(c){this.a.copy(c);this.b.zero()},neg:function(){var m=new ctx.FP8(this.a),t=new ctx.FP8(0);this.norm();m.add(this.b);m.neg();t.copy(m);t.add(this.b);this.b.copy(m);this.b.add(this.a);this.a.copy(t);this.norm()},conj:function(){this.b.neg();this.norm()},nconj:function(){this.a.neg();this.norm()},add:function(x){this.a.add(x.a);this.b.add(x.b)},sub:function(x){var m=new FP16(x);m.neg();this.add(m)},pmul:function(s){this.a.mul(s);this.b.mul(s)},qmul:function(s){this.a.qmul(s);this.b.qmul(s)},imul:function(c){this.a.imul(c);this.b.imul(c)},sqr:function(){var t1=new ctx.FP8(this.a),t2=new ctx.FP8(this.b),t3=new ctx.FP8(this.a);t3.mul(this.b);t1.add(this.b);t1.norm();t2.times_i();t2.add(this.a);t2.norm();this.a.copy(t1);this.a.mul(t2);t2.copy(t3);t2.times_i();t2.add(t3);t2.neg();this.a.add(t2);this.b.copy(t3);this.b.add(t3);this.norm()},mul:function(y){var t1=new ctx.FP8(this.a),t2=new ctx.FP8(this.b),t3=new ctx.FP8(0),t4=new ctx.FP8(this.b);t1.mul(y.a);t2.mul(y.b);t3.copy(y.b);t3.add(y.a);t4.add(this.a);t3.norm();t4.norm();t4.mul(t3);t3.copy(t1);t3.neg();t4.add(t3);t3.copy(t2);t3.neg();this.b.copy(t4);this.b.add(t3);t2.times_i();this.a.copy(t2);this.a.add(t1);this.norm()},toString:function(){return"["+this.a.toString()+","+this.b.toString()+"]"},inverse:function(){this.norm();var t1=new ctx.FP8(this.a),t2=new ctx.FP8(this.b);t1.sqr();t2.sqr();t2.times_i();t2.norm();t1.sub(t2);t1.inverse();this.a.mul(t1);t1.neg();t1.norm();this.b.mul(t1)},times_i:function(){var s=new ctx.FP8(this.b),t=new ctx.FP8(this.a);s.times_i();this.b.copy(t);this.a.copy(s);this.norm()},times_i2:function(){this.a.times_i();this.b.times_i()},times_i4:function(){this.a.times_i2();this.b.times_i2()},frob:function(f){var ff=new ctx.FP2(f);ff.sqr();ff.norm();this.a.frob(ff);this.b.frob(ff);this.b.qmul(f);this.b.times_i()},pow:function(e){this.norm();e.norm();var w=new FP16(this),z=new ctx.BIG(e),r=new FP16(1),bt;for(;;){bt=z.parity();z.fshr(1);if(bt===1){r.mul(w)}if(z.iszilch()){break}w.sqr()}r.reduce();return r},xtr_A:function(w,y,z){var r=new FP16(w),t=new FP16(w);r.sub(y);r.norm();r.pmul(this.a);t.add(y);t.norm();t.pmul(this.b);t.times_i();this.copy(r);this.add(t);this.add(z);this.reduce()},xtr_D:function(){var w=new FP16(this);this.sqr();w.conj();w.add(w);this.sub(w);this.reduce()},xtr_pow:function(n){var a=new FP16(3),b=new FP16(this),c=new FP16(b),t=new FP16(0),r=new FP16(0),par,v,nb,i;c.xtr_D();n.norm();par=n.parity();v=new ctx.BIG(n);v.fshr(1);if(par===0){v.dec(1);v.norm()}nb=v.nbits();for(i=nb-1;i>=0;i--){if(v.bit(i)!=1){t.copy(b);this.conj();c.conj();b.xtr_A(a,this,c);this.conj();c.copy(t);c.xtr_D();a.xtr_D()}else{t.copy(a);t.conj();a.copy(b);a.xtr_D();b.xtr_A(c,this,t);c.xtr_D()}}if(par===0){r.copy(c)}else{r.copy(b)}r.reduce();return r},xtr_pow2:function(ck,ckml,ckm2l,a,b){a.norm();b.norm();var e=new ctx.BIG(a),d=new ctx.BIG(b),w=new ctx.BIG(0),cu=new FP16(ck),cv=new FP16(this),cumv=new FP16(ckml),cum2v=new FP16(ckm2l),r=new FP16(0),t=new FP16(0),f2=0,i;while(d.parity()===0&&e.parity()===0){d.fshr(1);e.fshr(1);f2++}while(ctx.BIG.comp(d,e)!==0){if(ctx.BIG.comp(d,e)>0){w.copy(e);w.imul(4);w.norm();if(ctx.BIG.comp(d,w)<=0){w.copy(d);d.copy(e);e.rsub(w);e.norm();t.copy(cv);t.xtr_A(cu,cumv,cum2v);cum2v.copy(cumv);cum2v.conj();cumv.copy(cv);cv.copy(cu);cu.copy(t)}else if(d.parity()===0){d.fshr(1);r.copy(cum2v);r.conj();t.copy(cumv);t.xtr_A(cu,cv,r);cum2v.copy(cumv);cum2v.xtr_D();cumv.copy(t);cu.xtr_D()}else if(e.parity()==1){d.sub(e);d.norm();d.fshr(1);t.copy(cv);t.xtr_A(cu,cumv,cum2v);cu.xtr_D();cum2v.copy(cv);cum2v.xtr_D();cum2v.conj();cv.copy(t)}else{w.copy(d);d.copy(e);d.fshr(1);e.copy(w);t.copy(cumv);t.xtr_D();cumv.copy(cum2v);cumv.conj();cum2v.copy(t);cum2v.conj();t.copy(cv);t.xtr_D();cv.copy(cu);cu.copy(t)}}if(ctx.BIG.comp(d,e)<0){w.copy(d);w.imul(4);w.norm();if(ctx.BIG.comp(e,w)<=0){e.sub(d);e.norm();t.copy(cv);t.xtr_A(cu,cumv,cum2v);cum2v.copy(cumv);cumv.copy(cu);cu.copy(t)}else if(e.parity()===0){w.copy(d);d.copy(e);d.fshr(1);e.copy(w);t.copy(cumv);t.xtr_D();cumv.copy(cum2v);cumv.conj();cum2v.copy(t);cum2v.conj();t.copy(cv);t.xtr_D();cv.copy(cu);cu.copy(t)}else if(d.parity()==1){w.copy(e);e.copy(d);w.sub(d);w.norm();d.copy(w);d.fshr(1);t.copy(cv);t.xtr_A(cu,cumv,cum2v);cumv.conj();cum2v.copy(cu);cum2v.xtr_D();cum2v.conj();cu.copy(cv);cu.xtr_D();cv.copy(t)}else{d.fshr(1);r.copy(cum2v);r.conj();t.copy(cumv);t.xtr_A(cu,cv,r);cum2v.copy(cumv);cum2v.xtr_D();cumv.copy(t);cu.xtr_D()}}}r.copy(cv);r.xtr_A(cu,cumv,cum2v);for(i=0;i<f2;i++){r.xtr_D()}r=r.xtr_pow(d);return r}};return FP16}function FP2(ctx){var FP2=function(c,d){if(c instanceof FP2){this.a=new ctx.FP(c.a);this.b=new ctx.FP(c.b)}else{this.a=new ctx.FP(c);this.b=new ctx.FP(d)}};FP2.prototype={reduce:function(){this.a.reduce();this.b.reduce()},norm:function(){this.a.norm();this.b.norm()},iszilch:function(){this.reduce();return this.a.iszilch()&&this.b.iszilch()},isunity:function(){var one=new ctx.FP(1);return this.a.equals(one)&&this.b.iszilch()},cmove:function(g,d){this.a.cmove(g.a,d);this.b.cmove(g.b,d)},equals:function(x){return this.a.equals(x.a)&&this.b.equals(x.b)},getA:function(){return this.a.redc()},getB:function(){return this.b.redc()},set:function(c,d){this.a.copy(c);this.b.copy(d)},seta:function(c){this.a.copy(c);this.b.zero()},bset:function(c,d){this.a.bcopy(c);this.b.bcopy(d)},bseta:function(c){this.a.bcopy(c);this.b.zero()},copy:function(x){this.a.copy(x.a);this.b.copy(x.b)},zero:function(){this.a.zero();this.b.zero()},one:function(){this.a.one();this.b.zero()},neg:function(){var m=new ctx.FP(this.a),t=new ctx.FP(0);m.add(this.b);m.neg();t.copy(m);t.add(this.b);this.b.copy(m);this.b.add(this.a);this.a.copy(t)},conj:function(){this.b.neg();this.b.norm()},add:function(x){this.a.add(x.a);this.b.add(x.b)},sub:function(x){var m=new FP2(x);m.neg();this.add(m)},rsub:function(x){this.neg();this.add(x)},pmul:function(s){this.a.mul(s);this.b.mul(s)},imul:function(c){this.a.imul(c);this.b.imul(c)},sqr:function(){var w1=new ctx.FP(this.a),w3=new ctx.FP(this.a),mb=new ctx.FP(this.b);w1.add(this.b);w3.add(this.a);w3.norm();this.b.mul(w3);mb.neg();this.a.add(mb);this.a.norm();w1.norm();this.a.mul(w1)},mul:function(y){var p=new ctx.BIG(0),pR=new ctx.DBIG(0),A,B,C,D,E,F;p.rcopy(ctx.ROM_FIELD.Modulus);pR.ucopy(p);if((this.a.XES+this.b.XES)*(y.a.XES+y.b.XES)>ctx.FP.FEXCESS){if(this.a.XES>1){this.a.reduce()}if(this.b.XES>1){this.b.reduce()}}A=ctx.BIG.mul(this.a.f,y.a.f);B=ctx.BIG.mul(this.b.f,y.b.f);C=new ctx.BIG(this.a.f);D=new ctx.BIG(y.a.f);C.add(this.b.f);C.norm();D.add(y.b.f);D.norm();E=ctx.BIG.mul(C,D);F=new ctx.DBIG(0);F.copy(A);F.add(B);B.rsub(pR);A.add(B);A.norm();E.sub(F);E.norm();this.a.f.copy(ctx.FP.mod(A));this.a.XES=3;this.b.f.copy(ctx.FP.mod(E));this.b.XES=2},sqrt:function(){var w1,w2;if(this.iszilch()){return true}w1=new ctx.FP(this.b);w2=new ctx.FP(this.a);w1.sqr();w2.sqr();w1.add(w2);if(w1.jacobi()!=1){this.zero();return false}w1=w1.sqrt();w2.copy(this.a);w2.add(w1);w2.norm();w2.div2();if(w2.jacobi()!=1){w2.copy(this.a);w2.sub(w1);w2.norm();w2.div2();if(w2.jacobi()!=1){this.zero();return false}}w2=w2.sqrt();this.a.copy(w2);w2.add(w2);w2.inverse();this.b.mul(w2);return true},toString:function(){return"["+this.a.toString()+","+this.b.toString()+"]"},inverse:function(){var w1,w2;this.norm();w1=new ctx.FP(this.a);w2=new ctx.FP(this.b);w1.sqr();w2.sqr();w1.add(w2);w1.inverse();this.a.mul(w1);w1.neg();w1.norm();this.b.mul(w1)},div2:function(){this.a.div2();this.b.div2()},times_i:function(){var z=new ctx.FP(this.a);this.a.copy(this.b);this.a.neg();this.b.copy(z)},mul_ip:function(){var t=new FP2(this),z=new ctx.FP(this.a);this.a.copy(this.b);this.a.neg();this.b.copy(z);this.add(t)},div_ip2:function(){var t=new FP2(0);this.norm();t.a.copy(this.a);t.a.add(this.b);t.b.copy(this.b);t.b.sub(this.a);this.copy(t);this.norm()},div_ip:function(){var t=new FP2(0);this.norm();t.a.copy(this.a);t.a.add(this.b);t.b.copy(this.b);t.b.sub(this.a);this.copy(t);this.norm();this.div2()},pow:function(e){this.norm();var r=new FP2(1),x=new FP2(this),bt;e.norm();for(;;){bt=e.parity();e.fshr(1);if(bt==1){r.mul(x)}if(e.iszilch()){break}x.sqr()}r.reduce();return r}};return FP2}function FP24(ctx){var FP24=function(d,e,f){if(d instanceof FP24){this.a=new ctx.FP8(d.a);this.b=new ctx.FP8(d.b);this.c=new ctx.FP8(d.c)}else{this.a=new ctx.FP8(d);this.b=new ctx.FP8(e);this.c=new ctx.FP8(f)}};FP24.prototype={reduce:function(){this.a.reduce();this.b.reduce();this.c.reduce()},norm:function(){this.a.norm();this.b.norm();this.c.norm()},iszilch:function(){this.reduce();return this.a.iszilch()&&this.b.iszilch()&&this.c.iszilch()},isunity:function(){var one=new ctx.FP8(1);return this.a.equals(one)&&this.b.iszilch()&&this.c.iszilch()},cmove:function(g,d){this.a.cmove(g.a,d);this.b.cmove(g.b,d);this.c.cmove(g.c,d)},select:function(g,b){var invf=new FP24(0),m,babs;m=b>>31;babs=(b^m)-m;babs=(babs-1)/2;this.cmove(g[0],FP24.teq(babs,0));this.cmove(g[1],FP24.teq(babs,1));this.cmove(g[2],FP24.teq(babs,2));this.cmove(g[3],FP24.teq(babs,3));this.cmove(g[4],FP24.teq(babs,4));this.cmove(g[5],FP24.teq(babs,5));this.cmove(g[6],FP24.teq(babs,6));this.cmove(g[7],FP24.teq(babs,7));invf.copy(this);invf.conj();this.cmove(invf,m&1)},geta:function(){return this.a},getb:function(){return this.b},getc:function(){return this.c},equals:function(x){return this.a.equals(x.a)&&this.b.equals(x.b)&&this.c.equals(x.c)},copy:function(x){this.a.copy(x.a);this.b.copy(x.b);this.c.copy(x.c)},one:function(){this.a.one();this.b.zero();this.c.zero()},conj:function(){this.a.conj();this.b.nconj();this.c.conj()},set:function(d,e,f){this.a.copy(d);this.b.copy(e);this.c.copy(f)},seta:function(d){this.a.copy(d);this.b.zero();this.c.zero()},usqr:function(){var A=new ctx.FP8(this.a),B=new ctx.FP8(this.c),C=new ctx.FP8(this.b),D=new ctx.FP8(0);this.a.sqr();D.copy(this.a);D.add(this.a);this.a.add(D);A.nconj();A.add(A);this.a.add(A);B.sqr();B.times_i();D.copy(B);D.add(B);B.add(D);C.sqr();D.copy(C);D.add(C);C.add(D);this.b.conj();this.b.add(this.b);this.c.nconj();this.c.add(this.c);this.b.add(B);this.c.add(C);this.reduce()},sqr:function(){var A=new ctx.FP8(this.a),B=new ctx.FP8(this.b),C=new ctx.FP8(this.c),D=new ctx.FP8(this.a);A.sqr();B.mul(this.c);B.add(B);C.sqr();D.mul(this.b);D.add(D);this.c.add(this.a);this.c.add(this.b);this.c.norm();this.c.sqr();this.a.copy(A);A.add(B);A.add(C);A.add(D);A.neg();B.times_i();C.times_i();this.a.add(B);this.b.copy(C);this.b.add(D);this.c.add(A);this.norm()},mul:function(y){var z0=new ctx.FP8(this.a),z1=new ctx.FP8(0),z2=new ctx.FP8(this.b),z3=new ctx.FP8(0),t0=new ctx.FP8(this.a),t1=new ctx.FP8(y.a);z0.mul(y.a);z2.mul(y.b);t0.add(this.b);t1.add(y.b);t0.norm();t1.norm();z1.copy(t0);z1.mul(t1);t0.copy(this.b);t0.add(this.c);t1.copy(y.b);t1.add(y.c);t0.norm();t1.norm();z3.copy(t0);z3.mul(t1);t0.copy(z0);t0.neg();t1.copy(z2);t1.neg();z1.add(t0);this.b.copy(z1);this.b.add(t1);z3.add(t1);z2.add(t0);t0.copy(this.a);t0.add(this.c);t1.copy(y.a);t1.add(y.c);t0.norm();t1.norm();t0.mul(t1);z2.add(t0);t0.copy(this.c);t0.mul(y.c);t1.copy(t0);t1.neg();this.c.copy(z2);this.c.add(t1);z3.add(t1);t0.times_i();this.b.add(t0);z3.times_i();this.a.copy(z0);this.a.add(z3);this.norm()},smul:function(y,twist){var z0,z1,z2,z3,t0,t1;if(twist==ctx.ECP.D_TYPE){z0=new ctx.FP8(this.a);z2=new ctx.FP8(this.b);z3=new ctx.FP8(this.b);t0=new ctx.FP8(0);t1=new ctx.FP8(y.a);z0.mul(y.a);z2.pmul(y.b.real());this.b.add(this.a);t1.real().add(y.b.real());this.b.norm();t1.norm();this.b.mul(t1);z3.add(this.c);z3.norm();z3.pmul(y.b.real());t0.copy(z0);t0.neg();t1.copy(z2);t1.neg();this.b.add(t0);this.b.add(t1);z3.add(t1);z2.add(t0);t0.copy(this.a);t0.add(this.c);t0.norm();t0.mul(y.a);this.c.copy(z2);this.c.add(t0);z3.times_i();this.a.copy(z0);this.a.add(z3)}if(twist==ctx.ECP.M_TYPE){z0=new ctx.FP8(this.a);z1=new ctx.FP8(0);z2=new ctx.FP8(0);z3=new ctx.FP8(0);t0=new ctx.FP8(this.a);t1=new ctx.FP8(0);z0.mul(y.a);t0.add(this.b);t0.norm();z1.copy(t0);z1.mul(y.a);t0.copy(this.b);t0.add(this.c);t0.norm();z3.copy(t0);z3.pmul(y.c.getb());z3.times_i();t0.copy(z0);t0.neg();z1.add(t0);this.b.copy(z1);z2.copy(t0);t0.copy(this.a);t0.add(this.c);t1.copy(y.a);t1.add(y.c);t0.norm();t1.norm();t0.mul(t1);z2.add(t0);t0.copy(this.c);t0.pmul(y.c.getb());t0.times_i();t1.copy(t0);t1.neg();this.c.copy(z2);this.c.add(t1);z3.add(t1);t0.times_i();this.b.add(t0);z3.norm();z3.times_i();this.a.copy(z0);this.a.add(z3)}this.norm()},inverse:function(){var f0=new ctx.FP8(this.a),f1=new ctx.FP8(this.b),f2=new ctx.FP8(this.a),f3=new ctx.FP8(0);f0.sqr();f1.mul(this.c);f1.times_i();f0.sub(f1);f0.norm();f1.copy(this.c);f1.sqr();f1.times_i();f2.mul(this.b);f1.sub(f2);f1.norm();f2.copy(this.b);f2.sqr();f3.copy(this.a);f3.mul(this.c);f2.sub(f3);f2.norm();f3.copy(this.b);f3.mul(f2);f3.times_i();this.a.mul(f0);f3.add(this.a);this.c.mul(f1);this.c.times_i();f3.add(this.c);f3.norm();f3.inverse();this.a.copy(f0);this.a.mul(f3);this.b.copy(f1);this.b.mul(f3);this.c.copy(f2);this.c.mul(f3)},frob:function(f,n){var f2=new ctx.FP2(f),f3=new ctx.FP2(f),i;f2.sqr();f3.mul(f2);f3.mul_ip();f3.norm();for(i=0;i<n;i++){this.a.frob(f3);this.b.frob(f3);this.c.frob(f3);this.b.qmul(f);this.b.times_i2();this.c.qmul(f2);this.c.times_i2();this.c.times_i2()}},trace:function(){var t=new ctx.FP8(0);t.copy(this.a);t.imul(3);t.reduce();return t},toString:function(){return"["+this.a.toString()+","+this.b.toString()+","+this.c.toString()+"]"},toBytes:function(w){var t=[],i;this.a.geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i]=t[i]}this.a.geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+ctx.BIG.MODBYTES]=t[i]}this.a.geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+2*ctx.BIG.MODBYTES]=t[i]}this.a.geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+3*ctx.BIG.MODBYTES]=t[i]}this.a.getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+4*ctx.BIG.MODBYTES]=t[i]}this.a.getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+5*ctx.BIG.MODBYTES]=t[i]}this.a.getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+6*ctx.BIG.MODBYTES]=t[i]}this.a.getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+7*ctx.BIG.MODBYTES]=t[i]}this.b.geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+8*ctx.BIG.MODBYTES]=t[i]}this.b.geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+9*ctx.BIG.MODBYTES]=t[i]}this.b.geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+10*ctx.BIG.MODBYTES]=t[i]}this.b.geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+11*ctx.BIG.MODBYTES]=t[i]}this.b.getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+12*ctx.BIG.MODBYTES]=t[i]}this.b.getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+13*ctx.BIG.MODBYTES]=t[i]}this.b.getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+14*ctx.BIG.MODBYTES]=t[i]}this.b.getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+15*ctx.BIG.MODBYTES]=t[i]}this.c.geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+16*ctx.BIG.MODBYTES]=t[i]}this.c.geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+17*ctx.BIG.MODBYTES]=t[i]}this.c.geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+18*ctx.BIG.MODBYTES]=t[i]}this.c.geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+19*ctx.BIG.MODBYTES]=t[i]}this.c.getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+20*ctx.BIG.MODBYTES]=t[i]}this.c.getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+21*ctx.BIG.MODBYTES]=t[i]}this.c.getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+22*ctx.BIG.MODBYTES]=t[i]}this.c.getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+23*ctx.BIG.MODBYTES]=t[i]}},pow:function(e){var e3,w,nb,i,bt;this.norm();e.norm();e3=new ctx.BIG(e);e3.pmul(3);e3.norm();w=new FP24(this);nb=e3.nbits();for(i=nb-2;i>=1;i--){w.usqr();bt=e3.bit(i)-e.bit(i);if(bt==1){w.mul(this)}if(bt==-1){this.conj();w.mul(this);this.conj()}}w.reduce();return w},pinpow:function(e,bts){var R=[],i,b;R[0]=new FP24(1);R[1]=new FP24(this);for(i=bts-1;i>=0;i--){b=e>>i&1;R[1-b].mul(R[b]);R[b].usqr()}this.copy(R[0])},compow:function(e,r){var fa,fb,f,q,m,a,b,g1,g2,c,cp,cpm1,cpm2;fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);q=new ctx.BIG(0);q.rcopy(ctx.ROM_FIELD.Modulus);m=new ctx.BIG(q);m.mod(r);a=new ctx.BIG(e);a.mod(m);b=new ctx.BIG(e);b.div(m);g1=new FP24(0);g2=new FP24(0);g1.copy(this);c=g1.trace();if(b.iszilch()){c=c.xtr_pow(e);return c}g2.copy(g1);g2.frob(f,1);cp=g2.trace();g1.conj();g2.mul(g1);cpm1=g2.trace();g2.mul(g1);cpm2=g2.trace();c=c.xtr_pow2(cp,cpm1,cpm2,a,b);return c}};FP24.fromBytes=function(w){var t=[],i,a,b,c,d,e,f,g,r,ea,eb;for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+2*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+3*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);ea=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){
t[i]=w[i+4*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+5*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+6*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+7*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);eb=new ctx.FP4(c,d);e=new ctx.FP8(ea,eb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+8*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+9*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+10*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+11*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);ea=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+12*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+13*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+14*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+15*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);eb=new ctx.FP4(c,d);f=new ctx.FP8(ea,eb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+16*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+17*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+18*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+19*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);ea=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+20*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+21*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+22*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+23*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);eb=new ctx.FP4(c,d);g=new ctx.FP8(ea,eb);r=new FP24(e,f,g);return r};FP24.teq=function(b,c){var x=b^c;x-=1;return x>>31&1};FP24.pow8=function(q,u){var g1=[],g2=[],r=new FP24(0),p=new FP24(0),t=[],mt=new ctx.BIG(0),fa=new ctx.BIG(0),fb=new ctx.BIG(0),w1=[],s1=[],w2=[],s2=[],i,j,k,nb,bt,pb1,pb2,f;for(i=0;i<8;i++){t[i]=new ctx.BIG(u[i]);t[i].norm()}g1[0]=new FP24(q[0]);g1[1]=new FP24(g1[0]);g1[1].mul(q[1]);g1[2]=new FP24(g1[0]);g1[2].mul(q[2]);g1[3]=new FP24(g1[1]);g1[3].mul(q[2]);g1[4]=new FP24(q[0]);g1[4].mul(q[3]);g1[5]=new FP24(g1[1]);g1[5].mul(q[3]);g1[6]=new FP24(g1[2]);g1[6].mul(q[3]);g1[7]=new FP24(g1[3]);g1[7].mul(q[3]);fa.rcopy(ctx.ROM_FIELD.Fra);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);for(i=0;i<8;i++){g2[i]=new FP24(g1[i]);g2[i].frob(f,4)}pb1=1-t[0].parity();t[0].inc(pb1);t[0].norm();pb2=1-t[4].parity();t[4].inc(pb2);t[4].norm();mt.zero();for(i=0;i<8;i++){mt.or(t[i])}nb=1+mt.nbits();s1[nb-1]=1;s2[nb-1]=1;for(i=0;i<nb-1;i++){t[0].fshr(1);s1[i]=2*t[0].parity()-1;t[4].fshr(1);s2[i]=2*t[4].parity()-1}for(i=0;i<nb;i++){w1[i]=0;k=1;for(j=1;j<4;j++){bt=s1[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w1[i]+=bt*k;k*=2}w2[i]=0;k=1;for(j=5;j<8;j++){bt=s2[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w2[i]+=bt*k;k*=2}}p.select(g1,2*w1[nb-1]+1);r.select(g2,2*w2[nb-1]+1);p.mul(r);for(i=nb-2;i>=0;i--){p.usqr();r.select(g1,2*w1[i]+s1[i]);p.mul(r);r.select(g2,2*w2[i]+s2[i]);p.mul(r)}r.copy(q[0]);r.conj();r.mul(p);p.cmove(r,pb1);r.copy(q[4]);r.conj();r.mul(p);p.cmove(r,pb2);p.reduce();return p};return FP24}function FP4(ctx){var FP4=function(c,d){if(c instanceof FP4){this.a=new ctx.FP2(c.a);this.b=new ctx.FP2(c.b)}else{this.a=new ctx.FP2(c);this.b=new ctx.FP2(d)}};FP4.prototype={reduce:function(){this.a.reduce();this.b.reduce()},norm:function(){this.a.norm();this.b.norm()},iszilch:function(){this.reduce();return this.a.iszilch()&&this.b.iszilch()},isunity:function(){var one=new ctx.FP2(1);return this.a.equals(one)&&this.b.iszilch()},cmove:function(g,d){this.a.cmove(g.a,d);this.b.cmove(g.b,d)},isreal:function(){return this.b.iszilch()},real:function(){return this.a},geta:function(){return this.a},getb:function(){return this.b},equals:function(x){return this.a.equals(x.a)&&this.b.equals(x.b)},copy:function(x){this.a.copy(x.a);this.b.copy(x.b)},zero:function(){this.a.zero();this.b.zero()},one:function(){this.a.one();this.b.zero()},set:function(c,d){this.a.copy(c);this.b.copy(d)},seta:function(c){this.a.copy(c);this.b.zero()},neg:function(){this.norm();var m=new ctx.FP2(this.a),t=new ctx.FP2(0);m.add(this.b);m.neg();t.copy(m);t.add(this.b);this.b.copy(m);this.b.add(this.a);this.a.copy(t);this.norm()},conj:function(){this.b.neg();this.norm()},nconj:function(){this.a.neg();this.norm()},add:function(x){this.a.add(x.a);this.b.add(x.b)},sub:function(x){var m=new FP4(x);m.neg();this.add(m)},rsub:function(x){this.neg();this.add(x)},pmul:function(s){this.a.mul(s);this.b.mul(s)},imul:function(c){this.a.imul(c);this.b.imul(c)},sqr:function(){var t1=new ctx.FP2(this.a),t2=new ctx.FP2(this.b),t3=new ctx.FP2(this.a);t3.mul(this.b);t1.add(this.b);t1.norm();t2.mul_ip();t2.add(this.a);t2.norm();this.a.copy(t1);this.a.mul(t2);t2.copy(t3);t2.mul_ip();t2.add(t3);t2.norm();t2.neg();this.a.add(t2);this.b.copy(t3);this.b.add(t3);this.norm()},mul:function(y){var t1=new ctx.FP2(this.a),t2=new ctx.FP2(this.b),t3=new ctx.FP2(0),t4=new ctx.FP2(this.b);t1.mul(y.a);t2.mul(y.b);t3.copy(y.b);t3.add(y.a);t4.add(this.a);t3.norm();t4.norm();t4.mul(t3);t3.copy(t1);t3.neg();t4.add(t3);t3.copy(t2);t3.neg();this.b.copy(t4);this.b.add(t3);t2.mul_ip();this.a.copy(t2);this.a.add(t1);this.norm()},toString:function(){return"["+this.a.toString()+","+this.b.toString()+"]"},inverse:function(){this.norm();var t1=new ctx.FP2(this.a),t2=new ctx.FP2(this.b);t1.sqr();t2.sqr();t2.mul_ip();t2.norm();t1.sub(t2);t1.inverse();this.a.mul(t1);t1.neg();t1.norm();this.b.mul(t1)},times_i:function(){var s=new ctx.FP2(this.b),t=new ctx.FP2(this.b);s.times_i();t.add(s);this.b.copy(this.a);this.a.copy(t);this.norm()},frob:function(f){this.a.conj();this.b.conj();this.b.mul(f)},pow:function(e){this.norm();e.norm();var w=new FP4(this),z=new ctx.BIG(e),r=new FP4(1),bt;for(;;){bt=z.parity();z.fshr(1);if(bt===1){r.mul(w)}if(z.iszilch()){break}w.sqr()}r.reduce();return r},xtr_A:function(w,y,z){var r=new FP4(w),t=new FP4(w);r.sub(y);r.norm();r.pmul(this.a);t.add(y);t.norm();t.pmul(this.b);t.times_i();this.copy(r);this.add(t);this.add(z);this.reduce()},xtr_D:function(){var w=new FP4(this);this.sqr();w.conj();w.add(w);this.sub(w);this.reduce()},xtr_pow:function(n){var a=new FP4(3),b=new FP4(this),c=new FP4(b),t=new FP4(0),r=new FP4(0),par,v,nb,i;c.xtr_D();n.norm();par=n.parity();v=new ctx.BIG(n);v.fshr(1);if(par===0){v.dec(1);v.norm()}nb=v.nbits();for(i=nb-1;i>=0;i--){if(v.bit(i)!=1){t.copy(b);this.conj();c.conj();b.xtr_A(a,this,c);this.conj();c.copy(t);c.xtr_D();a.xtr_D()}else{t.copy(a);t.conj();a.copy(b);a.xtr_D();b.xtr_A(c,this,t);c.xtr_D()}}if(par===0){r.copy(c)}else{r.copy(b)}r.reduce();return r},xtr_pow2:function(ck,ckml,ckm2l,a,b){a.norm();b.norm();var e=new ctx.BIG(a),d=new ctx.BIG(b),w=new ctx.BIG(0),cu=new FP4(ck),cv=new FP4(this),cumv=new FP4(ckml),cum2v=new FP4(ckm2l),r=new FP4(0),t=new FP4(0),f2=0,i;while(d.parity()===0&&e.parity()===0){d.fshr(1);e.fshr(1);f2++}while(ctx.BIG.comp(d,e)!==0){if(ctx.BIG.comp(d,e)>0){w.copy(e);w.imul(4);w.norm();if(ctx.BIG.comp(d,w)<=0){w.copy(d);d.copy(e);e.rsub(w);e.norm();t.copy(cv);t.xtr_A(cu,cumv,cum2v);cum2v.copy(cumv);cum2v.conj();cumv.copy(cv);cv.copy(cu);cu.copy(t)}else if(d.parity()===0){d.fshr(1);r.copy(cum2v);r.conj();t.copy(cumv);t.xtr_A(cu,cv,r);cum2v.copy(cumv);cum2v.xtr_D();cumv.copy(t);cu.xtr_D()}else if(e.parity()==1){d.sub(e);d.norm();d.fshr(1);t.copy(cv);t.xtr_A(cu,cumv,cum2v);cu.xtr_D();cum2v.copy(cv);cum2v.xtr_D();cum2v.conj();cv.copy(t)}else{w.copy(d);d.copy(e);d.fshr(1);e.copy(w);t.copy(cumv);t.xtr_D();cumv.copy(cum2v);cumv.conj();cum2v.copy(t);cum2v.conj();t.copy(cv);t.xtr_D();cv.copy(cu);cu.copy(t)}}if(ctx.BIG.comp(d,e)<0){w.copy(d);w.imul(4);w.norm();if(ctx.BIG.comp(e,w)<=0){e.sub(d);e.norm();t.copy(cv);t.xtr_A(cu,cumv,cum2v);cum2v.copy(cumv);cumv.copy(cu);cu.copy(t)}else if(e.parity()===0){w.copy(d);d.copy(e);d.fshr(1);e.copy(w);t.copy(cumv);t.xtr_D();cumv.copy(cum2v);cumv.conj();cum2v.copy(t);cum2v.conj();t.copy(cv);t.xtr_D();cv.copy(cu);cu.copy(t)}else if(d.parity()==1){w.copy(e);e.copy(d);w.sub(d);w.norm();d.copy(w);d.fshr(1);t.copy(cv);t.xtr_A(cu,cumv,cum2v);cumv.conj();cum2v.copy(cu);cum2v.xtr_D();cum2v.conj();cu.copy(cv);cu.xtr_D();cv.copy(t)}else{d.fshr(1);r.copy(cum2v);r.conj();t.copy(cumv);t.xtr_A(cu,cv,r);cum2v.copy(cumv);cum2v.xtr_D();cumv.copy(t);cu.xtr_D()}}}r.copy(cv);r.xtr_A(cu,cumv,cum2v);for(i=0;i<f2;i++){r.xtr_D()}r=r.xtr_pow(d);return r},div2:function(){this.a.div2();this.b.div2()},div_i:function(){var u=new ctx.FP2(this.a),v=new ctx.FP2(this.b);u.div_ip();this.a.copy(v);this.b.copy(u)},div_2i:function(){var u=new ctx.FP2(this.a),v=new ctx.FP2(this.b);u.div_ip2();v.add(v);v.norm();this.a.copy(v);this.b.copy(u)},qmul:function(s){this.a.pmul(s);this.b.pmul(s)},sqrt:function(){if(this.iszilch()){return true}var wa=new ctx.FP2(this.a),ws=new ctx.FP2(this.b),wt=new ctx.FP2(this.a);if(ws.iszilch()){if(wt.sqrt()){this.a.copy(wt);this.b.zero()}else{wt.div_ip();wt.sqrt();this.b.copy(wt);this.a.zero()}return true}ws.sqr();wa.sqr();ws.mul_ip();ws.norm();wa.sub(ws);ws.copy(wa);if(!ws.sqrt()){return false}wa.copy(wt);wa.add(ws);wa.norm();wa.div2();if(!wa.sqrt()){wa.copy(wt);wa.sub(ws);wa.norm();wa.div2();if(!wa.sqrt()){return false}}wt.copy(this.b);ws.copy(wa);ws.add(wa);ws.inverse();wt.mul(ws);this.a.copy(wa);this.b.copy(wt);return true}};return FP4}function FP48(ctx){var FP48=function(d,e,f){if(d instanceof FP48){this.a=new ctx.FP16(d.a);this.b=new ctx.FP16(d.b);this.c=new ctx.FP16(d.c)}else{this.a=new ctx.FP16(d);this.b=new ctx.FP16(e);this.c=new ctx.FP16(f)}};FP48.prototype={reduce:function(){this.a.reduce();this.b.reduce();this.c.reduce()},norm:function(){this.a.norm();this.b.norm();this.c.norm()},iszilch:function(){this.reduce();return this.a.iszilch()&&this.b.iszilch()&&this.c.iszilch()},isunity:function(){var one=new ctx.FP16(1);return this.a.equals(one)&&this.b.iszilch()&&this.c.iszilch()},cmove:function(g,d){this.a.cmove(g.a,d);this.b.cmove(g.b,d);this.c.cmove(g.c,d)},select:function(g,b){var invf=new FP48(0),m,babs;m=b>>31;babs=(b^m)-m;babs=(babs-1)/2;this.cmove(g[0],FP48.teq(babs,0));this.cmove(g[1],FP48.teq(babs,1));this.cmove(g[2],FP48.teq(babs,2));this.cmove(g[3],FP48.teq(babs,3));this.cmove(g[4],FP48.teq(babs,4));this.cmove(g[5],FP48.teq(babs,5));this.cmove(g[6],FP48.teq(babs,6));this.cmove(g[7],FP48.teq(babs,7));invf.copy(this);invf.conj();this.cmove(invf,m&1)},geta:function(){return this.a},getb:function(){return this.b},getc:function(){return this.c},equals:function(x){return this.a.equals(x.a)&&this.b.equals(x.b)&&this.c.equals(x.c)},copy:function(x){this.a.copy(x.a);this.b.copy(x.b);this.c.copy(x.c)},one:function(){this.a.one();this.b.zero();this.c.zero()},conj:function(){this.a.conj();this.b.nconj();this.c.conj()},set:function(d,e,f){this.a.copy(d);this.b.copy(e);this.c.copy(f)},seta:function(d){this.a.copy(d);this.b.zero();this.c.zero()},usqr:function(){var A=new ctx.FP16(this.a),B=new ctx.FP16(this.c),C=new ctx.FP16(this.b),D=new ctx.FP16(0);this.a.sqr();D.copy(this.a);D.add(this.a);this.a.add(D);A.nconj();A.add(A);this.a.add(A);B.sqr();B.times_i();D.copy(B);D.add(B);B.add(D);C.sqr();D.copy(C);D.add(C);C.add(D);this.b.conj();this.b.add(this.b);this.c.nconj();this.c.add(this.c);this.b.add(B);this.c.add(C);this.reduce()},sqr:function(){var A=new ctx.FP16(this.a),B=new ctx.FP16(this.b),C=new ctx.FP16(this.c),D=new ctx.FP16(this.a);A.sqr();B.mul(this.c);B.add(B);C.sqr();D.mul(this.b);D.add(D);this.c.add(this.a);this.c.add(this.b);this.c.norm();this.c.sqr();this.a.copy(A);A.add(B);A.add(C);A.add(D);A.neg();B.times_i();C.times_i();this.a.add(B);this.b.copy(C);this.b.add(D);this.c.add(A);this.norm()},mul:function(y){var z0=new ctx.FP16(this.a),z1=new ctx.FP16(0),z2=new ctx.FP16(this.b),z3=new ctx.FP16(0),t0=new ctx.FP16(this.a),t1=new ctx.FP16(y.a);z0.mul(y.a);z2.mul(y.b);t0.add(this.b);t1.add(y.b);t0.norm();t1.norm();z1.copy(t0);z1.mul(t1);t0.copy(this.b);t0.add(this.c);t1.copy(y.b);t1.add(y.c);t0.norm();t1.norm();z3.copy(t0);z3.mul(t1);t0.copy(z0);t0.neg();t1.copy(z2);t1.neg();z1.add(t0);this.b.copy(z1);this.b.add(t1);z3.add(t1);z2.add(t0);t0.copy(this.a);t0.add(this.c);t1.copy(y.a);t1.add(y.c);t0.norm();t1.norm();t0.mul(t1);z2.add(t0);t0.copy(this.c);t0.mul(y.c);t1.copy(t0);t1.neg();this.c.copy(z2);this.c.add(t1);z3.add(t1);t0.times_i();this.b.add(t0);z3.times_i();this.a.copy(z0);this.a.add(z3);this.norm()},smul:function(y,twist){var z0,z1,z2,z3,t0,t1;if(twist==ctx.ECP.D_TYPE){z0=new ctx.FP16(this.a),z2=new ctx.FP16(this.b),z3=new ctx.FP16(this.b),t0=new ctx.FP16(0),t1=new ctx.FP16(y.a);z0.mul(y.a);z2.pmul(y.b.real());this.b.add(this.a);t1.real().add(y.b.real());this.b.norm();t1.norm();this.b.mul(t1);z3.add(this.c);z3.norm();z3.pmul(y.b.real());t0.copy(z0);t0.neg();t1.copy(z2);t1.neg();this.b.add(t0);this.b.add(t1);z3.add(t1);z2.add(t0);t0.copy(this.a);t0.add(this.c);t0.norm();t0.mul(y.a);this.c.copy(z2);this.c.add(t0);z3.times_i();this.a.copy(z0);this.a.add(z3)}if(twist==ctx.ECP.M_TYPE){z0=new ctx.FP16(this.a);z1=new ctx.FP16(0);z2=new ctx.FP16(0);z3=new ctx.FP16(0);t0=new ctx.FP16(this.a);t1=new ctx.FP16(0);z0.mul(y.a);t0.add(this.b);t0.norm();z1.copy(t0);z1.mul(y.a);t0.copy(this.b);t0.add(this.c);t0.norm();z3.copy(t0);z3.pmul(y.c.getb());z3.times_i();t0.copy(z0);t0.neg();z1.add(t0);this.b.copy(z1);z2.copy(t0);t0.copy(this.a);t0.add(this.c);t1.copy(y.a);t1.add(y.c);t0.norm();t1.norm();t0.mul(t1);z2.add(t0);t0.copy(this.c);t0.pmul(y.c.getb());t0.times_i();t1.copy(t0);t1.neg();this.c.copy(z2);this.c.add(t1);z3.add(t1);t0.times_i();this.b.add(t0);z3.norm();z3.times_i();this.a.copy(z0);this.a.add(z3)}this.norm()},inverse:function(){var f0=new ctx.FP16(this.a),f1=new ctx.FP16(this.b),f2=new ctx.FP16(this.a),f3=new ctx.FP16(0);f0.sqr();f1.mul(this.c);f1.times_i();f0.sub(f1);f0.norm();f1.copy(this.c);f1.sqr();f1.times_i();f2.mul(this.b);f1.sub(f2);f1.norm();f2.copy(this.b);f2.sqr();f3.copy(this.a);f3.mul(this.c);f2.sub(f3);f2.norm();f3.copy(this.b);f3.mul(f2);f3.times_i();this.a.mul(f0);f3.add(this.a);this.c.mul(f1);this.c.times_i();f3.add(this.c);f3.norm();f3.inverse();this.a.copy(f0);this.a.mul(f3);this.b.copy(f1);this.b.mul(f3);this.c.copy(f2);this.c.mul(f3)},frob:function(f,n){var f2=new ctx.FP2(f),f3=new ctx.FP2(f),i;f2.sqr();f3.mul(f2);f3.mul_ip();f3.norm();f3.mul_ip();f3.norm();for(i=0;i<n;i++){this.a.frob(f3);this.b.frob(f3);this.c.frob(f3);this.b.qmul(f);this.b.times_i4();this.b.times_i2();this.c.qmul(f2);this.c.times_i4();this.c.times_i4();this.c.times_i4()}},trace:function(){var t=new ctx.FP16(0);t.copy(this.a);t.imul(3);t.reduce();return t},toString:function(){return"["+this.a.toString()+","+this.b.toString()+","+this.c.toString()+"]"},toBytes:function(w){var t=[],i;this.a.geta().geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i]=t[i]}this.a.geta().geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+ctx.BIG.MODBYTES]=t[i]}this.a.geta().geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+2*ctx.BIG.MODBYTES]=t[i]}this.a.geta().geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+3*ctx.BIG.MODBYTES]=t[i]}this.a.geta().getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+4*ctx.BIG.MODBYTES]=t[i]}this.a.geta().getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+5*ctx.BIG.MODBYTES]=t[i]}this.a.geta().getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+6*ctx.BIG.MODBYTES]=t[i]}this.a.geta().getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+7*ctx.BIG.MODBYTES]=t[i]}this.a.getb().geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+8*ctx.BIG.MODBYTES]=t[i]}this.a.getb().geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+9*ctx.BIG.MODBYTES]=t[i]}this.a.getb().geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+10*ctx.BIG.MODBYTES]=t[i]}this.a.getb().geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+11*ctx.BIG.MODBYTES]=t[i]}this.a.getb().getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+12*ctx.BIG.MODBYTES]=t[i]}this.a.getb().getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+13*ctx.BIG.MODBYTES]=t[i]}this.a.getb().getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+14*ctx.BIG.MODBYTES]=t[i]}this.a.getb().getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+15*ctx.BIG.MODBYTES]=t[i]}this.b.geta().geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+16*ctx.BIG.MODBYTES]=t[i]}this.b.geta().geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+17*ctx.BIG.MODBYTES]=t[i]}this.b.geta().geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+18*ctx.BIG.MODBYTES]=t[i]}this.b.geta().geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+19*ctx.BIG.MODBYTES]=t[i]}this.b.geta().getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+20*ctx.BIG.MODBYTES]=t[i]}this.b.geta().getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+21*ctx.BIG.MODBYTES]=t[i]}this.b.geta().getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+22*ctx.BIG.MODBYTES]=t[i]}this.b.geta().getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+23*ctx.BIG.MODBYTES]=t[i]}this.b.getb().geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+24*ctx.BIG.MODBYTES]=t[i]}this.b.getb().geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+25*ctx.BIG.MODBYTES]=t[i]}this.b.getb().geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+26*ctx.BIG.MODBYTES]=t[i]}this.b.getb().geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+27*ctx.BIG.MODBYTES]=t[i]}this.b.getb().getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+28*ctx.BIG.MODBYTES]=t[i]}this.b.getb().getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+29*ctx.BIG.MODBYTES]=t[i]}this.b.getb().getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+30*ctx.BIG.MODBYTES]=t[i]}this.b.getb().getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+31*ctx.BIG.MODBYTES]=t[i]}this.c.geta().geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+32*ctx.BIG.MODBYTES]=t[i]}this.c.geta().geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+33*ctx.BIG.MODBYTES]=t[i]}this.c.geta().geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+34*ctx.BIG.MODBYTES]=t[i]}this.c.geta().geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+35*ctx.BIG.MODBYTES]=t[i]}this.c.geta().getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+36*ctx.BIG.MODBYTES]=t[i]}this.c.geta().getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+37*ctx.BIG.MODBYTES]=t[i]}this.c.geta().getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+38*ctx.BIG.MODBYTES]=t[i]}this.c.geta().getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+39*ctx.BIG.MODBYTES]=t[i]}this.c.getb().geta().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+40*ctx.BIG.MODBYTES]=t[i]}this.c.getb().geta().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+41*ctx.BIG.MODBYTES]=t[i]}this.c.getb().geta().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+42*ctx.BIG.MODBYTES]=t[i]}this.c.getb().geta().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+43*ctx.BIG.MODBYTES]=t[i]}this.c.getb().getb().geta().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+44*ctx.BIG.MODBYTES]=t[i]}this.c.getb().getb().geta().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+45*ctx.BIG.MODBYTES]=t[i]}this.c.getb().getb().getb().getA().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+46*ctx.BIG.MODBYTES]=t[i]}this.c.getb().getb().getb().getB().toBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){w[i+47*ctx.BIG.MODBYTES]=t[i]}},pow:function(e){var e3,w,nb,i,bt;this.norm();e.norm();e3=new ctx.BIG(e);e3.pmul(3);e3.norm();w=new FP48(this);nb=e3.nbits();for(i=nb-2;i>=1;i--){w.usqr();bt=e3.bit(i)-e.bit(i);if(bt==1){w.mul(this)}if(bt==-1){this.conj();w.mul(this);this.conj()}}w.reduce();return w},pinpow:function(e,bts){var R=[],i,b;R[0]=new FP48(1);R[1]=new FP48(this);for(i=bts-1;i>=0;i--){b=e>>i&1;R[1-b].mul(R[b]);R[b].usqr()}this.copy(R[0])},compow:function(e,r){var fa,fb,f,q,m,a,b,g1,g2,c,cp,cpm1,cpm2;fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);q=new ctx.BIG(0);q.rcopy(ctx.ROM_FIELD.Modulus);m=new ctx.BIG(q);m.mod(r);a=new ctx.BIG(e);a.mod(m);b=new ctx.BIG(e);b.div(m);g1=new FP48(0);g2=new FP48(0);g1.copy(this);c=g1.trace();if(b.iszilch()){c=c.xtr_pow(e);return c}g2.copy(g1);g2.frob(f,1);cp=g2.trace();g1.conj();g2.mul(g1);cpm1=g2.trace();g2.mul(g1);cpm2=g2.trace();c=c.xtr_pow2(cp,cpm1,cpm2,a,b);return c}};FP48.fromBytes=function(w){var t=[],i,a,b,c,d,e,f,g,r,ea,eb,fa,fb;for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+2*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+3*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);ea=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+4*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+5*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+6*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+7*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);eb=new ctx.FP4(c,d);fa=new ctx.FP8(ea,eb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+8*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+9*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+10*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+11*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);ea=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+12*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+13*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+14*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+15*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);eb=new ctx.FP4(c,d);fb=new ctx.FP8(ea,eb);e=new ctx.FP16(fa,fb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+16*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+17*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+18*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+19*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);ea=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+20*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+21*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+22*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+23*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);eb=new ctx.FP4(c,d);fa=new ctx.FP8(ea,eb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+24*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+25*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+26*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+27*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);ea=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+28*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+29*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+30*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+31*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);eb=new ctx.FP4(c,d);fb=new ctx.FP8(ea,eb);f=new ctx.FP16(fa,fb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+32*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+33*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+34*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+35*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);ea=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+36*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+37*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+38*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+39*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);eb=new ctx.FP4(c,d);fa=new ctx.FP8(ea,eb);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+40*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+41*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+42*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+43*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);ea=new ctx.FP4(c,d);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+44*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+45*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);c=new ctx.FP2(a,b);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+46*ctx.BIG.MODBYTES]}a=ctx.BIG.fromBytes(t);for(i=0;i<ctx.BIG.MODBYTES;i++){t[i]=w[i+47*ctx.BIG.MODBYTES]}b=ctx.BIG.fromBytes(t);d=new ctx.FP2(a,b);eb=new ctx.FP4(c,d);fb=new ctx.FP8(ea,eb);g=new ctx.FP16(fa,fb);r=new FP48(e,f,g);return r};FP48.teq=function(b,c){var x=b^c;x-=1;return x>>31&1};FP48.pow16=function(q,u){var g1=[],g2=[],g3=[],g4=[],r=new FP48(0),p=new FP48(0),t=[],mt=new ctx.BIG(0),fa=new ctx.BIG(0),fb=new ctx.BIG(0),w1=[],s1=[],w2=[],s2=[],w3=[],s3=[],w4=[],s4=[],i,j,k,nb,bt,pb1,pb2,pb3,pb4,f;for(i=0;i<16;i++){t[i]=new ctx.BIG(u[i]);t[i].norm()}g1[0]=new FP48(q[0]);g1[1]=new FP48(g1[0]);g1[1].mul(q[1]);g1[2]=new FP48(g1[0]);g1[2].mul(q[2]);g1[3]=new FP48(g1[1]);g1[3].mul(q[2]);g1[4]=new FP48(q[0]);g1[4].mul(q[3]);g1[5]=new FP48(g1[1]);g1[5].mul(q[3]);g1[6]=new FP48(g1[2]);g1[6].mul(q[3]);g1[7]=new FP48(g1[3]);g1[7].mul(q[3]);fa.rcopy(ctx.ROM_FIELD.Fra);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);for(i=0;i<8;i++){g2[i]=new FP48(g1[i]);g2[i].frob(f,4);g3[i]=new FP48(g2[i]);g3[i].frob(f,4);g4[i]=new FP48(g3[i]);g4[i].frob(f,4)}pb1=1-t[0].parity();t[0].inc(pb1);t[0].norm();pb2=1-t[4].parity();t[4].inc(pb2);t[4].norm();pb3=1-t[8].parity();t[8].inc(pb3);t[8].norm();pb4=1-t[12].parity();t[12].inc(pb4);t[12].norm();mt.zero();for(i=0;i<16;i++){mt.or(t[i])}nb=1+mt.nbits();s1[nb-1]=1;s2[nb-1]=1;s3[nb-1]=1;s4[nb-1]=1;for(i=0;i<nb-1;i++){t[0].fshr(1);s1[i]=2*t[0].parity()-1;t[4].fshr(1);s2[i]=2*t[4].parity()-1;t[8].fshr(1);s3[i]=2*t[8].parity()-1;t[12].fshr(1);s4[i]=2*t[12].parity()-1}for(i=0;i<nb;i++){w1[i]=0;k=1;for(j=1;j<4;j++){bt=s1[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w1[i]+=bt*k;k*=2}w2[i]=0;k=1;for(j=5;j<8;j++){bt=s2[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w2[i]+=bt*k;k*=2}w3[i]=0;k=1;for(j=9;j<12;j++){bt=s3[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w3[i]+=bt*k;k*=2}w4[i]=0;k=1;for(j=13;j<16;j++){bt=s4[i]*t[j].parity();t[j].fshr(1);t[j].dec(bt>>1);t[j].norm();w4[i]+=bt*k;k*=2}}p.select(g1,2*w1[nb-1]+1);r.select(g2,2*w2[nb-1]+1);p.mul(r);r.select(g3,2*w3[nb-1]+1);p.mul(r);r.select(g4,2*w4[nb-1]+1);p.mul(r);for(i=nb-2;i>=0;i--){p.usqr();r.select(g1,2*w1[i]+s1[i]);p.mul(r);r.select(g2,2*w2[i]+s2[i]);p.mul(r);r.select(g3,2*w3[i]+s3[i]);p.mul(r);r.select(g4,2*w4[i]+s4[i]);p.mul(r)}r.copy(q[0]);r.conj();r.mul(p);p.cmove(r,pb1);r.copy(q[4]);r.conj();r.mul(p);p.cmove(r,pb2);r.copy(q[8]);r.conj();r.mul(p);p.cmove(r,pb3);r.copy(q[12]);r.conj();r.mul(p);p.cmove(r,pb4);p.reduce();return p};return FP48}function FP8(ctx){var FP8=function(c,d){if(c instanceof FP8){this.a=new ctx.FP4(c.a);this.b=new ctx.FP4(c.b)}else{this.a=new ctx.FP4(c);this.b=new ctx.FP4(d)}};FP8.prototype={reduce:function(){this.a.reduce();this.b.reduce()},norm:function(){this.a.norm();this.b.norm()},iszilch:function(){this.reduce();return this.a.iszilch()&&this.b.iszilch()},isunity:function(){var one=new ctx.FP4(1);return this.a.equals(one)&&this.b.iszilch()},cmove:function(g,d){this.a.cmove(g.a,d);this.b.cmove(g.b,d)},isreal:function(){return this.b.iszilch()},real:function(){return this.a},geta:function(){return this.a},getb:function(){return this.b},equals:function(x){return this.a.equals(x.a)&&this.b.equals(x.b)},copy:function(x){this.a.copy(x.a);this.b.copy(x.b)},zero:function(){this.a.zero();this.b.zero()},one:function(){this.a.one();this.b.zero()},set:function(c,d){this.a.copy(c);this.b.copy(d)},seta:function(c){this.a.copy(c);this.b.zero()},neg:function(){this.norm();var m=new ctx.FP4(this.a),t=new ctx.FP4(0);m.add(this.b);m.neg();t.copy(m);t.add(this.b);this.b.copy(m);this.b.add(this.a);this.a.copy(t);this.norm()},conj:function(){this.b.neg();this.norm()},nconj:function(){this.a.neg();this.norm()},add:function(x){this.a.add(x.a);this.b.add(x.b)},sub:function(x){var m=new FP8(x);m.neg();this.add(m)},rsub:function(x){this.neg();this.add(x)},pmul:function(s){this.a.mul(s);this.b.mul(s)},imul:function(c){this.a.imul(c);this.b.imul(c)},sqr:function(){var t1=new ctx.FP4(this.a),t2=new ctx.FP4(this.b),t3=new ctx.FP4(this.a);t3.mul(this.b);t1.add(this.b);t1.norm();t2.times_i();t2.add(this.a);t2.norm();this.a.copy(t1);this.a.mul(t2);t2.copy(t3);t2.times_i();t2.add(t3);t2.neg();this.a.add(t2);this.b.copy(t3);this.b.add(t3);this.norm()},mul:function(y){var t1=new ctx.FP4(this.a),t2=new ctx.FP4(this.b),t3=new ctx.FP4(0),t4=new ctx.FP4(this.b);t1.mul(y.a);t2.mul(y.b);t3.copy(y.b);t3.add(y.a);t4.add(this.a);t3.norm();t4.norm();t4.mul(t3);t3.copy(t1);t3.neg();t4.add(t3);t3.copy(t2);t3.neg();this.b.copy(t4);this.b.add(t3);t2.times_i();this.a.copy(t2);this.a.add(t1);this.norm()},toString:function(){return"["+this.a.toString()+","+this.b.toString()+"]"},inverse:function(){this.norm();var t1=new ctx.FP4(this.a),t2=new ctx.FP4(this.b);t1.sqr();t2.sqr();t2.times_i();t2.norm();t1.sub(t2);t1.inverse();this.a.mul(t1);t1.neg();t1.norm();this.b.mul(t1)},times_i:function(){var s=new ctx.FP4(this.b),t=new ctx.FP4(this.a);s.times_i();this.b.copy(t);this.a.copy(s);this.norm()},times_i2:function(){this.a.times_i();this.b.times_i()},frob:function(f){var ff=new ctx.FP2(f);ff.sqr();ff.mul_ip();ff.norm();this.a.frob(ff);this.b.frob(ff);this.b.pmul(f);this.b.times_i()},pow:function(e){this.norm();e.norm();var w=new FP8(this),z=new ctx.BIG(e),r=new FP8(1),bt;for(;;){bt=z.parity();z.fshr(1);if(bt===1){r.mul(w)}if(z.iszilch()){break}w.sqr()}r.reduce();return r},xtr_A:function(w,y,z){var r=new FP8(w),t=new FP8(w);r.sub(y);r.norm();r.pmul(this.a);t.add(y);t.norm();t.pmul(this.b);t.times_i();this.copy(r);this.add(t);this.add(z);this.reduce()},xtr_D:function(){var w=new FP8(this);this.sqr();w.conj();w.add(w);this.sub(w);this.reduce()},xtr_pow:function(n){var a=new FP8(3),b=new FP8(this),c=new FP8(b),t=new FP8(0),r=new FP8(0),par,v,nb,i;c.xtr_D();n.norm();par=n.parity();v=new ctx.BIG(n);v.fshr(1);if(par===0){v.dec(1);v.norm()}nb=v.nbits();for(i=nb-1;i>=0;i--){if(v.bit(i)!=1){t.copy(b);this.conj();c.conj();b.xtr_A(a,this,c);this.conj();c.copy(t);c.xtr_D();a.xtr_D()}else{t.copy(a);t.conj();a.copy(b);a.xtr_D();b.xtr_A(c,this,t);c.xtr_D()}}
if(par===0){r.copy(c)}else{r.copy(b)}r.reduce();return r},xtr_pow2:function(ck,ckml,ckm2l,a,b){a.norm();b.norm();var e=new ctx.BIG(a),d=new ctx.BIG(b),w=new ctx.BIG(0),cu=new FP8(ck),cv=new FP8(this),cumv=new FP8(ckml),cum2v=new FP8(ckm2l),r=new FP8(0),t=new FP8(0),f2=0,i;while(d.parity()===0&&e.parity()===0){d.fshr(1);e.fshr(1);f2++}while(ctx.BIG.comp(d,e)!==0){if(ctx.BIG.comp(d,e)>0){w.copy(e);w.imul(4);w.norm();if(ctx.BIG.comp(d,w)<=0){w.copy(d);d.copy(e);e.rsub(w);e.norm();t.copy(cv);t.xtr_A(cu,cumv,cum2v);cum2v.copy(cumv);cum2v.conj();cumv.copy(cv);cv.copy(cu);cu.copy(t)}else if(d.parity()===0){d.fshr(1);r.copy(cum2v);r.conj();t.copy(cumv);t.xtr_A(cu,cv,r);cum2v.copy(cumv);cum2v.xtr_D();cumv.copy(t);cu.xtr_D()}else if(e.parity()==1){d.sub(e);d.norm();d.fshr(1);t.copy(cv);t.xtr_A(cu,cumv,cum2v);cu.xtr_D();cum2v.copy(cv);cum2v.xtr_D();cum2v.conj();cv.copy(t)}else{w.copy(d);d.copy(e);d.fshr(1);e.copy(w);t.copy(cumv);t.xtr_D();cumv.copy(cum2v);cumv.conj();cum2v.copy(t);cum2v.conj();t.copy(cv);t.xtr_D();cv.copy(cu);cu.copy(t)}}if(ctx.BIG.comp(d,e)<0){w.copy(d);w.imul(4);w.norm();if(ctx.BIG.comp(e,w)<=0){e.sub(d);e.norm();t.copy(cv);t.xtr_A(cu,cumv,cum2v);cum2v.copy(cumv);cumv.copy(cu);cu.copy(t)}else if(e.parity()===0){w.copy(d);d.copy(e);d.fshr(1);e.copy(w);t.copy(cumv);t.xtr_D();cumv.copy(cum2v);cumv.conj();cum2v.copy(t);cum2v.conj();t.copy(cv);t.xtr_D();cv.copy(cu);cu.copy(t)}else if(d.parity()==1){w.copy(e);e.copy(d);w.sub(d);w.norm();d.copy(w);d.fshr(1);t.copy(cv);t.xtr_A(cu,cumv,cum2v);cumv.conj();cum2v.copy(cu);cum2v.xtr_D();cum2v.conj();cu.copy(cv);cu.xtr_D();cv.copy(t)}else{d.fshr(1);r.copy(cum2v);r.conj();t.copy(cumv);t.xtr_A(cu,cv,r);cum2v.copy(cumv);cum2v.xtr_D();cumv.copy(t);cu.xtr_D()}}}r.copy(cv);r.xtr_A(cu,cumv,cum2v);for(i=0;i<f2;i++){r.xtr_D()}r=r.xtr_pow(d);return r},div2:function(){this.a.div2();this.b.div2()},div_i:function(){var u=new ctx.FP4(this.a),v=new ctx.FP4(this.b);u.div_i();this.a.copy(v);this.b.copy(u)},div_i2:function(){this.a.div_i();this.b.div_i()},div_2i:function(){var u=new ctx.FP4(this.a),v=new ctx.FP4(this.b);u.div_2i();v.add(v);v.norm();this.a.copy(v);this.b.copy(u)},qmul:function(s){this.a.pmul(s);this.b.pmul(s)},tmul:function(s){this.a.qmul(s);this.b.qmul(s)},sqrt:function(){if(this.iszilch()){return true}var wa=new ctx.FP4(this.a),ws=new ctx.FP4(this.b),wt=new ctx.FP4(this.a);if(ws.iszilch()){if(wt.sqrt()){this.a.copy(wt);this.b.zero()}else{wt.div_i();wt.sqrt();this.b.copy(wt);this.a.zero()}return true}ws.sqr();wa.sqr();ws.times_i();ws.norm();wa.sub(ws);ws.copy(wa);if(!ws.sqrt()){return false}wa.copy(wt);wa.add(ws);wa.norm();wa.div2();if(!wa.sqrt()){wa.copy(wt);wa.sub(ws);wa.norm();wa.div2();if(!wa.sqrt()){return false}}wt.copy(this.b);ws.copy(wa);ws.add(wa);ws.inverse();wt.mul(ws);this.a.copy(wa);this.b.copy(wt);return true}};return FP8}function GCM(ctx){var GCM=function(){this.table=new Array(128);for(var i=0;i<128;i++){this.table[i]=new Array(4)}this.stateX=[];this.Y_0=[];this.counter=0;this.lenA=[];this.lenC=[];this.status=0;this.a=new ctx.AES};GCM.ACCEPTING_HEADER=0;GCM.ACCEPTING_CIPHER=1;GCM.NOT_ACCEPTING_MORE=2;GCM.FINISHED=3;GCM.ENCRYPTING=0;GCM.DECRYPTING=1;GCM.prototype={precompute:function(H){var b=[],i,j,c;for(i=j=0;i<4;i++,j+=4){b[0]=H[j];b[1]=H[j+1];b[2]=H[j+2];b[3]=H[j+3];this.table[0][i]=GCM.pack(b)}for(i=1;i<128;i++){c=0;for(j=0;j<4;j++){this.table[i][j]=c|this.table[i-1][j]>>>1;c=this.table[i-1][j]<<31}if(c!==0){this.table[i][0]^=3774873600}}},gf2mul:function(){var P=[],b=[],i,j,m,k,c;P[0]=P[1]=P[2]=P[3]=0;j=8;m=0;for(i=0;i<128;i++){c=this.stateX[m]>>>--j&1;c=~c+1;for(k=0;k<4;k++){P[k]^=this.table[i][k]&c}if(j===0){j=8;m++;if(m==16){break}}}for(i=j=0;i<4;i++,j+=4){b=GCM.unpack(P[i]);this.stateX[j]=b[0];this.stateX[j+1]=b[1];this.stateX[j+2]=b[2];this.stateX[j+3]=b[3]}},wrap:function(){var F=[],L=[],b=[],i,j;F[0]=this.lenA[0]<<3|(this.lenA[1]&3758096384)>>>29;F[1]=this.lenA[1]<<3;F[2]=this.lenC[0]<<3|(this.lenC[1]&3758096384)>>>29;F[3]=this.lenC[1]<<3;for(i=j=0;i<4;i++,j+=4){b=GCM.unpack(F[i]);L[j]=b[0];L[j+1]=b[1];L[j+2]=b[2];L[j+3]=b[3]}for(i=0;i<16;i++){this.stateX[i]^=L[i]}this.gf2mul()},init:function(nk,key,niv,iv){var H=[],b=[],i;for(i=0;i<16;i++){H[i]=0;this.stateX[i]=0}this.a.init(ctx.AES.ECB,nk,key,iv);this.a.ecb_encrypt(H);this.precompute(H);this.lenA[0]=this.lenC[0]=this.lenA[1]=this.lenC[1]=0;if(niv==12){for(i=0;i<12;i++){this.a.f[i]=iv[i]}b=GCM.unpack(1);this.a.f[12]=b[0];this.a.f[13]=b[1];this.a.f[14]=b[2];this.a.f[15]=b[3];for(i=0;i<16;i++){this.Y_0[i]=this.a.f[i]}}else{this.status=GCM.ACCEPTING_CIPHER;this.ghash(iv,niv);this.wrap();for(i=0;i<16;i++){this.a.f[i]=this.stateX[i];this.Y_0[i]=this.a.f[i];this.stateX[i]=0}this.lenA[0]=this.lenC[0]=this.lenA[1]=this.lenC[1]=0}this.status=GCM.ACCEPTING_HEADER},add_header:function(header,len){var i,j=0;if(this.status!=GCM.ACCEPTING_HEADER){return false}while(j<len){for(i=0;i<16&&j<len;i++){this.stateX[i]^=header[j++];this.lenA[1]++;this.lenA[1]|=0;if(this.lenA[1]===0){this.lenA[0]++}}this.gf2mul()}if(len%16!==0){this.status=GCM.ACCEPTING_CIPHER}return true},ghash:function(plain,len){var i,j=0;if(this.status==GCM.ACCEPTING_HEADER){this.status=GCM.ACCEPTING_CIPHER}if(this.status!=GCM.ACCEPTING_CIPHER){return false}while(j<len){for(i=0;i<16&&j<len;i++){this.stateX[i]^=plain[j++];this.lenC[1]++;this.lenC[1]|=0;if(this.lenC[1]===0){this.lenC[0]++}}this.gf2mul()}if(len%16!==0){this.status=GCM.NOT_ACCEPTING_MORE}return true},add_plain:function(plain,len){var B=[],b=[],cipher=[],i,j=0;if(this.status==GCM.ACCEPTING_HEADER){this.status=GCM.ACCEPTING_CIPHER}if(this.status!=GCM.ACCEPTING_CIPHER){return cipher}while(j<len){b[0]=this.a.f[12];b[1]=this.a.f[13];b[2]=this.a.f[14];b[3]=this.a.f[15];this.counter=GCM.pack(b);this.counter++;b=GCM.unpack(this.counter);this.a.f[12]=b[0];this.a.f[13]=b[1];this.a.f[14]=b[2];this.a.f[15]=b[3];for(i=0;i<16;i++){B[i]=this.a.f[i]}this.a.ecb_encrypt(B);for(i=0;i<16&&j<len;i++){cipher[j]=plain[j]^B[i];this.stateX[i]^=cipher[j++];this.lenC[1]++;this.lenC[1]|=0;if(this.lenC[1]===0){this.lenC[0]++}}this.gf2mul()}if(len%16!==0){this.status=GCM.NOT_ACCEPTING_MORE}return cipher},add_cipher:function(cipher,len){var B=[],b=[],plain=[],j=0,i,oc;if(this.status==GCM.ACCEPTING_HEADER){this.status=GCM.ACCEPTING_CIPHER}if(this.status!=GCM.ACCEPTING_CIPHER){return plain}while(j<len){b[0]=this.a.f[12];b[1]=this.a.f[13];b[2]=this.a.f[14];b[3]=this.a.f[15];this.counter=GCM.pack(b);this.counter++;b=GCM.unpack(this.counter);this.a.f[12]=b[0];this.a.f[13]=b[1];this.a.f[14]=b[2];this.a.f[15]=b[3];for(i=0;i<16;i++){B[i]=this.a.f[i]}this.a.ecb_encrypt(B);for(i=0;i<16&&j<len;i++){oc=cipher[j];plain[j]=cipher[j]^B[i];this.stateX[i]^=oc;j++;this.lenC[1]++;this.lenC[1]|=0;if(this.lenC[1]===0){this.lenC[0]++}}this.gf2mul()}if(len%16!==0){this.status=GCM.NOT_ACCEPTING_MORE}return plain},finish:function(extract){var tag=[],i;this.wrap();if(extract){this.a.ecb_encrypt(this.Y_0);for(i=0;i<16;i++){this.Y_0[i]^=this.stateX[i]}for(i=0;i<16;i++){tag[i]=this.Y_0[i];this.Y_0[i]=this.stateX[i]=0}}this.status=GCM.FINISHED;this.a.end();return tag}};GCM.pack=function(b){return(b[0]&255)<<24|(b[1]&255)<<16|(b[2]&255)<<8|b[3]&255};GCM.unpack=function(a){var b=[];b[3]=a&255;b[2]=a>>>8&255;b[1]=a>>>16&255;b[0]=a>>>24&255;return b};GCM.hex2bytes=function(s){var len=s.length,data=[],i;for(i=0;i<len;i+=2){data[i/2]=parseInt(s.substr(i,2),16)}return data};return GCM}function HASH256(){var HASH256=function(){this.length=[];this.h=[];this.w=[];this.init()};HASH256.prototype={transform:function(){var a,b,c,d,e,f,g,hh,t1,t2,j;for(j=16;j<64;j++){this.w[j]=HASH256.theta1(this.w[j-2])+this.w[j-7]+HASH256.theta0(this.w[j-15])+this.w[j-16]|0}a=this.h[0];b=this.h[1];c=this.h[2];d=this.h[3];e=this.h[4];f=this.h[5];g=this.h[6];hh=this.h[7];for(j=0;j<64;j++){t1=hh+HASH256.Sig1(e)+HASH256.Ch(e,f,g)+HASH256.HK[j]+this.w[j]|0;t2=HASH256.Sig0(a)+HASH256.Maj(a,b,c)|0;hh=g;g=f;f=e;e=d+t1|0;d=c;c=b;b=a;a=t1+t2|0}this.h[0]+=a;this.h[1]+=b;this.h[2]+=c;this.h[3]+=d;this.h[4]+=e;this.h[5]+=f;this.h[6]+=g;this.h[7]+=hh},init:function(){var i;for(i=0;i<64;i++){this.w[i]=0}this.length[0]=this.length[1]=0;this.h[0]=HASH256.H[0];this.h[1]=HASH256.H[1];this.h[2]=HASH256.H[2];this.h[3]=HASH256.H[3];this.h[4]=HASH256.H[4];this.h[5]=HASH256.H[5];this.h[6]=HASH256.H[6];this.h[7]=HASH256.H[7]},process:function(byt){var cnt;cnt=(this.length[0]>>>5)%16;this.w[cnt]<<=8;this.w[cnt]|=byt&255;this.length[0]+=8;if((this.length[0]&4294967295)===0){this.length[1]++;this.length[0]=0}if(this.length[0]%512===0){this.transform()}},process_array:function(b){for(var i=0;i<b.length;i++){this.process(b[i])}},process_num:function(n){this.process(n>>24&255);this.process(n>>16&255);this.process(n>>8&255);this.process(n&255)},hash:function(){var digest=[],len0,len1,i;len0=this.length[0];len1=this.length[1];this.process(128);while(this.length[0]%512!=448){this.process(0)}this.w[14]=len1;this.w[15]=len0;this.transform();for(i=0;i<HASH256.len;i++){digest[i]=this.h[i>>>2]>>8*(3-i%4)&255}this.init();return digest}};HASH256.S=function(n,x){return x>>>n|x<<32-n};HASH256.R=function(n,x){return x>>>n};HASH256.Ch=function(x,y,z){return x&y^~x&z};HASH256.Maj=function(x,y,z){return x&y^x&z^y&z};HASH256.Sig0=function(x){return HASH256.S(2,x)^HASH256.S(13,x)^HASH256.S(22,x)};HASH256.Sig1=function(x){return HASH256.S(6,x)^HASH256.S(11,x)^HASH256.S(25,x)};HASH256.theta0=function(x){return HASH256.S(7,x)^HASH256.S(18,x)^HASH256.R(3,x)};HASH256.theta1=function(x){return HASH256.S(17,x)^HASH256.S(19,x)^HASH256.R(10,x)};HASH256.len=32;HASH256.H=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];HASH256.HK=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];return HASH256}function HASH384(ctx){var HASH384=function(){this.length=[];this.h=[];this.w=[];this.init()};HASH384.prototype={transform:function(){var a,b,c,d,e,f,g,hh,t1,t2,j;for(j=16;j<80;j++){this.w[j]=HASH384.theta1(this.w[j-2]).add(this.w[j-7]).add(HASH384.theta0(this.w[j-15])).add(this.w[j-16])}a=this.h[0].copy();b=this.h[1].copy();c=this.h[2].copy();d=this.h[3].copy();e=this.h[4].copy();f=this.h[5].copy();g=this.h[6].copy();hh=this.h[7].copy();for(j=0;j<80;j++){t1=hh.copy();t1.add(HASH384.Sig1(e)).add(HASH384.Ch(e,f,g)).add(HASH384.HK[j]).add(this.w[j]);t2=HASH384.Sig0(a);t2.add(HASH384.Maj(a,b,c));hh=g;g=f;f=e;e=d.copy();e.add(t1);d=c;c=b;b=a;a=t1.copy();a.add(t2)}this.h[0].add(a);this.h[1].add(b);this.h[2].add(c);this.h[3].add(d);this.h[4].add(e);this.h[5].add(f);this.h[6].add(g);this.h[7].add(hh)},init:function(){var i;for(i=0;i<80;i++){this.w[i]=new ctx.UInt64(0,0)}this.length[0]=new ctx.UInt64(0,0);this.length[1]=new ctx.UInt64(0,0);this.h[0]=HASH384.H[0].copy();this.h[1]=HASH384.H[1].copy();this.h[2]=HASH384.H[2].copy();this.h[3]=HASH384.H[3].copy();this.h[4]=HASH384.H[4].copy();this.h[5]=HASH384.H[5].copy();this.h[6]=HASH384.H[6].copy();this.h[7]=HASH384.H[7].copy()},process:function(byt){var cnt,e;cnt=(this.length[0].bot>>>6)%16;this.w[cnt].shlb();this.w[cnt].bot|=byt&255;e=new ctx.UInt64(0,8);this.length[0].add(e);if(this.length[0].top===0&&this.length[0].bot==0){e=new ctx.UInt64(0,1);this.length[1].add(e)}if(this.length[0].bot%1024===0){this.transform()}},process_array:function(b){for(var i=0;i<b.length;i++){this.process(b[i])}},process_num:function(n){this.process(n>>24&255);this.process(n>>16&255);this.process(n>>8&255);this.process(n&255)},hash:function(){var digest=[],len0,len1,i;len0=this.length[0].copy();len1=this.length[1].copy();this.process(128);while(this.length[0].bot%1024!=896){this.process(0)}this.w[14]=len1;this.w[15]=len0;this.transform();for(i=0;i<HASH384.len;i++){digest[i]=HASH384.R(8*(7-i%8),this.h[i>>>3]).bot&255}this.init();return digest}};HASH384.S=function(n,x){if(n==0){return x}if(n<32){return new ctx.UInt64(x.top>>>n|x.bot<<32-n,x.bot>>>n|x.top<<32-n)}else{return new ctx.UInt64(x.bot>>>n-32|x.top<<64-n,x.top>>>n-32|x.bot<<64-n)}};HASH384.R=function(n,x){if(n==0){return x}if(n<32){return new ctx.UInt64(x.top>>>n,x.bot>>>n|x.top<<32-n)}else{return new ctx.UInt64(0,x.top>>>n-32)}};HASH384.Ch=function(x,y,z){return new ctx.UInt64(x.top&y.top^~x.top&z.top,x.bot&y.bot^~x.bot&z.bot)};HASH384.Maj=function(x,y,z){return new ctx.UInt64(x.top&y.top^x.top&z.top^y.top&z.top,x.bot&y.bot^x.bot&z.bot^y.bot&z.bot)};HASH384.Sig0=function(x){var r1=HASH384.S(28,x),r2=HASH384.S(34,x),r3=HASH384.S(39,x);return new ctx.UInt64(r1.top^r2.top^r3.top,r1.bot^r2.bot^r3.bot)};HASH384.Sig1=function(x){var r1=HASH384.S(14,x),r2=HASH384.S(18,x),r3=HASH384.S(41,x);return new ctx.UInt64(r1.top^r2.top^r3.top,r1.bot^r2.bot^r3.bot)};HASH384.theta0=function(x){var r1=HASH384.S(1,x),r2=HASH384.S(8,x),r3=HASH384.R(7,x);return new ctx.UInt64(r1.top^r2.top^r3.top,r1.bot^r2.bot^r3.bot)};HASH384.theta1=function(x){var r1=HASH384.S(19,x),r2=HASH384.S(61,x),r3=HASH384.R(6,x);return new ctx.UInt64(r1.top^r2.top^r3.top,r1.bot^r2.bot^r3.bot)};HASH384.len=48;HASH384.H=[new ctx.UInt64(3418070365,3238371032),new ctx.UInt64(1654270250,914150663),new ctx.UInt64(2438529370,812702999),new ctx.UInt64(355462360,4144912697),new ctx.UInt64(1731405415,4290775857),new ctx.UInt64(2394180231,1750603025),new ctx.UInt64(3675008525,1694076839),new ctx.UInt64(1203062813,3204075428)];HASH384.HK=[new ctx.UInt64(1116352408,3609767458),new ctx.UInt64(1899447441,602891725),new ctx.UInt64(3049323471,3964484399),new ctx.UInt64(3921009573,2173295548),new ctx.UInt64(961987163,4081628472),new ctx.UInt64(1508970993,3053834265),new ctx.UInt64(2453635748,2937671579),new ctx.UInt64(2870763221,3664609560),new ctx.UInt64(3624381080,2734883394),new ctx.UInt64(310598401,1164996542),new ctx.UInt64(607225278,1323610764),new ctx.UInt64(1426881987,3590304994),new ctx.UInt64(1925078388,4068182383),new ctx.UInt64(2162078206,991336113),new ctx.UInt64(2614888103,633803317),new ctx.UInt64(3248222580,3479774868),new ctx.UInt64(3835390401,2666613458),new ctx.UInt64(4022224774,944711139),new ctx.UInt64(264347078,2341262773),new ctx.UInt64(604807628,2007800933),new ctx.UInt64(770255983,1495990901),new ctx.UInt64(1249150122,1856431235),new ctx.UInt64(1555081692,3175218132),new ctx.UInt64(1996064986,2198950837),new ctx.UInt64(2554220882,3999719339),new ctx.UInt64(2821834349,766784016),new ctx.UInt64(2952996808,2566594879),new ctx.UInt64(3210313671,3203337956),new ctx.UInt64(3336571891,1034457026),new ctx.UInt64(3584528711,2466948901),new ctx.UInt64(113926993,3758326383),new ctx.UInt64(338241895,168717936),new ctx.UInt64(666307205,1188179964),new ctx.UInt64(773529912,1546045734),new ctx.UInt64(1294757372,1522805485),new ctx.UInt64(1396182291,2643833823),new ctx.UInt64(1695183700,2343527390),new ctx.UInt64(1986661051,1014477480),new ctx.UInt64(2177026350,1206759142),new ctx.UInt64(2456956037,344077627),new ctx.UInt64(2730485921,1290863460),new ctx.UInt64(2820302411,3158454273),new ctx.UInt64(3259730800,3505952657),new ctx.UInt64(3345764771,106217008),new ctx.UInt64(3516065817,3606008344),new ctx.UInt64(3600352804,1432725776),new ctx.UInt64(4094571909,1467031594),new ctx.UInt64(275423344,851169720),new ctx.UInt64(430227734,3100823752),new ctx.UInt64(506948616,1363258195),new ctx.UInt64(659060556,3750685593),new ctx.UInt64(883997877,3785050280),new ctx.UInt64(958139571,3318307427),new ctx.UInt64(1322822218,3812723403),new ctx.UInt64(1537002063,2003034995),new ctx.UInt64(1747873779,3602036899),new ctx.UInt64(1955562222,1575990012),new ctx.UInt64(2024104815,1125592928),new ctx.UInt64(2227730452,2716904306),new ctx.UInt64(2361852424,442776044),new ctx.UInt64(2428436474,593698344),new ctx.UInt64(2756734187,3733110249),new ctx.UInt64(3204031479,2999351573),new ctx.UInt64(3329325298,3815920427),new ctx.UInt64(3391569614,3928383900),new ctx.UInt64(3515267271,566280711),new ctx.UInt64(3940187606,3454069534),new ctx.UInt64(4118630271,4000239992),new ctx.UInt64(116418474,1914138554),new ctx.UInt64(174292421,2731055270),new ctx.UInt64(289380356,3203993006),new ctx.UInt64(460393269,320620315),new ctx.UInt64(685471733,587496836),new ctx.UInt64(852142971,1086792851),new ctx.UInt64(1017036298,365543100),new ctx.UInt64(1126000580,2618297676),new ctx.UInt64(1288033470,3409855158),new ctx.UInt64(1501505948,4234509866),new ctx.UInt64(1607167915,987167468),new ctx.UInt64(1816402316,1246189591)];return HASH384}function HASH512(ctx){var HASH512=function(){this.length=[];this.h=[];this.w=[];this.init()};HASH512.prototype={transform:function(){var a,b,c,d,e,f,g,hh,t1,t2,j;for(j=16;j<80;j++){this.w[j]=HASH512.theta1(this.w[j-2]).add(this.w[j-7]).add(HASH512.theta0(this.w[j-15])).add(this.w[j-16])}a=this.h[0].copy();b=this.h[1].copy();c=this.h[2].copy();d=this.h[3].copy();e=this.h[4].copy();f=this.h[5].copy();g=this.h[6].copy();hh=this.h[7].copy();for(j=0;j<80;j++){t1=hh.copy();t1.add(HASH512.Sig1(e)).add(HASH512.Ch(e,f,g)).add(HASH512.HK[j]).add(this.w[j]);t2=HASH512.Sig0(a);t2.add(HASH512.Maj(a,b,c));hh=g;g=f;f=e;e=d.copy();e.add(t1);d=c;c=b;b=a;a=t1.copy();a.add(t2)}this.h[0].add(a);this.h[1].add(b);this.h[2].add(c);this.h[3].add(d);this.h[4].add(e);this.h[5].add(f);this.h[6].add(g);this.h[7].add(hh)},init:function(){var i;for(i=0;i<80;i++){this.w[i]=new ctx.UInt64(0,0)}this.length[0]=new ctx.UInt64(0,0);this.length[1]=new ctx.UInt64(0,0);this.h[0]=HASH512.H[0].copy();this.h[1]=HASH512.H[1].copy();this.h[2]=HASH512.H[2].copy();this.h[3]=HASH512.H[3].copy();this.h[4]=HASH512.H[4].copy();this.h[5]=HASH512.H[5].copy();this.h[6]=HASH512.H[6].copy();this.h[7]=HASH512.H[7].copy()},process:function(byt){var cnt,e;cnt=(this.length[0].bot>>>6)%16;this.w[cnt].shlb();this.w[cnt].bot|=byt&255;e=new ctx.UInt64(0,8);this.length[0].add(e);if(this.length[0].top===0&&this.length[0].bot==0){e=new ctx.UInt64(0,1);this.length[1].add(e)}if(this.length[0].bot%1024===0){this.transform()}},process_array:function(b){for(var i=0;i<b.length;i++){this.process(b[i])}},process_num:function(n){this.process(n>>24&255);this.process(n>>16&255);this.process(n>>8&255);this.process(n&255)},hash:function(){var digest=[],len0,len1,i;len0=this.length[0].copy();len1=this.length[1].copy();this.process(128);while(this.length[0].bot%1024!=896){this.process(0)}this.w[14]=len1;this.w[15]=len0;this.transform();for(i=0;i<HASH512.len;i++){digest[i]=HASH512.R(8*(7-i%8),this.h[i>>>3]).bot&255}this.init();return digest}};HASH512.S=function(n,x){if(n==0){return x}if(n<32){return new ctx.UInt64(x.top>>>n|x.bot<<32-n,x.bot>>>n|x.top<<32-n)}else{return new ctx.UInt64(x.bot>>>n-32|x.top<<64-n,x.top>>>n-32|x.bot<<64-n)}};HASH512.R=function(n,x){if(n==0){return x}if(n<32){return new ctx.UInt64(x.top>>>n,x.bot>>>n|x.top<<32-n)}else{return new ctx.UInt64(0,x.top>>>n-32)}};HASH512.Ch=function(x,y,z){return new ctx.UInt64(x.top&y.top^~x.top&z.top,x.bot&y.bot^~x.bot&z.bot)};HASH512.Maj=function(x,y,z){return new ctx.UInt64(x.top&y.top^x.top&z.top^y.top&z.top,x.bot&y.bot^x.bot&z.bot^y.bot&z.bot)};HASH512.Sig0=function(x){var r1=HASH512.S(28,x),r2=HASH512.S(34,x),r3=HASH512.S(39,x);return new ctx.UInt64(r1.top^r2.top^r3.top,r1.bot^r2.bot^r3.bot)};HASH512.Sig1=function(x){var r1=HASH512.S(14,x),r2=HASH512.S(18,x),r3=HASH512.S(41,x);return new ctx.UInt64(r1.top^r2.top^r3.top,r1.bot^r2.bot^r3.bot)};HASH512.theta0=function(x){var r1=HASH512.S(1,x),r2=HASH512.S(8,x),r3=HASH512.R(7,x);return new ctx.UInt64(r1.top^r2.top^r3.top,r1.bot^r2.bot^r3.bot)};HASH512.theta1=function(x){var r1=HASH512.S(19,x),r2=HASH512.S(61,x),r3=HASH512.R(6,x);return new ctx.UInt64(r1.top^r2.top^r3.top,r1.bot^r2.bot^r3.bot)};HASH512.len=64;HASH512.H=[new ctx.UInt64(1779033703,4089235720),new ctx.UInt64(3144134277,2227873595),new ctx.UInt64(1013904242,4271175723),new ctx.UInt64(2773480762,1595750129),new ctx.UInt64(1359893119,2917565137),new ctx.UInt64(2600822924,725511199),new ctx.UInt64(528734635,4215389547),new ctx.UInt64(1541459225,327033209)];HASH512.HK=[new ctx.UInt64(1116352408,3609767458),new ctx.UInt64(1899447441,602891725),new ctx.UInt64(3049323471,3964484399),new ctx.UInt64(3921009573,2173295548),new ctx.UInt64(961987163,4081628472),new ctx.UInt64(1508970993,3053834265),new ctx.UInt64(2453635748,2937671579),new ctx.UInt64(2870763221,3664609560),new ctx.UInt64(3624381080,2734883394),new ctx.UInt64(310598401,1164996542),new ctx.UInt64(607225278,1323610764),new ctx.UInt64(1426881987,3590304994),new ctx.UInt64(1925078388,4068182383),new ctx.UInt64(2162078206,991336113),new ctx.UInt64(2614888103,633803317),new ctx.UInt64(3248222580,3479774868),new ctx.UInt64(3835390401,2666613458),new ctx.UInt64(4022224774,944711139),new ctx.UInt64(264347078,2341262773),new ctx.UInt64(604807628,2007800933),new ctx.UInt64(770255983,1495990901),new ctx.UInt64(1249150122,1856431235),new ctx.UInt64(1555081692,3175218132),new ctx.UInt64(1996064986,2198950837),new ctx.UInt64(2554220882,3999719339),new ctx.UInt64(2821834349,766784016),new ctx.UInt64(2952996808,2566594879),new ctx.UInt64(3210313671,3203337956),new ctx.UInt64(3336571891,1034457026),new ctx.UInt64(3584528711,2466948901),new ctx.UInt64(113926993,3758326383),new ctx.UInt64(338241895,168717936),new ctx.UInt64(666307205,1188179964),new ctx.UInt64(773529912,1546045734),new ctx.UInt64(1294757372,1522805485),new ctx.UInt64(1396182291,2643833823),new ctx.UInt64(1695183700,2343527390),new ctx.UInt64(1986661051,1014477480),new ctx.UInt64(2177026350,1206759142),new ctx.UInt64(2456956037,344077627),new ctx.UInt64(2730485921,1290863460),new ctx.UInt64(2820302411,3158454273),new ctx.UInt64(3259730800,3505952657),new ctx.UInt64(3345764771,106217008),new ctx.UInt64(3516065817,3606008344),new ctx.UInt64(3600352804,1432725776),new ctx.UInt64(4094571909,1467031594),new ctx.UInt64(275423344,851169720),new ctx.UInt64(430227734,3100823752),new ctx.UInt64(506948616,1363258195),new ctx.UInt64(659060556,3750685593),new ctx.UInt64(883997877,3785050280),new ctx.UInt64(958139571,3318307427),new ctx.UInt64(1322822218,3812723403),new ctx.UInt64(1537002063,2003034995),new ctx.UInt64(1747873779,3602036899),new ctx.UInt64(1955562222,1575990012),new ctx.UInt64(2024104815,1125592928),new ctx.UInt64(2227730452,2716904306),new ctx.UInt64(2361852424,442776044),new ctx.UInt64(2428436474,593698344),new ctx.UInt64(2756734187,3733110249),new ctx.UInt64(3204031479,2999351573),new ctx.UInt64(3329325298,3815920427),new ctx.UInt64(3391569614,3928383900),new ctx.UInt64(3515267271,566280711),new ctx.UInt64(3940187606,3454069534),new ctx.UInt64(4118630271,4000239992),new ctx.UInt64(116418474,1914138554),new ctx.UInt64(174292421,2731055270),new ctx.UInt64(289380356,3203993006),new ctx.UInt64(460393269,320620315),new ctx.UInt64(685471733,587496836),new ctx.UInt64(852142971,1086792851),new ctx.UInt64(1017036298,365543100),new ctx.UInt64(1126000580,2618297676),new ctx.UInt64(1288033470,3409855158),new ctx.UInt64(1501505948,4234509866),new ctx.UInt64(1607167915,987167468),new ctx.UInt64(1816402316,1246189591)];return HASH512}function MPIN(ctx){var MPIN={BAD_PARAMS:-11,INVALID_POINT:-14,WRONG_ORDER:-18,BAD_PIN:-19,MAXPIN:1e4,PBLEN:14,TS:12,TRAP:2e3,EFS:ctx.BIG.MODBYTES,EGS:ctx.BIG.MODBYTES,SHA256:32,SHA384:48,SHA512:64,today:function(){var now=new Date;return Math.floor(now.getTime()/(6e4*1440))},bytestostring:function(b){var s="",len=b.length,ch,i;for(i=0;i<len;i++){ch=b[i];s+=(ch>>>4&15).toString(16);s+=(ch&15).toString(16)}return s},stringtobytes:function(s){var b=[],i;for(i=0;i<s.length;i++){b.push(s.charCodeAt(i))}return b},comparebytes:function(a,b){if(a.length!=b.length){return false}for(var i=0;i<a.length;i++){if(a[i]!=b[i]){return false}}return true},mpin_hash:function(sha,c,U){var t=[],w=[],h=[],H,R,i;c.geta().getA().toBytes(w);for(i=0;i<this.EFS;i++){t[i]=w[i]}c.geta().getB().toBytes(w);for(i=this.EFS;i<2*this.EFS;i++){t[i]=w[i-this.EFS]}c.getb().getA().toBytes(w);for(i=2*this.EFS;i<3*this.EFS;i++){t[i]=w[i-2*this.EFS]}c.getb().getB().toBytes(w);for(i=3*this.EFS;i<4*this.EFS;i++){t[i]=w[i-3*this.EFS]}U.getX().toBytes(w);for(i=4*this.EFS;i<5*this.EFS;i++){t[i]=w[i-4*this.EFS]}U.getY().toBytes(w);for(i=5*this.EFS;i<6*this.EFS;i++){t[i]=w[i-5*this.EFS]}if(sha==this.SHA256){H=new ctx.HASH256}else if(sha==this.SHA384){H=new ctx.HASH384}else if(sha==this.SHA512){H=new ctx.HASH512}H.process_array(t);h=H.hash();if(h.length==0){return null}R=[];for(i=0;i<ctx.ECP.AESKEY;i++){R[i]=h[i]}return R},hashit:function(sha,n,B){var R=[],H,W,i,len;if(sha==this.SHA256){H=new ctx.HASH256}else if(sha==this.SHA384){H=new ctx.HASH384}else if(sha==this.SHA512){H=new ctx.HASH512}if(n>0){H.process_num(n)}H.process_array(B);R=H.hash();if(R.length==0){return null}W=[];len=ctx.BIG.MODBYTES;if(sha>=len){for(i=0;i<len;i++){W[i]=R[i]}}else{for(i=0;i<sha;i++){W[i+len-sha]=R[i]}for(i=0;i<len-sha;i++){W[i]=0}}return W},map:function(u,cb){var P=new ctx.ECP,x=new ctx.BIG(u),p=new ctx.BIG(0);p.rcopy(ctx.ROM_FIELD.Modulus);x.mod(p);for(;;){P.setxi(x,cb);if(!P.is_infinity()){break}x.inc(1);x.norm()}return P},unmap:function(u,P){var s=P.getS(),R=new ctx.ECP,r=0,x=P.getX();u.copy(x);for(;;){u.dec(1);u.norm();r++;R.setxi(u,s);if(!R.is_infinity()){break}}return r},ENCODING:function(rng,E){var T=[],i,rn,m,su,sv,u,v,P,p,W;for(i=0;i<this.EFS;i++){T[i]=E[i+1]}u=ctx.BIG.fromBytes(T);for(i=0;i<this.EFS;i++){T[i]=E[i+this.EFS+1]}v=ctx.BIG.fromBytes(T);P=new ctx.ECP(0);P.setxy(u,v);if(P.is_infinity()){return this.INVALID_POINT}p=new ctx.BIG(0);p.rcopy(ctx.ROM_FIELD.Modulus);u=ctx.BIG.randomnum(p,rng);su=rng.getByte();if(su<0){su=-su}su%=2;W=this.map(u,su);P.sub(W);sv=P.getS();rn=this.unmap(v,P);m=rng.getByte();if(m<0){m=-m}m%=rn;v.inc(m+1);E[0]=su+2*sv;u.toBytes(T);for(i=0;i<this.EFS;i++){E[i+1]=T[i]}v.toBytes(T);for(i=0;i<this.EFS;i++){E[i+this.EFS+1]=T[i]}return 0},DECODING:function(D){var T=[],i,su,sv,u,v,W,P;if((D[0]&4)!==0){return this.INVALID_POINT}for(i=0;i<this.EFS;i++){T[i]=D[i+1]}u=ctx.BIG.fromBytes(T);for(i=0;i<this.EFS;i++){T[i]=D[i+this.EFS+1]}v=ctx.BIG.fromBytes(T);su=D[0]&1;sv=D[0]>>1&1;W=this.map(u,su);P=this.map(v,sv);P.add(W);u=P.getX();v=P.getY();D[0]=4;u.toBytes(T);for(i=0;i<this.EFS;i++){D[i+1]=T[i]}v.toBytes(T);for(i=0;i<this.EFS;i++){D[i+this.EFS+1]=T[i]}return 0},RECOMBINE_G1:function(R1,R2,R){var P=ctx.ECP.fromBytes(R1),Q=ctx.ECP.fromBytes(R2);if(P.is_infinity()||Q.is_infinity()){return this.INVALID_POINT}P.add(Q);P.toBytes(R);return 0},RECOMBINE_G2:function(W1,W2,W){var P=ctx.ECP2.fromBytes(W1),Q=ctx.ECP2.fromBytes(W2);if(P.is_infinity()||Q.is_infinity()){return this.INVALID_POINT}P.add(Q);P.toBytes(W);return 0},HASH_ID:function(sha,ID){return this.hashit(sha,0,ID)},RANDOM_GENERATE:function(rng,S){var r=new ctx.BIG(0),s;r.rcopy(ctx.ROM_CURVE.CURVE_Order);s=ctx.BIG.randomnum(r,rng);s.toBytes(S);return 0},EXTRACT_PIN:function(sha,CID,pin,TOKEN){return this.EXTRACT_FACTOR(sha,CID,pin%this.MAXPIN,this.PBLEN,TOKEN)},EXTRACT_FACTOR:function(sha,CID,factor,facbits,TOKEN){var P,R,h;P=ctx.ECP.fromBytes(TOKEN);if(P.is_infinity()){return this.INVALID_POINT}h=this.hashit(sha,0,CID);R=ctx.ECP.mapit(h);R=R.pinmul(factor,facbits);P.sub(R);P.toBytes(TOKEN);return 0},RESTORE_FACTOR:function(sha,CID,factor,facbits,TOKEN){var P,R,h;P=ctx.ECP.fromBytes(TOKEN);if(P.is_infinity()){return this.INVALID_POINT}h=this.hashit(sha,0,CID),R=ctx.ECP.mapit(h);R=R.pinmul(factor,facbits);P.add(R);P.toBytes(TOKEN);return 0},GET_SERVER_SECRET:function(S,SST){var s,Q;Q=ctx.ECP2.generator();s=ctx.BIG.fromBytes(S);Q=ctx.PAIR.G2mul(Q,s);Q.toBytes(SST);return 0},GET_G1_MULTIPLE:function(rng,type,X,G,W){var r=new ctx.BIG(0),x,P;r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(rng!=null){x=ctx.BIG.randomnum(r,rng);x.toBytes(X)}else{x=ctx.BIG.fromBytes(X)}if(type==0){P=ctx.ECP.fromBytes(G);if(P.is_infinity()){return this.INVALID_POINT}}else{P=ctx.ECP.mapit(G)}ctx.PAIR.G1mul(P,x).toBytes(W);return 0},GET_CLIENT_SECRET:function(S,CID,CST){return this.GET_G1_MULTIPLE(null,1,S,CID,CST)},GET_CLIENT_PERMIT:function(sha,date,S,CID,CTT){var h=this.hashit(sha,date,CID),P=ctx.ECP.mapit(h),s=ctx.BIG.fromBytes(S);P=ctx.PAIR.G1mul(P,s);P.toBytes(CTT);return 0},CLIENT_1:function(sha,date,CLIENT_ID,rng,X,pin,TOKEN,SEC,xID,xCID,PERMIT){var r=new ctx.BIG(0),x,P,T,W,h;r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(rng!==null){x=ctx.BIG.randomnum(r,rng);x.toBytes(X)}else{x=ctx.BIG.fromBytes(X)}h=this.hashit(sha,0,CLIENT_ID);P=ctx.ECP.mapit(h);T=ctx.ECP.fromBytes(TOKEN);if(T.is_infinity()){return this.INVALID_POINT}pin%=this.MAXPIN;W=P.pinmul(pin,this.PBLEN);T.add(W);if(date!=0){W=ctx.ECP.fromBytes(PERMIT);if(W.is_infinity()){return this.INVALID_POINT}T.add(W);h=this.hashit(sha,date,h);W=ctx.ECP.mapit(h);if(xID!=null){P=ctx.PAIR.G1mul(P,x);P.toBytes(xID);W=ctx.PAIR.G1mul(W,x);P.add(W)}else{P.add(W);P=ctx.PAIR.G1mul(P,x)}if(xCID!=null){P.toBytes(xCID)}}else{if(xID!=null){P=ctx.PAIR.G1mul(P,x);P.toBytes(xID)}}T.toBytes(SEC);return 0},CLIENT_2:function(X,Y,SEC){var r=new ctx.BIG(0),P,px,py;r.rcopy(ctx.ROM_CURVE.CURVE_Order);P=ctx.ECP.fromBytes(SEC);if(P.is_infinity()){return this.INVALID_POINT}px=ctx.BIG.fromBytes(X);py=ctx.BIG.fromBytes(Y);px.add(py);px.mod(r);P=ctx.PAIR.G1mul(P,px);P.neg();P.toBytes(SEC);return 0},SERVER_1:function(sha,date,CID,HID,HTID){var h=this.hashit(sha,0,CID),P=ctx.ECP.mapit(h),R;P.toBytes(HID);if(date!==0){h=this.hashit(sha,date,h);R=ctx.ECP.mapit(h);P.add(R);P.toBytes(HTID)}},SERVER_2:function(date,HID,HTID,Y,SST,xID,xCID,mSEC,E,F,Pa){var Q,sQ,R,y,P,g;if(typeof Pa==="undefined"||Pa==null){Q=ctx.ECP2.generator()}else{Q=ctx.ECP2.fromBytes(Pa);if(Q.is_infinity()){return this.INVALID_POINT}}sQ=ctx.ECP2.fromBytes(SST);if(sQ.is_infinity()){return this.INVALID_POINT}if(date!==0){R=ctx.ECP.fromBytes(xCID)}else{if(xID==null){return this.BAD_PARAMS}R=ctx.ECP.fromBytes(xID)}if(R.is_infinity()){return this.INVALID_POINT}y=ctx.BIG.fromBytes(Y);if(date!=0){P=ctx.ECP.fromBytes(HTID)}else{if(HID==null){return this.BAD_PARAMS}P=ctx.ECP.fromBytes(HID)}if(P.is_infinity()){return this.INVALID_POINT}P=ctx.PAIR.G1mul(P,y);P.add(R);P.affine();R=ctx.ECP.fromBytes(mSEC);if(R.is_infinity()){return this.INVALID_POINT}g=ctx.PAIR.ate2(Q,R,sQ,P);g=ctx.PAIR.fexp(g);if(!g.isunity()){if(HID!=null&&xID!=null&&E!=null&&F!=null){g.toBytes(E);if(date!==0){P=ctx.ECP.fromBytes(HID);if(P.is_infinity()){return this.INVALID_POINT}R=ctx.ECP.fromBytes(xID);if(R.is_infinity()){return this.INVALID_POINT}P=ctx.PAIR.G1mul(P,y);P.add(R);P.affine()}g=ctx.PAIR.ate(Q,P);g=ctx.PAIR.fexp(g);g.toBytes(F)}return this.BAD_PIN}return 0},KANGAROO:function(E,F){var ge=ctx.FP12.fromBytes(E),gf=ctx.FP12.fromBytes(F),distance=[],t=new ctx.FP12(gf),table=[],i,j,m,s,dn,dm,res,steps;s=1;for(m=0;m<this.TS;m++){distance[m]=s;table[m]=new ctx.FP12(t);s*=2;t.usqr()}t.one();dn=0;for(j=0;j<this.TRAP;j++){i=t.geta().geta().getA().lastbits(20)%this.TS;t.mul(table[i]);dn+=distance[i]}gf.copy(t);gf.conj();steps=0;dm=0;res=0;while(dm-dn<this.MAXPIN){steps++;if(steps>4*this.TRAP){break}i=ge.geta().geta().getA().lastbits(20)%this.TS;ge.mul(table[i]);dm+=distance[i];if(ge.equals(t)){res=dm-dn;break}if(ge.equals(gf)){res=dn-dm;break}}if(steps>4*this.TRAP||dm-dn>=this.MAXPIN){res=0}return res},GET_TIME:function(){var now=new Date;return Math.floor(now.getTime()/1e3)},GET_Y:function(sha,TimeValue,xCID,Y){var q=new ctx.BIG(0),h=this.hashit(sha,TimeValue,xCID),y=ctx.BIG.fromBytes(h);q.rcopy(ctx.ROM_CURVE.CURVE_Order);y.mod(q);y.toBytes(Y);return 0},CLIENT:function(sha,date,CLIENT_ID,rng,X,pin,TOKEN,SEC,xID,xCID,PERMIT,TimeValue,Y,Message){var rtn=0,M=[],pID,i;if(date==0){pID=xID}else{pID=xCID;xID=null}rtn=this.CLIENT_1(sha,date,CLIENT_ID,rng,X,pin,TOKEN,SEC,xID,xCID,PERMIT);if(rtn!=0){return rtn}
M=pID.slice();if(typeof Message!=="undefined"||Message!=null){for(i=0;i<Message.length;i++){M.push(Message[i])}}this.GET_Y(sha,TimeValue,M,Y);rtn=this.CLIENT_2(X,Y,SEC);if(rtn!=0){return rtn}return 0},SERVER:function(sha,date,HID,HTID,Y,SST,xID,xCID,mSEC,E,F,CID,TimeValue,Message,Pa){var rtn=0,M=[],pID,i;if(date==0){pID=xID}else{pID=xCID}this.SERVER_1(sha,date,CID,HID,HTID);M=pID.slice();if(typeof Message!=="undefined"||Message!=null){for(i=0;i<Message.length;i++){M.push(Message[i])}}this.GET_Y(sha,TimeValue,M,Y);rtn=this.SERVER_2(date,HID,HTID,Y,SST,xID,xCID,mSEC,E,F,Pa);if(rtn!=0){return rtn}return 0},PRECOMPUTE:function(TOKEN,CID,G1,G2){var P,T,g,Q;T=ctx.ECP.fromBytes(TOKEN);if(T.is_infinity()){return this.INVALID_POINT}P=ctx.ECP.mapit(CID);Q=ctx.ECP2.generator();g=ctx.PAIR.ate(Q,T);g=ctx.PAIR.fexp(g);g.toBytes(G1);g=ctx.PAIR.ate(Q,P);g=ctx.PAIR.fexp(g);g.toBytes(G2);return 0},HASH_ALL:function(sha,HID,xID,xCID,SEC,Y,R,W){var tlen=0,T=[],i;for(i=0;i<HID.length;i++){T[i]=HID[i]}tlen+=HID.length;if(xCID!=null){for(i=0;i<xCID.length;i++){T[i+tlen]=xCID[i]}tlen+=xCID.length}else{for(i=0;i<xID.length;i++){T[i+tlen]=xID[i]}tlen+=xID.length}for(i=0;i<SEC.length;i++){T[i+tlen]=SEC[i]}tlen+=SEC.length;for(i=0;i<Y.length;i++){T[i+tlen]=Y[i]}tlen+=Y.length;for(i=0;i<R.length;i++){T[i+tlen]=R[i]}tlen+=R.length;for(i=0;i<W.length;i++){T[i+tlen]=W[i]}tlen+=W.length;return this.hashit(sha,0,T)},CLIENT_KEY:function(sha,G1,G2,pin,R,X,H,wCID,CK){var t=[],g1=ctx.FP12.fromBytes(G1),g2=ctx.FP12.fromBytes(G2),z=ctx.BIG.fromBytes(R),x=ctx.BIG.fromBytes(X),h=ctx.BIG.fromBytes(H),W=ctx.ECP.fromBytes(wCID),r,c,i;if(W.is_infinity()){return this.INVALID_POINT}W=ctx.PAIR.G1mul(W,x);r=new ctx.BIG(0);r.rcopy(ctx.ROM_CURVE.CURVE_Order);z.add(h);z.mod(r);g2.pinpow(pin,this.PBLEN);g1.mul(g2);c=g1.compow(z,r);t=this.mpin_hash(sha,c,W);for(i=0;i<ctx.ECP.AESKEY;i++){CK[i]=t[i]}return 0},SERVER_KEY:function(sha,Z,SST,W,H,HID,xID,xCID,SK){var t=[],sQ,R,A,U,w,h,g,c,i;sQ=ctx.ECP2.fromBytes(SST);if(sQ.is_infinity()){return this.INVALID_POINT}R=ctx.ECP.fromBytes(Z);if(R.is_infinity()){return this.INVALID_POINT}A=ctx.ECP.fromBytes(HID);if(A.is_infinity()){return this.INVALID_POINT}if(xCID!=null){U=ctx.ECP.fromBytes(xCID)}else{U=ctx.ECP.fromBytes(xID)}if(U.is_infinity()){return this.INVALID_POINT}w=ctx.BIG.fromBytes(W);h=ctx.BIG.fromBytes(H);A=ctx.PAIR.G1mul(A,h);R.add(A);R.affine();U=ctx.PAIR.G1mul(U,w);g=ctx.PAIR.ate(sQ,R);g=ctx.PAIR.fexp(g);c=g.trace();t=this.mpin_hash(sha,c,U);for(i=0;i<ctx.ECP.AESKEY;i++){SK[i]=t[i]}return 0},GET_DVS_KEYPAIR:function(rng,Z,Pa){var r=new ctx.BIG(0),z,Q;r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(rng!=null){z=ctx.BIG.randomnum(r,rng);z.toBytes(Z)}else{z=ctx.BIG.fromBytes(Z)}z.invmodp(r);Q=ctx.ECP2.generator();Q=ctx.PAIR.G2mul(Q,z);Q.toBytes(Pa);return 0}};return MPIN}function MPIN192(ctx){var MPIN192={BAD_PARAMS:-11,INVALID_POINT:-14,WRONG_ORDER:-18,BAD_PIN:-19,MAXPIN:1e4,PBLEN:14,TS:12,TRAP:2e3,EFS:ctx.BIG.MODBYTES,EGS:ctx.BIG.MODBYTES,SHA256:32,SHA384:48,SHA512:64,today:function(){var now=new Date;return Math.floor(now.getTime()/(6e4*1440))},bytestostring:function(b){var s="",len=b.length,ch,i;for(i=0;i<len;i++){ch=b[i];s+=(ch>>>4&15).toString(16);s+=(ch&15).toString(16)}return s},stringtobytes:function(s){var b=[],i;for(i=0;i<s.length;i++){b.push(s.charCodeAt(i))}return b},comparebytes:function(a,b){if(a.length!=b.length){return false}for(var i=0;i<a.length;i++){if(a[i]!=b[i]){return false}}return true},mpin_hash:function(sha,c,U){var t=[],w=[],h=[],H,R,i;c.geta().geta().getA().toBytes(w);for(i=0;i<this.EFS;i++){t[i]=w[i]}c.geta().geta().getB().toBytes(w);for(i=this.EFS;i<2*this.EFS;i++){t[i]=w[i-this.EFS]}c.geta().getb().getA().toBytes(w);for(i=2*this.EFS;i<3*this.EFS;i++){t[i]=w[i-2*this.EFS]}c.geta().getb().getB().toBytes(w);for(i=3*this.EFS;i<4*this.EFS;i++){t[i]=w[i-3*this.EFS]}c.getb().geta().getA().toBytes(w);for(i=4*this.EFS;i<5*this.EFS;i++){t[i]=w[i-4*this.EFS]}c.getb().geta().getB().toBytes(w);for(i=5*this.EFS;i<6*this.EFS;i++){t[i]=w[i-5*this.EFS]}c.getb().getb().getA().toBytes(w);for(i=6*this.EFS;i<7*this.EFS;i++){t[i]=w[i-6*this.EFS]}c.getb().getb().getB().toBytes(w);for(i=7*this.EFS;i<8*this.EFS;i++){t[i]=w[i-7*this.EFS]}U.getX().toBytes(w);for(i=8*this.EFS;i<9*this.EFS;i++){t[i]=w[i-8*this.EFS]}U.getY().toBytes(w);for(i=9*this.EFS;i<10*this.EFS;i++){t[i]=w[i-9*this.EFS]}if(sha==this.SHA256){H=new ctx.HASH256}else if(sha==this.SHA384){H=new ctx.HASH384}else if(sha==this.SHA512){H=new ctx.HASH512}H.process_array(t);h=H.hash();if(h.length==0){return null}R=[];for(i=0;i<ctx.ECP.AESKEY;i++){R[i]=h[i]}return R},hashit:function(sha,n,B){var R=[],H,W,i,len;if(sha==this.SHA256){H=new ctx.HASH256}else if(sha==this.SHA384){H=new ctx.HASH384}else if(sha==this.SHA512){H=new ctx.HASH512}if(n>0){H.process_num(n)}H.process_array(B);R=H.hash();if(R.length==0){return null}W=[];len=ctx.BIG.MODBYTES;if(sha>=len){for(i=0;i<len;i++){W[i]=R[i]}}else{for(i=0;i<sha;i++){W[i+len-sha]=R[i]}for(i=0;i<len-sha;i++){W[i]=0}}return W},map:function(u,cb){var P=new ctx.ECP,x=new ctx.BIG(u),p=new ctx.BIG(0);p.rcopy(ctx.ROM_FIELD.Modulus);x.mod(p);for(;;){P.setxi(x,cb);if(!P.is_infinity()){break}x.inc(1);x.norm()}return P},unmap:function(u,P){var s=P.getS(),R=new ctx.ECP,r=0,x=P.getX();u.copy(x);for(;;){u.dec(1);u.norm();r++;R.setxi(u,s);if(!R.is_infinity()){break}}return r},ENCODING:function(rng,E){var T=[],i,rn,m,su,sv,u,v,P,p,W;for(i=0;i<this.EFS;i++){T[i]=E[i+1]}u=ctx.BIG.fromBytes(T);for(i=0;i<this.EFS;i++){T[i]=E[i+this.EFS+1]}v=ctx.BIG.fromBytes(T);P=new ctx.ECP(0);P.setxy(u,v);if(P.is_infinity()){return this.INVALID_POINT}p=new ctx.BIG(0);p.rcopy(ctx.ROM_FIELD.Modulus);u=ctx.BIG.randomnum(p,rng);su=rng.getByte();if(su<0){su=-su}su%=2;W=this.map(u,su);P.sub(W);sv=P.getS();rn=this.unmap(v,P);m=rng.getByte();if(m<0){m=-m}m%=rn;v.inc(m+1);E[0]=su+2*sv;u.toBytes(T);for(i=0;i<this.EFS;i++){E[i+1]=T[i]}v.toBytes(T);for(i=0;i<this.EFS;i++){E[i+this.EFS+1]=T[i]}return 0},DECODING:function(D){var T=[],i,su,sv,u,v,W,P;if((D[0]&4)!==0){return this.INVALID_POINT}for(i=0;i<this.EFS;i++){T[i]=D[i+1]}u=ctx.BIG.fromBytes(T);for(i=0;i<this.EFS;i++){T[i]=D[i+this.EFS+1]}v=ctx.BIG.fromBytes(T);su=D[0]&1;sv=D[0]>>1&1;W=this.map(u,su);P=this.map(v,sv);P.add(W);u=P.getX();v=P.getY();D[0]=4;u.toBytes(T);for(i=0;i<this.EFS;i++){D[i+1]=T[i]}v.toBytes(T);for(i=0;i<this.EFS;i++){D[i+this.EFS+1]=T[i]}return 0},RECOMBINE_G1:function(R1,R2,R){var P=ctx.ECP.fromBytes(R1),Q=ctx.ECP.fromBytes(R2);if(P.is_infinity()||Q.is_infinity()){return this.INVALID_POINT}P.add(Q);P.toBytes(R,false);return 0},RECOMBINE_G2:function(W1,W2,W){var P=ctx.ECP4.fromBytes(W1),Q=ctx.ECP4.fromBytes(W2);if(P.is_infinity()||Q.is_infinity()){return this.INVALID_POINT}P.add(Q);P.toBytes(W);return 0},HASH_ID:function(sha,ID){return this.hashit(sha,0,ID)},RANDOM_GENERATE:function(rng,S){var r=new ctx.BIG(0),s;r.rcopy(ctx.ROM_CURVE.CURVE_Order);s=ctx.BIG.randomnum(r,rng);s.toBytes(S);return 0},EXTRACT_PIN:function(sha,CID,pin,TOKEN){return this.EXTRACT_FACTOR(sha,CID,pin%this.MAXPIN,this.PBLEN,TOKEN)},EXTRACT_FACTOR:function(sha,CID,factor,facbits,TOKEN){var P,R,h;P=ctx.ECP.fromBytes(TOKEN);if(P.is_infinity()){return this.INVALID_POINT}h=this.hashit(sha,0,CID);R=ctx.ECP.mapit(h);R=R.pinmul(factor,facbits);P.sub(R);P.toBytes(TOKEN,false);return 0},RESTORE_FACTOR:function(sha,CID,factor,facbits,TOKEN){var P,R,h;P=ctx.ECP.fromBytes(TOKEN);if(P.is_infinity()){return this.INVALID_POINT}h=this.hashit(sha,0,CID),R=ctx.ECP.mapit(h);R=R.pinmul(factor,facbits);P.add(R);P.toBytes(TOKEN,false);return 0},GET_SERVER_SECRET:function(S,SST){var s,Q;Q=ctx.ECP4.generator();s=ctx.BIG.fromBytes(S);Q=ctx.PAIR192.G2mul(Q,s);Q.toBytes(SST);return 0},GET_G1_MULTIPLE:function(rng,type,X,G,W){var r=new ctx.BIG(0),x,P;r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(rng!=null){x=ctx.BIG.randomnum(r,rng);x.toBytes(X)}else{x=ctx.BIG.fromBytes(X)}if(type==0){P=ctx.ECP.fromBytes(G);if(P.is_infinity()){return this.INVALID_POINT}}else{P=ctx.ECP.mapit(G)}ctx.PAIR192.G1mul(P,x).toBytes(W,false);return 0},GET_CLIENT_SECRET:function(S,CID,CST){return this.GET_G1_MULTIPLE(null,1,S,CID,CST)},GET_CLIENT_PERMIT:function(sha,date,S,CID,CTT){var h=this.hashit(sha,date,CID),P=ctx.ECP.mapit(h),s=ctx.BIG.fromBytes(S);P=ctx.PAIR192.G1mul(P,s);P.toBytes(CTT,false);return 0},CLIENT_1:function(sha,date,CLIENT_ID,rng,X,pin,TOKEN,SEC,xID,xCID,PERMIT){var r=new ctx.BIG(0),x,P,T,W,h;r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(rng!==null){x=ctx.BIG.randomnum(r,rng);x.toBytes(X)}else{x=ctx.BIG.fromBytes(X)}h=this.hashit(sha,0,CLIENT_ID);P=ctx.ECP.mapit(h);T=ctx.ECP.fromBytes(TOKEN);if(T.is_infinity()){return this.INVALID_POINT}pin%=this.MAXPIN;W=P.pinmul(pin,this.PBLEN);T.add(W);if(date!=0){W=ctx.ECP.fromBytes(PERMIT);if(W.is_infinity()){return this.INVALID_POINT}T.add(W);h=this.hashit(sha,date,h);W=ctx.ECP.mapit(h);if(xID!=null){P=ctx.PAIR192.G1mul(P,x);P.toBytes(xID,false);W=ctx.PAIR192.G1mul(W,x);P.add(W)}else{P.add(W);P=ctx.PAIR192.G1mul(P,x)}if(xCID!=null){P.toBytes(xCID,false)}}else{if(xID!=null){P=ctx.PAIR192.G1mul(P,x);P.toBytes(xID,false)}}T.toBytes(SEC,false);return 0},CLIENT_2:function(X,Y,SEC){var r=new ctx.BIG(0),P,px,py;r.rcopy(ctx.ROM_CURVE.CURVE_Order);P=ctx.ECP.fromBytes(SEC);if(P.is_infinity()){return this.INVALID_POINT}px=ctx.BIG.fromBytes(X);py=ctx.BIG.fromBytes(Y);px.add(py);px.mod(r);P=ctx.PAIR192.G1mul(P,px);P.neg();P.toBytes(SEC,false);return 0},SERVER_1:function(sha,date,CID,HID,HTID){var h=this.hashit(sha,0,CID),P=ctx.ECP.mapit(h),R;P.toBytes(HID,false);if(date!==0){h=this.hashit(sha,date,h);R=ctx.ECP.mapit(h);P.add(R);P.toBytes(HTID,false)}},SERVER_2:function(date,HID,HTID,Y,SST,xID,xCID,mSEC,E,F,Pa){var Q,sQ,R,y,P,g;if(typeof Pa==="undefined"||Pa==null){Q=ctx.ECP4.generator()}else{Q=ctx.ECP4.fromBytes(Pa);if(Q.is_infinity()){return this.INVALID_POINT}}sQ=ctx.ECP4.fromBytes(SST);if(sQ.is_infinity()){return this.INVALID_POINT}if(date!==0){R=ctx.ECP.fromBytes(xCID)}else{if(xID==null){return this.BAD_PARAMS}R=ctx.ECP.fromBytes(xID)}if(R.is_infinity()){return this.INVALID_POINT}y=ctx.BIG.fromBytes(Y);if(date!=0){P=ctx.ECP.fromBytes(HTID)}else{if(HID==null){return this.BAD_PARAMS}P=ctx.ECP.fromBytes(HID)}if(P.is_infinity()){return this.INVALID_POINT}P=ctx.PAIR192.G1mul(P,y);P.add(R);P.affine();R=ctx.ECP.fromBytes(mSEC);if(R.is_infinity()){return this.INVALID_POINT}g=ctx.PAIR192.ate2(Q,R,sQ,P);g=ctx.PAIR192.fexp(g);if(!g.isunity()){if(HID!=null&&xID!=null&&E!=null&&F!=null){g.toBytes(E);if(date!==0){P=ctx.ECP.fromBytes(HID);if(P.is_infinity()){return this.INVALID_POINT}R=ctx.ECP.fromBytes(xID);if(R.is_infinity()){return this.INVALID_POINT}P=ctx.PAIR192.G1mul(P,y);P.add(R);P.affine()}g=ctx.PAIR192.ate(Q,P);g=ctx.PAIR192.fexp(g);g.toBytes(F)}return this.BAD_PIN}return 0},KANGAROO:function(E,F){var ge=ctx.FP24.fromBytes(E),gf=ctx.FP24.fromBytes(F),distance=[],t=new ctx.FP24(gf),table=[],i,j,m,s,dn,dm,res,steps;s=1;for(m=0;m<this.TS;m++){distance[m]=s;table[m]=new ctx.FP24(t);s*=2;t.usqr()}t.one();dn=0;for(j=0;j<this.TRAP;j++){i=t.geta().geta().geta().getA().lastbits(20)%this.TS;t.mul(table[i]);dn+=distance[i]}gf.copy(t);gf.conj();steps=0;dm=0;res=0;while(dm-dn<this.MAXPIN){steps++;if(steps>4*this.TRAP){break}i=ge.geta().geta().geta().getA().lastbits(20)%this.TS;ge.mul(table[i]);dm+=distance[i];if(ge.equals(t)){res=dm-dn;break}if(ge.equals(gf)){res=dn-dm;break}}if(steps>4*this.TRAP||dm-dn>=this.MAXPIN){res=0}return res},GET_TIME:function(){var now=new Date;return Math.floor(now.getTime()/1e3)},GET_Y:function(sha,TimeValue,xCID,Y){var q=new ctx.BIG(0),h=this.hashit(sha,TimeValue,xCID),y=ctx.BIG.fromBytes(h);q.rcopy(ctx.ROM_CURVE.CURVE_Order);y.mod(q);y.toBytes(Y);return 0},CLIENT:function(sha,date,CLIENT_ID,rng,X,pin,TOKEN,SEC,xID,xCID,PERMIT,TimeValue,Y,Message){var rtn=0,M=[],pID,i;if(date==0){pID=xID}else{pID=xCID;xID=null}rtn=this.CLIENT_1(sha,date,CLIENT_ID,rng,X,pin,TOKEN,SEC,xID,xCID,PERMIT);if(rtn!=0){return rtn}M=pID.slice();if(typeof Message!=="undefined"||Message!=null){for(i=0;i<Message.length;i++){M.push(Message[i])}}this.GET_Y(sha,TimeValue,M,Y);rtn=this.CLIENT_2(X,Y,SEC);if(rtn!=0){return rtn}return 0},SERVER:function(sha,date,HID,HTID,Y,SST,xID,xCID,mSEC,E,F,CID,TimeValue,Message,Pa){var rtn=0,M=[],pID,i;if(date==0){pID=xID}else{pID=xCID}this.SERVER_1(sha,date,CID,HID,HTID);M=pID.slice();if(typeof Message!=="undefined"||Message!=null){for(i=0;i<Message.length;i++){M.push(Message[i])}}this.GET_Y(sha,TimeValue,M,Y);rtn=this.SERVER_2(date,HID,HTID,Y,SST,xID,xCID,mSEC,E,F,Pa);if(rtn!=0){return rtn}return 0},PRECOMPUTE:function(TOKEN,CID,G1,G2){var P,T,g,Q;T=ctx.ECP.fromBytes(TOKEN);if(T.is_infinity()){return this.INVALID_POINT}P=ctx.ECP.mapit(CID);Q=ctx.ECP4.generator();g=ctx.PAIR192.ate(Q,T);g=ctx.PAIR192.fexp(g);g.toBytes(G1);g=ctx.PAIR192.ate(Q,P);g=ctx.PAIR192.fexp(g);g.toBytes(G2);return 0},HASH_ALL:function(sha,HID,xID,xCID,SEC,Y,R,W){var tlen=0,T=[],i;for(i=0;i<HID.length;i++){T[i]=HID[i]}tlen+=HID.length;if(xCID!=null){for(i=0;i<xCID.length;i++){T[i+tlen]=xCID[i]}tlen+=xCID.length}else{for(i=0;i<xID.length;i++){T[i+tlen]=xID[i]}tlen+=xID.length}for(i=0;i<SEC.length;i++){T[i+tlen]=SEC[i]}tlen+=SEC.length;for(i=0;i<Y.length;i++){T[i+tlen]=Y[i]}tlen+=Y.length;for(i=0;i<R.length;i++){T[i+tlen]=R[i]}tlen+=R.length;for(i=0;i<W.length;i++){T[i+tlen]=W[i]}tlen+=W.length;return this.hashit(sha,0,T)},CLIENT_KEY:function(sha,G1,G2,pin,R,X,H,wCID,CK){var t=[],g1=ctx.FP24.fromBytes(G1),g2=ctx.FP24.fromBytes(G2),z=ctx.BIG.fromBytes(R),x=ctx.BIG.fromBytes(X),h=ctx.BIG.fromBytes(H),W=ctx.ECP.fromBytes(wCID),r,c,i;if(W.is_infinity()){return this.INVALID_POINT}W=ctx.PAIR192.G1mul(W,x);r=new ctx.BIG(0);r.rcopy(ctx.ROM_CURVE.CURVE_Order);z.add(h);z.mod(r);g2.pinpow(pin,this.PBLEN);g1.mul(g2);c=g1.compow(z,r);t=this.mpin_hash(sha,c,W);for(i=0;i<ctx.ECP.AESKEY;i++){CK[i]=t[i]}return 0},SERVER_KEY:function(sha,Z,SST,W,H,HID,xID,xCID,SK){var t=[],sQ,R,A,U,w,h,g,c,i;sQ=ctx.ECP4.fromBytes(SST);if(sQ.is_infinity()){return this.INVALID_POINT}R=ctx.ECP.fromBytes(Z);if(R.is_infinity()){return this.INVALID_POINT}A=ctx.ECP.fromBytes(HID);if(A.is_infinity()){return this.INVALID_POINT}if(xCID!=null){U=ctx.ECP.fromBytes(xCID)}else{U=ctx.ECP.fromBytes(xID)}if(U.is_infinity()){return this.INVALID_POINT}w=ctx.BIG.fromBytes(W);h=ctx.BIG.fromBytes(H);A=ctx.PAIR192.G1mul(A,h);R.add(A);R.affine();U=ctx.PAIR192.G1mul(U,w);g=ctx.PAIR192.ate(sQ,R);g=ctx.PAIR192.fexp(g);c=g.trace();t=this.mpin_hash(sha,c,U);for(i=0;i<ctx.ECP.AESKEY;i++){SK[i]=t[i]}return 0},GET_DVS_KEYPAIR:function(rng,Z,Pa){var r=new ctx.BIG(0),z,Q;r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(rng!=null){z=ctx.BIG.randomnum(r,rng);z.toBytes(Z)}else{z=ctx.BIG.fromBytes(Z)}z.invmodp(r);Q=ctx.ECP4.generator();Q=ctx.PAIR192.G2mul(Q,z);Q.toBytes(Pa);return 0}};return MPIN192}function MPIN256(ctx){var MPIN256={BAD_PARAMS:-11,INVALID_POINT:-14,WRONG_ORDER:-18,BAD_PIN:-19,MAXPIN:1e4,PBLEN:14,TS:12,TRAP:2e3,EFS:ctx.BIG.MODBYTES,EGS:ctx.BIG.MODBYTES,SHA256:32,SHA384:48,SHA512:64,today:function(){var now=new Date;return Math.floor(now.getTime()/(6e4*1440))},bytestostring:function(b){var s="",len=b.length,ch,i;for(i=0;i<len;i++){ch=b[i];s+=(ch>>>4&15).toString(16);s+=(ch&15).toString(16)}return s},stringtobytes:function(s){var b=[],i;for(i=0;i<s.length;i++){b.push(s.charCodeAt(i))}return b},comparebytes:function(a,b){if(a.length!=b.length){return false}for(var i=0;i<a.length;i++){if(a[i]!=b[i]){return false}}return true},mpin_hash:function(sha,c,U){var t=[],w=[],h=[],H,R,i;c.geta().geta().geta().getA().toBytes(w);for(i=0;i<this.EFS;i++){t[i]=w[i]}c.geta().geta().geta().getB().toBytes(w);for(i=this.EFS;i<2*this.EFS;i++){t[i]=w[i-this.EFS]}c.geta().geta().getb().getA().toBytes(w);for(i=2*this.EFS;i<3*this.EFS;i++){t[i]=w[i-2*this.EFS]}c.geta().geta().getb().getB().toBytes(w);for(i=3*this.EFS;i<4*this.EFS;i++){t[i]=w[i-3*this.EFS]}c.geta().getb().geta().getA().toBytes(w);for(i=4*this.EFS;i<5*this.EFS;i++){t[i]=w[i-4*this.EFS]}c.geta().getb().geta().getB().toBytes(w);for(i=5*this.EFS;i<6*this.EFS;i++){t[i]=w[i-5*this.EFS]}c.geta().getb().getb().getA().toBytes(w);for(i=6*this.EFS;i<7*this.EFS;i++){t[i]=w[i-6*this.EFS]}c.geta().getb().getb().getB().toBytes(w);for(i=7*this.EFS;i<8*this.EFS;i++){t[i]=w[i-7*this.EFS]}c.getb().geta().geta().getA().toBytes(w);for(i=8*this.EFS;i<9*this.EFS;i++){t[i]=w[i-8*this.EFS]}c.getb().geta().geta().getB().toBytes(w);for(i=9*this.EFS;i<10*this.EFS;i++){t[i]=w[i-9*this.EFS]}c.getb().geta().getb().getA().toBytes(w);for(i=10*this.EFS;i<11*this.EFS;i++){t[i]=w[i-10*this.EFS]}c.getb().geta().getb().getB().toBytes(w);for(i=11*this.EFS;i<12*this.EFS;i++){t[i]=w[i-11*this.EFS]}c.getb().getb().geta().getA().toBytes(w);for(i=12*this.EFS;i<13*this.EFS;i++){t[i]=w[i-12*this.EFS]}c.getb().getb().geta().getB().toBytes(w);for(i=13*this.EFS;i<14*this.EFS;i++){t[i]=w[i-13*this.EFS]}c.getb().getb().getb().getA().toBytes(w);for(i=14*this.EFS;i<15*this.EFS;i++){t[i]=w[i-14*this.EFS]}c.getb().getb().getb().getB().toBytes(w);for(i=15*this.EFS;i<16*this.EFS;i++){t[i]=w[i-15*this.EFS]}U.getX().toBytes(w);for(i=16*this.EFS;i<17*this.EFS;i++){t[i]=w[i-16*this.EFS]}U.getY().toBytes(w);for(i=17*this.EFS;i<18*this.EFS;i++){t[i]=w[i-17*this.EFS]}if(sha==this.SHA256){H=new ctx.HASH256}else if(sha==this.SHA384){H=new ctx.HASH384}else if(sha==this.SHA512){H=new ctx.HASH512}H.process_array(t);h=H.hash();if(h.length==0){return null}R=[];for(i=0;i<ctx.ECP.AESKEY;i++){R[i]=h[i]}return R},hashit:function(sha,n,B){var R=[],H,W,i,len;if(sha==this.SHA256){H=new ctx.HASH256}else if(sha==this.SHA384){H=new ctx.HASH384}else if(sha==this.SHA512){H=new ctx.HASH512}if(n>0){H.process_num(n)}H.process_array(B);R=H.hash();if(R.length==0){return null}W=[];len=ctx.BIG.MODBYTES;if(sha>=len){for(i=0;i<len;i++){W[i]=R[i]}}else{for(i=0;i<sha;i++){W[i+len-sha]=R[i]}for(i=0;i<len-sha;i++){W[i]=0}}return W},map:function(u,cb){var P=new ctx.ECP,x=new ctx.BIG(u),p=new ctx.BIG(0);p.rcopy(ctx.ROM_FIELD.Modulus);x.mod(p);for(;;){P.setxi(x,cb);if(!P.is_infinity()){break}x.inc(1);x.norm()}return P},unmap:function(u,P){var s=P.getS(),R=new ctx.ECP,r=0,x=P.getX();u.copy(x);for(;;){u.dec(1);u.norm();r++;R.setxi(u,s);if(!R.is_infinity()){break}}return r},ENCODING:function(rng,E){var T=[],i,rn,m,su,sv,u,v,P,p,W;for(i=0;i<this.EFS;i++){T[i]=E[i+1]}u=ctx.BIG.fromBytes(T);for(i=0;i<this.EFS;i++){T[i]=E[i+this.EFS+1]}v=ctx.BIG.fromBytes(T);P=new ctx.ECP(0);P.setxy(u,v);if(P.is_infinity()){return this.INVALID_POINT}p=new ctx.BIG(0);p.rcopy(ctx.ROM_FIELD.Modulus);u=ctx.BIG.randomnum(p,rng);su=rng.getByte();if(su<0){su=-su}su%=2;W=this.map(u,su);P.sub(W);sv=P.getS();rn=this.unmap(v,P);m=rng.getByte();if(m<0){m=-m}m%=rn;v.inc(m+1);E[0]=su+2*sv;u.toBytes(T);for(i=0;i<this.EFS;i++){E[i+1]=T[i]}v.toBytes(T);for(i=0;i<this.EFS;i++){E[i+this.EFS+1]=T[i]}return 0},DECODING:function(D){var T=[],i,su,sv,u,v,W,P;if((D[0]&4)!==0){return this.INVALID_POINT}for(i=0;i<this.EFS;i++){T[i]=D[i+1]}u=ctx.BIG.fromBytes(T);for(i=0;i<this.EFS;i++){T[i]=D[i+this.EFS+1]}v=ctx.BIG.fromBytes(T);su=D[0]&1;sv=D[0]>>1&1;W=this.map(u,su);P=this.map(v,sv);P.add(W);u=P.getX();v=P.getY();D[0]=4;u.toBytes(T);for(i=0;i<this.EFS;i++){D[i+1]=T[i]}v.toBytes(T);for(i=0;i<this.EFS;i++){D[i+this.EFS+1]=T[i]}return 0},RECOMBINE_G1:function(R1,R2,R){var P=ctx.ECP.fromBytes(R1),Q=ctx.ECP.fromBytes(R2);if(P.is_infinity()||Q.is_infinity()){return this.INVALID_POINT}P.add(Q);P.toBytes(R,false);return 0},RECOMBINE_G2:function(W1,W2,W){var P=ctx.ECP8.fromBytes(W1),Q=ctx.ECP8.fromBytes(W2);if(P.is_infinity()||Q.is_infinity()){return this.INVALID_POINT}P.add(Q);P.toBytes(W);return 0},HASH_ID:function(sha,ID){return this.hashit(sha,0,ID)},RANDOM_GENERATE:function(rng,S){var r=new ctx.BIG(0),s;r.rcopy(ctx.ROM_CURVE.CURVE_Order);s=ctx.BIG.randomnum(r,rng);s.toBytes(S);return 0},EXTRACT_PIN:function(sha,CID,pin,TOKEN){return this.EXTRACT_FACTOR(sha,CID,pin%this.MAXPIN,this.PBLEN,TOKEN)},EXTRACT_FACTOR:function(sha,CID,factor,facbits,TOKEN){var P,R,h;P=ctx.ECP.fromBytes(TOKEN);if(P.is_infinity()){return this.INVALID_POINT}h=this.hashit(sha,0,CID);R=ctx.ECP.mapit(h);R=R.pinmul(factor,facbits);P.sub(R);P.toBytes(TOKEN,false);return 0},RESTORE_FACTOR:function(sha,CID,factor,facbits,TOKEN){var P,R,h;P=ctx.ECP.fromBytes(TOKEN);if(P.is_infinity()){return this.INVALID_POINT}h=this.hashit(sha,0,CID),R=ctx.ECP.mapit(h);R=R.pinmul(factor,facbits);P.add(R);P.toBytes(TOKEN,false);return 0},GET_SERVER_SECRET:function(S,SST){var s,Q;Q=ctx.ECP8.generator();s=ctx.BIG.fromBytes(S);Q=ctx.PAIR256.G2mul(Q,s);Q.toBytes(SST);return 0},GET_G1_MULTIPLE:function(rng,type,X,G,W){var r=new ctx.BIG(0),x,P;r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(rng!=null){x=ctx.BIG.randomnum(r,rng);x.toBytes(X)}else{x=ctx.BIG.fromBytes(X)}if(type==0){P=ctx.ECP.fromBytes(G);if(P.is_infinity()){return this.INVALID_POINT}}else{P=ctx.ECP.mapit(G)}ctx.PAIR256.G1mul(P,x).toBytes(W,false);return 0},GET_CLIENT_SECRET:function(S,CID,CST){return this.GET_G1_MULTIPLE(null,1,S,CID,CST)},GET_CLIENT_PERMIT:function(sha,date,S,CID,CTT){var h=this.hashit(sha,date,CID),P=ctx.ECP.mapit(h),s=ctx.BIG.fromBytes(S);P=ctx.PAIR256.G1mul(P,s);P.toBytes(CTT,false);return 0},CLIENT_1:function(sha,date,CLIENT_ID,rng,X,pin,TOKEN,SEC,xID,xCID,PERMIT){var r=new ctx.BIG(0),x,P,T,W,h;r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(rng!==null){x=ctx.BIG.randomnum(r,rng);x.toBytes(X)}else{x=ctx.BIG.fromBytes(X)}h=this.hashit(sha,0,CLIENT_ID);P=ctx.ECP.mapit(h);T=ctx.ECP.fromBytes(TOKEN);if(T.is_infinity()){return this.INVALID_POINT}pin%=this.MAXPIN;W=P.pinmul(pin,this.PBLEN);T.add(W);if(date!=0){W=ctx.ECP.fromBytes(PERMIT);if(W.is_infinity()){return this.INVALID_POINT}T.add(W);h=this.hashit(sha,date,h);W=ctx.ECP.mapit(h);if(xID!=null){P=ctx.PAIR256.G1mul(P,x);P.toBytes(xID,false);W=ctx.PAIR256.G1mul(W,x);P.add(W)}else{P.add(W);P=ctx.PAIR256.G1mul(P,x)}if(xCID!=null){P.toBytes(xCID,false)}}else{if(xID!=null){P=ctx.PAIR256.G1mul(P,x);P.toBytes(xID,false)}}T.toBytes(SEC,false);return 0},CLIENT_2:function(X,Y,SEC){var r=new ctx.BIG(0),P,px,py;r.rcopy(ctx.ROM_CURVE.CURVE_Order);P=ctx.ECP.fromBytes(SEC);if(P.is_infinity()){return this.INVALID_POINT}px=ctx.BIG.fromBytes(X);py=ctx.BIG.fromBytes(Y);px.add(py);px.mod(r);P=ctx.PAIR256.G1mul(P,px);P.neg();P.toBytes(SEC,false);return 0},SERVER_1:function(sha,date,CID,HID,HTID){var h=this.hashit(sha,0,CID),P=ctx.ECP.mapit(h),R;P.toBytes(HID,false);if(date!==0){h=this.hashit(sha,date,h);R=ctx.ECP.mapit(h);P.add(R);P.toBytes(HTID,false)}},SERVER_2:function(date,HID,HTID,Y,SST,xID,xCID,mSEC,E,F,Pa){var Q,sQ,R,y,P,g;if(typeof Pa==="undefined"||Pa==null){Q=ctx.ECP8.generator()}else{Q=ctx.ECP8.fromBytes(Pa);if(Q.is_infinity()){return this.INVALID_POINT}}sQ=ctx.ECP8.fromBytes(SST);if(sQ.is_infinity()){return this.INVALID_POINT}if(date!==0){R=ctx.ECP.fromBytes(xCID)}else{if(xID==null){return this.BAD_PARAMS}R=ctx.ECP.fromBytes(xID)}if(R.is_infinity()){return this.INVALID_POINT}y=ctx.BIG.fromBytes(Y);if(date!=0){P=ctx.ECP.fromBytes(HTID)}else{if(HID==null){return this.BAD_PARAMS}P=ctx.ECP.fromBytes(HID)}if(P.is_infinity()){return this.INVALID_POINT}P=ctx.PAIR256.G1mul(P,y);P.add(R);P.affine();R=ctx.ECP.fromBytes(mSEC);if(R.is_infinity()){return this.INVALID_POINT}g=ctx.PAIR256.ate2(Q,R,sQ,P);g=ctx.PAIR256.fexp(g);if(!g.isunity()){if(HID!=null&&xID!=null&&E!=null&&F!=null){g.toBytes(E);if(date!==0){P=ctx.ECP.fromBytes(HID);if(P.is_infinity()){return this.INVALID_POINT}R=ctx.ECP.fromBytes(xID);if(R.is_infinity()){return this.INVALID_POINT}P=ctx.PAIR256.G1mul(P,y);P.add(R);P.affine()}g=ctx.PAIR256.ate(Q,P);g=ctx.PAIR256.fexp(g);g.toBytes(F)}return this.BAD_PIN}return 0},KANGAROO:function(E,F){var ge=ctx.FP48.fromBytes(E),gf=ctx.FP48.fromBytes(F),distance=[],t=new ctx.FP48(gf),table=[],i,j,m,s,dn,dm,res,steps;s=1;for(m=0;m<this.TS;m++){distance[m]=s;table[m]=new ctx.FP48(t);s*=2;t.usqr()}t.one();dn=0;for(j=0;j<this.TRAP;j++){i=t.geta().geta().geta().geta().getA().lastbits(20)%this.TS;t.mul(table[i]);dn+=distance[i]}gf.copy(t);gf.conj();steps=0;dm=0;res=0;while(dm-dn<this.MAXPIN){steps++;if(steps>4*this.TRAP){break}i=ge.geta().geta().geta().geta().getA().lastbits(20)%this.TS;ge.mul(table[i]);dm+=distance[i];if(ge.equals(t)){res=dm-dn;break}if(ge.equals(gf)){res=dn-dm;break}}if(steps>4*this.TRAP||dm-dn>=this.MAXPIN){res=0}return res},GET_TIME:function(){var now=new Date;return Math.floor(now.getTime()/1e3)},GET_Y:function(sha,TimeValue,xCID,Y){var q=new ctx.BIG(0),h=this.hashit(sha,TimeValue,xCID),y=ctx.BIG.fromBytes(h);q.rcopy(ctx.ROM_CURVE.CURVE_Order);y.mod(q);y.toBytes(Y);return 0},CLIENT:function(sha,date,CLIENT_ID,rng,X,pin,TOKEN,SEC,xID,xCID,PERMIT,TimeValue,Y,Message){var rtn=0,M=[],pID,i;if(date==0){pID=xID}else{pID=xCID;xID=null}rtn=this.CLIENT_1(sha,date,CLIENT_ID,rng,X,pin,TOKEN,SEC,xID,xCID,PERMIT);if(rtn!=0){return rtn}M=pID.slice();if(typeof Message!=="undefined"||Message!=null){for(i=0;i<Message.length;i++){M.push(Message[i])}}this.GET_Y(sha,TimeValue,M,Y);rtn=this.CLIENT_2(X,Y,SEC);if(rtn!=0){return rtn}return 0},SERVER:function(sha,date,HID,HTID,Y,SST,xID,xCID,mSEC,E,F,CID,TimeValue,Message,Pa){var rtn=0,M=[],pID,i;if(date==0){pID=xID}else{pID=xCID}this.SERVER_1(sha,date,CID,HID,HTID);M=pID.slice();if(typeof Message!=="undefined"||Message!=null){for(i=0;i<Message.length;i++){M.push(Message[i])}}this.GET_Y(sha,TimeValue,M,Y);rtn=this.SERVER_2(date,HID,HTID,Y,SST,xID,xCID,mSEC,E,F,Pa);if(rtn!=0){return rtn}return 0},PRECOMPUTE:function(TOKEN,CID,G1,G2){var P,T,g,Q;T=ctx.ECP.fromBytes(TOKEN);if(T.is_infinity()){return this.INVALID_POINT}P=ctx.ECP.mapit(CID);Q=ctx.ECP8.generator();g=ctx.PAIR256.ate(Q,T);g=ctx.PAIR256.fexp(g);g.toBytes(G1);g=ctx.PAIR256.ate(Q,P);g=ctx.PAIR256.fexp(g);g.toBytes(G2);return 0},HASH_ALL:function(sha,HID,xID,xCID,SEC,Y,R,W){var tlen=0,T=[],i;for(i=0;i<HID.length;i++){T[i]=HID[i]}tlen+=HID.length;if(xCID!=null){for(i=0;i<xCID.length;i++){T[i+tlen]=xCID[i]}tlen+=xCID.length}else{for(i=0;i<xID.length;i++){T[i+tlen]=xID[i]}tlen+=xID.length}for(i=0;i<SEC.length;i++){T[i+tlen]=SEC[i]}tlen+=SEC.length;for(i=0;i<Y.length;i++){T[i+tlen]=Y[i]}tlen+=Y.length;for(i=0;i<R.length;i++){T[i+tlen]=R[i]}tlen+=R.length;for(i=0;i<W.length;i++){T[i+tlen]=W[i]}tlen+=W.length;return this.hashit(sha,0,T)},CLIENT_KEY:function(sha,G1,G2,pin,R,X,H,wCID,CK){var t=[],g1=ctx.FP48.fromBytes(G1),g2=ctx.FP48.fromBytes(G2),z=ctx.BIG.fromBytes(R),x=ctx.BIG.fromBytes(X),h=ctx.BIG.fromBytes(H),W=ctx.ECP.fromBytes(wCID),r,c,i;if(W.is_infinity()){return this.INVALID_POINT}W=ctx.PAIR256.G1mul(W,x);r=new ctx.BIG(0);r.rcopy(ctx.ROM_CURVE.CURVE_Order);z.add(h);z.mod(r);g2.pinpow(pin,this.PBLEN);g1.mul(g2);c=g1.compow(z,r);t=this.mpin_hash(sha,c,W);for(i=0;i<ctx.ECP.AESKEY;i++){CK[i]=t[i]}return 0},SERVER_KEY:function(sha,Z,SST,W,H,HID,xID,xCID,SK){var t=[],sQ,R,A,U,w,h,g,c,i;sQ=ctx.ECP8.fromBytes(SST);if(sQ.is_infinity()){return this.INVALID_POINT}R=ctx.ECP.fromBytes(Z);if(R.is_infinity()){return this.INVALID_POINT}A=ctx.ECP.fromBytes(HID);if(A.is_infinity()){return this.INVALID_POINT}if(xCID!=null){U=ctx.ECP.fromBytes(xCID)}else{U=ctx.ECP.fromBytes(xID)}if(U.is_infinity()){return this.INVALID_POINT}w=ctx.BIG.fromBytes(W);h=ctx.BIG.fromBytes(H);A=ctx.PAIR256.G1mul(A,h);R.add(A);R.affine();U=ctx.PAIR256.G1mul(U,w);g=ctx.PAIR256.ate(sQ,R);g=ctx.PAIR256.fexp(g);c=g.trace();t=this.mpin_hash(sha,c,U);for(i=0;i<ctx.ECP.AESKEY;i++){SK[i]=t[i]}return 0},GET_DVS_KEYPAIR:function(rng,Z,Pa){var r=new ctx.BIG(0),z,Q;r.rcopy(ctx.ROM_CURVE.CURVE_Order);if(rng!=null){z=ctx.BIG.randomnum(r,rng);z.toBytes(Z)}else{z=ctx.BIG.fromBytes(Z)}z.invmodp(r);Q=ctx.ECP8.generator();Q=ctx.PAIR256.G2mul(Q,z);Q.toBytes(Pa);return 0}};return MPIN256}function NHS(ctx){var NHS={round:function(a,b){return Math.floor((a+(b>>1))/b)},nabs:function(x){var mask=x>>31;return x+mask^mask},redc:function(T){var m=(T&67108863)*NHS.ND&67108863;return(m*NHS.PRIME+T)*NHS.MODINV},nres:function(x){return NHS.redc(x*NHS.R2MODP)},modmul:function(a,b){return NHS.redc(a*b)},ntt:function(x){var t=NHS.DEGREE/2,q=NHS.PRIME,m,i,j,k,S,U,V;for(j=0;j<NHS.DEGREE;j++){x[j]=NHS.nres(x[j])}m=1;while(m<NHS.DEGREE){k=0;for(i=0;i<m;i++){S=NHS.roots[m+i];for(j=k;j<k+t;j++){U=x[j];V=NHS.modmul(x[j+t],S);x[j]=U+V;x[j+t]=U+2*q-V}k+=2*t}t/=2;m*=2}},intt:function(x){var q=NHS.PRIME,t=1,m,i,j,k,S,U,V,W;m=NHS.DEGREE/2;while(m>1){k=0;for(i=0;i<m;i++){S=NHS.iroots[m+i];for(j=k;j<k+t;j++){U=x[j];V=x[j+t];x[j]=U+V;W=U+NHS.DEGREE*q-V;x[j+t]=NHS.modmul(W,S)}k+=2*t}t*=2;m/=2}t=NHS.DEGREE/2;for(j=0;j<t;j++){U=x[j];V=x[j+t];W=U+NHS.DEGREE*q-V;x[j+t]=NHS.modmul(W,NHS.invpr);x[j]=NHS.modmul(U+V,NHS.inv)}for(j=0;j<NHS.DEGREE;j++){x[j]=NHS.redc(x[j]);x[j]-=q;x[j]+=x[j]>>NHS.WL-1&q}},Encode:function(key,poly){var i,j,b,k,kj,q2;q2=NHS.PRIME/2;for(i=j=0;i<256;){kj=key[j++];for(k=0;k<8;k++){b=kj&1;poly[i]=b*q2;poly[i+256]=b*q2;poly[i+512]=b*q2;poly[i+768]=b*q2;kj>>=1;i++}}},Decode:function(poly,key){var q2=NHS.PRIME/2,i,j,k,b,t;for(i=0;i<32;i++){key[i]=0}for(i=j=0;i<256;){for(k=0;k<8;k++){t=NHS.nabs(poly[i]-q2)+NHS.nabs(poly[i+256]-q2)+NHS.nabs(poly[i+512]-q2)+NHS.nabs(poly[i+768]-q2);b=t-NHS.PRIME;b=b>>31&1;key[j]=((key[j]&255)>>1)+(b<<7);i++}j++}},Parse:function(seed,poly){var sh=new ctx.SHA3(ctx.SHA3.SHAKE128),hash=[],i,j,n;for(i=0;i<32;i++){sh.process(seed[i])}sh.shake(hash,4*NHS.DEGREE);for(i=j=0;i<NHS.DEGREE;i++){n=hash[j]&127;n<<=8;n+=hash[j+1]&255;n<<=8;n+=hash[j+2]&255;n<<=8;n+=hash[j+3]&255;j+=4;poly[i]=NHS.nres(n)}},pack:function(poly,array){var i,j,a,b,c,d;for(i=j=0;i<NHS.DEGREE;){a=poly[i++];b=poly[i++];c=poly[i++];d=poly[i++];array[j++]=a&255;array[j++]=(a>>8|b<<6)&255;array[j++]=b>>2&255;array[j++]=(b>>10|c<<4)&255;array[j++]=c>>4&255;array[j++]=(c>>12|d<<2)&255;array[j++]=d>>6}},unpack:function(array,poly){var i,j,a,b,c,d,e,f,g;for(i=j=0;i<NHS.DEGREE;){a=array[j++]&255;b=array[j++]&255;c=array[j++]&255;d=array[j++]&255;e=array[j++]&255;f=array[j++]&255;g=array[j++]&255;poly[i++]=a|(b&63)<<8;poly[i++]=b>>6|c<<2|(d&15)<<10;poly[i++]=d>>4|e<<4|(f&3)<<12;poly[i++]=f>>2|g<<6}},Compress:function(poly,array){var col=0,i,j,k,b;for(i=j=0;i<NHS.DEGREE;){for(k=0;k<8;k++){b=NHS.round(poly[i]*8,NHS.PRIME)&7;col=(col<<3)+b;i++}array[j]=col&255;array[j+1]=col>>>8&255;array[j+2]=col>>>16&255;j+=3;col=0}},Decompress:function(array,poly){var col=0,i,j,k,b;for(i=j=0;i<NHS.DEGREE;){col=array[j+2]&255;col=(col<<8)+(array[j+1]&255);col=(col<<8)+(array[j]&255);j+=3;for(k=0;k<8;k++){b=(col&14680064)>>>21;col<<=3;poly[i]=NHS.round(b*NHS.PRIME,8);i++}}},Error:function(RNG,poly){var n1,n2,r,i,j;for(i=0;i<NHS.DEGREE;i++){n1=RNG.getByte()+(RNG.getByte()<<8);n2=RNG.getByte()+(RNG.getByte()<<8);r=0;for(j=0;j<16;j++){r+=(n1&1)-(n2&1);n1>>=1;n2>>=1}poly[i]=r+NHS.PRIME}},redc_it:function(p){var i;for(i=0;i<NHS.DEGREE;i++){p[i]=NHS.redc(p[i])}},nres_it:function(p){var i;for(i=0;i<NHS.DEGREE;i++){p[i]=NHS.nres(p[i])}},poly_mul:function(p1,p2,p3){var i;for(i=0;i<NHS.DEGREE;i++){p1[i]=NHS.modmul(p2[i],p3[i])}},poly_add:function(p1,p2,p3){var i;for(i=0;i<NHS.DEGREE;i++){p1[i]=p2[i]+p3[i]}},poly_sub:function(p1,p2,p3){var i;for(i=0;i<NHS.DEGREE;i++){p1[i]=p2[i]+NHS.PRIME-p3[i]}},poly_soft_reduce:function(poly){var i,e;for(i=0;i<NHS.DEGREE;i++){e=poly[i]-NHS.PRIME;poly[i]=e+(e>>NHS.WL-1&NHS.PRIME)}},poly_hard_reduce:function(poly){var i,e;for(i=0;i<NHS.DEGREE;i++){e=NHS.modmul(poly[i],NHS.ONE);e=e-NHS.PRIME;poly[i]=e+(e>>NHS.WL-1&NHS.PRIME)}},bytestostring:function(b){var s="",len=b.length,ch,i;for(i=0;i<len;i++){ch=b[i];s+=(ch>>>4&15).toString(16);s+=(ch&15).toString(16)}return s},SERVER_1:function(RNG,SB,S){var seed=new Uint8Array(32),array=new Uint8Array(1792),s=new Int32Array(NHS.DEGREE),e=new Int32Array(NHS.DEGREE),b=new Int32Array(NHS.DEGREE),i;for(i=0;i<32;i++){seed[i]=RNG.getByte()}NHS.Parse(seed,b);NHS.Error(RNG,e);NHS.Error(RNG,s);NHS.ntt(s);NHS.ntt(e);NHS.poly_mul(b,b,s);NHS.poly_add(b,b,e);NHS.poly_hard_reduce(b);NHS.redc_it(b);NHS.pack(b,array);for(i=0;i<32;i++){SB[i]=seed[i]}for(i=0;i<1792;i++){SB[i+32]=array[i]}NHS.poly_hard_reduce(s);NHS.pack(s,array);for(i=0;i<1792;i++){S[i]=array[i]}},CLIENT:function(RNG,SB,UC,KEY){
var sh=new ctx.SHA3(ctx.SHA3.HASH256),seed=new Uint8Array(32),array=new Uint8Array(1792),key=new Uint8Array(32),cc=new Uint8Array(384),sd=new Int32Array(NHS.DEGREE),ed=new Int32Array(NHS.DEGREE),u=new Int32Array(NHS.DEGREE),k=new Int32Array(NHS.DEGREE),c=new Int32Array(NHS.DEGREE),i;NHS.Error(RNG,sd);NHS.Error(RNG,ed);NHS.ntt(sd);NHS.ntt(ed);for(i=0;i<32;i++){seed[i]=SB[i]}for(i=0;i<1792;i++){array[i]=SB[i+32]}NHS.Parse(seed,u);NHS.poly_mul(u,u,sd);NHS.poly_add(u,u,ed);NHS.poly_hard_reduce(u);for(i=0;i<32;i++){key[i]=RNG.getByte()}for(i=0;i<32;i++){sh.process(key[i])}sh.hash(key);NHS.Encode(key,k);NHS.unpack(array,c);NHS.nres_it(c);NHS.poly_mul(c,c,sd);NHS.intt(c);NHS.Error(RNG,ed);NHS.poly_add(c,c,ed);NHS.poly_add(c,c,k);NHS.Compress(c,cc);sh.init(ctx.SHA3.HASH256);for(i=0;i<32;i++){sh.process(key[i])}sh.hash(key);for(i=0;i<32;i++){KEY[i]=key[i]}NHS.redc_it(u);NHS.pack(u,array);for(i=0;i<1792;i++){UC[i]=array[i]}for(i=0;i<384;i++){UC[i+1792]=cc[i]}},SERVER_2:function(S,UC,KEY){var sh=new ctx.SHA3(ctx.SHA3.HASH256),c=new Int32Array(NHS.DEGREE),s=new Int32Array(NHS.DEGREE),k=new Int32Array(NHS.DEGREE),array=new Uint8Array(1792),key=new Uint8Array(32),cc=new Uint8Array(384),i;for(i=0;i<1792;i++){array[i]=UC[i]}NHS.unpack(array,k);NHS.nres_it(k);for(i=0;i<384;i++){cc[i]=UC[i+1792]}NHS.Decompress(cc,c);for(i=0;i<1792;i++){array[i]=S[i]}NHS.unpack(array,s);NHS.poly_mul(k,k,s);NHS.intt(k);NHS.poly_sub(k,c,k);NHS.poly_soft_reduce(k);NHS.Decode(k,key);for(i=0;i<32;i++){sh.process(key[i])}sh.hash(key);for(i=0;i<32;i++){KEY[i]=key[i]}}};NHS.PRIME=12289;NHS.LGN=10;NHS.ND=50343935;NHS.ONE=10924;NHS.R2MODP=7586;NHS.MODINV=Math.pow(2,-26);NHS.DEGREE=1024;NHS.WL=26;NHS.inv=4091;NHS.invpr=4401;NHS.roots=[10924,3439,7271,11355,11709,9879,10742,2259,7036,2539,8427,9802,10192,4635,1420,1239,6050,10731,7026,5040,6577,5505,10953,9704,9373,11614,867,8052,8079,8356,11442,11524,5127,11769,941,9207,6770,2705,895,3507,8981,1510,2703,8477,3501,7979,11817,9904,8201,12253,10369,921,1414,10113,10933,2417,9035,7667,7466,5597,6765,10100,2047,7870,560,7412,6155,2904,6540,11072,4731,7581,4991,4e3,324,75,12204,2825,7295,437,3820,3160,4680,9276,4234,5304,233,11774,251,9730,10988,7095,4248,9176,1923,6931,8295,8406,5916,4,1634,4247,9401,7069,10180,10094,1727,1879,11798,1138,7441,5705,10500,3796,1733,5294,12024,10976,11900,10037,4486,1266,6075,10623,7623,6885,10819,11266,3798,11120,7291,6353,8366,1709,9220,4410,8350,795,5533,1167,3593,7090,5367,901,452,7387,8918,8664,12,6830,11982,11649,3414,1473,4826,2255,5637,7108,6327,6585,8638,4958,10454,10385,8712,6113,10609,2342,8475,255,1311,2693,225,11317,9605,289,3623,11876,10744,11590,3250,10538,829,2809,2950,11834,8504,6520,8996,3903,11536,7677,5059,1740,6777,4641,9487,2765,4095,1972,1616,6291,3717,8029,4828,11586,3470,4672,4226,4847,4534,4008,2831,3500,6428,4674,490,341,9994,2541,11867,9688,8748,2025,8115,4268,10521,9604,3043,9466,9197,1560,11648,1786,5134,1416,853,4180,9924,7759,5761,8047,7251,4068,2763,5760,12264,108,5722,4283,11321,6148,4502,2180,9762,1577,6849,8754,12187,3390,8447,4800,10220,90,672,1521,7386,1027,7848,5913,8135,11555,1514,9681,182,1180,2759,11676,8270,8514,4584,3792,5616,1300,2623,3907,7653,11671,5443,11387,9242,8739,12216,9655,6988,12086,9954,256,9557,9836,11792,10012,1450,6025,8601,10525,4232,8262,7841,3977,7290,7832,311,7013,9453,3895,11971,3340,1991,4671,2862,6807,6659,7117,946,1812,10617,2799,11068,11665,3587,3675,8124,3246,1074,9124,2845,7372,8118,12120,10842,1827,11417,11632,10,9788,9985,3563,11528,7220,8204,7816,918,6357,7237,196,6332,11479,5956,2289,7260,3046,10889,6048,519,6606,8228,9187,10651,1669,11183,1337,11593,9397,5517,253,10901,589,2739,4389,4857,5562,1704,11318,1767,4164,878,4072,4397,10007,9376,7177,3613,2088,759,8027,4011,3318,4914,7282,9859,5582,6867,6710,588,2867,9535,5507,7529,10732,2983,12183,5855,4200,2798,3151,5436,9451,8397,5016,9062,4601,3703,4157,9738,206,2794,9067,11025,1528,3663,1872,5481,4341,10318,2616,11782,224,3754,2462,9371,2283,11159,12255,10689,6912,12259,7503,2111,11526,270,6207,10170,306,4031,10605,5450,1034,10087,173,3081,2420,10273,7726,10450,4012,964,12057,3540,11743,7747,7824,11721,4420,10435,1619,3900,7730,10826,913,4387,219,11680,3614,1639,9141,8249,2706,5458,1491,5786,7939,4930,8196,7005,11521,11931,1055,11207,2708,208,11882,11064,5292,10020,954,1724,6316,11685,8508,11356,3539,2734,11784,1741,5751,8229,7708,1460,3524,96,5484,9833,7169,9899,7867,9940,8673,5483,1383,26,10702,9172,1668,2937,6483,4166,7564,6069,7208,7397,9336,6360,6934,11311,8649,6587,3004,10523,6646,6265,12260,1422,10570,6632,10183,12218,6697,8985,7883,8251,12037,11138,6447,9898,9346,2797,4630,1800,4513,3106,2312,10488,9255,2040,5934,3920,2728,6218,8039,8913,3770,8539,3911,10359,3422,2268,525,11694,7486,1909,3059,2162,9831,8182,3487,5060,261,1631,8684,1757,6665,3182,509,5158,2787,1172,11650,8909,9686,4545,28,11438,5151,4362,327,9815,9213,12089,864,8852,7966,2931,3068,12055,1994,12131,191,10434,3098,9566,8814,6824,8862,5658,627,4205,11328,1999,5128,2008,4106,1881,7604,9406,11963,3095,6292,9294,5565,1864,8169,573,474,702,6307,3164,2553,981,11492,84,10943,10140,7809,11609,10311,9204,3496,2592,600,7422,9228,11310,10128,11733,11250,11828,5924,529,4105,10169,1785,9177,6562,1575,5485,5790,2023,783,9398,1474,7396,10461,32,5803,7374,8361,9104,10372,8773,1527,2743,7018,4583,10835,12180,10572,7909,4964,7066,4087,1515,11312,7170,1441,7047,9218,7368,12001,8126,5004,9351,7160,3478,7528,12211,8129,8140,3430,2387,8513,5498,9335,6371,12080,1886,7649,5298,12202,5783,9012,4817,2934,10920,7802,213,11360,9912,5971,4682,8023,5157,3460,7173,1601,3898,7052,3453,12114,756,3187,5403,5513,6169,6936,2971,6889,11039,11076,12122,11575,11441,9973,9022,10095,630,4704,10647,2546,7189,5780,4524,7789,7151,10598,6322,1274,8260,7024,7998,8734,10442,7510,1966,2445,9100,6072,2771,4415,7963,1234,5975,3249,12017,11778,6140,12049,10868,8233,1792,5454,7407,8810,8639,10150,5308,11051,12230,5046,8678,5731,3261,1874,5668,2177,12224,4726,2687,10063,11091,1648,8119,7745,10782,9746,663,6622,395,585,7304,3742,7921,531,1147,7712,10433,7518,2423,7626,2448,7670,11106,2160,500,6185,7690,70,7071,8450,363,6962,1384,8272,5556,6426,7632,1503,1372,7457,6619,4825,3734,1664,9033,2489,5469,3633,9375,8440,2864,823,11683,4547,9359,7417,4334,1752,1771,2573,4123,6884,6145,9421,2067,11928,5492,80,4570,6146,3926,6201,8604,4187,1083,713,2327,5313,7033,3499,10937,9820,1818,7568,2207,11202,10103,4116,7780,5300,1682,3547,1390,8592,11547,4118,4822,7297,9768,1185,4712,9623,10534,1989,7629,1343,4521,6721,1442,7269,2024,3441,10696,1063,815,1500,5809,10781,6023,8740,1568,1700,4945,4152,3692,4379,12051,1089,11517,12079,3365,2488,6948,1890,6582,9745,2142,3639,501,1283,7238,9164,1211,9278,4651,10466,4926,11705,3506,6748,10665,202,8467,5073,5612,8313,6362,11600,11333,2722,4954,2048,6391,6131,1533,8026,720,11473,2542,8587,6653,1339,10437,3635,6417,9932,8216,12168,6913,9783,7385,4715,6667,1456,9440,3714,177,8695,6678,12068,7345,8061,10400,5758,195];NHS.iroots=[10924,8850,934,5018,10030,1547,2410,580,11050,10869,7654,2097,2487,3862,9750,5253,765,847,3933,4210,4237,11422,675,2916,2585,1336,6784,5712,7249,5263,1558,6239,4419,10242,2189,5524,6692,4823,4622,3254,9872,1356,2176,10875,11368,1920,36,4088,2385,472,4310,8788,3812,9586,10779,3308,8782,11394,9584,5519,3082,11348,520,7162,1023,1470,5404,4666,1666,6214,11023,7803,2252,389,1313,265,6995,10556,8493,1789,6584,4848,11151,491,10410,10562,2195,2109,5220,2888,8042,10655,12285,6373,3883,3994,5358,10366,3113,8041,5194,1301,2559,12038,515,12056,6985,8055,3013,7609,9129,8469,11852,4994,9464,85,12214,11965,8289,7298,4708,7558,1217,5749,9385,6134,4877,11729,10712,2527,10109,7787,6141,968,8006,6567,12181,25,6529,9526,8221,5038,4242,6528,4530,2365,8109,11436,10873,7155,10503,641,10729,3092,2823,9246,2685,1768,8021,4174,10264,3541,2601,422,9748,2295,11948,11799,7615,5861,8789,9458,8281,7755,7442,8063,7617,8819,703,7461,4260,8572,5998,10673,10317,8194,9524,2802,7648,5512,10549,7230,4612,753,8386,3293,5769,3785,455,9339,9480,11460,1751,9039,699,1545,413,8666,12e3,2684,972,12064,9596,10978,12034,3814,9947,1680,6176,3577,1904,1835,7331,3651,5704,5962,5181,6652,10034,7463,10816,8875,640,307,5459,12277,3625,3371,4902,11837,11388,6922,5199,8696,11122,6756,11494,3939,7879,3069,10580,3923,5936,4998,1169,8491,8750,933,3781,604,5973,10565,11335,2269,6997,1225,407,12081,9581,1082,11234,358,768,5284,4093,7359,4350,6503,10798,6831,9583,4040,3148,10650,8675,609,12070,7902,11376,1463,4559,8389,10670,1854,7869,568,4465,4542,546,8749,232,11325,8277,1839,4563,2016,9869,9208,12116,2202,11255,6839,1684,8258,11983,2119,6082,12019,763,10178,4786,30,5377,1600,34,1130,10006,2918,9827,8535,12065,507,9673,1971,7948,6808,10417,8626,10761,1264,3222,9495,12083,2551,8132,8586,7688,3227,7273,3892,2838,6853,9138,9491,8089,6434,106,9306,1557,4760,6782,2754,9422,11701,5579,5422,6707,2430,5007,7375,8971,8278,4262,11530,10201,8676,5112,2913,2282,7892,8217,11411,8125,10522,971,10585,6727,7432,7900,9550,11700,1388,12036,6772,2892,696,10952,1106,10620,1638,3102,4061,5683,11770,6241,1400,9243,5029,1e4,6333,810,5957,12093,5052,5932,11371,4473,4085,5069,761,8726,2304,2501,12279,657,872,10462,1447,169,4171,4917,9444,3165,11215,9043,4165,8614,8702,624,1221,9490,1672,10477,11343,5172,5630,5482,9427,7618,10298,8949,318,8394,2836,5276,11978,4457,4999,8312,4448,4027,8057,1764,3688,6264,10839,2277,497,2453,2732,12033,2335,203,5301,2634,73,3550,3047,902,6846,618,4636,8382,9666,10989,6673,8497,7705,3775,4019,613,9530,11109,12107,2608,10775,734,4154,6376,4441,11262,4903,10768,11617,12199,2069,7489,3842,8899,102,3535,5440,12094,6531,1889,4228,4944,221,5611,3594,12112,8575,2849,10833,5622,7574,4904,2506,5376,121,4073,2357,5872,8654,1852,10950,5636,3702,9747,816,11569,4263,10756,6158,5898,10241,7335,9567,956,689,5927,3976,6677,7216,3822,12087,1624,5541,8783,584,7363,1823,7638,3011,11078,3125,5051,11006,11788,8650,10147,2544,5707,10399,5341,9801,8924,210,772,11200,238,7910,8597,8137,7344,10589,10721,3549,6266,1508,6480,10789,11474,11226,1593,8848,10265,5020,10847,5568,7768,10946,4660,10300,1755,2666,7577,11104,2521,4992,7467,8171,742,3697,10899,8742,10607,6989,4509,8173,2186,1087,10082,4721,10471,2469,1352,8790,5256,6976,9962,11576,11206,8102,3685,6088,8363,6143,7719,12209,6797,361,10222,2868,6144,5405,8166,9716,10518,10537,7955,4872,2930,7742,606,11466,9425,3849,2914,8656,6820,9800,3256,10625,8555,7464,5670,4832,10917,10786,4657,5863,6733,4017,10905,5327,11926,3839,5218,12219,4599,6104,11789,10129,1183,4619,9841,4663,9866,4771,1856,4577,11142,11758,4368,8547,4985,11704,11894,5667,11626,2543,1507,4544,4170,10641,1198,2226,9602,7563,65,10112,6621,10415,9028,6558,3611,7243,59,1238,6981,2139,3650,3479,4882,6835,10497,4056,1421,240,6149,511,272,9040,6314,11055,4326,7874,9518,6217,3189,9844,10323,4779,1847,3555,4291,5265,4029,11015,5967,1691,5138,4500,7765,6509,5100,9743,1642,7585,11659,2194,3267,2316,848,714,167,1213,1250,5400,9318,5353,6120,6776,6886,9102,11533,175,8836,5237,8391,10688,5116,8829,7132,4266,7607,6318,2377,929,12076,4487,1369,9355,7472,3277,6506,87,6991,4640,10403,209,5918,2954,6791,3776,9902,8859,4149,4160,78,4761,8811,5129,2938,7285,4163,288,4921,3071,5242,10848,5119,977,10774,8202,5223,7325,4380,1717,109,1454,7706,5271,9546,10762,3516,1917,3185,3928,4915,6486,12257,1828,4893,10815,2891,11506,10266,6499,6804,10714,5727,3112,10504,2120,8184,11760,6365,461,1039,556,2161,979,3061,4867,11689,9697,8793,3085,1978,680,4480,2149,1346,12205,797,11308,9736,9125,5982,11587,11815,11716,4120,10425,6724,2995,5997,9194,326,2883,4685,10408,8183,10281,7161,10290,961,8084,11662,6631,3427,5465,3475,2723,9191,1855,12098,158,10295,234,9221,9358,4323,3437,11425,200,3076,2474,11962,7927,7138,851,12261,7744,2603,3380,639,11117,9502,7131,11780,9107,5624,10532,3605,10658,12028,7229,8802,4107,2458,10127,9230,10380,4803,595,11764,10021,8867,1930,8378,3750,8519,3376,4250,6071,9561,8369,6355,10249,3034,1801,9977,9183,7776,10489,7659,9492,2943,2391,5842,1151,252,4038,4406,3304,5592,71,2106,5657,1719,10867,29,6024,5643,1766,9285,5702,3640,978,5355,5929,2953,4892,5081,6220,4725,8123,5806,9352,10621,3117,1587,12263,10906,6806,3616,2349,4422,2390,5120,2456,6805,12193,8765,10829,4581,4060,6538,10548,505,9555];return NHS}function PAIR(ctx){var PAIR={line:function(A,B,Qx,Qy){var r=new ctx.FP12(1),c=new ctx.FP4(0),XX,YY,ZZ,YZ,sb,X1,Y1,T1,T2,a,b;if(A==B){XX=new ctx.FP2(A.getx());YY=new ctx.FP2(A.gety());ZZ=new ctx.FP2(A.getz());YZ=new ctx.FP2(YY);YZ.mul(ZZ);XX.sqr();YY.sqr();ZZ.sqr();YZ.imul(4);YZ.neg();YZ.norm();YZ.pmul(Qy);XX.imul(6);XX.pmul(Qx);sb=3*ctx.ROM_CURVE.CURVE_B_I;ZZ.imul(sb);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){ZZ.div_ip2()}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){ZZ.mul_ip();ZZ.add(ZZ);YZ.mul_ip();YZ.norm()}ZZ.norm();YY.add(YY);ZZ.sub(YY);ZZ.norm();a=new ctx.FP4(YZ,ZZ);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){b=new ctx.FP4(XX);c=new ctx.FP4(0)}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){b=new ctx.FP4(0);c=new ctx.FP4(XX);c.times_i()}A.dbl()}else{X1=new ctx.FP2(A.getx());Y1=new ctx.FP2(A.gety());T1=new ctx.FP2(A.getz());T2=new ctx.FP2(A.getz());T1.mul(B.gety());T2.mul(B.getx());X1.sub(T2);X1.norm();Y1.sub(T1);Y1.norm();T1.copy(X1);X1.pmul(Qy);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){X1.mul_ip();X1.norm()}T1.mul(B.gety());T2.copy(Y1);T2.mul(B.getx());T2.sub(T1);T2.norm();Y1.pmul(Qx);Y1.neg();Y1.norm();a=new ctx.FP4(X1,T2);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){b=new ctx.FP4(Y1);c=new ctx.FP4(0)}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){b=new ctx.FP4(0);c=new ctx.FP4(Y1);c.times_i()}A.add(B)}r.set(a,b,c);return r},ate:function(P,Q){var fa,fb,f,x,n,n3,K,lv,Qx,Qy,A,r,nb,bt,i;x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);n=new ctx.BIG(x);K=new ctx.ECP2;if(ctx.ECP.CURVE_PAIRING_TYPE==ctx.ECP.BN){fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){f.inverse();f.norm()}n.pmul(6);if(ctx.ECP.SIGN_OF_X==ctx.ECP.POSITIVEX){n.inc(2)}else{n.dec(2)}}else{n.copy(x)}n.norm();n3=new ctx.BIG(n);n3.pmul(3);n3.norm();Qx=new ctx.FP(Q.getx());Qy=new ctx.FP(Q.gety());A=new ctx.ECP2;r=new ctx.FP12(1);A.copy(P);nb=n3.nbits();for(i=nb-2;i>=1;i--){r.sqr();lv=PAIR.line(A,A,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);bt=n3.bit(i)-n.bit(i);if(bt==1){lv=PAIR.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST)}if(bt==-1){P.neg();lv=PAIR.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);P.neg()}}if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){r.conj()}if(ctx.ECP.CURVE_PAIRING_TYPE==ctx.ECP.BN){if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){A.neg()}K.copy(P);K.frob(f);lv=PAIR.line(A,K,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);K.frob(f);K.neg();lv=PAIR.line(A,K,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST)}return r},ate2:function(P,Q,R,S){var fa,fb,f,x,n,n3,K,lv,Qx,Qy,Sx,Sy,A,B,r,nb,bt,i;x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);n=new ctx.BIG(x);K=new ctx.ECP2;if(ctx.ECP.CURVE_PAIRING_TYPE==ctx.ECP.BN){fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){f.inverse();f.norm()}n.pmul(6);if(ctx.ECP.SIGN_OF_X==ctx.ECP.POSITIVEX){n.inc(2)}else{n.dec(2)}}else{n.copy(x)}n.norm();n3=new ctx.BIG(n);n3.pmul(3);n3.norm();Qx=new ctx.FP(Q.getx());Qy=new ctx.FP(Q.gety());Sx=new ctx.FP(S.getx());Sy=new ctx.FP(S.gety());A=new ctx.ECP2;B=new ctx.ECP2;r=new ctx.FP12(1);A.copy(P);B.copy(R);nb=n3.nbits();for(i=nb-2;i>=1;i--){r.sqr();lv=PAIR.line(A,A,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);lv=PAIR.line(B,B,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);bt=n3.bit(i)-n.bit(i);if(bt==1){lv=PAIR.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);lv=PAIR.line(B,R,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST)}if(bt==-1){P.neg();lv=PAIR.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);P.neg();R.neg();lv=PAIR.line(B,R,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);R.neg()}}if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){r.conj()}if(ctx.ECP.CURVE_PAIRING_TYPE==ctx.ECP.BN){if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){A.neg();B.neg()}K.copy(P);K.frob(f);lv=PAIR.line(A,K,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);K.frob(f);K.neg();lv=PAIR.line(A,K,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);K.copy(R);K.frob(f);lv=PAIR.line(B,K,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);K.frob(f);K.neg();lv=PAIR.line(B,K,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST)}return r},fexp:function(m){var fa,fb,f,x,r,lv,x0,x1,x2,x3,x4,x5,y0,y1,y2,y3;fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);r=new ctx.FP12(m);lv=new ctx.FP12(r);lv.inverse();r.conj();r.mul(lv);lv.copy(r);r.frob(f);r.frob(f);r.mul(lv);if(ctx.ECP.CURVE_PAIRING_TYPE==ctx.ECP.BN){lv.copy(r);lv.frob(f);x0=new ctx.FP12(lv);x0.frob(f);lv.mul(r);x0.mul(lv);x0.frob(f);x1=new ctx.FP12(r);x1.conj();x4=r.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.POSITIVEX){x4.conj()}x3=new ctx.FP12(x4);x3.frob(f);x2=x4.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.POSITIVEX){x2.conj()}x5=new ctx.FP12(x2);x5.conj();lv=x2.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.POSITIVEX){lv.conj()}x2.frob(f);r.copy(x2);r.conj();x4.mul(r);x2.frob(f);r.copy(lv);r.frob(f);lv.mul(r);lv.usqr();lv.mul(x4);lv.mul(x5);r.copy(x3);r.mul(x5);r.mul(lv);lv.mul(x2);r.usqr();r.mul(lv);r.usqr();lv.copy(r);lv.mul(x1);r.mul(x0);lv.usqr();r.mul(lv);r.reduce()}else{y0=new ctx.FP12(r);y0.usqr();y1=y0.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){y1.conj()}x.fshr(1);y2=y1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){y2.conj()}x.fshl(1);y3=new ctx.FP12(r);y3.conj();y1.mul(y3);y1.conj();y1.mul(y2);y2=y1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){y2.conj()}y3=y2.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){y3.conj()}y1.conj();y3.mul(y1);y1.conj();y1.frob(f);y1.frob(f);y1.frob(f);y2.frob(f);y2.frob(f);y1.mul(y2);y2=y3.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){y2.conj()}y2.mul(y0);y2.mul(r);y1.mul(y2);y2.copy(y3);y2.frob(f);y1.mul(y2);r.copy(y1);r.reduce()}return r}};PAIR.glv=function(e){var u=[],t,q,v,d,x,x2,i,j;if(ctx.ECP.CURVE_PAIRING_TYPE==ctx.ECP.BN){t=new ctx.BIG(0);q=new ctx.BIG(0);v=[];q.rcopy(ctx.ROM_CURVE.CURVE_Order);for(i=0;i<2;i++){t.rcopy(ctx.ROM_CURVE.CURVE_W[i]);d=ctx.BIG.mul(t,e);v[i]=new ctx.BIG(d.div(q));u[i]=new ctx.BIG(0)}u[0].copy(e);for(i=0;i<2;i++){for(j=0;j<2;j++){t.rcopy(ctx.ROM_CURVE.CURVE_SB[j][i]);t.copy(ctx.BIG.modmul(v[j],t,q));u[i].add(q);u[i].sub(t);u[i].mod(q)}}}else{q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);x2=ctx.BIG.smul(x,x);u[0]=new ctx.BIG(e);u[0].mod(x2);u[1]=new ctx.BIG(e);u[1].div(x2);u[1].rsub(q)}return u};PAIR.gs=function(e){var u=[],i,j,t,q,v,d,x,w;if(ctx.ECP.CURVE_PAIRING_TYPE==ctx.ECP.BN){t=new ctx.BIG(0);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);v=[];for(i=0;i<4;i++){t.rcopy(ctx.ROM_CURVE.CURVE_WB[i]);d=ctx.BIG.mul(t,e);v[i]=new ctx.BIG(d.div(q));u[i]=new ctx.BIG(0)}u[0].copy(e);for(i=0;i<4;i++){for(j=0;j<4;j++){t.rcopy(ctx.ROM_CURVE.CURVE_BB[j][i]);t.copy(ctx.BIG.modmul(v[j],t,q));u[i].add(q);u[i].sub(t);u[i].mod(q)}}}else{x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);w=new ctx.BIG(e);for(i=0;i<3;i++){u[i]=new ctx.BIG(w);u[i].mod(x);w.div(x)}u[3]=new ctx.BIG(w);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){u[1].copy(ctx.BIG.modneg(u[1],q));u[3].copy(ctx.BIG.modneg(u[3],q))}}return u};PAIR.G1mul=function(P,e){var R,Q,q,bcru,cru,t,u,np,nn;if(ctx.ROM_CURVE.USE_GLV){P.affine();R=new ctx.ECP;R.copy(P);Q=new ctx.ECP;Q.copy(P);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);bcru=new ctx.BIG(0);bcru.rcopy(ctx.ROM_CURVE.CURVE_Cru);cru=new ctx.FP(bcru);t=new ctx.BIG(0);u=PAIR.glv(e);Q.getx().mul(cru);np=u[0].nbits();t.copy(ctx.BIG.modneg(u[0],q));nn=t.nbits();if(nn<np){u[0].copy(t);R.neg()}np=u[1].nbits();t.copy(ctx.BIG.modneg(u[1],q));nn=t.nbits();if(nn<np){u[1].copy(t);Q.neg()}u[0].norm();u[1].norm();R=R.mul2(u[0],Q,u[1])}else{R=P.mul(e)}return R};PAIR.G2mul=function(P,e){var R,Q,fa,fb,f,q,u,t,i,np,nn;if(ctx.ROM_CURVE.USE_GS_G2){Q=[];fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){f.inverse();f.norm()}q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);u=PAIR.gs(e);t=new ctx.BIG(0);P.affine();Q[0]=new ctx.ECP2;Q[0].copy(P);for(i=1;i<4;i++){Q[i]=new ctx.ECP2;Q[i].copy(Q[i-1]);Q[i].frob(f)}for(i=0;i<4;i++){np=u[i].nbits();t.copy(ctx.BIG.modneg(u[i],q));nn=t.nbits();if(nn<np){u[i].copy(t);Q[i].neg()}u[i].norm()}R=ctx.ECP2.mul4(Q,u)}else{R=P.mul(e)}return R};PAIR.GTpow=function(d,e){var r,g,fa,fb,f,q,t,u,i,np,nn;if(ctx.ROM_CURVE.USE_GS_GT){g=[];fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);t=new ctx.BIG(0);u=PAIR.gs(e);g[0]=new ctx.FP12(d);for(i=1;i<4;i++){g[i]=new ctx.FP12(0);g[i].copy(g[i-1]);g[i].frob(f)}for(i=0;i<4;i++){np=u[i].nbits();t.copy(ctx.BIG.modneg(u[i],q));nn=t.nbits();if(nn<np){u[i].copy(t);g[i].conj()}u[i].norm()}r=ctx.FP12.pow4(g,u)}else{r=d.pow(e)}return r};return PAIR}function PAIR192(ctx){var PAIR192={line:function(A,B,Qx,Qy){var r=new ctx.FP24(1),XX,YY,ZZ,YZ,sb,X1,Y1,T1,T2,a,b,c;if(A==B){XX=new ctx.FP4(A.getx());YY=new ctx.FP4(A.gety());ZZ=new ctx.FP4(A.getz());YZ=new ctx.FP4(YY);YZ.mul(ZZ);XX.sqr();YY.sqr();ZZ.sqr();YZ.imul(4);YZ.neg();YZ.norm();YZ.qmul(Qy);XX.imul(6);XX.qmul(Qx);sb=3*ctx.ROM_CURVE.CURVE_B_I;ZZ.imul(sb);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){ZZ.div_2i()}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){ZZ.times_i();ZZ.add(ZZ);YZ.times_i();YZ.norm()}ZZ.norm();YY.add(YY);ZZ.sub(YY);ZZ.norm();a=new ctx.FP8(YZ,ZZ);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){b=new ctx.FP8(XX);c=new ctx.FP8(0)}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){b=new ctx.FP8(0);c=new ctx.FP8(XX);c.times_i()}A.dbl()}else{X1=new ctx.FP4(A.getx());Y1=new ctx.FP4(A.gety());T1=new ctx.FP4(A.getz());T2=new ctx.FP4(A.getz());T1.mul(B.gety());T2.mul(B.getx());X1.sub(T2);X1.norm();Y1.sub(T1);Y1.norm();T1.copy(X1);X1.qmul(Qy);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){X1.times_i();X1.norm()}T1.mul(B.gety());T2.copy(Y1);T2.mul(B.getx());T2.sub(T1);T2.norm();Y1.qmul(Qx);Y1.neg();Y1.norm();a=new ctx.FP8(X1,T2);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){b=new ctx.FP8(Y1);c=new ctx.FP8(0)}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){b=new ctx.FP8(0);c=new ctx.FP8(Y1);c.times_i()}A.add(B)}r.set(a,b,c);return r},ate:function(P,Q){var x,n,n3,lv,Qx,Qy,A,r,nb,bt,i;x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);n=new ctx.BIG(x);n3=new ctx.BIG(n);n3.pmul(3);n3.norm();Qx=new ctx.FP(Q.getx());Qy=new ctx.FP(Q.gety());A=new ctx.ECP4;r=new ctx.FP24(1);A.copy(P);nb=n3.nbits();for(i=nb-2;i>=1;i--){r.sqr();lv=PAIR192.line(A,A,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);bt=n3.bit(i)-n.bit(i);if(bt==1){lv=PAIR192.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST)}if(bt==-1){P.neg();lv=PAIR192.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);P.neg()}}if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){r.conj()}return r},ate2:function(P,Q,R,S){var x,n,n3,lv,Qx,Qy,Sx,Sy,A,B,r,nb,bt,i;x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);n=new ctx.BIG(x);n3=new ctx.BIG(n);n3.pmul(3);n3.norm();Qx=new ctx.FP(Q.getx());Qy=new ctx.FP(Q.gety());Sx=new ctx.FP(S.getx());Sy=new ctx.FP(S.gety());A=new ctx.ECP4;B=new ctx.ECP4;r=new ctx.FP24(1);A.copy(P);B.copy(R);nb=n3.nbits();for(i=nb-2;i>=1;i--){r.sqr();lv=PAIR192.line(A,A,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);lv=PAIR192.line(B,B,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);bt=n3.bit(i)-n.bit(i);if(bt==1){lv=PAIR192.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);lv=PAIR192.line(B,R,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST)}if(bt==-1){P.neg();lv=PAIR192.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);P.neg();R.neg();lv=PAIR192.line(B,R,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);R.neg()}}if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){r.conj()}return r},fexp:function(m){var fa,fb,f,x,r,lv,t0,t1,t2,t3,t4,t5,t6,t7;fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);r=new ctx.FP24(m);lv=new ctx.FP24(r);lv.inverse();r.conj();r.mul(lv);lv.copy(r);r.frob(f,4);r.mul(lv);t7=new ctx.FP24(r);t7.usqr();t1=t7.pow(x);x.fshr(1);t2=t1.pow(x);x.fshl(1);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3=new ctx.FP24(t1);t3.conj();t2.mul(t3);t2.mul(r);t3=t2.pow(x);t4=t3.pow(x);t5=t4.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t3.conj();t5.conj()}t3.frob(f,6);t4.frob(f,5);t3.mul(t4);t6=t5.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t6.conj()}t5.frob(f,4);t3.mul(t5);t0=new ctx.FP24(t2);t0.conj();t6.mul(t0);t5.copy(t6);t5.frob(f,3);t3.mul(t5);t5=t6.pow(x);t6=t5.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t5.conj()}t0.copy(t5);t0.frob(f,2);t3.mul(t0);t0.copy(t6);t0.frob(f,1);t3.mul(t0);t5=t6.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t5.conj()}t2.frob(f,7);t5.mul(t7);t3.mul(t2);t3.mul(t5);r.mul(t3);r.reduce();return r}};PAIR192.glv=function(e){var u=[],q,x,x2;q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);x2=ctx.BIG.smul(x,x);x=ctx.BIG.smul(x2,x2);u[0]=new ctx.BIG(e);u[0].mod(x);u[1]=new ctx.BIG(e);u[1].div(x);u[1].rsub(q);return u};PAIR192.gs=function(e){var u=[],i,q,x,w;x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);w=new ctx.BIG(e);for(i=0;i<7;i++){u[i]=new ctx.BIG(w);u[i].mod(x);w.div(x)}u[7]=new ctx.BIG(w);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){u[1].copy(ctx.BIG.modneg(u[1],q));u[3].copy(ctx.BIG.modneg(u[3],q));u[5].copy(ctx.BIG.modneg(u[5],q));u[7].copy(ctx.BIG.modneg(u[7],q))}return u};PAIR192.G1mul=function(P,e){var R,Q,q,bcru,cru,t,u,np,nn;if(ctx.ROM_CURVE.USE_GLV){P.affine();R=new ctx.ECP;R.copy(P);Q=new ctx.ECP;Q.copy(P);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);bcru=new ctx.BIG(0);bcru.rcopy(ctx.ROM_CURVE.CURVE_Cru);cru=new ctx.FP(bcru);t=new ctx.BIG(0);u=PAIR192.glv(e);Q.getx().mul(cru);np=u[0].nbits();t.copy(ctx.BIG.modneg(u[0],q));nn=t.nbits();if(nn<np){u[0].copy(t);R.neg()}np=u[1].nbits();t.copy(ctx.BIG.modneg(u[1],q));nn=t.nbits();if(nn<np){u[1].copy(t);Q.neg()}u[0].norm();u[1].norm();R=R.mul2(u[0],Q,u[1])}else{R=P.mul(e)}return R};PAIR192.G2mul=function(P,e){var R,Q,F,q,u,t,i,np,nn;if(ctx.ROM_CURVE.USE_GS_G2){Q=[];F=ctx.ECP4.frob_constants();q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);u=PAIR192.gs(e);t=new ctx.BIG(0);P.affine();Q[0]=new ctx.ECP4;Q[0].copy(P);for(i=1;i<8;i++){Q[i]=new ctx.ECP4;Q[i].copy(Q[i-1]);Q[i].frob(F,1)}for(i=0;i<8;i++){np=u[i].nbits();t.copy(ctx.BIG.modneg(u[i],q));nn=t.nbits();if(nn<np){u[i].copy(t);Q[i].neg()}u[i].norm()}R=ctx.ECP4.mul8(Q,u)}else{R=P.mul(e)}return R};PAIR192.GTpow=function(d,e){var r,g,fa,fb,f,q,t,u,i,np,nn;if(ctx.ROM_CURVE.USE_GS_GT){g=[];fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);t=new ctx.BIG(0);u=PAIR192.gs(e);g[0]=new ctx.FP24(d);for(i=1;i<8;i++){g[i]=new ctx.FP24(0);g[i].copy(g[i-1]);g[i].frob(f,1)}for(i=0;i<8;i++){np=u[i].nbits();t.copy(ctx.BIG.modneg(u[i],q));nn=t.nbits();if(nn<np){u[i].copy(t);g[i].conj()}u[i].norm()}r=ctx.FP24.pow8(g,u)}else{r=d.pow(e)}return r};return PAIR192}function PAIR256(ctx){var PAIR256={line:function(A,B,Qx,Qy){var r=new ctx.FP48(1),XX,YY,ZZ,YZ,sb,X1,Y1,T1,T2,a,b,c;if(A==B){XX=new ctx.FP8(A.getx());YY=new ctx.FP8(A.gety());ZZ=new ctx.FP8(A.getz());YZ=new ctx.FP8(YY);YZ.mul(ZZ);XX.sqr();YY.sqr();ZZ.sqr();YZ.imul(4);YZ.neg();YZ.norm();YZ.tmul(Qy);XX.imul(6);XX.tmul(Qx);sb=3*ctx.ROM_CURVE.CURVE_B_I;ZZ.imul(sb);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){ZZ.div_2i()}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){ZZ.times_i();ZZ.add(ZZ);YZ.times_i();YZ.norm()}ZZ.norm();YY.add(YY);ZZ.sub(YY);ZZ.norm();a=new ctx.FP16(YZ,ZZ);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){b=new ctx.FP16(XX);c=new ctx.FP16(0)}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){b=new ctx.FP16(0);c=new ctx.FP16(XX);c.times_i()}A.dbl()}else{X1=new ctx.FP8(A.getx());Y1=new ctx.FP8(A.gety());T1=new ctx.FP8(A.getz());T2=new ctx.FP8(A.getz());T1.mul(B.gety());T2.mul(B.getx());X1.sub(T2);X1.norm();Y1.sub(T1);Y1.norm();T1.copy(X1);X1.tmul(Qy);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){X1.times_i();X1.norm()}T1.mul(B.gety());T2.copy(Y1);T2.mul(B.getx());T2.sub(T1);T2.norm();Y1.tmul(Qx);Y1.neg();Y1.norm();a=new ctx.FP16(X1,T2);if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.D_TYPE){b=new ctx.FP16(Y1);c=new ctx.FP16(0)}if(ctx.ECP.SEXTIC_TWIST==ctx.ECP.M_TYPE){b=new ctx.FP16(0);c=new ctx.FP16(Y1);c.times_i()}A.add(B)}r.set(a,b,c);return r},ate:function(P,Q){var x,n,n3,lv,Qx,Qy,A,r,nb,bt,i;x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);n=new ctx.BIG(x);n3=new ctx.BIG(n);n3.pmul(3);n3.norm();Qx=new ctx.FP(Q.getx());Qy=new ctx.FP(Q.gety());A=new ctx.ECP8;r=new ctx.FP48(1);A.copy(P);nb=n3.nbits();for(i=nb-2;i>=1;i--){r.sqr();lv=PAIR256.line(A,A,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);bt=n3.bit(i)-n.bit(i);if(bt==1){lv=PAIR256.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST)}if(bt==-1){P.neg();lv=PAIR256.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);P.neg()}}if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){r.conj()}return r},ate2:function(P,Q,R,S){var x,n,n3,lv,Qx,Qy,Sx,Sy,A,B,r,nb,bt,i;x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);n=new ctx.BIG(x);n3=new ctx.BIG(n);n3.pmul(3);n3.norm();Qx=new ctx.FP(Q.getx());Qy=new ctx.FP(Q.gety());Sx=new ctx.FP(S.getx());Sy=new ctx.FP(S.gety());A=new ctx.ECP8;B=new ctx.ECP8;r=new ctx.FP48(1);A.copy(P);B.copy(R);nb=n3.nbits();for(i=nb-2;i>=1;i--){r.sqr();lv=PAIR256.line(A,A,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);lv=PAIR256.line(B,B,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);bt=n3.bit(i)-n.bit(i);if(bt==1){lv=PAIR256.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);lv=PAIR256.line(B,R,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST)}if(bt==-1){P.neg();lv=PAIR256.line(A,P,Qx,Qy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);P.neg();R.neg();lv=PAIR256.line(B,R,Sx,Sy);r.smul(lv,ctx.ECP.SEXTIC_TWIST);R.neg()}}if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){r.conj()}return r},fexp:function(m){var fa,fb,f,x,r,lv,t1,t2,t3,t7;fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);r=new ctx.FP48(m);lv=new ctx.FP48(r);lv.inverse();r.conj();r.mul(lv);lv.copy(r);r.frob(f,8);r.mul(lv);t7=new ctx.FP48(r);t7.usqr();t1=t7.pow(x);x.fshr(1);t2=t1.pow(x);x.fshl(1);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3=new ctx.FP48(t1);t3.conj();t2.mul(t3);t2.mul(r);r.mul(t7);t1=t2.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,14);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,13);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,12);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,11);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,10);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,9);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,8);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t2);t3.conj();t1.mul(t3);t3.copy(t1);t3.frob(f,7);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,6);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,5);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,4);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,3);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,2);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}t3.copy(t1);t3.frob(f,1);r.mul(t3);t1=t1.pow(x);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){t1.conj()}
r.mul(t1);t2.frob(f,15);r.mul(t2);r.reduce();return r}};PAIR256.glv=function(e){var u=[],q,x,x2;q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);x2=ctx.BIG.smul(x,x);x=ctx.BIG.smul(x2,x2);x2=ctx.BIG.smul(x,x);u[0]=new ctx.BIG(e);u[0].mod(x2);u[1]=new ctx.BIG(e);u[1].div(x2);u[1].rsub(q);return u};PAIR256.gs=function(e){var u=[],i,q,x,w;x=new ctx.BIG(0);x.rcopy(ctx.ROM_CURVE.CURVE_Bnx);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);w=new ctx.BIG(e);for(i=0;i<15;i++){u[i]=new ctx.BIG(w);u[i].mod(x);w.div(x)}u[15]=new ctx.BIG(w);if(ctx.ECP.SIGN_OF_X==ctx.ECP.NEGATIVEX){u[1].copy(ctx.BIG.modneg(u[1],q));u[3].copy(ctx.BIG.modneg(u[3],q));u[5].copy(ctx.BIG.modneg(u[5],q));u[7].copy(ctx.BIG.modneg(u[7],q));u[9].copy(ctx.BIG.modneg(u[9],q));u[11].copy(ctx.BIG.modneg(u[11],q));u[13].copy(ctx.BIG.modneg(u[13],q));u[15].copy(ctx.BIG.modneg(u[15],q))}return u};PAIR256.G1mul=function(P,e){var R,Q,q,bcru,cru,t,u,np,nn;if(ctx.ROM_CURVE.USE_GLV){P.affine();R=new ctx.ECP;R.copy(P);Q=new ctx.ECP;Q.copy(P);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);bcru=new ctx.BIG(0);bcru.rcopy(ctx.ROM_CURVE.CURVE_Cru);cru=new ctx.FP(bcru);t=new ctx.BIG(0);u=PAIR256.glv(e);Q.getx().mul(cru);np=u[0].nbits();t.copy(ctx.BIG.modneg(u[0],q));nn=t.nbits();if(nn<np){u[0].copy(t);R.neg()}np=u[1].nbits();t.copy(ctx.BIG.modneg(u[1],q));nn=t.nbits();if(nn<np){u[1].copy(t);Q.neg()}u[0].norm();u[1].norm();R=R.mul2(u[0],Q,u[1])}else{R=P.mul(e)}return R};PAIR256.G2mul=function(P,e){var R,Q,F,q,u,t,i,np,nn;if(ctx.ROM_CURVE.USE_GS_G2){Q=[];F=ctx.ECP8.frob_constants();q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);u=PAIR256.gs(e);t=new ctx.BIG(0);P.affine();Q[0]=new ctx.ECP8;Q[0].copy(P);for(i=1;i<16;i++){Q[i]=new ctx.ECP8;Q[i].copy(Q[i-1]);Q[i].frob(F,1)}for(i=0;i<16;i++){np=u[i].nbits();t.copy(ctx.BIG.modneg(u[i],q));nn=t.nbits();if(nn<np){u[i].copy(t);Q[i].neg()}u[i].norm()}R=ctx.ECP8.mul16(Q,u)}else{R=P.mul(e)}return R};PAIR256.GTpow=function(d,e){var r,g,fa,fb,f,q,t,u,i,np,nn;if(ctx.ROM_CURVE.USE_GS_GT){g=[];fa=new ctx.BIG(0);fa.rcopy(ctx.ROM_FIELD.Fra);fb=new ctx.BIG(0);fb.rcopy(ctx.ROM_FIELD.Frb);f=new ctx.FP2(fa,fb);q=new ctx.BIG(0);q.rcopy(ctx.ROM_CURVE.CURVE_Order);t=new ctx.BIG(0);u=PAIR256.gs(e);g[0]=new ctx.FP48(d);for(i=1;i<16;i++){g[i]=new ctx.FP48(0);g[i].copy(g[i-1]);g[i].frob(f,1)}for(i=0;i<16;i++){np=u[i].nbits();t.copy(ctx.BIG.modneg(u[i],q));nn=t.nbits();if(nn<np){u[i].copy(t);g[i].conj()}u[i].norm()}r=ctx.FP48.pow16(g,u)}else{r=d.pow(e)}return r};return PAIR256}function RAND(ctx){var RAND=function(){this.ira=[];this.rndptr=0;this.borrow=0;this.pool_ptr=0;this.pool=[];this.clean()};RAND.prototype={NK:21,NJ:6,NV:8,clean:function(){var i;for(i=0;i<32;i++){this.pool[i]=0}for(i=0;i<this.NK;i++){this.ira[i]=0}this.rndptr=0;this.borrow=0;this.pool_ptr=0},sbrand:function(){var i,k,pdiff,t;this.rndptr++;if(this.rndptr<this.NK){return this.ira[this.rndptr]}this.rndptr=0;for(i=0,k=this.NK-this.NJ;i<this.NK;i++,k++){if(k==this.NK){k=0}t=this.ira[k]>>>0;pdiff=t-this.ira[i]-this.borrow|0;pdiff>>>=0;if(pdiff<t){this.borrow=0}if(pdiff>t){this.borrow=1}this.ira[i]=pdiff|0}return this.ira[0]},sirand:function(seed){var m=1,i,inn,t;this.borrow=0;this.rndptr=0;seed>>>=0;this.ira[0]^=seed;for(i=1;i<this.NK;i++){inn=this.NV*i%this.NK;this.ira[inn]^=m;t=m;m=seed-m|0;seed=t}for(i=0;i<1e4;i++){this.sbrand()}},fill_pool:function(){var sh=new ctx.HASH256,i;for(i=0;i<128;i++){sh.process(this.sbrand())}this.pool=sh.hash();this.pool_ptr=0},seed:function(rawlen,raw){var sh=new ctx.HASH256,digest=[],b=[],i;this.pool_ptr=0;for(i=0;i<this.NK;i++){this.ira[i]=0}if(rawlen>0){for(i=0;i<rawlen;i++){sh.process(raw[i])}digest=sh.hash();for(i=0;i<8;i++){b[0]=digest[4*i];b[1]=digest[4*i+1];b[2]=digest[4*i+2];b[3]=digest[4*i+3];this.sirand(RAND.pack(b))}}this.fill_pool()},getByte:function(){var r=this.pool[this.pool_ptr++];if(this.pool_ptr>=32){this.fill_pool()}return r&255}};RAND.pack=function(b){return(b[3]&255)<<24|(b[2]&255)<<16|(b[1]&255)<<8|b[0]&255};return RAND}var ROM_CURVE_ANSSI,ROM_CURVE_BLS383,ROM_CURVE_BLS24,ROM_CURVE_BLS48,ROM_CURVE_BLS381,ROM_CURVE_BLS461,ROM_CURVE_FP256BN,ROM_CURVE_FP512BN,ROM_CURVE_BN254,ROM_CURVE_BN254CX,ROM_CURVE_BRAINPOOL,ROM_CURVE_C25519,ROM_CURVE_C41417,ROM_CURVE_ED25519,ROM_CURVE_GOLDILOCKS,ROM_CURVE_HIFIVE,ROM_CURVE_NIST256,ROM_CURVE_NIST384,ROM_CURVE_NIST521,ROM_CURVE_NUMS256E,ROM_CURVE_NUMS256W,ROM_CURVE_NUMS384E,ROM_CURVE_NUMS384W,ROM_CURVE_NUMS512E,ROM_CURVE_NUMS512W,ROM_CURVE_SECP256K1;ROM_CURVE_ANSSI={Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[8107839,15570555,8401013,14987681,15469722,12586975,7686724,871098,2664752,4180564,60981],CURVE_Order:[14046689,13916614,9707517,4248255,14444513,4414291,15257154,1053293,3855759,1543179,61949],CURVE_Gx:[9395455,8007129,91337,11507895,2609884,2332044,4671956,3217469,12663275,13943638,46771],CURVE_Gy:[404731,5903700,14779153,15262921,115463,15698983,15791084,2069105,11666577,14743496,24898]};ROM_CURVE_BLS383={CURVE_Cof_I:0,CURVE_A:0,CURVE_B_I:15,CURVE_B:[15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[3932161,3397629,6089858,591516,6228314,7355328,370220,2228452,3672512,6145,32774,8,0,0,0,0,0],CURVE_Gx:[7554419,7238160,1172241,2073528,6143752,6851466,1227896,4447596,7613487,7168259,5011069,7176839,7603501,1863787,6191929,6105820,16892],CURVE_Gy:[258596,2931968,7636148,4455623,8210924,2472906,2849491,2721098,4493575,841580,7616183,6436556,1891377,18781,3402944,735546,1679],CURVE_Bnx:[4608,2,262176,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[1482411,2802346,8312129,349663,2796544,2731,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[2802345,5152861,4944653,1506094,6252570,6829956,866216,2693029,7429346,6928314,86292,4866979,3424366,1312949,2808749,2837170,21861],CURVE_Pxa:[8334726,6777946,7885042,4909289,8235879,6675715,4020373,4165192,7494612,1090986,824327,997938,616395,1576754,8061178,6885891,1588],CURVE_Pxb:[5430805,4734344,3653479,2883376,4895373,3861354,2335925,7128532,5016031,5978635,1299043,1773289,7434888,6188878,22830,3932208,12301],CURVE_Pya:[576321,6387496,5861795,1075980,2022991,6089577,2770152,4964822,1785448,2942867,3826747,3253211,357374,7940411,4756689,1473694,13177],CURVE_Pyb:[4690067,820990,1633121,7541028,4442893,1250818,1211887,7887226,8032122,579197,473141,5494528,3833109,6593999,3367706,1195753,8421],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:true,USE_GS_G2:true,USE_GS_GT:true,GT_STRONG:true};ROM_CURVE_BLS24={CURVE_Cof_I:0,CURVE_A:0,CURVE_B_I:19,CURVE_B:[19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1,1179616,4604008,2095784,7464707,6577077,3645368,6855989,4837582,4786463,4879112,2649099,3884192,6338353,6817731,32770,65552,0,0,0,0],CURVE_Gx:[6540500,4320215,1413533,5729530,2031149,7618456,1032762,4233788,5855992,7310833,3716625,6637197,8276989,7015837,484381,3067102,753642,6017987,2876705,7446718,109355],CURVE_Gy:[1987141,4953508,5968686,4598511,3593824,6762125,8079955,7988313,2396687,4729008,5831017,1921662,5112054,4554483,6722122,2707451,6727588,7390100,5214686,3695458,294859],CURVE_Bnx:[1179520,1024,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[7607723,8355827,6291207,2798933,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[5739689,5122267,6885104,1857433,6529801,4488120,4490708,3603928,8107043,926905,6189976,1158257,526048,1629540,6157728,274559,3230752,315848,3085986,245790,349632],CURVE_Pxaa:[6440568,2533097,143242,2173970,6341443,4061395,6133555,7076999,2959496,7702133,2465052,8294956,4959031,1170091,6427812,7703125,7890545,7516560,3299357,7511327,38301],CURVE_Pxab:[3185080,4027903,4252158,38179,6518618,7882506,5719751,8188341,2533168,1375764,7785111,6408130,6722145,6978607,4087209,6237544,2963921,4865176,5044209,6832523,241886],CURVE_Pxba:[2954707,1822243,6010503,4651888,1594135,4702516,3133690,3512242,5693014,1465113,1916782,1106230,7778799,1643463,4198895,2070863,4186640,5525894,4320202,8219250,257063],CURVE_Pxbb:[6354048,6622909,3027434,2222946,1332590,1849715,4765664,1048317,5247535,5631519,2505687,3070251,1811373,3785566,3002881,1516334,1943502,5025962,1992671,4644432,42419],CURVE_Pyaa:[7871136,1254952,2803225,1580472,3541466,4163735,4888657,1610322,312362,7769180,6732194,1842544,5229276,6942076,8202348,54917,104697,4562336,3155213,1764251,329087],CURVE_Pyab:[3016954,5812189,5945071,6116092,493428,3442068,3324966,146482,3919095,758079,4068681,6000767,7844838,2279149,7890430,4042491,6354264,7351674,3810701,2405135,183851],CURVE_Pyba:[7392321,322891,513484,2791509,8358194,6231080,7561702,1327212,6859262,2219175,5096782,1079358,7467940,3842870,7099141,1989340,1718749,8156144,1623706,2306551,98416],CURVE_Pybb:[6036654,6671522,2323398,2807884,2965715,7425774,1113968,3859809,79542,4110951,7719923,3306576,1448641,6076833,2900718,4766607,5689414,7491713,7844397,2578125,301521],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:true,USE_GS_G2:true,USE_GS_GT:true,GT_STRONG:true};ROM_CURVE_BLS48={CURVE_Cof_I:0,CURVE_A:0,CURVE_B_I:17,CURVE_B:[17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1,8257536,4332543,7425747,4543497,342082,8045960,8292968,710849,1592741,8369634,387382,6222969,1226881,4652607,3341701,2716612,4007437,3247601,560471,4158442,6279,0,0,0],CURVE_Gx:[5709107,5922507,261281,8329583,5768532,2350103,365020,1673208,8169462,3431939,2112922,95053,4476423,5636786,327742,5857749,3199554,3369922,496193,918681,8314228,3895594,2186597,5525321,9],CURVE_Gy:[7264314,3571668,3398249,2442552,6048661,2821359,8037274,4708808,6781791,5217853,7194790,7454919,4932834,4892913,4993177,3174883,2361442,1809615,358852,5052823,3361242,4152406,5445809,5686916,0],CURVE_Bnx:[6553632,251,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[1223659,2236158,21131,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[3908649,1899737,1442009,4827066,5124258,1053301,989708,7148654,4372537,1148308,5173428,351451,6754939,4033841,3248691,153372,1765119,7519347,594712,1642976,2596728,6579207,7593787,6864577,15],CURVE_Pxaaa:[2346570,6102290,7645748,6904841,4026626,2573337,7743564,6942898,4601793,6284286,2371170,4162878,5100211,6761438,454034,2857901,7097023,3750018,3337761,3077025,5851262,601931,157808,3325036,14],CURVE_Pxaab:[662497,1805144,8243655,15339,2686523,7529867,5366028,3245418,3707463,1423869,2639850,3028384,635111,8360654,6906056,808993,4743981,823708,3942388,2790221,3443566,3107611,1547562,4853769,2],CURVE_Pxaba:[810436,6592750,4942057,7263863,2712749,8228461,5048678,5572740,1648300,4658733,6501717,2513250,6554296,4781893,6822239,1674042,1146082,6201083,7508789,4661102,3574202,3912945,4053852,2719612,11],CURVE_Pxabb:[6600512,5426484,5735256,4606210,1178953,4676514,6034700,4416006,3366439,8190566,5487263,3793423,269884,3197763,6192506,4745690,439301,5748355,7811178,4093770,6533542,4973694,7752575,1843284,9],CURVE_Pxbaa:[7462943,1622757,9964,1726547,4395469,4394769,4450532,2105420,3517321,7822343,4399148,4467011,1979506,728042,1344541,5678753,5121987,6996887,1121898,4538172,4496690,6457593,8193587,7278459,13],CURVE_Pxbab:[3618877,7358220,420904,8178751,2228819,2597925,1342295,6597038,7995719,6409771,7741631,1895323,4134470,5588700,1224392,2780486,3704926,688080,3811700,7893745,5214715,2809346,6496577,1497555,8],CURVE_Pxbba:[1151900,8087470,7054752,3461644,1828125,6679937,7167155,6579686,4240260,1338948,5567601,1154937,1157555,5387704,3417090,7013248,5350403,2286351,2040762,4623583,5938383,7849094,6370896,4265273,10],CURVE_Pxbbb:[7293081,136458,7670965,4805298,1855979,1545080,2711140,5985367,4695945,1311736,6444940,3104056,8382508,7143266,205154,3853285,1978368,26255,4352587,5195501,5743400,6466800,1011803,8104508,13],CURVE_Pyaaa:[1275972,3121e3,5102466,5241465,4516964,7147683,1829617,4927324,756337,2140956,2251648,6700668,6765584,8294057,3130248,6744524,2109270,3758204,3423884,5425343,399627,1178382,6366421,3372677,7],CURVE_Pyaab:[4731280,6590939,4344184,2315340,3058420,203365,4779697,8317710,597807,2988332,61564,4908399,6852306,6480800,2639704,89335,8265822,653888,2419301,845948,8002626,1854749,5207722,3990940,2],CURVE_Pyaba:[1596429,4169859,1025905,5294318,868429,481747,6913362,6658236,6839420,6368600,1445126,2228723,6060412,1098612,949788,5437952,2056368,273188,7747040,905826,1314145,2533350,5857212,2280932,13],CURVE_Pyabb:[1917688,4280363,6127039,559890,2374397,3997271,5161978,3125267,8142079,1914647,7946266,3392564,6512439,2745590,2925275,8031984,4184322,3344841,2036315,4190409,29456,3225563,2625035,460629,10],CURVE_Pybaa:[3670943,2451262,1590100,4094161,977045,75679,2641942,4480133,4980357,8357271,2813397,3039993,3305740,5200721,5833068,6387911,7218830,2963951,2897590,7436130,1907388,3290900,8158137,5776164,2],CURVE_Pybab:[6256741,4251218,2156967,7616979,4130646,5856175,8191094,2652952,5637966,1599097,4288192,1951762,1212350,1628597,3951261,1846196,1268900,8011948,7575940,7274636,7438570,5812077,5982978,596300,3],CURVE_Pybba:[4987257,7683791,7276384,3911996,4894620,7076690,4655192,4272701,5505496,4801540,6082396,773894,8285903,5938208,863743,6618948,3236955,5171331,5120748,1123397,4746332,6062609,6806118,4195986,12],CURVE_Pybbb:[4846171,1223775,6108146,3527510,2903936,3820702,3955314,4353140,6139026,5423430,6370923,7134839,5938831,7208816,7151843,5923046,3399450,176039,233712,6496418,4150419,1885043,1526160,503963,10],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:true,USE_GS_G2:true,USE_GS_GT:true,GT_STRONG:true};ROM_CURVE_BLS381={CURVE_Cof_I:0,CURVE_A:0,CURVE_B_I:4,CURVE_B:[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1,8388096,8126463,8385247,5914671,43639,157814,1895428,8210483,2511674,5224093,3,0,0,0,0,0],CURVE_Gx:[2279099,6297014,4189419,4968663,6194175,724362,4572907,2563359,3736993,2043625,893489,5070974,3720442,316076,6682085,6935448,6129],CURVE_Gy:[4581345,4608653,1061544,1328215,5010506,8239623,4915500,7179365,718336,2861984,7591810,7100199,972609,3412934,6989884,8012017,2227],CURVE_Bnx:[65536,0,215044,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[43691,5592576,5910530,2797322,4767749,1837,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[8323070,8388607,571399,1069056,8225078,5315522,7978533,5887133,7858909,971806,6924056,3568269,7536119,779052,0,0,0],CURVE_Pxa:[2211256,2986370,4149761,4206047,4207210,3072373,2013428,2655666,3867316,2749568,1806827,2654862,5403356,2408704,2343588,5331320,586],CURVE_Pxb:[273278,7998138,6264497,1876714,5181729,599657,7806932,7155933,3545781,2175553,6664003,3832618,3803266,1029530,1861592,1421353,5088],CURVE_Pya:[3680257,2690065,2590285,6120724,2923715,2462279,5527604,2182452,5482349,5577083,3667566,7448789,6057378,3250489,2055044,6984633,3301],CURVE_Pyb:[6257086,966624,436900,6775021,7393909,3500006,5622694,3819861,6532902,8194894,2947233,1334478,2818748,415130,2739507,6443031,1542],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:true,USE_GS_G2:true,USE_GS_GT:true,GT_STRONG:false};ROM_CURVE_BLS461={Curve_Cof_I:0,CURVE_A:0,CURVE_B_I:9,CURVE_B:[9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1,0,7340032,8355839,524031,139264,8331264,8257727,59393,4243360,1535,8380428,8388479,511,0,0,0,0,0,0,0],CURVE_Gx:[6220093,316693,5260596,7813723,2989056,6510846,6686420,4265185,5097761,2205356,2631065,8118601,4415846,4547374,1716132,3708539,819506,4681332,3827409,5670714,0],CURVE_Gy:[5362789,4598517,5358557,6578815,5339268,7447595,424346,2943060,2383689,1428358,3019332,4586784,1502923,4135293,3351294,1545149,6233151,4116882,4533441,3923565,0],CURVE_Bnx:[0,8387584,8388591,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[2796203,8387925,5941919,5603498,8213930,2793471,21845,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[8388606,1023,16,8388352,8388223,6422509,12575,6488633,7190460,6433522,7590365,4434457,4132489,656578,5772288,8347647,131071,0,0,0,0],CURVE_Pxa:[5284732,2122509,3217773,1522414,1846857,2952981,517223,8041072,7667602,6360502,1679375,3582989,7174356,7885327,2247653,1971078,7764293,4855093,5122074,418464,1],CURVE_Pxb:[4309165,3756421,3647457,6427365,1494374,4526785,304454,2100579,4112098,8037685,8230597,5263001,4566875,7224745,4952912,1193267,2259410,1918713,5503339,4907261,0],CURVE_Pya:[3125254,2196320,843571,5394581,5493140,1202450,5780467,6505892,62367,1996086,8079080,4120034,5111178,388947,3443187,8024991,6320372,7666894,1194490,1127780,0],CURVE_Pyb:[7423356,875515,172692,7209569,5073457,7194614,2532292,2831477,6572335,3045495,1697866,2487645,2231271,6058157,8131344,141483,2798032,6817236,7159470,7454848,0],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:true,USE_GS_G2:true,USE_GS_GT:true,GT_STRONG:false};ROM_CURVE_FP256BN={Curve_Cof_I:1,CURVE_A:0,CURVE_B_I:3,CURVE_B:[3,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[741389,5467345,1766957,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],CURVE_Gx:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Gy:[2,0,0,0,0,0,0,0,0,0,0],CURVE_Bnx:[11577345,16105520,26754,0,0,0,0,0,0,0,0],CURVE_Cof:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[10598407,664739,2022172,15831853,13490077,1598875,4231696,3770593,1,0,0],CURVE_Pxa:[12623611,1488521,3985958,1228676,1856410,9517774,5733416,2643471,13200416,3362996,65036],CURVE_Pxb:[8284715,15545507,9032297,8900661,14514402,1292580,12990424,14375649,9093204,6313843,20134],CURVE_Pya:[14428159,11829694,4778249,9265496,13313141,4084207,7672398,7763725,4367283,4646853,28704],CURVE_Pyb:[11338907,8458570,11788306,8526488,5029504,11706251,4794750,4386470,8962704,14925011,1364],CURVE_W:[[344067,224795,6699760,16776824,16777215,255,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0]],CURVE_SB:[[[6721540,15658620,6753269,16776824,16777215,255,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0]],[[6377473,15433825,53509,0,0,0,0,0,0,0,0],[397322,5242550,11844413,1219353,14444027,10788108,6221425,4646386,16576717,16777215,65535]]],CURVE_WB:[[3188736,6786829,13373472,5592274,5592405,85,0,0,0,0,0],[8243205,7752717,11344598,10554307,14585790,1066087,8413536,13698539,0,0,0],[1521667,11929119,14074284,5277153,15681503,533043,12595376,6849269,0,0,0],[9566209,5443438,13426982,5592274,5592405,85,0,0,0,0,0]],CURVE_BB:[[[5941261,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[5941260,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[5941260,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[6377474,15433825,53509,0,0,0,0,0,0,0,0]],[[6377473,15433825,53509,0,0,0,0,0,0,0,0],[5941260,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[5941261,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[5941260,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535]],[[6377474,15433825,53509,0,0,0,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0]],[[11577346,16105520,26754,0,0,0,0,0,0,0,0],[12754946,14090434,107019,0,0,0,0,0,0,0,0],[11141130,6810735,1713447,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[11577346,16105520,26754,0,0,0,0,0,0,0,0]]],USE_GLV:true,USE_GS_G2:true,USE_GS_GT:true,GT_STRONG:false};ROM_CURVE_FP512BN={Curve_Cof_I:1,CURVE_A:0,CURVE_B_I:3,CURVE_B:[3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1706477,1359523,5249689,2608405,201696,3434818,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],CURVE_Gx:[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Gy:[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Bnx:[1824783,882364,4211404,362431,3103747,3344,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[7940490,2900280,338972,6052030,7235481,1201625,3118232,4441267,5274317,1128526,1911936,589080,7925622,7459929,3021517,1388707,8243261,8385496,8388607,8388607,8388607,8388607,63],CURVE_Pxa:[3557045,5430299,8010782,4733311,1017649,7464003,7286513,2875152,5097180,7390882,4231501,3958405,5920716,3618479,5071811,6154573,6954571,155257,28317,2378436,1971078,6474343,14],CURVE_Pxb:[712937,1564597,7141079,7095432,4866332,6003841,5115734,2648944,7212382,6621860,6322313,6072011,3155302,4779345,1776572,5450606,3441246,88017,7155994,4142660,4162822,230009,18],CURVE_Pya:[6186913,402779,1542432,718812,2194134,7834523,655917,1149226,4099805,8116266,5977186,3460773,6668632,1810557,5866175,4380911,5187440,1668206,3921580,4047177,5014140,6307216,27],CURVE_Pyb:[5213835,6491536,5903917,2489264,377378,72702,8096231,1607019,464036,509386,665087,827629,3998870,6394732,4596126,662624,5840642,6471403,888880,3938518,4763726,3438493,20],CURVE_W:[[214403,7417491,5227587,6862091,6273297,4717868,8388413,8388607,8388607,8388607,8388607,7,0,0,0,0,0,0,0,0,0,0,0],[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[4953444,5652762,5193387,6137228,65803,4711180,8388413,8388607,8388607,8388607,8388607,7,0,0,0,0,0,0,0,0,0,0,0],[6445518,7983402,5215488,1883542,2382810,3428129,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63]],[[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[214403,7417491,5227587,6862091,6273297,4717868,8388413,8388607,8388607,8388607,8388607,7,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[5908976,6739306,3169130,2891416,4467808,4374399,5592340,2796202,5592405,2796202,5592405,2,0,0,0,0,0,0,0,0,0,0,0],[3497291,153412,4586412,7076903,2161695,7064478,2586798,2902397,5952527,7520457,4540882,2730161,5729219,273601,5798904,7716912,53509,0,0,0,0,0,0],[2661037,517888,4398908,3719667,2632721,3533911,5487703,5645502,7170567,3760228,6464745,5559384,7058913,136800,2899452,8052760,26754,0,0,0,0,0,0],[2259409,4974578,3134930,2166553,6648922,4367710,5592340,2796202,5592405,2796202,5592405,2,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[1824784,882364,4211404,362431,3103747,3344,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1824783,882364,4211404,362431,3103747,3344,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1824783,882364,4211404,362431,3103747,3344,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[6445519,7983402,5215488,1883542,2382810,3428129,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63]],[[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[8270302,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],[8270301,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],[8270302,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63]],[[3649566,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[8270303,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],[2795951,6218674,5181288,1158679,4563924,3421440,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],[3649565,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[8270303,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63]]],USE_GLV:true,USE_GS_G2:true,USE_GS_GT:true,GT_STRONG:false};ROM_CURVE_BN254={Curve_Cof_I:1,CURVE_A:0,CURVE_B_I:2,CURVE_B:[2,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[13,0,1089792,0,10452992,2047,8388608,12203085,1,6586944,9507],CURVE_Gx:[18,0,1287936,0,2162688,2145,8388608,12203085,1,6586944,9507],CURVE_Gy:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Bnx:[1,0,16512,0,0,0,0,0,0,0,0],CURVE_Cof:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[7,0,445824,0,589824,585,4194304,4830050,0,0,0],CURVE_Pxa:[260907,4334792,889326,4757695,6589371,15578788,8293473,15437196,10401327,1096529,1562],CURVE_Pxb:[13978867,3457511,11996556,11417476,5076075,11164447,9197954,3213991,7567411,11205050,1302],CURVE_Pya:[13446042,14710929,12392944,12434953,12389094,8528681,9857420,10129632,11506499,9937003,536],CURVE_Pyb:[3853979,1764459,5737005,14105033,9438975,9254832,5699059,9399620,9114918,2821756,3771],CURVE_W:[[3,0,132096,0,8486912,97,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0]],CURVE_SB:[[[4,0,165120,0,8486912,97,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0]],[[1,0,33024,0,0,0,0,0,0,0,0],[10,0,957696,0,1966080,1950,8388608,12203085,1,6586944,9507]]],CURVE_WB:[[0,0,16512,0,8421376,32,0,0,0,0,0],[5,0,346752,0,458752,455,8388608,3220033,0,0,0],[3,0,181632,0,8617984,227,12582912,1610016,0,0,0],[1,0,49536,0,8421376,32,0,0,0,0,0]],CURVE_BB:[[[13,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[12,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[12,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[2,0,33024,0,0,0,0,0,0,0,0]],[[1,0,33024,0,0,0,0,0,0,0,0],[12,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[13,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[12,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507]],[[2,0,33024,0,0,0,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0]],[[2,0,16512,0,0,0,0,0,0,0,0],[2,0,66048,0,0,0,0,0,0,0,0],[10,0,1056768,0,10452992,2047,8388608,12203085,1,6586944,9507],[2,0,16512,0,0,0,0,0,0,0,0]]],USE_GLV:true,USE_GS_G2:true,USE_GS_GT:true,GT_STRONG:false};ROM_CURVE_BN254CX={Curve_Cof_I:1,CURVE_A:0,CURVE_B_I:2,CURVE_B:[2,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[15409005,12625462,13549073,837894,4183790,6738628,6584931,11582943,7350797,8,9216],CURVE_Gx:[1791410,2355036,14794342,1575230,4183790,6738724,6584931,11582943,7350797,8,9216],CURVE_Gy:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Bnx:[12587697,3,16384,0,0,0,0,0,0,0,0],CURVE_Cof:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[2317463,9639828,5648864,7466887,12443492,4133952,3240,4718592,0,0,0],CURVE_Pxa:[13823092,1896164,2539653,10501671,8160703,4963216,62915,3509029,5485142,2960496,6504],CURVE_Pxb:[2740193,9341742,1001381,12716483,1808304,9913336,3647721,10490313,1701450,12184638,5222],
CURVE_Pya:[778399,16575439,11734267,8683201,6402877,14813539,1408430,14163490,3353485,15587698,2681],CURVE_Pyb:[10022557,4924040,15461776,6935277,8801957,3432898,5320077,3524324,12894352,801260,1558],CURVE_W:[[3140483,6506774,1179732,737336,0,96,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0]],CURVE_SB:[[[11538660,6506781,1212500,737336,0,96,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0]],[[8398177,7,32768,0,0,0,0,0,0,0,0],[12268522,6118688,12369341,100558,4183790,6738532,6584931,11582943,7350797,8,9216]]],CURVE_WB:[[8029360,2168918,11550748,245778,0,32,0,0,0,0,0],[2229365,16356798,10106573,11061887,8295661,2756032,2160,3145728,0,0,0],[15797139,16567008,13450086,13919551,4147830,1378016,1080,1572864,0,0,0],[16427537,2168925,11583516,245778,0,32,0,0,0,0,0]],CURVE_BB:[[[2821309,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[2821308,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[2821308,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[8398178,7,32768,0,0,0,0,0,0,0,0]],[[8398177,7,32768,0,0,0,0,0,0,0,0],[2821308,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[2821309,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[2821308,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216]],[[8398178,7,32768,0,0,0,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0]],[[12587698,3,16384,0,0,0,0,0,0,0,0],[19138,15,65536,0,0,0,0,0,0,0,0],[7010826,12625455,13516305,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[12587698,3,16384,0,0,0,0,0,0,0,0]]],USE_GLV:true,USE_GS_G2:true,USE_GS_GT:true,GT_STRONG:false};ROM_CURVE_BRAINPOOL={Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[15280900,8454654,2452197,11480905,9694148,7780287,7552267,16672423,14175908,6407216,26156],CURVE_Order:[4740775,950935,16224286,11887014,3766947,9269644,9477507,4089354,15641020,5757857,43515],CURVE_Gx:[1246708,9524782,2849185,8040380,10568388,6375855,11680357,7545363,13625271,15416513,41960],CURVE_Gy:[2476478,15266651,7595,3788839,12367582,4292201,14763588,8354594,3786093,7111220,11673]};ROM_CURVE_C25519={Curve_Cof_I:8,CURVE_A:486662,CURVE_B_I:0,CURVE_B:[0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[16110573,6494812,14047250,10680220,14612958,20,0,0,0,0,4096],CURVE_Gx:[9,0,0,0,0,0,0,0,0,0,0],CURVE_Gy:[0,0,0,0,0,0,0,0,0,0,0]};ROM_CURVE_C41417={Curve_Cof_I:8,CURVE_A:1,CURVE_B_I:3617,CURVE_B:[3617,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[438137,432004,110823,1635270,211117,900208,393771,340956,3983652,4194220,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,32767],CURVE_Gx:[771477,2116559,806867,1367833,3406504,311401,1489425,2806619,1349796,1441741,257151,2609456,869942,637311,405955,34352,1327920,2364496,107316],CURVE_Gy:[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};ROM_CURVE_ED25519={Curve_Cof_I:8,CURVE_A:-1,CURVE_B_I:0,CURVE_B:[5863587,5098003,11236843,4276696,7342669,15243264,7960441,9226048,7339635,7138859,20995],CURVE_Order:[16110573,6494812,14047250,10680220,14612958,20,0,0,0,0,4096],CURVE_Gx:[2479386,2973839,11716950,9774503,2934624,14441577,3276246,12625122,7230462,3593165,8553],CURVE_Gy:[6710872,6710886,6710886,6710886,6710886,6710886,6710886,6710886,6710886,6710886,26214]};ROM_CURVE_GOLDILOCKS={Curve_Cof_I:4,CURVE_A:1,CURVE_B_I:-39081,CURVE_B:[8349526,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8257535,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,2047],CURVE_Order:[5784819,337238,5541347,7220346,4990760,5375021,7058829,2583972,2353604,8321428,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,511],CURVE_Gx:[5592405,2796202,5592405,2796202,5592405,2796202,5592405,2796202,5592405,5417642,2796202,5592405,2796202,5592405,2796202,5592405,2796202,5592405,2796202,1365],CURVE_Gy:[1279725,7838677,3107755,945411,4926445,1251191,5147276,3322561,4503565,6624689,6262197,4353725,7996248,28122,2207916,7016488,897881,1420809,1549709,1392]};ROM_CURVE_HIFIVE={Curve_Cof_I:8,CURVE_A:1,CURVE_B_I:11111,CURVE_B:[11111,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[2074629,2829949,2747582,4180445,775864,5442072,4523390,3,0,0,0,0,0,0,2048],CURVE_Gx:[12,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Gy:[8291890,854539,7097083,5249838,5596428,3595115,2080013,6406286,3230534,7382947,5796865,815328,5656622,3719894,771]};ROM_CURVE_NIST256={Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[13787211,3948071,16137166,13390768,1902256,8830053,5600920,11791293,3838951,3528874,23238],CURVE_Order:[6497617,13288188,8713145,10950558,15137453,16777148,16777215,16777215,0,16776960,65535],CURVE_Gx:[10011286,3753432,10548385,3009331,228737,4256375,15033252,16301286,2900551,13759201,27415],CURVE_Gy:[12538357,4220983,13552566,7024990,13513559,10360363,4881423,9365483,1736603,4383486,20451]};ROM_CURVE_NIST384={Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[7088879,1170343,7645719,5338764,6527192,7035082,5506273,656455,4264451,6159618,6321777,4286664,5684799,1249728,1030649,1561585,45873],CURVE_Order:[4532595,3331481,7058352,4556091,2153252,3926787,8195531,3253952,8388551,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],CURVE_Gx:[7735991,3961060,3205457,8038731,3089883,4655776,2135306,8102128,1808473,4527951,3699949,355235,7466802,7460408,2277709,6623583,43655],CURVE_Gy:[6950495,3864865,7727372,7074828,728289,1573196,7175214,7149705,1342697,8016180,6541430,1499471,784681,7058387,625435,7284043,13847]};ROM_CURVE_NIST521={Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[5259008,4171990,4701460,6906279,4061315,6350510,5172335,2711646,1276694,2349309,5792997,544522,1644783,7804561,7128444,3747276,7250650,7146113,6850178,5307540,1630665,2610988,5221],CURVE_Order:[3695625,7224610,3861950,5038653,6069128,3802998,4047465,6684836,1469311,491103,4594206,8388562,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,32767],CURVE_Gx:[6667622,8151941,7333369,2839060,736280,1820265,6864874,974995,5843198,7331790,339321,6942165,7734964,4130069,5238088,4234370,4365412,4664168,8072600,5139697,7356494,3260630,12705],CURVE_Gy:[5334608,2682175,140026,1283602,4655210,7087783,5237569,2645120,2506949,3325416,6273482,7549284,5337715,194039,6738202,2237611,5871861,5831223,2719440,8932,631740,2436431,17934]};ROM_CURVE_NUMS256E={Curve_Cof_I:4,CURVE_A:1,CURVE_B_I:-15342,CURVE_B:[16761685,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,65535],CURVE_Order:[14502645,11636974,10164807,3103043,9788069,65,0,0,0,0,16384],CURVE_Gx:[15537114,12619822,8823006,14878773,3770894,10212876,6252832,13442621,15344509,1375082,35445],CURVE_Gy:[9079270,1501049,13840294,1082734,6250968,8392817,14263883,13538917,14230983,4104153,17621]};ROM_CURVE_NUMS256W={Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:152961,CURVE_B:[152961,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[5351461,2107719,6299819,15345244,3965557,16777188,16777215,16777215,16777215,16777215,65535],CURVE_Gx:[1748145,15605426,3849298,251079,5741321,13306243,10506050,2718357,11197281,14071386,48286],CURVE_Gy:[8707743,12176161,12288181,1388815,5620689,14693833,16219652,7554187,10073766,12644659,53391]};ROM_CURVE_NUMS384E={Curve_Cof_I:4,CURVE_A:1,CURVE_B_I:-11556,CURVE_B:[8376735,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],CURVE_Order:[2328957,3770829,6587111,5877315,4543914,3796028,2956024,2329870,8388578,8388607,8388607,8388607,8388607,8388607,8388607,8388607,16383],CURVE_Gx:[2124766,116952,5063509,2763936,2698006,6819326,3984472,3276756,4980823,904060,4992977,2813357,2173358,1578708,6965659,589218,25009],CURVE_Gy:[7508882,508896,7501364,3629638,2822036,4808718,8229221,511099,6248067,6939268,5944841,552632,1720891,1107734,6929324,2044892,33432]};ROM_CURVE_NUMS384W={Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:-34568,CURVE_B:[8353723,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],CURVE_Order:[942521,257270,6914358,6405907,2741204,1062875,3856218,1005455,8388566,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],CURVE_Gx:[1578282,7604289,7319154,8064547,7262464,6834757,4889393,6198413,7992563,1832707,562951,3116336,2237456,593945,6014471,2848856,30073],CURVE_Gy:[1574678,7461068,1667538,8365417,7032251,7329690,4490912,1065406,7576761,7336190,4198821,2522101,5439576,1768551,6742926,7451760,44254]};ROM_CURVE_NUMS512E={Curve_Cof_I:4,CURVE_A:1,CURVE_B_I:-78296,CURVE_B:[8309743,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,63],CURVE_Order:[7263341,1698359,8232218,7307111,6313862,6202696,6040993,2092132,1161886,5922719,5489037,8388605,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,15],CURVE_Gx:[7100414,5657395,5707494,6694784,5395495,1417724,1417793,6218953,7540600,1957004,1607429,6031930,7070323,4518959,7416032,7589798,3354577,1157002,6499810,3466192,5318875,7456301,55],CURVE_Gy:[6485473,4030851,8178103,6262400,7157929,4169804,703280,852803,3498592,6673196,207183,7608841,3758345,5580141,616264,8098668,7267446,5264458,4445662,5475525,3789980,2177022,27]};ROM_CURVE_NUMS512W={Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:121243,CURVE_B:[121243,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[3364189,8286728,997460,255634,6861670,3721066,6681647,6368374,203599,7809487,7139987,8388602,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,63],CURVE_Gx:[2862679,994073,750090,7043823,5636407,3171243,611717,3973443,3514003,2232022,4228741,3592138,795952,2662620,4226465,7085530,5413066,4225654,2998282,5545681,7422416,5768840,14],CURVE_Gy:[3483558,966768,2395778,6809727,3523044,4217317,2922133,1102880,7203265,3479069,659543,686245,6342589,1173860,7286499,7204693,19351,4708194,3914609,3513968,2267861,477849,37]};ROM_CURVE_SECP256K1={CURVE_Cof_I:1,CURVE_A:0,CURVE_B_I:7,CURVE_B:[7,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[3555649,6196432,3915730,11487392,11459814,16776890,16777215,16777215,16777215,16777215,65535],CURVE_Gx:[16258968,8477462,14244338,3001896,10222811,722690,9817735,5611618,14465964,6717177,31166],CURVE_Gy:[1103032,13668347,1678407,10913108,1553480,567549,16518673,6137083,10732645,14317350,18490]};var ROM_CURVE={ANSSI:ROM_CURVE_ANSSI,BLS383:ROM_CURVE_BLS383,BLS24:ROM_CURVE_BLS24,BLS48:ROM_CURVE_BLS48,BLS381:ROM_CURVE_BLS381,BLS461:ROM_CURVE_BLS461,FP256BN:ROM_CURVE_FP256BN,FP512BN:ROM_CURVE_FP512BN,BN254:ROM_CURVE_BN254,BN254CX:ROM_CURVE_BN254CX,BRAINPOOL:ROM_CURVE_BRAINPOOL,C25519:ROM_CURVE_C25519,C41417:ROM_CURVE_C41417,ED25519:ROM_CURVE_ED25519,GOLDILOCKS:ROM_CURVE_GOLDILOCKS,HIFIVE:ROM_CURVE_HIFIVE,NIST256:ROM_CURVE_NIST256,NIST384:ROM_CURVE_NIST384,NIST521:ROM_CURVE_NIST521,NUMS256E:ROM_CURVE_NUMS256E,NUMS256W:ROM_CURVE_NUMS256W,NUMS384E:ROM_CURVE_NUMS384E,NUMS384W:ROM_CURVE_NUMS384W,NUMS512E:ROM_CURVE_NUMS512E,NUMS512W:ROM_CURVE_NUMS512W,SECP256K1:ROM_CURVE_SECP256K1};var ROM_FIELD_25519,ROM_FIELD_256PM,ROM_FIELD_384PM,ROM_FIELD_512PM,ROM_FIELD_ANSSI,ROM_FIELD_BLS383,ROM_FIELD_BLS24,ROM_FIELD_BLS48,ROM_FIELD_BLS381,ROM_FIELD_BLS461,ROM_FIELD_FP256BN,ROM_FIELD_FP512BN,ROM_FIELD_BN254,ROM_FIELD_BN254CX,ROM_FIELD_BRAINPOOL,ROM_FIELD_C41417,ROM_FIELD_GOLDILOCKS,ROM_FIELD_HIFIVE,ROM_FIELD_NIST256,ROM_FIELD_NIST384,ROM_FIELD_NIST521,ROM_FIELD_SECP256K1;ROM_FIELD_25519={Modulus:[16777197,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,32767],R2modp:[10747904,5,0,0,0,0,0,0,0,0,0],MConst:19};ROM_FIELD_256PM={Modulus:[16777027,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,65535],R2modp:[8978432,139,0,0,0,0,0,0,0,0,0],MConst:189};ROM_FIELD_384PM={Modulus:[8388291,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],R2modp:[2244608,196,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:317};ROM_FIELD_512PM={Modulus:[8388039,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,63],R2modp:[0,362496,79,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:569};ROM_FIELD_ANSSI={Modulus:[7248899,15946712,7203068,11258058,6401468,4414265,15257154,1053293,3855759,1543179,61949],R2modp:[11332835,9584998,11603918,7142326,556738,4056125,13815655,10911198,11350258,772782,57240],MConst:5116245};ROM_FIELD_BLS383={Modulus:[2797739,3852555,3107036,5448745,4453016,2002769,5920841,1629184,2429356,5891787,177432,5542949,6046206,3411381,2808749,2837170,21861],R2modp:[2427460,6878831,932980,7935858,3483107,925205,3499542,5568036,5275753,2565731,4869296,3510931,5989747,651903,6202292,6356269,20839],MConst:3421693,Fra:[1170113,3037798,24907,7551903,1263631,1643629,3757110,2832933,1738370,2391924,3748275,5937032,8137745,422259,2087471,7004033,8876],Frb:[1627626,814757,3082129,6285450,3189384,359140,2163731,7184859,690985,3499863,4817765,7994524,6297068,2989121,721278,4221745,12984]};ROM_FIELD_BLS24={Modulus:[398635,183956,7069971,4286854,3145262,3593416,4658991,1656247,6227594,943169,1114502,323833,3364494,4853550,3174048,1522674,7241791,472536,3348202,245790,349632],R2modp:[2283258,8037017,4993150,6874897,8234158,3685571,1180812,72573,3974162,2941985,4797100,2597638,3410794,26222,4154741,3113532,658918,1277637,3658940,4760910,311947],MConst:1441405,Fra:[7958301,5150071,7255410,6841215,4325259,4647123,8026264,8155812,2393095,7240153,5654942,5158015,2608086,3393122,5150534,796568,3765577,4872987,6066358,4049523,310216],Frb:[828942,3422492,8203168,5834246,7208610,7334900,5021334,1889042,3834498,2091624,3848167,3554425,756407,1460428,6412122,726105,3476214,3988157,5670451,4584874,39415]};ROM_FIELD_BLS48={Modulus:[7777291,4988921,6798299,5452015,1470473,4524037,6406992,6331348,486190,4210957,1478740,3489281,1315585,6746993,3880282,7162501,3601413,2655242,4541107,2843699,2688122,746606,786239,6864578,15],R2modp:[6243010,5861e3,3070202,1427824,2431156,2782695,6475347,4398160,3994887,6426180,880589,137853,2087487,434329,341127,5500607,5563088,4735869,2241496,6498671,2223649,6362135,6397237,1287706,11],MConst:5931101,Fra:[2473865,7994150,5699976,3774996,5275299,489877,4122682,5434537,4076660,6233619,3046576,2449213,3860472,3034870,3923604,503898,1296444,8124004,2093695,7331970,3880654,1278227,7217154,5004291,2],Frb:[2473865,7994150,5699976,3774996,5275299,489877,4122682,5434537,4076660,6233619,3046576,2449213,3860472,3034870,3923604,503898,1296444,8124004,2093695,7331970,3880654,1278227,7217154,5004291,2]};ROM_FIELD_BLS381={Modulus:[8366763,8388607,8316923,696319,4194283,4490197,4041789,1599824,1228647,648970,1170734,6121147,8086580,4809588,6289830,587036,6657],R2modp:[4245222,924200,4004972,7152712,1814801,5156776,2268300,5041749,4641453,8104060,7374901,2364369,6750947,3735830,892479,4970076,2467],MConst:8191997,Fra:[2318264,7068452,7746589,2046985,6968278,3710671,6368942,1188331,6246267,8026490,4151311,6318328,7029250,7882295,3064217,6938497,6404],Frb:[6048499,1320155,570334,7037942,5614612,779525,6061455,411492,3370988,1011087,5408030,8191426,1057329,5315901,3225612,2037147,252]};ROM_FIELD_BLS461={Modulus:[2796203,341,2796208,2796117,85,524292,5595072,1267016,1884175,4191416,2951843,5809188,2935367,4610839,7297991,674223,5625492,3451572,1398069,2796202,1],R2modp:[6427800,3889247,267912,7305229,1557049,1412490,4790930,7568881,141830,4588131,2580466,5543619,7162578,3832646,3826467,1516465,7741515,6749478,5141566,1828462,0],MConst:8388605,Fra:[76346,3112759,15812,5426402,1860360,753428,4424148,5428008,5821535,3513488,1950412,6382978,8151531,7016901,6566940,4332336,5111546,3976132,1236954,1515560,1],Frb:[2719857,5276190,2780395,5758323,6528332,8159471,1170923,4227616,4451247,677927,1001431,7814818,3172443,5982545,731050,4730495,513945,7864048,161114,1280642,0]};ROM_FIELD_FP256BN={Modulus:[13840403,3005358,8573737,1218570,14444027,10788620,6221425,4646386,16576717,16777215,65535],R2modp:[3098625,16218577,4095854,11807290,13179337,12741640,1816341,13250262,5515582,939918,30954],MConst:3663333,Fra:[9711878,207023,9401462,1981106,10580305,6803257,9296648,2955886,7892789,7758538,15713],Frb:[4128525,2798335,15949491,16014679,3863721,3985363,13701993,1690499,8683928,9018677,49822]};ROM_FIELD_FP512BN={Modulus:[3010355,5247557,2020268,8020771,2448613,8139309,2803931,4600559,1620196,4020605,4528956,490026,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],R2modp:[2352733,5724727,4267216,2711475,6555241,3628137,598933,7570578,7867757,1822109,4291754,3000059,8301819,3305539,8335303,992908,7591731,2181065,2804947,3336952,3877918,870050,48],MConst:5004293,Fra:[3619506,3105769,4706904,1054070,1381622,5258286,3469153,5222464,2931637,5586186,6531042,1061916,4771630,3499223,2473444,5293353,4623182,2969999,450118,8160429,1897915,6218581,7],Frb:[7779457,2141787,5701972,6966700,1066991,2881023,7723386,7766702,7077166,6823026,6386521,7816717,7553516,4371108,857821,3476419,3700343,5415497,7938489,228178,6490692,2170026,56]};ROM_FIELD_BN254={Modulus:[19,0,1287936,0,2162688,2145,8388608,12203085,1,6586944,9507],R2modp:[3091111,5468231,16314740,12837732,11242524,3940405,431433,3641991,3925545,7692666,8007],MConst:9713125,Fra:[2780649,15122543,12771709,5062519,619666,9781125,5285958,11946395,3046540,7739681,6967],Frb:[13996586,1654672,5293442,11714696,1543021,6998236,3102649,256690,13730677,15624478,2539]};ROM_FIELD_BN254CX={Modulus:[1791411,2355036,14794342,1575230,4183790,6738724,6584931,11582943,7350797,8,9216],R2modp:[9365053,7479262,13371537,1098379,872282,4987131,9451258,4162655,10815460,7924521,5511],MConst:7904901,Fra:[13110947,537429,2186201,15823864,6779686,1611880,9088167,11526539,3801444,536486,4953],Frb:[5457680,1817606,12608141,2528582,14181319,5126843,14273980,56403,3549353,16240738,4262]};ROM_FIELD_BRAINPOOL={Modulus:[7230327,4726047,2629651,13968928,3929635,9269870,9477507,4089354,15641020,5757857,43515],R2modp:[3520537,11547688,15511311,3691684,4853461,2367978,11163180,1023045,14528088,4411645,21176],MConst:16615865};ROM_FIELD_C41417={Modulus:[4194287,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,262143],R2modp:[73984,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:17};ROM_FIELD_GOLDILOCKS={Modulus:[8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8257535,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,2047],R2modp:[0,4,0,0,0,0,0,0,0,0,786432,0,0,0,0,0,0,0,0,0],MConst:1};ROM_FIELD_HIFIVE={Modulus:[8388605,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,16383],R2modp:[2359296,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:3};ROM_FIELD_NIST256={Modulus:[16777215,16777215,16777215,16777215,0,0,0,0,1,16776960,65535],R2modp:[196608,0,0,16776960,16515071,16777215,16777214,16777215,16646143,16777215,4],MConst:1};ROM_FIELD_NIST384={Modulus:[8388607,511,0,0,8388592,8380415,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],R2modp:[16384,0,8388606,511,524288,0,0,8372224,4194303,0,512,131072,0,0,0,0,0],MConst:1};ROM_FIELD_NIST521={Modulus:[8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,32767],R2modp:[65536,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:1};ROM_FIELD_SECP256K1={Modulus:[16776239,16776959,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,65535],R2modp:[10551296,3728,1954,256,0,0,0,0,0,0,0],MConst:2438449};var ROM_FIELD={25519:ROM_FIELD_25519,"256PM":ROM_FIELD_256PM,"384PM":ROM_FIELD_384PM,"512PM":ROM_FIELD_512PM,ANSSI:ROM_FIELD_ANSSI,BLS383:ROM_FIELD_BLS383,BLS24:ROM_FIELD_BLS24,BLS48:ROM_FIELD_BLS48,BLS381:ROM_FIELD_BLS381,BLS461:ROM_FIELD_BLS461,FP256BN:ROM_FIELD_FP256BN,FP512BN:ROM_FIELD_FP512BN,BN254:ROM_FIELD_BN254,BN254CX:ROM_FIELD_BN254CX,BRAINPOOL:ROM_FIELD_BRAINPOOL,C41417:ROM_FIELD_C41417,GOLDILOCKS:ROM_FIELD_GOLDILOCKS,HIFIVE:ROM_FIELD_HIFIVE,NIST256:ROM_FIELD_NIST256,NIST384:ROM_FIELD_NIST384,NIST521:ROM_FIELD_NIST521,SECP256K1:ROM_FIELD_SECP256K1};function RSA(ctx){var RSA={RFS:ctx.BIG.MODBYTES*ctx.FF.FFLEN,SHA256:32,SHA384:48,SHA512:64,HASH_TYPE:32,SHA256ID:[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],SHA384ID:[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],SHA512ID:[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],bytestohex:function(b){var s="",len=b.length,ch,i;for(i=0;i<len;i++){ch=b[i];s+=(ch>>>4&15).toString(16);s+=(ch&15).toString(16)}return s},bytestostring:function(b){var s="",i;for(i=0;i<b.length;i++){s+=String.fromCharCode(b[i])}return s},stringtobytes:function(s){var b=[],i;for(i=0;i<s.length;i++){b.push(s.charCodeAt(i))}return b},hashit:function(sha,A,n){var R=[],H;if(sha==this.SHA256){H=new ctx.HASH256;if(A!=null){H.process_array(A)}if(n>=0){H.process_num(n)}R=H.hash()}else if(sha==this.SHA384){H=new ctx.HASH384;if(A!=null){H.process_array(A)}if(n>=0){H.process_num(n)}R=H.hash()}else if(sha==this.SHA512){H=new ctx.HASH512;if(A!=null){H.process_array(A)}if(n>=0){H.process_num(n)}R=H.hash()}return R},KEY_PAIR:function(rng,e,PRIV,PUB){var n=PUB.n.length>>1,t=new ctx.FF(n),p1=new ctx.FF(n),q1=new ctx.FF(n);for(;;){PRIV.p.random(rng);while(PRIV.p.lastbits(2)!=3){PRIV.p.inc(1)}while(!ctx.FF.prime(PRIV.p,rng)){PRIV.p.inc(4)}p1.copy(PRIV.p);p1.dec(1);if(p1.cfactor(e)){continue}break}for(;;){PRIV.q.random(rng);while(PRIV.q.lastbits(2)!=3){PRIV.q.inc(1)}while(!ctx.FF.prime(PRIV.q,rng)){PRIV.q.inc(4)}q1.copy(PRIV.q);q1.dec(1);if(q1.cfactor(e)){continue}break}PUB.n=ctx.FF.mul(PRIV.p,PRIV.q);PUB.e=e;t.copy(p1);t.shr();PRIV.dp.set(e);PRIV.dp.invmodp(t);if(PRIV.dp.parity()===0){PRIV.dp.add(t)}PRIV.dp.norm();t.copy(q1);t.shr();PRIV.dq.set(e);PRIV.dq.invmodp(t);if(PRIV.dq.parity()===0){PRIV.dq.add(t)}PRIV.dq.norm();PRIV.c.copy(PRIV.p);PRIV.c.invmodp(PRIV.q);return},MGF1:function(sha,Z,olen,K){var hlen=sha,B=[],k=0,counter,cthreshold,i;for(i=0;i<K.length;i++){K[i]=0}cthreshold=Math.floor(olen/hlen);if(olen%hlen!==0){cthreshold++}for(counter=0;counter<cthreshold;counter++){B=this.hashit(sha,Z,counter);if(k+hlen>olen){for(i=0;i<olen%hlen;i++){K[k++]=B[i]}}else{for(i=0;i<hlen;i++){K[k++]=B[i]}}}},PKCS15:function(sha,m,w){var olen=ctx.FF.FF_BITS/8,hlen=sha,idlen=19,H,i,j;if(olen<idlen+hlen+10){return false}H=this.hashit(sha,m,-1);for(i=0;i<w.length;i++){w[i]=0}i=0;w[i++]=0;w[i++]=1;for(j=0;j<olen-idlen-hlen-3;j++){w[i++]=255}w[i++]=0;if(hlen==this.SHA256){for(j=0;j<idlen;j++){w[i++]=this.SHA256ID[j]}}else if(hlen==this.SHA384){for(j=0;j<idlen;j++){w[i++]=this.SHA384ID[j]}}else if(hlen==this.SHA512){for(j=0;j<idlen;j++){w[i++]=this.SHA512ID[j]}}for(j=0;j<hlen;j++){w[i++]=H[j]}return true},OAEP_ENCODE:function(sha,m,rng,p){var olen=RSA.RFS-1,mlen=m.length,SEED=[],DBMASK=[],f=[],hlen,seedlen,slen,i,d,h;seedlen=hlen=sha;if(mlen>olen-hlen-seedlen-1){return null}h=this.hashit(sha,p,-1);for(i=0;i<hlen;i++){f[i]=h[i]}slen=olen-mlen-hlen-seedlen-1;for(i=0;i<slen;i++){f[hlen+i]=0}f[hlen+slen]=1;for(i=0;i<mlen;i++){f[hlen+slen+1+i]=m[i]}for(i=0;i<seedlen;i++){SEED[i]=rng.getByte()}this.MGF1(sha,SEED,olen-seedlen,DBMASK);for(i=0;i<olen-seedlen;i++){DBMASK[i]^=f[i]}this.MGF1(sha,DBMASK,seedlen,f);for(i=0;i<seedlen;i++){f[i]^=SEED[i]}for(i=0;i<olen-seedlen;i++){f[i+seedlen]=DBMASK[i]}d=1;for(i=RSA.RFS-1;i>=d;i--){f[i]=f[i-d]}for(i=d-1;i>=0;i--){f[i]=0}return f},OAEP_DECODE:function(sha,p,f){var olen=RSA.RFS-1,SEED=[],CHASH=[],DBMASK=[],comp,hlen,seedlen,x,t,d,i,k,h,r;seedlen=hlen=sha;if(olen<seedlen+hlen+1){return null}for(i=0;i<olen-seedlen;i++){DBMASK[i]=0}if(f.length<RSA.RFS){d=RSA.RFS-f.length;for(i=RSA.RFS-1;i>=d;i--){f[i]=f[i-d]}for(i=d-1;i>=0;i--){f[i]=0}}h=this.hashit(sha,p,-1);for(i=0;i<hlen;i++){CHASH[i]=h[i]}x=f[0];for(i=seedlen;i<olen;i++){DBMASK[i-seedlen]=f[i+1]}this.MGF1(sha,DBMASK,seedlen,SEED);for(i=0;i<seedlen;i++){SEED[i]^=f[i+1]}this.MGF1(sha,SEED,olen-seedlen,f);for(i=0;i<olen-seedlen;i++){DBMASK[i]^=f[i]}comp=true;for(i=0;i<hlen;i++){if(CHASH[i]!=DBMASK[i]){comp=false}}for(i=0;i<olen-seedlen-hlen;i++){DBMASK[i]=DBMASK[i+hlen]}for(i=0;i<hlen;i++){SEED[i]=CHASH[i]=0}for(k=0;;k++){if(k>=olen-seedlen-hlen){return null}if(DBMASK[k]!==0){break}}t=DBMASK[k];if(!comp||x!==0||t!=1){for(i=0;i<olen-seedlen;i++){DBMASK[i]=0}return null}r=[];for(i=0;i<olen-seedlen-hlen-k-1;i++){r[i]=DBMASK[i+k+1]}for(i=0;i<olen-seedlen;i++){DBMASK[i]=0}return r},PRIVATE_KEY_KILL:function(PRIV){PRIV.p.zero();PRIV.q.zero();PRIV.dp.zero();PRIV.dq.zero();PRIV.c.zero()},ENCRYPT:function(PUB,F,G){var n=PUB.n.getlen(),f=new ctx.FF(n);ctx.FF.fromBytes(f,F);f.power(PUB.e,PUB.n);f.toBytes(G)},DECRYPT:function(PRIV,G,F){var n=PRIV.p.getlen(),g=new ctx.FF(2*n),jp,jq,t;ctx.FF.fromBytes(g,G);jp=g.dmod(PRIV.p);jq=g.dmod(PRIV.q);jp.skpow(PRIV.dp,PRIV.p);jq.skpow(PRIV.dq,PRIV.q);g.zero();g.dscopy(jp);jp.mod(PRIV.q);if(ctx.FF.comp(jp,jq)>0){jq.add(PRIV.q)}jq.sub(jp);jq.norm();t=ctx.FF.mul(PRIV.c,jq);jq=t.dmod(PRIV.q);t=ctx.FF.mul(jq,PRIV.p);g.add(t);g.norm();g.toBytes(F)}};return RSA}function rsa_private_key(ctx){var rsa_private_key=function(n){this.p=new ctx.FF(n);this.q=new ctx.FF(n);this.dp=new ctx.FF(n);this.dq=new ctx.FF(n);this.c=new ctx.FF(n)};return rsa_private_key}function rsa_public_key(ctx){var rsa_public_key=function(m){this.e=0;this.n=new ctx.FF(m)};return rsa_public_key}function SHA3(ctx){var SHA3=function(olen){this.length=0;this.rate=0;this.len=0;this.S=[];this.init(olen)};SHA3.prototype={transform:function(){var C=[],D=[],B=[],i,j,k;for(k=0;k<SHA3.ROUNDS;k++){C[0]=new ctx.UInt64(this.S[0][0].top^this.S[0][1].top^this.S[0][2].top^this.S[0][3].top^this.S[0][4].top,this.S[0][0].bot^this.S[0][1].bot^this.S[0][2].bot^this.S[0][3].bot^this.S[0][4].bot);C[1]=new ctx.UInt64(this.S[1][0].top^this.S[1][1].top^this.S[1][2].top^this.S[1][3].top^this.S[1][4].top,this.S[1][0].bot^this.S[1][1].bot^this.S[1][2].bot^this.S[1][3].bot^this.S[1][4].bot);C[2]=new ctx.UInt64(this.S[2][0].top^this.S[2][1].top^this.S[2][2].top^this.S[2][3].top^this.S[2][4].top,this.S[2][0].bot^this.S[2][1].bot^this.S[2][2].bot^this.S[2][3].bot^this.S[2][4].bot);C[3]=new ctx.UInt64(this.S[3][0].top^this.S[3][1].top^this.S[3][2].top^this.S[3][3].top^this.S[3][4].top,this.S[3][0].bot^this.S[3][1].bot^this.S[3][2].bot^this.S[3][3].bot^this.S[3][4].bot);C[4]=new ctx.UInt64(this.S[4][0].top^this.S[4][1].top^this.S[4][2].top^this.S[4][3].top^this.S[4][4].top,this.S[4][0].bot^this.S[4][1].bot^this.S[4][2].bot^this.S[4][3].bot^this.S[4][4].bot);D[0]=SHA3.xor(C[4],SHA3.rotl(C[1],1));D[1]=SHA3.xor(C[0],SHA3.rotl(C[2],1));D[2]=SHA3.xor(C[1],SHA3.rotl(C[3],1));D[3]=SHA3.xor(C[2],SHA3.rotl(C[4],1));D[4]=SHA3.xor(C[3],SHA3.rotl(C[0],1));for(i=0;i<5;i++){B[i]=[];for(j=0;j<5;j++){B[i][j]=new ctx.UInt64(0,0);this.S[i][j]=SHA3.xor(this.S[i][j],D[i])}}B[0][0]=this.S[0][0].copy();B[1][3]=SHA3.rotl(this.S[0][1],36);B[2][1]=SHA3.rotl(this.S[0][2],3);B[3][4]=SHA3.rotl(this.S[0][3],41);B[4][2]=SHA3.rotl(this.S[0][4],18);B[0][2]=SHA3.rotl(this.S[1][0],1);B[1][0]=SHA3.rotl(this.S[1][1],44);B[2][3]=SHA3.rotl(this.S[1][2],10);B[3][1]=SHA3.rotl(this.S[1][3],45);B[4][4]=SHA3.rotl(this.S[1][4],2);B[0][4]=SHA3.rotl(this.S[2][0],62);B[1][2]=SHA3.rotl(this.S[2][1],6);B[2][0]=SHA3.rotl(this.S[2][2],43);B[3][3]=SHA3.rotl(this.S[2][3],15);B[4][1]=SHA3.rotl(this.S[2][4],61);B[0][1]=SHA3.rotl(this.S[3][0],28);B[1][4]=SHA3.rotl(this.S[3][1],55);B[2][2]=SHA3.rotl(this.S[3][2],25);B[3][0]=SHA3.rotl(this.S[3][3],21);B[4][3]=SHA3.rotl(this.S[3][4],56);B[0][3]=SHA3.rotl(this.S[4][0],27);B[1][1]=SHA3.rotl(this.S[4][1],20);B[2][4]=SHA3.rotl(this.S[4][2],39);B[3][2]=SHA3.rotl(this.S[4][3],8);B[4][0]=SHA3.rotl(this.S[4][4],14);for(i=0;i<5;i++){for(j=0;j<5;j++){this.S[i][j]=SHA3.xor(B[i][j],SHA3.and(SHA3.not(B[(i+1)%5][j]),B[(i+2)%5][j]))}}this.S[0][0]=SHA3.xor(this.S[0][0],SHA3.RC[k])}},init:function(olen){var i,j;for(i=0;i<5;i++){this.S[i]=[];for(j=0;j<5;j++){this.S[i][j]=new ctx.UInt64(0,0)}}this.length=0;this.len=olen;this.rate=200-2*olen},process:function(byt){var i,j,k,b,cnt,el;cnt=this.length%this.rate;b=cnt%8;cnt>>=3;i=cnt%5;j=Math.floor(cnt/5);el=new ctx.UInt64(0,byt);for(k=0;k<b;k++){el.shlb()}this.S[i][j]=SHA3.xor(this.S[i][j],el);this.length++;if(this.length%this.rate==0){this.transform()}},squeeze:function(buff,olen){var done,m=0,i,j,k,el;done=false;for(;;){for(j=0;j<5;j++){for(i=0;i<5;i++){el=this.S[i][j].copy();for(k=0;k<8;k++){buff[m++]=el.bot&255;if(m>=olen||m%this.rate==0){done=true;break}el=SHA3.rotl(el,56)}if(done){break}}if(done){break}}if(m>=olen){break}done=false;this.transform()}},hash:function(buff){var q=this.rate-this.length%this.rate;if(q==1){this.process(134)}else{this.process(6);while(this.length%this.rate!=this.rate-1){this.process(0)}this.process(128)}this.squeeze(buff,this.len)},shake:function(buff,olen){var q=this.rate-this.length%this.rate;if(q==1){this.process(159)}else{this.process(31);while(this.length%this.rate!=this.rate-1){this.process(0)}this.process(128)}this.squeeze(buff,olen)}};SHA3.rotl=function(x,n){if(n==0){return x}if(n<32){return new ctx.UInt64(x.top<<n|x.bot>>>32-n,x.bot<<n|x.top>>>32-n)}else{return new ctx.UInt64(x.bot<<n-32|x.top>>>64-n,x.top<<n-32|x.bot>>>64-n)}};SHA3.xor=function(a,b){return new ctx.UInt64(a.top^b.top,a.bot^b.bot)};SHA3.and=function(a,b){return new ctx.UInt64(a.top&b.top,a.bot&b.bot)};SHA3.not=function(a){return new ctx.UInt64(~a.top,~a.bot)};SHA3.ROUNDS=24;SHA3.HASH224=28;SHA3.HASH256=32;SHA3.HASH384=48;SHA3.HASH512=64;SHA3.SHAKE128=16;SHA3.SHAKE256=32;SHA3.RC=[new ctx.UInt64(0,1),new ctx.UInt64(0,32898),new ctx.UInt64(2147483648,32906),new ctx.UInt64(2147483648,2147516416),new ctx.UInt64(0,32907),new ctx.UInt64(0,2147483649),new ctx.UInt64(2147483648,2147516545),new ctx.UInt64(2147483648,32777),new ctx.UInt64(0,138),new ctx.UInt64(0,136),new ctx.UInt64(0,2147516425),new ctx.UInt64(0,2147483658),new ctx.UInt64(0,2147516555),new ctx.UInt64(2147483648,139),new ctx.UInt64(2147483648,32905),new ctx.UInt64(2147483648,32771),new ctx.UInt64(2147483648,32770),new ctx.UInt64(2147483648,128),new ctx.UInt64(0,32778),new ctx.UInt64(2147483648,2147483658),new ctx.UInt64(2147483648,2147516545),new ctx.UInt64(2147483648,32896),new ctx.UInt64(0,2147483649),new ctx.UInt64(2147483648,2147516424)];return SHA3}function UInt64(){var UInt64=function(top,bot){this.top=top;this.bot=bot};UInt64.prototype={add:function(y){var t=(this.bot>>>0)+(y.bot>>>0),low=t>>>0,high=(this.top>>>0)+(y.top>>>0);this.bot=low;if(low!=t){this.top=high+1>>>0}else{this.top=high}return this},copy:function(){var r=new UInt64(this.top,this.bot);return r},shlb:function(){var t=this.bot>>>24;this.top=t+(this.top<<8);this.bot<<=8;return this}};return UInt64}function CTX(input_parameter){var ctx=this,CTXLIST;CTXLIST={ED25519:{BITS:"256",FIELD:"25519",CURVE:"ED25519","@NB":32,"@BASE":24,"@NBT":255,"@M8":5,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},C25519:{BITS:"256",FIELD:"25519",CURVE:"C25519","@NB":32,"@BASE":24,"@NBT":255,"@M8":5,"@MT":1,"@CT":2,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},SECP256K1:{BITS:"256",FIELD:"SECP256K1",CURVE:"SECP256K1","@NB":32,"@BASE":24,"@NBT":256,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},NIST256:{BITS:"256",FIELD:"NIST256",CURVE:"NIST256","@NB":32,"@BASE":24,"@NBT":256,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},NIST384:{BITS:"384",FIELD:"NIST384",CURVE:"NIST384","@NB":48,"@BASE":23,"@NBT":384,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":48,"@AK":24},BRAINPOOL:{BITS:"256",FIELD:"BRAINPOOL",CURVE:"BRAINPOOL","@NB":32,"@BASE":24,"@NBT":256,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},ANSSI:{BITS:"256",FIELD:"ANSSI",CURVE:"ANSSI","@NB":32,"@BASE":24,"@NBT":256,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},HIFIVE:{BITS:"336",FIELD:"HIFIVE",CURVE:"HIFIVE","@NB":42,
"@BASE":23,"@NBT":336,"@M8":5,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":48,"@AK":24},GOLDILOCKS:{BITS:"448",FIELD:"GOLDILOCKS",CURVE:"GOLDILOCKS","@NB":56,"@BASE":23,"@NBT":448,"@M8":7,"@MT":2,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},C41417:{BITS:"416",FIELD:"C41417",CURVE:"C41417","@NB":52,"@BASE":22,"@NBT":414,"@M8":7,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},NIST521:{BITS:"528",FIELD:"NIST521",CURVE:"NIST521","@NB":66,"@BASE":23,"@NBT":521,"@M8":7,"@MT":1,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},NUMS256W:{BITS:"256",FIELD:"256PM",CURVE:"NUMS256W","@NB":32,"@BASE":24,"@NBT":256,"@M8":3,"@MT":1,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},NUMS256E:{BITS:"256",FIELD:"256PM",CURVE:"NUMS256E","@NB":32,"@BASE":24,"@NBT":256,"@M8":3,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},NUMS384W:{BITS:"384",FIELD:"384PM",CURVE:"NUMS384W","@NB":48,"@BASE":23,"@NBT":384,"@M8":3,"@MT":1,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":48,"@AK":24},NUMS384E:{BITS:"384",FIELD:"384PM",CURVE:"NUMS384E","@NB":48,"@BASE":23,"@NBT":384,"@M8":3,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":48,"@AK":24},NUMS512W:{BITS:"512",FIELD:"512PM",CURVE:"NUMS512W","@NB":64,"@BASE":23,"@NBT":512,"@M8":7,"@MT":1,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},NUMS512E:{BITS:"512",FIELD:"512PM",CURVE:"NUMS512E","@NB":64,"@BASE":23,"@NBT":512,"@M8":7,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},FP256BN:{BITS:"256",FIELD:"FP256BN",CURVE:"FP256BN","@NB":32,"@BASE":24,"@NBT":256,"@M8":3,"@MT":0,"@CT":0,"@PF":1,"@ST":1,"@SX":1,"@HT":32,"@AK":16},FP512BN:{BITS:"512",FIELD:"FP512BN",CURVE:"FP512BN","@NB":64,"@BASE":23,"@NBT":512,"@M8":3,"@MT":0,"@CT":0,"@PF":1,"@ST":1,"@SX":0,"@HT":32,"@AK":16},BN254:{BITS:"256",FIELD:"BN254",CURVE:"BN254","@NB":32,"@BASE":24,"@NBT":254,"@M8":3,"@MT":0,"@CT":0,"@PF":1,"@ST":0,"@SX":1,"@HT":32,"@AK":16},BN254CX:{BITS:"256",FIELD:"BN254CX",CURVE:"BN254CX","@NB":32,"@BASE":24,"@NBT":254,"@M8":3,"@MT":0,"@CT":0,"@PF":1,"@ST":0,"@SX":1,"@HT":32,"@AK":16},BLS383:{BITS:"384",FIELD:"BLS383",CURVE:"BLS383","@NB":48,"@BASE":23,"@NBT":383,"@M8":3,"@MT":0,"@CT":0,"@PF":2,"@ST":1,"@SX":0,"@HT":32,"@AK":16},BLS24:{BITS:"480",FIELD:"BLS24",CURVE:"BLS24","@NB":60,"@BASE":23,"@NBT":479,"@M8":3,"@MT":0,"@CT":0,"@PF":3,"@ST":1,"@SX":0,"@HT":48,"@AK":24},BLS48:{BITS:"560",FIELD:"BLS48",CURVE:"BLS48","@NB":70,"@BASE":23,"@NBT":556,"@M8":3,"@MT":0,"@CT":0,"@PF":4,"@ST":1,"@SX":0,"@HT":64,"@AK":32},BLS381:{BITS:"381",FIELD:"BLS381",CURVE:"BLS381","@NB":48,"@BASE":23,"@NBT":381,"@M8":3,"@MT":0,"@CT":0,"@PF":2,"@ST":1,"@SX":1,"@HT":32,"@AK":16},BLS461:{BITS:"464",FIELD:"BLS461",CURVE:"BLS461","@NB":58,"@BASE":23,"@NBT":461,"@M8":3,"@MT":0,"@CT":0,"@PF":2,"@ST":1,"@SX":1,"@HT":32,"@AK":16},RSA2048:{BITS:"1024",TFF:"2048","@NB":128,"@BASE":22,"@ML":2},RSA3072:{BITS:"384",TFF:"3072","@NB":48,"@BASE":23,"@ML":8},RSA4096:{BITS:"512",TFF:"4096","@NB":64,"@BASE":23,"@ML":8}};ctx["AES"]=AES();ctx["GCM"]=GCM(ctx);ctx["UInt64"]=UInt64();ctx["HASH256"]=HASH256();ctx["HASH384"]=HASH384(ctx);ctx["HASH512"]=HASH512(ctx);ctx["SHA3"]=SHA3(ctx);ctx["RAND"]=RAND(ctx);ctx["NHS"]=NHS(ctx);if(typeof input_parameter==="undefined"){return}ctx.config=CTXLIST[input_parameter];ctx["BIG"]=BIG(ctx);ctx["DBIG"]=DBIG(ctx);if(typeof ctx.config["TFF"]!=="undefined"){ctx["FF"]=FF(ctx);ctx["RSA"]=RSA(ctx);ctx["rsa_public_key"]=rsa_public_key(ctx);ctx["rsa_private_key"]=rsa_private_key(ctx);return}if(typeof ctx.config["CURVE"]!=="undefined"){ctx["ROM_CURVE"]=ROM_CURVE[ctx.config["CURVE"]];ctx["ROM_FIELD"]=ROM_FIELD[ctx.config["FIELD"]];ctx["FP"]=FP(ctx);ctx["ECP"]=ECP(ctx);ctx["ECDH"]=ECDH(ctx);if(ctx.config["@PF"]==1||ctx.config["@PF"]==2){ctx["FP2"]=FP2(ctx);ctx["FP4"]=FP4(ctx);ctx["FP12"]=FP12(ctx);ctx["ECP2"]=ECP2(ctx);ctx["PAIR"]=PAIR(ctx);ctx["MPIN"]=MPIN(ctx)}if(ctx.config["@PF"]==3){ctx["FP2"]=FP2(ctx);ctx["FP4"]=FP4(ctx);ctx["FP8"]=FP8(ctx);ctx["FP24"]=FP24(ctx);ctx["ECP4"]=ECP4(ctx);ctx["PAIR192"]=PAIR192(ctx);ctx["MPIN192"]=MPIN192(ctx)}if(ctx.config["@PF"]==4){ctx["FP2"]=FP2(ctx);ctx["FP4"]=FP4(ctx);ctx["FP8"]=FP8(ctx);ctx["FP16"]=FP16(ctx);ctx["FP48"]=FP48(ctx);ctx["ECP8"]=ECP8(ctx);ctx["PAIR256"]=PAIR256(ctx);ctx["MPIN256"]=MPIN256(ctx)}return}}function Users(storage,projectId,storageKey){var self=this;if(typeof storage.getItem!=="function"||typeof storage.setItem!=="function"){throw new Error("Invalid user storage object")}self.storage=storage;self.customerId=projectId;self.storageKey=storageKey?storageKey:"mfa";self.loadData()}Users.prototype.data=[],Users.prototype.states={invalid:"INVALID",start:"STARTED",active:"ACTIVATED",register:"REGISTERED",revoked:"REVOKED"};Users.prototype.loadData=function(){var self=this;self.data=JSON.parse(self.storage.getItem(self.storageKey))||[];self.store();self.data.sort(function(a,b){if(a.lastUsed&&(!b.lastUsed||a.lastUsed>b.lastUsed)){return 1}if(b.lastUsed&&(!a.lastUsed||a.lastUsed<b.lastUsed)){return-1}return 0})};Users.prototype.write=function(userId,userData){var self=this,i,uKey;if(!self.exists(userId)){self.data.push({userId:userId,customerId:self.customerId,state:self.states.invalid,created:Math.round((new Date).getTime()/1e3)})}for(i=0;i<self.data.length;++i){if(self.data[i].userId===userId&&self.data[i].customerId===self.customerId){for(uKey in userData){if(userData[uKey]){self.data[i][uKey]=userData[uKey]}}}}self.store()};Users.prototype.updateLastUsed=function(userId){this.write(userId,{lastUsed:(new Date).getTime()})};Users.prototype.exists=function(userId){return typeof this.get(userId,"userId")!=="undefined"};Users.prototype.is=function(userId,state){return this.get(userId,"state")===state};Users.prototype.get=function(userId,userProperty){var self=this,i;for(i=0;i<self.data.length;++i){if(self.data[i].userId===userId&&self.data[i].customerId===self.customerId){if(userProperty){return self.data[i][userProperty]||""}else{return self.data[i]}}}};Users.prototype.list=function(){var self=this,usersList={},i;for(i=0;i<self.data.length;++i){if(self.data[i].customerId===self.customerId){usersList[self.data[i].userId]=self.data[i].state}}return usersList};Users.prototype.remove=function(userId){var self=this,i;if(!self.exists(userId)){return}for(i=0;i<self.data.length;++i){if(self.data[i].userId===userId&&self.data[i].customerId===self.customerId){self.data.splice(i,1)}}self.store()};Users.prototype.store=function(){var self=this,i;for(i=0;i<self.data.length;++i){delete self.data[i].csHex;delete self.data[i].regOTT}self.storage.setItem(self.storageKey,JSON.stringify(self.data))};var CryptoContexts={},RequestError=createErrorType("RequestError",["message","status"]),CryptoError=createErrorType("CryptoError",["message","code"]),NotVerifiedError=createErrorType("NotVerifiedError",["message"]),VerificationExpiredError=createErrorType("VerificationExpiredError",["message"]),IdentityError=createErrorType("IdentityError",["message"]),InvalidRegCodeError=createErrorType("InvalidRegCodeError",["message"]);function createErrorType(name,params){function CustomError(){for(var i=0;i<params.length;++i){this[params[i]]=arguments[i]||""}this.stack=(new Error).stack}CustomError.prototype=new Error;CustomError.prototype.name=name;CustomError.prototype.constructor=CustomError;return CustomError}function Client(options){var self=this;if(!options){throw new Error("Missing options")}if(!options.projectId){throw new Error("Missing project ID")}if(!options.userStorage){throw new Error("Missing user storage object")}if(!options.server){options.server="https://api.mpin.io"}else{options.server=options.server.replace(/\/$/,"")}if(!options.defaultPinLength||options.defaultPinLength>6||options.defaultPinLength<4){options.defaultPinLength=4}if(!options.requestTimeout||isNaN(options.requestTimeout)){options.requestTimeout=4e3}self.options=options;self.rng=new(self._crypto().RAND);self.rng.clean();self.users=new Users(options.userStorage,options.projectId,"mfa");self.dvsUsers=new Users(options.userStorage,options.projectId,"dvs")}Client.prototype.options={};Client.prototype.session={};Client.prototype._crypto=function(curve){if(!curve){curve="BN254CX"}if(!CryptoContexts[curve]){CryptoContexts[curve]=new CTX(curve);CryptoContexts[curve].MPIN.MAXPIN=1e6;CryptoContexts[curve].MPIN.PBLEN=20;CryptoContexts[curve].MPIN.TRAP=2e3}return CryptoContexts[curve]};Client.prototype._seedRNG=function(seedHex){var self=this,entropyBytes;seedHex=seedHex+self.options.seed;entropyBytes=self._hexToBytes(seedHex);self.rng.seed(entropyBytes.length,entropyBytes)};Client.prototype.setAccessId=function(accessId){this.session.accessId=accessId};Client.prototype.fetchAccessId=function(userId,callback){var self=this,reqData;reqData={url:self.options.server+"/authorize?"+self._urlEncode(self.options.oidc),type:"POST",data:{prerollId:userId,registerOnly:self.options.registerOnly?true:false}};self._request(reqData,function(error,res){if(error){return callback(error,null)}if(!res.webOTT||!res.accessURL||!res.qrURL||!res.accessId){return callback(new Error("Missing initial request params"),null)}self.session=res;callback(null,res)})};Client.prototype.fetchStatus=function(callback){var self=this,reqData;reqData={url:self.options.server+"/rps/v2/access",type:"POST",data:{webOTT:self.session.webOTT}};self._request(reqData,function(error,data){if(error){return callback(error,null)}if(!data||!data.status){return callback(new Error("Missing status data"),null)}callback(null,data)})};Client.prototype.sendPushNotificationForAuth=function(userId,callback){var self=this,reqData;if(!userId){return callback(new Error("Missing user ID"),null)}reqData={url:self.options.server+"/pushauth?"+self._urlEncode(self.options.oidc),type:"POST",data:{prerollId:userId}};self._request(reqData,function(err,result){if(err){return callback(err,null)}self.session.webOTT=result.webOTT;callback(null,result)})};Client.prototype.sendVerificationEmail=function(userId,callback){var self=this,reqData={};reqData.url=self.options.server+"/verification";reqData.type="POST";reqData.data={userId:userId,clientId:self.options.oidc.client_id,redirectURI:self.options.oidc.redirect_uri,accessId:self.session.accessId,deviceName:self._getDeviceName()};self._request(reqData,callback)};Client.prototype.getActivationToken=function(verificationURI,callback){var self=this,reqData={},params;params=self._parseUriParams(verificationURI);reqData.url=self.options.server+"/verification/confirmation";reqData.type="POST";reqData.data={userId:params["user_id"],code:params["code"],clientId:params["client_id"],redirectUri:params["redirect_uri"],state:params["state"],stage:params["stage"]};self._request(reqData,function(err,data){if(err){return callback(err,data)}data.userId=params["user_id"];callback(null,data)})};Client.prototype.register=function(userId,activationToken,pinCallback,callback){var self=this;if(!userId){throw new Error("Missing user ID")}self._registration(userId,activationToken,function(err,regData){if(err){return callback(err,null)}self._getSecret1(userId,regData,function(err,sec1Data){if(err){return callback(err,null)}self._getSecret2(sec1Data,function(err,sec2Data){if(err){return callback(err,null)}var pinLength,passPin;pinLength=self.users.get(userId,"pinLength");if(!pinLength){pinLength=self.options.defaultPinLength}passPin=function(userPin){self._createIdentity(userId,userPin,sec1Data,sec2Data,callback)};pinCallback(passPin,pinLength)})})})};Client.prototype._registration=function(userId,activationToken,callback){var self=this,regData={};regData.url=self.options.server+"/rps/v2/user";regData.type="PUT";regData.data={userId:userId,mobile:0,deviceName:self._getDeviceName(),activateCode:activationToken};self._request(regData,function(err,data){if(err){if(activationToken&&err.status===403){return callback(new InvalidRegCodeError("Invalid registration code"),null)}else{return callback(err,null)}}data.state=data.active?self.users.states.active:self.users.states.start;self.users.write(userId,data);callback(null,data)})};Client.prototype._getDeviceName=function(){var self=this;if(self.options.deviceName){return self.options.deviceName}return"Browser"};Client.prototype._getSecret1=function(userId,regData,callback){var self=this,cs1Url;cs1Url=self.options.server+"/rps/v2/signature/";cs1Url+=self.users.get(userId,"mpinId");cs1Url+="?regOTT="+regData.regOTT;self._request({url:cs1Url},function(err,sec1Data){if(err){if(err.status===401){return callback(new NotVerifiedError("Identity not verified"),null)}else if(err.status===404){return callback(new VerificationExpiredError("Registration session expired"),null)}else{return callback(err,null)}}callback(null,sec1Data)})};Client.prototype._getSecret2=function(sec1Data,callback){var self=this;self._request({url:sec1Data.cs2url},callback)};Client.prototype._createIdentity=function(userId,userPin,sec1Data,sec2Data,callback){var self=this,userData,mpinId,csHex,token;if(sec1Data.mpin_id){mpinId=sec1Data.mpin_id}else{mpinId=self.users.get(userId,"mpinId")}try{csHex=self._addShares(sec1Data.clientSecretShare,sec2Data.clientSecret,sec1Data.curve);token=self._extractPin(mpinId,userPin,csHex,sec1Data.curve)}catch(err){return callback(err,null)}userData={curve:sec1Data.curve,dtas:sec1Data.dtas,mpinId:mpinId,state:self.users.states.register,token:token};self.users.write(userId,userData);callback(null,userData)};Client.prototype._addShares=function(share1Hex,share2Hex,curve){var self=this,share1Bytes=[],share2Bytes=[],sumBytes=[],errorCode;share1Bytes=self._hexToBytes(share1Hex);share2Bytes=self._hexToBytes(share2Hex);errorCode=self._crypto(curve).MPIN.RECOMBINE_G1(share1Bytes,share2Bytes,sumBytes);if(errorCode!==0){throw new CryptoError("Could not combine the client secret shares",errorCode)}return self._bytesToHex(sumBytes)};Client.prototype._extractPin=function(mpinIdHex,PIN,clientSecretHex,curve){var self=this,clientSecretBytes=[],mpinIdBytes=[],errorCode;clientSecretBytes=self._hexToBytes(clientSecretHex);mpinIdBytes=self._hexToBytes(mpinIdHex);errorCode=self._crypto(curve).MPIN.EXTRACT_PIN(self._crypto(curve).MPIN.SHA256,mpinIdBytes,PIN,clientSecretBytes);if(errorCode!==0){throw new CryptoError("Could not extract PIN from client secret",errorCode)}return self._bytesToHex(clientSecretBytes)};Client.prototype.authenticate=function(userId,userPin,callback){this._authentication(userId,userPin,["oidc"],callback)};Client.prototype.generateAuthCode=function(userId,userPin,callback){var self=this;self.fetchAccessId(userId,function(err){if(err){return callback(err,null)}self._authentication(userId,userPin,["authcode"],callback)})};Client.prototype.generateOTP=function(userId,userPin,callback){this._authentication(userId,userPin,["otp"],callback)};Client.prototype.generateQuickCode=function(userId,userPin,callback){this._authentication(userId,userPin,["reg-code"],callback)};Client.prototype._authentication=function(userId,userPin,scope,callback){var self=this,userStorage,SEC=[],X=[];userStorage=scope.indexOf("dvs-auth")!==-1?self.dvsUsers:self.users;if(!userStorage.exists(userId)){return callback(new IdentityError("Missing identity"),null)}self._getPass1(userId,userPin,scope,X,SEC,function(err,pass1Data){if(err){return callback(err,null)}self._getPass2(userId,scope,pass1Data.y,X,SEC,function(err,pass2Data){if(err){return callback(err,null)}self._finishAuthentication(userId,userPin,scope,pass2Data.authOTT,callback)})})};Client.prototype._getPass1=function(userId,userPin,scope,X,SEC,callback){var self=this,U=[],UT=[],userStorage,mpinIdHex,tokenHex,curve,errorCode,requestData;userStorage=scope.indexOf("dvs-auth")!==-1?self.dvsUsers:self.users;tokenHex=userStorage.get(userId,"token");curve=userStorage.get(userId,"curve");if(userStorage===self.users){mpinIdHex=userStorage.get(userId,"mpinId")}else{mpinIdHex=self._getSignMpinId(userStorage.get(userId,"mpinId"),userStorage.get(userId,"publicKey"))}errorCode=self._crypto(curve).MPIN.CLIENT_1(self._crypto(curve).MPIN.SHA256,0,self._hexToBytes(mpinIdHex),self.rng,X,userPin,self._hexToBytes(tokenHex),SEC,U,UT,self._hexToBytes(0));if(errorCode!==0){return callback(new CryptoError("Could not calculate pass 1 request data",errorCode),null)}requestData={scope:scope,mpin_id:userStorage.get(userId,"mpinId"),dtas:userStorage.get(userId,"dtas"),publicKey:userStorage.get(userId,"publicKey"),UT:self._bytesToHex(UT),U:self._bytesToHex(U)};self._request({url:self.options.server+"/rps/v2/pass1",type:"POST",data:requestData},callback)};Client.prototype._getPass2=function(userId,scope,yHex,X,SEC,callback){var self=this,userStorage,curve,requestData,yBytes,errorCode;userStorage=scope.indexOf("dvs-auth")!==-1?self.dvsUsers:self.users;curve=userStorage.get(userId,"curve");yBytes=self._hexToBytes(yHex);errorCode=self._crypto(curve).MPIN.CLIENT_2(X,yBytes,SEC);if(errorCode!==0){return callback(new CryptoError("Could not calculate pass 2 request data",errorCode),null)}requestData={mpin_id:userStorage.get(userId,"mpinId"),WID:self.session.accessId,V:self._bytesToHex(SEC)};self._request({url:self.options.server+"/rps/v2/pass2",type:"POST",data:requestData},callback)};Client.prototype._finishAuthentication=function(userId,userPin,scope,authOTT,callback){var self=this,requestData,userStorage,isDvsAuth;requestData={authOTT:authOTT};isDvsAuth=scope.indexOf("dvs-auth")!==-1;userStorage=isDvsAuth?self.dvsUsers:self.users;self._request({url:self.options.server+"/rps/v2/authenticate",type:"POST",data:requestData},function(err,data){if(err){if(err.status===410){userStorage.write(userId,{state:userStorage.states.revoked})}return callback(err,null)}if(data.renewSecret){self._renewSecret(userId,userPin,data.renewSecret,callback)}else if(data.dvsRegister&&isDvsAuth){self._renewDvsSecret(userId,userPin,data.dvsRegister,callback)}else{self.users.updateLastUsed(userId);callback(null,data)}})};Client.prototype._renewSecret=function(userId,userPin,sec1Data,callback){var self=this;self._getSecret2(sec1Data,function(err,sec2Data){if(err){return callback(err,null)}self._createIdentity(userId,userPin,sec1Data,sec2Data,function(err){if(err){return callback(err,null)}self.authenticate(userId,userPin,callback)})})};Client.prototype.signingRegister=function(userId,userPin,dvsPin,callback){var self=this;self._authentication(userId,userPin,["dvs-reg"],function(err,data){if(err){return callback(err,null)}self._renewDvsSecret(userId,dvsPin,data.dvsRegister,callback)})};Client.prototype._renewDvsSecret=function(userId,userPin,dvsRegister,callback){var self=this,keypair;keypair=self._generateSignKeypair(dvsRegister.curve);self._getDvsSecret1(keypair,dvsRegister.token,function(err,sec1Data){if(err){return callback(err,null)}self._getSecret2(sec1Data,function(err,sec2Data){if(err){return callback(err,null)}self._createSigningIdentity(userId,userPin,sec1Data,sec2Data,keypair,callback)})})};Client.prototype._getDvsSecret1=function(keypair,dvsRegisterToken,callback){var self=this,cs1Url,reqData;reqData={publicKey:keypair.publicKey,deviceName:self._getDeviceName(),dvsRegisterToken:dvsRegisterToken};cs1Url=self.options.server+"/rps/v2/dvsregister";self._request({url:cs1Url,type:"POST",data:reqData},callback)};Client.prototype._generateSignKeypair=function(curve){var self=this,privateKeyBytes=[],publicKeyBytes=[],errorCode;errorCode=self._crypto(curve).MPIN.GET_DVS_KEYPAIR(self.rng,privateKeyBytes,publicKeyBytes);if(errorCode!=0){throw new CryptoError("Could not generate key pair",errorCode)}return{publicKey:self._bytesToHex(publicKeyBytes),privateKey:self._bytesToHex(privateKeyBytes)}};Client.prototype._createSigningIdentity=function(userId,userPin,sec1Data,sec2Data,keypair,callback){var self=this,csHex,token,signMpinId,userData;try{csHex=self._addShares(sec1Data.dvsClientSecretShare,sec2Data.dvsClientSecret,sec1Data.curve);csHex=self._generateSignClientSecret(keypair.privateKey,csHex,sec1Data.curve);signMpinId=self._getSignMpinId(sec1Data.mpinId,keypair.publicKey);token=self._extractPin(signMpinId,userPin,csHex,sec1Data.curve)}catch(err){return callback(err,null)}userData={mpinId:sec1Data.mpinId,dtas:sec1Data.dtas,curve:sec1Data.curve,publicKey:keypair.publicKey,token:token,state:self.dvsUsers.states.register};self.dvsUsers.write(userId,userData);callback(null,userData)};Client.prototype._generateSignClientSecret=function(privateKeyHex,clientSecretHex,curve){var self=this,privateKeyBytes=self._hexToBytes(privateKeyHex),clientSecretBytes=self._hexToBytes(clientSecretHex),errorCode;errorCode=self._crypto(curve).MPIN.GET_G1_MULTIPLE(null,0,privateKeyBytes,clientSecretBytes,clientSecretBytes);if(errorCode!=0){throw new CryptoError("Could not combine private key with client secret",errorCode)}return self._bytesToHex(clientSecretBytes)};Client.prototype._getSignMpinId=function(mpinId,publicKey){var self=this,mpinIdBytes=self._hexToBytes(mpinId),publicKeyBytes=self._hexToBytes(publicKey),i;if(!mpinIdBytes||!publicKeyBytes){return}for(i=0;i<publicKeyBytes.length;i++){mpinIdBytes.push(publicKeyBytes[i])}return self._bytesToHex(mpinIdBytes)};Client.prototype.sign=function(userId,userPin,message,timestamp,callback){var self=this,messageBytes=self._hexToBytes(message),mpinIdHex=self._getSignMpinId(self.dvsUsers.get(userId,"mpinId"),self.dvsUsers.get(userId,"publicKey")),mpinIdBytes=self._hexToBytes(mpinIdHex),tokenHex=self.dvsUsers.get(userId,"token"),tokenBytes=self._hexToBytes(tokenHex),curve=self.dvsUsers.get(userId,"curve"),SEC=[],X=[],Y1=[],U=[],errorCode,signatureData;errorCode=self._crypto(curve).MPIN.CLIENT(self._crypto(curve).MPIN.SHA256,0,mpinIdBytes,self.rng,X,userPin,tokenBytes,SEC,U,null,null,timestamp,Y1,messageBytes);if(errorCode!=0){callback(new CryptoError("Could not sign message",errorCode),null)}signatureData={hash:message,u:self._bytesToHex(U),v:self._bytesToHex(SEC),mpinId:self.dvsUsers.get(userId,"mpinId"),publicKey:self.dvsUsers.get(userId,"publicKey"),dtas:self.dvsUsers.get(userId,"dtas")};this._authentication(userId,userPin,["dvs-auth"],function(err){if(err){return callback(err,null)}callback(null,signatureData)})};Client.prototype._hexToBytes=function(hexValue){var len,byteValue,i;if(!hexValue){return}len=hexValue.length;byteValue=[];for(i=0;i<len;i+=2){byteValue[i/2]=parseInt(hexValue.substr(i,2),16)}return byteValue};Client.prototype._bytesToHex=function(b){var s="",len=b.length,ch,i;for(i=0;i<len;i++){ch=b[i];s+=(ch>>>4&15).toString(16);s+=(ch&15).toString(16)}return s};Client.prototype._urlEncode=function(obj){var str=[],p;for(p in obj){if(Object.prototype.hasOwnProperty.call(obj,p)){str.push(encodeURIComponent(p)+"="+encodeURIComponent(obj[p]))}}return str.join("&")};Client.prototype._parseUriParams=function(uri){var query=uri.split("?").pop(),queryArr=query.split("&"),params={},pairArr,i;if(!query.length||!queryArr.length){return params}for(i=0;i<queryArr.length;i++){pairArr=queryArr[i].split("=");params[pairArr[0]]=decodeURIComponent(pairArr[1].replace(/\+/g," "))}return params};Client.prototype._request=function(options,callback){var self=this,url,type,request;if(typeof callback!=="function"){throw new Error("Bad or missing callback")}if(!options.url){throw new Error("Missing URL for request")}request=new XMLHttpRequest;url=options.url;type=options.type||"GET";request.onreadystatechange=function(){var response,description;if(request.readyState===4&&request.status===200){try{response=JSON.parse(request.responseText)}catch(e){response=request.responseText}callback(null,response)}else if(request.readyState===4){try{description=JSON.parse(request.responseText).error}catch(e){description=request.statusText}if(request.status!==0){callback(new RequestError(description,request.status),null)}else{callback(new RequestError("The request was aborted",0),null)}}};if(self.options.cors){url+=(url.indexOf("?")!==-1?"&":"?")+"project_id="+self.options.projectId}request.open(type,url,true);request.timeout=self.options.requestTimeout;request.setRequestHeader("X-MIRACL-CID",self.options.projectId);if(options.authorization){request.setRequestHeader("Authorization",options.authorization)}if(options.data){request.setRequestHeader("Content-Type","application/json");request.send(JSON.stringify(options.data))}else{request.send()}return request};return Client}();