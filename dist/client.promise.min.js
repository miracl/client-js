var MIRACLTrust=function(){"use strict";function t(t){var n=function(i,e){i instanceof n?(this.a=new t.FP(i.a),this.b=new t.FP(i.b)):(this.a=new t.FP(i),this.b=new t.FP(e))};return n.prototype={reduce:function(){this.a.reduce(),this.b.reduce()},norm:function(){this.a.norm(),this.b.norm()},iszilch:function(){return this.reduce(),this.a.iszilch()&&this.b.iszilch()},isunity:function(){var n=new t.FP(1);return this.a.equals(n)&&this.b.iszilch()},cmove:function(t,n){this.a.cmove(t.a,n),this.b.cmove(t.b,n)},equals:function(t){return this.a.equals(t.a)&&this.b.equals(t.b)},getA:function(){return this.a.redc()},getB:function(){return this.b.redc()},set:function(t,n){this.a.copy(t),this.b.copy(n)},seta:function(t){this.a.copy(t),this.b.zero()},bset:function(t,n){this.a.bcopy(t),this.b.bcopy(n)},bseta:function(t){this.a.bcopy(t),this.b.zero()},copy:function(t){this.a.copy(t.a),this.b.copy(t.b)},zero:function(){this.a.zero(),this.b.zero()},one:function(){this.a.one(),this.b.zero()},neg:function(){var n=new t.FP(this.a),i=new t.FP(0);n.add(this.b),n.neg(),i.copy(n),i.add(this.b),this.b.copy(n),this.b.add(this.a),this.a.copy(i)},conj:function(){this.b.neg(),this.b.norm()},add:function(t){this.a.add(t.a),this.b.add(t.b)},sub:function(t){var i=new n(t);i.neg(),this.add(i)},rsub:function(t){this.neg(),this.add(t)},pmul:function(t){this.a.mul(t),this.b.mul(t)},imul:function(t){this.a.imul(t),this.b.imul(t)},sqr:function(){var n=new t.FP(this.a),i=new t.FP(this.a),e=new t.FP(this.b);n.add(this.b),i.add(this.a),i.norm(),this.b.mul(i),e.neg(),this.a.add(e),this.a.norm(),n.norm(),this.a.mul(n)},mul:function(n){var i,e,o,r,s,h,c=new t.BIG(0),u=new t.DBIG(0);c.rcopy(t.ROM_FIELD.Modulus),u.ucopy(c),(this.a.XES+this.b.XES)*(n.a.XES+n.b.XES)>t.FP.FEXCESS&&(this.a.XES>1&&this.a.reduce(),this.b.XES>1&&this.b.reduce()),i=t.BIG.mul(this.a.f,n.a.f),e=t.BIG.mul(this.b.f,n.b.f),o=new t.BIG(this.a.f),r=new t.BIG(n.a.f),o.add(this.b.f),o.norm(),r.add(n.b.f),r.norm(),s=t.BIG.mul(o,r),(h=new t.DBIG(0)).copy(i),h.add(e),e.rsub(u),i.add(e),i.norm(),s.sub(h),s.norm(),this.a.f.copy(t.FP.mod(i)),this.a.XES=3,this.b.f.copy(t.FP.mod(s)),this.b.XES=2},sqrt:function(){var n,i;return!!this.iszilch()||(n=new t.FP(this.b),i=new t.FP(this.a),n.sqr(),i.sqr(),n.add(i),1!=n.jacobi()?(this.zero(),!1):(n=n.sqrt(),i.copy(this.a),i.add(n),i.norm(),i.div2(),1!=i.jacobi()&&(i.copy(this.a),i.sub(n),i.norm(),i.div2(),1!=i.jacobi())?(this.zero(),!1):(i=i.sqrt(),this.a.copy(i),i.add(i),i.inverse(),this.b.mul(i),!0)))},toString:function(){return"["+this.a.toString()+","+this.b.toString()+"]"},inverse:function(){var n,i;this.norm(),n=new t.FP(this.a),i=new t.FP(this.b),n.sqr(),i.sqr(),n.add(i),n.inverse(),this.a.mul(n),n.neg(),n.norm(),this.b.mul(n)},div2:function(){this.a.div2(),this.b.div2()},times_i:function(){var n=new t.FP(this.a);this.a.copy(this.b),this.a.neg(),this.b.copy(n)},mul_ip:function(){var i=new n(this),e=new t.FP(this.a);this.a.copy(this.b),this.a.neg(),this.b.copy(e),this.add(i)},div_ip2:function(){var t=new n(0);this.norm(),t.a.copy(this.a),t.a.add(this.b),t.b.copy(this.b),t.b.sub(this.a),this.copy(t),this.norm()},div_ip:function(){var t=new n(0);this.norm(),t.a.copy(this.a),t.a.add(this.b),t.b.copy(this.b),t.b.sub(this.a),this.copy(t),this.norm(),this.div2()},pow:function(t){this.norm();var i,e=new n(1),o=new n(this);for(t.norm();i=t.parity(),t.fshr(1),1==i&&e.mul(o),!t.iszilch();)o.sqr();return e.reduce(),e}},n}function n(t){var n=function(i,e){i instanceof n?(this.a=new t.FP2(i.a),this.b=new t.FP2(i.b)):(this.a=new t.FP2(i),this.b=new t.FP2(e))};return n.prototype={reduce:function(){this.a.reduce(),this.b.reduce()},norm:function(){this.a.norm(),this.b.norm()},iszilch:function(){return this.reduce(),this.a.iszilch()&&this.b.iszilch()},isunity:function(){var n=new t.FP2(1);return this.a.equals(n)&&this.b.iszilch()},cmove:function(t,n){this.a.cmove(t.a,n),this.b.cmove(t.b,n)},isreal:function(){return this.b.iszilch()},real:function(){return this.a},geta:function(){return this.a},getb:function(){return this.b},equals:function(t){return this.a.equals(t.a)&&this.b.equals(t.b)},copy:function(t){this.a.copy(t.a),this.b.copy(t.b)},zero:function(){this.a.zero(),this.b.zero()},one:function(){this.a.one(),this.b.zero()},set:function(t,n){this.a.copy(t),this.b.copy(n)},seta:function(t){this.a.copy(t),this.b.zero()},neg:function(){this.norm();var n=new t.FP2(this.a),i=new t.FP2(0);n.add(this.b),n.neg(),i.copy(n),i.add(this.b),this.b.copy(n),this.b.add(this.a),this.a.copy(i),this.norm()},conj:function(){this.b.neg(),this.norm()},nconj:function(){this.a.neg(),this.norm()},add:function(t){this.a.add(t.a),this.b.add(t.b)},sub:function(t){var i=new n(t);i.neg(),this.add(i)},rsub:function(t){this.neg(),this.add(t)},pmul:function(t){this.a.mul(t),this.b.mul(t)},imul:function(t){this.a.imul(t),this.b.imul(t)},sqr:function(){var n=new t.FP2(this.a),i=new t.FP2(this.b),e=new t.FP2(this.a);e.mul(this.b),n.add(this.b),n.norm(),i.mul_ip(),i.add(this.a),i.norm(),this.a.copy(n),this.a.mul(i),i.copy(e),i.mul_ip(),i.add(e),i.norm(),i.neg(),this.a.add(i),this.b.copy(e),this.b.add(e),this.norm()},mul:function(n){var i=new t.FP2(this.a),e=new t.FP2(this.b),o=new t.FP2(0),r=new t.FP2(this.b);i.mul(n.a),e.mul(n.b),o.copy(n.b),o.add(n.a),r.add(this.a),o.norm(),r.norm(),r.mul(o),o.copy(i),o.neg(),r.add(o),o.copy(e),o.neg(),this.b.copy(r),this.b.add(o),e.mul_ip(),this.a.copy(e),this.a.add(i),this.norm()},toString:function(){return"["+this.a.toString()+","+this.b.toString()+"]"},inverse:function(){this.norm();var n=new t.FP2(this.a),i=new t.FP2(this.b);n.sqr(),i.sqr(),i.mul_ip(),i.norm(),n.sub(i),n.inverse(),this.a.mul(n),n.neg(),n.norm(),this.b.mul(n)},times_i:function(){var n=new t.FP2(this.b),i=new t.FP2(this.b);n.times_i(),i.add(n),this.b.copy(this.a),this.a.copy(i),this.norm()},frob:function(t){this.a.conj(),this.b.conj(),this.b.mul(t)},pow:function(i){this.norm(),i.norm();for(var e,o=new n(this),r=new t.BIG(i),s=new n(1);e=r.parity(),r.fshr(1),1===e&&s.mul(o),!r.iszilch();)o.sqr();return s.reduce(),s},xtr_A:function(t,i,e){var o=new n(t),r=new n(t);o.sub(i),o.norm(),o.pmul(this.a),r.add(i),r.norm(),r.pmul(this.b),r.times_i(),this.copy(o),this.add(r),this.add(e),this.reduce()},xtr_D:function(){var t=new n(this);this.sqr(),t.conj(),t.add(t),this.sub(t),this.reduce()},xtr_pow:function(i){var e,o,r,s=new n(3),h=new n(this),c=new n(h),u=new n(0),a=new n(0);for(c.xtr_D(),i.norm(),e=i.parity(),(o=new t.BIG(i)).fshr(1),0===e&&(o.dec(1),o.norm()),r=o.nbits()-1;r>=0;r--)1!=o.bit(r)?(u.copy(h),this.conj(),c.conj(),h.xtr_A(s,this,c),this.conj(),c.copy(u),c.xtr_D(),s.xtr_D()):(u.copy(s),u.conj(),s.copy(h),s.xtr_D(),h.xtr_A(c,this,u),c.xtr_D());return 0===e?a.copy(c):a.copy(h),a.reduce(),a},xtr_pow2:function(i,e,o,r,s){r.norm(),s.norm();for(var h,c=new t.BIG(r),u=new t.BIG(s),a=new t.BIG(0),f=new n(i),E=new n(this),B=new n(e),y=new n(o),I=new n(0),p=new n(0),m=0;0===u.parity()&&0===c.parity();)u.fshr(1),c.fshr(1),m++;for(;0!==t.BIG.comp(u,c);)t.BIG.comp(u,c)>0&&(a.copy(c),a.imul(4),a.norm(),t.BIG.comp(u,a)<=0?(a.copy(u),u.copy(c),c.rsub(a),c.norm(),p.copy(E),p.xtr_A(f,B,y),y.copy(B),y.conj(),B.copy(E),E.copy(f),f.copy(p)):0===u.parity()?(u.fshr(1),I.copy(y),I.conj(),p.copy(B),p.xtr_A(f,E,I),y.copy(B),y.xtr_D(),B.copy(p),f.xtr_D()):1==c.parity()?(u.sub(c),u.norm(),u.fshr(1),p.copy(E),p.xtr_A(f,B,y),f.xtr_D(),y.copy(E),y.xtr_D(),y.conj(),E.copy(p)):(a.copy(u),u.copy(c),u.fshr(1),c.copy(a),p.copy(B),p.xtr_D(),B.copy(y),B.conj(),y.copy(p),y.conj(),p.copy(E),p.xtr_D(),E.copy(f),f.copy(p))),t.BIG.comp(u,c)<0&&(a.copy(u),a.imul(4),a.norm(),t.BIG.comp(c,a)<=0?(c.sub(u),c.norm(),p.copy(E),p.xtr_A(f,B,y),y.copy(B),B.copy(f),f.copy(p)):0===c.parity()?(a.copy(u),u.copy(c),u.fshr(1),c.copy(a),p.copy(B),p.xtr_D(),B.copy(y),B.conj(),y.copy(p),y.conj(),p.copy(E),p.xtr_D(),E.copy(f),f.copy(p)):1==u.parity()?(a.copy(c),c.copy(u),a.sub(u),a.norm(),u.copy(a),u.fshr(1),p.copy(E),p.xtr_A(f,B,y),B.conj(),y.copy(f),y.xtr_D(),y.conj(),f.copy(E),f.xtr_D(),E.copy(p)):(u.fshr(1),I.copy(y),I.conj(),p.copy(B),p.xtr_A(f,E,I),y.copy(B),y.xtr_D(),B.copy(p),f.xtr_D()));for(I.copy(E),I.xtr_A(f,B,y),h=0;h<m;h++)I.xtr_D();return I=I.xtr_pow(u)},div2:function(){this.a.div2(),this.b.div2()},div_i:function(){var n=new t.FP2(this.a),i=new t.FP2(this.b);n.div_ip(),this.a.copy(i),this.b.copy(n)},div_2i:function(){var n=new t.FP2(this.a),i=new t.FP2(this.b);n.div_ip2(),i.add(i),i.norm(),this.a.copy(i),this.b.copy(n)},qmul:function(t){this.a.pmul(t),this.b.pmul(t)},sqrt:function(){if(this.iszilch())return!0;var n=new t.FP2(this.a),i=new t.FP2(this.b),e=new t.FP2(this.a);return i.iszilch()?(e.sqrt()?(this.a.copy(e),this.b.zero()):(e.div_ip(),e.sqrt(),this.b.copy(e),this.a.zero()),!0):(i.sqr(),n.sqr(),i.mul_ip(),i.norm(),n.sub(i),i.copy(n),!!i.sqrt()&&(n.copy(e),n.add(i),n.norm(),n.div2(),!(!n.sqrt()&&(n.copy(e),n.sub(i),n.norm(),n.div2(),!n.sqrt()))&&(e.copy(this.b),i.copy(n),i.add(n),i.inverse(),e.mul(i),this.a.copy(n),this.b.copy(e),!0)))}},n}function i(t){var n=function(i,e){i instanceof n?(this.a=new t.FP4(i.a),this.b=new t.FP4(i.b)):(this.a=new t.FP4(i),this.b=new t.FP4(e))};return n.prototype={reduce:function(){this.a.reduce(),this.b.reduce()},norm:function(){this.a.norm(),this.b.norm()},iszilch:function(){return this.reduce(),this.a.iszilch()&&this.b.iszilch()},isunity:function(){var n=new t.FP4(1);return this.a.equals(n)&&this.b.iszilch()},cmove:function(t,n){this.a.cmove(t.a,n),this.b.cmove(t.b,n)},isreal:function(){return this.b.iszilch()},real:function(){return this.a},geta:function(){return this.a},getb:function(){return this.b},equals:function(t){return this.a.equals(t.a)&&this.b.equals(t.b)},copy:function(t){this.a.copy(t.a),this.b.copy(t.b)},zero:function(){this.a.zero(),this.b.zero()},one:function(){this.a.one(),this.b.zero()},set:function(t,n){this.a.copy(t),this.b.copy(n)},seta:function(t){this.a.copy(t),this.b.zero()},neg:function(){this.norm();var n=new t.FP4(this.a),i=new t.FP4(0);n.add(this.b),n.neg(),i.copy(n),i.add(this.b),this.b.copy(n),this.b.add(this.a),this.a.copy(i),this.norm()},conj:function(){this.b.neg(),this.norm()},nconj:function(){this.a.neg(),this.norm()},add:function(t){this.a.add(t.a),this.b.add(t.b)},sub:function(t){var i=new n(t);i.neg(),this.add(i)},rsub:function(t){this.neg(),this.add(t)},pmul:function(t){this.a.mul(t),this.b.mul(t)},imul:function(t){this.a.imul(t),this.b.imul(t)},sqr:function(){var n=new t.FP4(this.a),i=new t.FP4(this.b),e=new t.FP4(this.a);e.mul(this.b),n.add(this.b),n.norm(),i.times_i(),i.add(this.a),i.norm(),this.a.copy(n),this.a.mul(i),i.copy(e),i.times_i(),i.add(e),i.neg(),this.a.add(i),this.b.copy(e),this.b.add(e),this.norm()},mul:function(n){var i=new t.FP4(this.a),e=new t.FP4(this.b),o=new t.FP4(0),r=new t.FP4(this.b);i.mul(n.a),e.mul(n.b),o.copy(n.b),o.add(n.a),r.add(this.a),o.norm(),r.norm(),r.mul(o),o.copy(i),o.neg(),r.add(o),o.copy(e),o.neg(),this.b.copy(r),this.b.add(o),e.times_i(),this.a.copy(e),this.a.add(i),this.norm()},toString:function(){return"["+this.a.toString()+","+this.b.toString()+"]"},inverse:function(){this.norm();var n=new t.FP4(this.a),i=new t.FP4(this.b);n.sqr(),i.sqr(),i.times_i(),i.norm(),n.sub(i),n.inverse(),this.a.mul(n),n.neg(),n.norm(),this.b.mul(n)},times_i:function(){var n=new t.FP4(this.b),i=new t.FP4(this.a);n.times_i(),this.b.copy(i),this.a.copy(n),this.norm()},times_i2:function(){this.a.times_i(),this.b.times_i()},frob:function(n){var i=new t.FP2(n);i.sqr(),i.mul_ip(),i.norm(),this.a.frob(i),this.b.frob(i),this.b.pmul(n),this.b.times_i()},pow:function(i){this.norm(),i.norm();for(var e,o=new n(this),r=new t.BIG(i),s=new n(1);e=r.parity(),r.fshr(1),1===e&&s.mul(o),!r.iszilch();)o.sqr();return s.reduce(),s},xtr_A:function(t,i,e){var o=new n(t),r=new n(t);o.sub(i),o.norm(),o.pmul(this.a),r.add(i),r.norm(),r.pmul(this.b),r.times_i(),this.copy(o),this.add(r),this.add(e),this.reduce()},xtr_D:function(){var t=new n(this);this.sqr(),t.conj(),t.add(t),this.sub(t),this.reduce()},xtr_pow:function(i){var e,o,r,s=new n(3),h=new n(this),c=new n(h),u=new n(0),a=new n(0);for(c.xtr_D(),i.norm(),e=i.parity(),(o=new t.BIG(i)).fshr(1),0===e&&(o.dec(1),o.norm()),r=o.nbits()-1;r>=0;r--)1!=o.bit(r)?(u.copy(h),this.conj(),c.conj(),h.xtr_A(s,this,c),this.conj(),c.copy(u),c.xtr_D(),s.xtr_D()):(u.copy(s),u.conj(),s.copy(h),s.xtr_D(),h.xtr_A(c,this,u),c.xtr_D());return 0===e?a.copy(c):a.copy(h),a.reduce(),a},xtr_pow2:function(i,e,o,r,s){r.norm(),s.norm();for(var h,c=new t.BIG(r),u=new t.BIG(s),a=new t.BIG(0),f=new n(i),E=new n(this),B=new n(e),y=new n(o),I=new n(0),p=new n(0),m=0;0===u.parity()&&0===c.parity();)u.fshr(1),c.fshr(1),m++;for(;0!==t.BIG.comp(u,c);)t.BIG.comp(u,c)>0&&(a.copy(c),a.imul(4),a.norm(),t.BIG.comp(u,a)<=0?(a.copy(u),u.copy(c),c.rsub(a),c.norm(),p.copy(E),p.xtr_A(f,B,y),y.copy(B),y.conj(),B.copy(E),E.copy(f),f.copy(p)):0===u.parity()?(u.fshr(1),I.copy(y),I.conj(),p.copy(B),p.xtr_A(f,E,I),y.copy(B),y.xtr_D(),B.copy(p),f.xtr_D()):1==c.parity()?(u.sub(c),u.norm(),u.fshr(1),p.copy(E),p.xtr_A(f,B,y),f.xtr_D(),y.copy(E),y.xtr_D(),y.conj(),E.copy(p)):(a.copy(u),u.copy(c),u.fshr(1),c.copy(a),p.copy(B),p.xtr_D(),B.copy(y),B.conj(),y.copy(p),y.conj(),p.copy(E),p.xtr_D(),E.copy(f),f.copy(p))),t.BIG.comp(u,c)<0&&(a.copy(u),a.imul(4),a.norm(),t.BIG.comp(c,a)<=0?(c.sub(u),c.norm(),p.copy(E),p.xtr_A(f,B,y),y.copy(B),B.copy(f),f.copy(p)):0===c.parity()?(a.copy(u),u.copy(c),u.fshr(1),c.copy(a),p.copy(B),p.xtr_D(),B.copy(y),B.conj(),y.copy(p),y.conj(),p.copy(E),p.xtr_D(),E.copy(f),f.copy(p)):1==u.parity()?(a.copy(c),c.copy(u),a.sub(u),a.norm(),u.copy(a),u.fshr(1),p.copy(E),p.xtr_A(f,B,y),B.conj(),y.copy(f),y.xtr_D(),y.conj(),f.copy(E),f.xtr_D(),E.copy(p)):(u.fshr(1),I.copy(y),I.conj(),p.copy(B),p.xtr_A(f,E,I),y.copy(B),y.xtr_D(),B.copy(p),f.xtr_D()));for(I.copy(E),I.xtr_A(f,B,y),h=0;h<m;h++)I.xtr_D();return I=I.xtr_pow(u)},div2:function(){this.a.div2(),this.b.div2()},div_i:function(){var n=new t.FP4(this.a),i=new t.FP4(this.b);n.div_i(),this.a.copy(i),this.b.copy(n)},div_i2:function(){this.a.div_i(),this.b.div_i()},div_2i:function(){var n=new t.FP4(this.a),i=new t.FP4(this.b);n.div_2i(),i.add(i),i.norm(),this.a.copy(i),this.b.copy(n)},qmul:function(t){this.a.pmul(t),this.b.pmul(t)},tmul:function(t){this.a.qmul(t),this.b.qmul(t)},sqrt:function(){if(this.iszilch())return!0;var n=new t.FP4(this.a),i=new t.FP4(this.b),e=new t.FP4(this.a);return i.iszilch()?(e.sqrt()?(this.a.copy(e),this.b.zero()):(e.div_i(),e.sqrt(),this.b.copy(e),this.a.zero()),!0):(i.sqr(),n.sqr(),i.times_i(),i.norm(),n.sub(i),i.copy(n),!!i.sqrt()&&(n.copy(e),n.add(i),n.norm(),n.div2(),!(!n.sqrt()&&(n.copy(e),n.sub(i),n.norm(),n.div2(),!n.sqrt()))&&(e.copy(this.b),i.copy(n),i.add(n),i.inverse(),e.mul(i),this.a.copy(n),this.b.copy(e),!0)))}},n}var e={ANSSI:{Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[8107839,15570555,8401013,14987681,15469722,12586975,7686724,871098,2664752,4180564,60981],CURVE_Order:[14046689,13916614,9707517,4248255,14444513,4414291,15257154,1053293,3855759,1543179,61949],CURVE_Gx:[9395455,8007129,91337,11507895,2609884,2332044,4671956,3217469,12663275,13943638,46771],CURVE_Gy:[404731,5903700,14779153,15262921,115463,15698983,15791084,2069105,11666577,14743496,24898]},BLS383:{CURVE_Cof_I:0,CURVE_A:0,CURVE_B_I:15,CURVE_B:[15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[3932161,3397629,6089858,591516,6228314,7355328,370220,2228452,3672512,6145,32774,8,0,0,0,0,0],CURVE_Gx:[7554419,7238160,1172241,2073528,6143752,6851466,1227896,4447596,7613487,7168259,5011069,7176839,7603501,1863787,6191929,6105820,16892],CURVE_Gy:[258596,2931968,7636148,4455623,8210924,2472906,2849491,2721098,4493575,841580,7616183,6436556,1891377,18781,3402944,735546,1679],CURVE_Bnx:[4608,2,262176,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[1482411,2802346,8312129,349663,2796544,2731,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[2802345,5152861,4944653,1506094,6252570,6829956,866216,2693029,7429346,6928314,86292,4866979,3424366,1312949,2808749,2837170,21861],CURVE_Pxa:[8334726,6777946,7885042,4909289,8235879,6675715,4020373,4165192,7494612,1090986,824327,997938,616395,1576754,8061178,6885891,1588],CURVE_Pxb:[5430805,4734344,3653479,2883376,4895373,3861354,2335925,7128532,5016031,5978635,1299043,1773289,7434888,6188878,22830,3932208,12301],CURVE_Pya:[576321,6387496,5861795,1075980,2022991,6089577,2770152,4964822,1785448,2942867,3826747,3253211,357374,7940411,4756689,1473694,13177],CURVE_Pyb:[4690067,820990,1633121,7541028,4442893,1250818,1211887,7887226,8032122,579197,473141,5494528,3833109,6593999,3367706,1195753,8421],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:!0,USE_GS_G2:!0,USE_GS_GT:!0,GT_STRONG:!0},BLS24:{CURVE_Cof_I:0,CURVE_A:0,CURVE_B_I:19,CURVE_B:[19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1,1179616,4604008,2095784,7464707,6577077,3645368,6855989,4837582,4786463,4879112,2649099,3884192,6338353,6817731,32770,65552,0,0,0,0],CURVE_Gx:[6540500,4320215,1413533,5729530,2031149,7618456,1032762,4233788,5855992,7310833,3716625,6637197,8276989,7015837,484381,3067102,753642,6017987,2876705,7446718,109355],CURVE_Gy:[1987141,4953508,5968686,4598511,3593824,6762125,8079955,7988313,2396687,4729008,5831017,1921662,5112054,4554483,6722122,2707451,6727588,7390100,5214686,3695458,294859],CURVE_Bnx:[1179520,1024,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[7607723,8355827,6291207,2798933,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[5739689,5122267,6885104,1857433,6529801,4488120,4490708,3603928,8107043,926905,6189976,1158257,526048,1629540,6157728,274559,3230752,315848,3085986,245790,349632],CURVE_Pxaa:[6440568,2533097,143242,2173970,6341443,4061395,6133555,7076999,2959496,7702133,2465052,8294956,4959031,1170091,6427812,7703125,7890545,7516560,3299357,7511327,38301],CURVE_Pxab:[3185080,4027903,4252158,38179,6518618,7882506,5719751,8188341,2533168,1375764,7785111,6408130,6722145,6978607,4087209,6237544,2963921,4865176,5044209,6832523,241886],CURVE_Pxba:[2954707,1822243,6010503,4651888,1594135,4702516,3133690,3512242,5693014,1465113,1916782,1106230,7778799,1643463,4198895,2070863,4186640,5525894,4320202,8219250,257063],CURVE_Pxbb:[6354048,6622909,3027434,2222946,1332590,1849715,4765664,1048317,5247535,5631519,2505687,3070251,1811373,3785566,3002881,1516334,1943502,5025962,1992671,4644432,42419],CURVE_Pyaa:[7871136,1254952,2803225,1580472,3541466,4163735,4888657,1610322,312362,7769180,6732194,1842544,5229276,6942076,8202348,54917,104697,4562336,3155213,1764251,329087],CURVE_Pyab:[3016954,5812189,5945071,6116092,493428,3442068,3324966,146482,3919095,758079,4068681,6000767,7844838,2279149,7890430,4042491,6354264,7351674,3810701,2405135,183851],CURVE_Pyba:[7392321,322891,513484,2791509,8358194,6231080,7561702,1327212,6859262,2219175,5096782,1079358,7467940,3842870,7099141,1989340,1718749,8156144,1623706,2306551,98416],CURVE_Pybb:[6036654,6671522,2323398,2807884,2965715,7425774,1113968,3859809,79542,4110951,7719923,3306576,1448641,6076833,2900718,4766607,5689414,7491713,7844397,2578125,301521],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:!0,USE_GS_G2:!0,USE_GS_GT:!0,GT_STRONG:!0},BLS48:{CURVE_Cof_I:0,CURVE_A:0,CURVE_B_I:17,CURVE_B:[17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1,8257536,4332543,7425747,4543497,342082,8045960,8292968,710849,1592741,8369634,387382,6222969,1226881,4652607,3341701,2716612,4007437,3247601,560471,4158442,6279,0,0,0],CURVE_Gx:[5709107,5922507,261281,8329583,5768532,2350103,365020,1673208,8169462,3431939,2112922,95053,4476423,5636786,327742,5857749,3199554,3369922,496193,918681,8314228,3895594,2186597,5525321,9],CURVE_Gy:[7264314,3571668,3398249,2442552,6048661,2821359,8037274,4708808,6781791,5217853,7194790,7454919,4932834,4892913,4993177,3174883,2361442,1809615,358852,5052823,3361242,4152406,5445809,5686916,0],CURVE_Bnx:[6553632,251,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[1223659,2236158,21131,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[3908649,1899737,1442009,4827066,5124258,1053301,989708,7148654,4372537,1148308,5173428,351451,6754939,4033841,3248691,153372,1765119,7519347,594712,1642976,2596728,6579207,7593787,6864577,15],CURVE_Pxaaa:[2346570,6102290,7645748,6904841,4026626,2573337,7743564,6942898,4601793,6284286,2371170,4162878,5100211,6761438,454034,2857901,7097023,3750018,3337761,3077025,5851262,601931,157808,3325036,14],CURVE_Pxaab:[662497,1805144,8243655,15339,2686523,7529867,5366028,3245418,3707463,1423869,2639850,3028384,635111,8360654,6906056,808993,4743981,823708,3942388,2790221,3443566,3107611,1547562,4853769,2],CURVE_Pxaba:[810436,6592750,4942057,7263863,2712749,8228461,5048678,5572740,1648300,4658733,6501717,2513250,6554296,4781893,6822239,1674042,1146082,6201083,7508789,4661102,3574202,3912945,4053852,2719612,11],CURVE_Pxabb:[6600512,5426484,5735256,4606210,1178953,4676514,6034700,4416006,3366439,8190566,5487263,3793423,269884,3197763,6192506,4745690,439301,5748355,7811178,4093770,6533542,4973694,7752575,1843284,9],CURVE_Pxbaa:[7462943,1622757,9964,1726547,4395469,4394769,4450532,2105420,3517321,7822343,4399148,4467011,1979506,728042,1344541,5678753,5121987,6996887,1121898,4538172,4496690,6457593,8193587,7278459,13],CURVE_Pxbab:[3618877,7358220,420904,8178751,2228819,2597925,1342295,6597038,7995719,6409771,7741631,1895323,4134470,5588700,1224392,2780486,3704926,688080,3811700,7893745,5214715,2809346,6496577,1497555,8],CURVE_Pxbba:[1151900,8087470,7054752,3461644,1828125,6679937,7167155,6579686,4240260,1338948,5567601,1154937,1157555,5387704,3417090,7013248,5350403,2286351,2040762,4623583,5938383,7849094,6370896,4265273,10],CURVE_Pxbbb:[7293081,136458,7670965,4805298,1855979,1545080,2711140,5985367,4695945,1311736,6444940,3104056,8382508,7143266,205154,3853285,1978368,26255,4352587,5195501,5743400,6466800,1011803,8104508,13],CURVE_Pyaaa:[1275972,3121e3,5102466,5241465,4516964,7147683,1829617,4927324,756337,2140956,2251648,6700668,6765584,8294057,3130248,6744524,2109270,3758204,3423884,5425343,399627,1178382,6366421,3372677,7],CURVE_Pyaab:[4731280,6590939,4344184,2315340,3058420,203365,4779697,8317710,597807,2988332,61564,4908399,6852306,6480800,2639704,89335,8265822,653888,2419301,845948,8002626,1854749,5207722,3990940,2],CURVE_Pyaba:[1596429,4169859,1025905,5294318,868429,481747,6913362,6658236,6839420,6368600,1445126,2228723,6060412,1098612,949788,5437952,2056368,273188,7747040,905826,1314145,2533350,5857212,2280932,13],CURVE_Pyabb:[1917688,4280363,6127039,559890,2374397,3997271,5161978,3125267,8142079,1914647,7946266,3392564,6512439,2745590,2925275,8031984,4184322,3344841,2036315,4190409,29456,3225563,2625035,460629,10],CURVE_Pybaa:[3670943,2451262,1590100,4094161,977045,75679,2641942,4480133,4980357,8357271,2813397,3039993,3305740,5200721,5833068,6387911,7218830,2963951,2897590,7436130,1907388,3290900,8158137,5776164,2],CURVE_Pybab:[6256741,4251218,2156967,7616979,4130646,5856175,8191094,2652952,5637966,1599097,4288192,1951762,1212350,1628597,3951261,1846196,1268900,8011948,7575940,7274636,7438570,5812077,5982978,596300,3],CURVE_Pybba:[4987257,7683791,7276384,3911996,4894620,7076690,4655192,4272701,5505496,4801540,6082396,773894,8285903,5938208,863743,6618948,3236955,5171331,5120748,1123397,4746332,6062609,6806118,4195986,12],CURVE_Pybbb:[4846171,1223775,6108146,3527510,2903936,3820702,3955314,4353140,6139026,5423430,6370923,7134839,5938831,7208816,7151843,5923046,3399450,176039,233712,6496418,4150419,1885043,1526160,503963,10],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:!0,USE_GS_G2:!0,USE_GS_GT:!0,GT_STRONG:!0},BLS381:{CURVE_Cof_I:0,CURVE_A:0,CURVE_B_I:4,CURVE_B:[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1,8388096,8126463,8385247,5914671,43639,157814,1895428,8210483,2511674,5224093,3,0,0,0,0,0],CURVE_Gx:[2279099,6297014,4189419,4968663,6194175,724362,4572907,2563359,3736993,2043625,893489,5070974,3720442,316076,6682085,6935448,6129],CURVE_Gy:[4581345,4608653,1061544,1328215,5010506,8239623,4915500,7179365,718336,2861984,7591810,7100199,972609,3412934,6989884,8012017,2227],CURVE_Bnx:[65536,0,215044,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[43691,5592576,5910530,2797322,4767749,1837,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[8323070,8388607,571399,1069056,8225078,5315522,7978533,5887133,7858909,971806,6924056,3568269,7536119,779052,0,0,0],CURVE_Pxa:[2211256,2986370,4149761,4206047,4207210,3072373,2013428,2655666,3867316,2749568,1806827,2654862,5403356,2408704,2343588,5331320,586],CURVE_Pxb:[273278,7998138,6264497,1876714,5181729,599657,7806932,7155933,3545781,2175553,6664003,3832618,3803266,1029530,1861592,1421353,5088],CURVE_Pya:[3680257,2690065,2590285,6120724,2923715,2462279,5527604,2182452,5482349,5577083,3667566,7448789,6057378,3250489,2055044,6984633,3301],CURVE_Pyb:[6257086,966624,436900,6775021,7393909,3500006,5622694,3819861,6532902,8194894,2947233,1334478,2818748,415130,2739507,6443031,1542],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:!0,USE_GS_G2:!0,USE_GS_GT:!0,GT_STRONG:!1},BLS461:{Curve_Cof_I:0,CURVE_A:0,CURVE_B_I:9,CURVE_B:[9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1,0,7340032,8355839,524031,139264,8331264,8257727,59393,4243360,1535,8380428,8388479,511,0,0,0,0,0,0,0],CURVE_Gx:[6220093,316693,5260596,7813723,2989056,6510846,6686420,4265185,5097761,2205356,2631065,8118601,4415846,4547374,1716132,3708539,819506,4681332,3827409,5670714,0],CURVE_Gy:[5362789,4598517,5358557,6578815,5339268,7447595,424346,2943060,2383689,1428358,3019332,4586784,1502923,4135293,3351294,1545149,6233151,4116882,4533441,3923565,0],CURVE_Bnx:[0,8387584,8388591,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[2796203,8387925,5941919,5603498,8213930,2793471,21845,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[8388606,1023,16,8388352,8388223,6422509,12575,6488633,7190460,6433522,7590365,4434457,4132489,656578,5772288,8347647,131071,0,0,0,0],CURVE_Pxa:[5284732,2122509,3217773,1522414,1846857,2952981,517223,8041072,7667602,6360502,1679375,3582989,7174356,7885327,2247653,1971078,7764293,4855093,5122074,418464,1],CURVE_Pxb:[4309165,3756421,3647457,6427365,1494374,4526785,304454,2100579,4112098,8037685,8230597,5263001,4566875,7224745,4952912,1193267,2259410,1918713,5503339,4907261,0],CURVE_Pya:[3125254,2196320,843571,5394581,5493140,1202450,5780467,6505892,62367,1996086,8079080,4120034,5111178,388947,3443187,8024991,6320372,7666894,1194490,1127780,0],CURVE_Pyb:[7423356,875515,172692,7209569,5073457,7194614,2532292,2831477,6572335,3045495,1697866,2487645,2231271,6058157,8131344,141483,2798032,6817236,7159470,7454848,0],CURVE_W:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],USE_GLV:!0,USE_GS_G2:!0,USE_GS_GT:!0,GT_STRONG:!1},FP256BN:{Curve_Cof_I:1,CURVE_A:0,CURVE_B_I:3,CURVE_B:[3,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[741389,5467345,1766957,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],CURVE_Gx:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Gy:[2,0,0,0,0,0,0,0,0,0,0],CURVE_Bnx:[11577345,16105520,26754,0,0,0,0,0,0,0,0],CURVE_Cof:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[10598407,664739,2022172,15831853,13490077,1598875,4231696,3770593,1,0,0],CURVE_Pxa:[12623611,1488521,3985958,1228676,1856410,9517774,5733416,2643471,13200416,3362996,65036],CURVE_Pxb:[8284715,15545507,9032297,8900661,14514402,1292580,12990424,14375649,9093204,6313843,20134],CURVE_Pya:[14428159,11829694,4778249,9265496,13313141,4084207,7672398,7763725,4367283,4646853,28704],CURVE_Pyb:[11338907,8458570,11788306,8526488,5029504,11706251,4794750,4386470,8962704,14925011,1364],CURVE_W:[[344067,224795,6699760,16776824,16777215,255,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0]],CURVE_SB:[[[6721540,15658620,6753269,16776824,16777215,255,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0]],[[6377473,15433825,53509,0,0,0,0,0,0,0,0],[397322,5242550,11844413,1219353,14444027,10788108,6221425,4646386,16576717,16777215,65535]]],CURVE_WB:[[3188736,6786829,13373472,5592274,5592405,85,0,0,0,0,0],[8243205,7752717,11344598,10554307,14585790,1066087,8413536,13698539,0,0,0],[1521667,11929119,14074284,5277153,15681503,533043,12595376,6849269,0,0,0],[9566209,5443438,13426982,5592274,5592405,85,0,0,0,0,0]],CURVE_BB:[[[5941261,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[5941260,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[5941260,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[6377474,15433825,53509,0,0,0,0,0,0,0,0]],[[6377473,15433825,53509,0,0,0,0,0,0,0,0],[5941260,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[5941261,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[5941260,6139040,1740202,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535]],[[6377474,15433825,53509,0,0,0,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0],[6377473,15433825,53509,0,0,0,0,0,0,0,0]],[[11577346,16105520,26754,0,0,0,0,0,0,0,0],[12754946,14090434,107019,0,0,0,0,0,0,0,0],[11141130,6810735,1713447,1218962,14444027,10788364,6221425,4646386,16576717,16777215,65535],[11577346,16105520,26754,0,0,0,0,0,0,0,0]]],USE_GLV:!0,USE_GS_G2:!0,USE_GS_GT:!0,GT_STRONG:!1},FP512BN:{Curve_Cof_I:1,CURVE_A:0,CURVE_B_I:3,CURVE_B:[3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[1706477,1359523,5249689,2608405,201696,3434818,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],CURVE_Gx:[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Gy:[2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Bnx:[1824783,882364,4211404,362431,3103747,3344,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cof:[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[7940490,2900280,338972,6052030,7235481,1201625,3118232,4441267,5274317,1128526,1911936,589080,7925622,7459929,3021517,1388707,8243261,8385496,8388607,8388607,8388607,8388607,63],CURVE_Pxa:[3557045,5430299,8010782,4733311,1017649,7464003,7286513,2875152,5097180,7390882,4231501,3958405,5920716,3618479,5071811,6154573,6954571,155257,28317,2378436,1971078,6474343,14],CURVE_Pxb:[712937,1564597,7141079,7095432,4866332,6003841,5115734,2648944,7212382,6621860,6322313,6072011,3155302,4779345,1776572,5450606,3441246,88017,7155994,4142660,4162822,230009,18],CURVE_Pya:[6186913,402779,1542432,718812,2194134,7834523,655917,1149226,4099805,8116266,5977186,3460773,6668632,1810557,5866175,4380911,5187440,1668206,3921580,4047177,5014140,6307216,27],CURVE_Pyb:[5213835,6491536,5903917,2489264,377378,72702,8096231,1607019,464036,509386,665087,827629,3998870,6394732,4596126,662624,5840642,6471403,888880,3938518,4763726,3438493,20],CURVE_W:[[214403,7417491,5227587,6862091,6273297,4717868,8388413,8388607,8388607,8388607,8388607,7,0,0,0,0,0,0,0,0,0,0,0],[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],CURVE_SB:[[[4953444,5652762,5193387,6137228,65803,4711180,8388413,8388607,8388607,8388607,8388607,7,0,0,0,0,0,0,0,0,0,0,0],[6445518,7983402,5215488,1883542,2382810,3428129,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63]],[[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[214403,7417491,5227587,6862091,6273297,4717868,8388413,8388607,8388607,8388607,8388607,7,0,0,0,0,0,0,0,0,0,0,0]]],CURVE_WB:[[5908976,6739306,3169130,2891416,4467808,4374399,5592340,2796202,5592405,2796202,5592405,2,0,0,0,0,0,0,0,0,0,0,0],[3497291,153412,4586412,7076903,2161695,7064478,2586798,2902397,5952527,7520457,4540882,2730161,5729219,273601,5798904,7716912,53509,0,0,0,0,0,0],[2661037,517888,4398908,3719667,2632721,3533911,5487703,5645502,7170567,3760228,6464745,5559384,7058913,136800,2899452,8052760,26754,0,0,0,0,0,0],[2259409,4974578,3134930,2166553,6648922,4367710,5592340,2796202,5592405,2796202,5592405,2,0,0,0,0,0,0,0,0,0,0,0]],CURVE_BB:[[[1824784,882364,4211404,362431,3103747,3344,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1824783,882364,4211404,362431,3103747,3344,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1824783,882364,4211404,362431,3103747,3344,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[6445519,7983402,5215488,1883542,2382810,3428129,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63]],[[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[8270302,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],[8270301,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],[8270302,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63]],[[3649566,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[3649567,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],[[8270303,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],[2795951,6218674,5181288,1158679,4563924,3421440,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],[3649565,1764728,34200,724863,6207494,6688,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[8270303,477158,1038285,2245974,5486557,3431473,2804126,4600559,1620196,4020605,4528956,490018,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63]]],USE_GLV:!0,USE_GS_G2:!0,USE_GS_GT:!0,GT_STRONG:!1},BN254:{Curve_Cof_I:1,CURVE_A:0,CURVE_B_I:2,CURVE_B:[2,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[13,0,1089792,0,10452992,2047,8388608,12203085,1,6586944,9507],CURVE_Gx:[18,0,1287936,0,2162688,2145,8388608,12203085,1,6586944,9507],CURVE_Gy:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Bnx:[1,0,16512,0,0,0,0,0,0,0,0],CURVE_Cof:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[7,0,445824,0,589824,585,4194304,4830050,0,0,0],CURVE_Pxa:[260907,4334792,889326,4757695,6589371,15578788,8293473,15437196,10401327,1096529,1562],CURVE_Pxb:[13978867,3457511,11996556,11417476,5076075,11164447,9197954,3213991,7567411,11205050,1302],CURVE_Pya:[13446042,14710929,12392944,12434953,12389094,8528681,9857420,10129632,11506499,9937003,536],CURVE_Pyb:[3853979,1764459,5737005,14105033,9438975,9254832,5699059,9399620,9114918,2821756,3771],CURVE_W:[[3,0,132096,0,8486912,97,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0]],CURVE_SB:[[[4,0,165120,0,8486912,97,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0]],[[1,0,33024,0,0,0,0,0,0,0,0],[10,0,957696,0,1966080,1950,8388608,12203085,1,6586944,9507]]],CURVE_WB:[[0,0,16512,0,8421376,32,0,0,0,0,0],[5,0,346752,0,458752,455,8388608,3220033,0,0,0],[3,0,181632,0,8617984,227,12582912,1610016,0,0,0],[1,0,49536,0,8421376,32,0,0,0,0,0]],CURVE_BB:[[[13,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[12,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[12,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[2,0,33024,0,0,0,0,0,0,0,0]],[[1,0,33024,0,0,0,0,0,0,0,0],[12,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[13,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507],[12,0,1073280,0,10452992,2047,8388608,12203085,1,6586944,9507]],[[2,0,33024,0,0,0,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0],[1,0,33024,0,0,0,0,0,0,0,0]],[[2,0,16512,0,0,0,0,0,0,0,0],[2,0,66048,0,0,0,0,0,0,0,0],[10,0,1056768,0,10452992,2047,8388608,12203085,1,6586944,9507],[2,0,16512,0,0,0,0,0,0,0,0]]],USE_GLV:!0,USE_GS_G2:!0,USE_GS_GT:!0,GT_STRONG:!1},BN254CX:{Curve_Cof_I:1,CURVE_A:0,CURVE_B_I:2,CURVE_B:[2,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[15409005,12625462,13549073,837894,4183790,6738628,6584931,11582943,7350797,8,9216],CURVE_Gx:[1791410,2355036,14794342,1575230,4183790,6738724,6584931,11582943,7350797,8,9216],CURVE_Gy:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Bnx:[12587697,3,16384,0,0,0,0,0,0,0,0],CURVE_Cof:[1,0,0,0,0,0,0,0,0,0,0],CURVE_Cru:[2317463,9639828,5648864,7466887,12443492,4133952,3240,4718592,0,0,0],CURVE_Pxa:[13823092,1896164,2539653,10501671,8160703,4963216,62915,3509029,5485142,2960496,6504],CURVE_Pxb:[2740193,9341742,1001381,12716483,1808304,9913336,3647721,10490313,1701450,12184638,5222],CURVE_Pya:[778399,16575439,11734267,8683201,6402877,14813539,1408430,14163490,3353485,15587698,2681],CURVE_Pyb:[10022557,4924040,15461776,6935277,8801957,3432898,5320077,3524324,12894352,801260,1558],CURVE_W:[[3140483,6506774,1179732,737336,0,96,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0]],CURVE_SB:[[[11538660,6506781,1212500,737336,0,96,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0]],[[8398177,7,32768,0,0,0,0,0,0,0,0],[12268522,6118688,12369341,100558,4183790,6738532,6584931,11582943,7350797,8,9216]]],CURVE_WB:[[8029360,2168918,11550748,245778,0,32,0,0,0,0,0],[2229365,16356798,10106573,11061887,8295661,2756032,2160,3145728,0,0,0],[15797139,16567008,13450086,13919551,4147830,1378016,1080,1572864,0,0,0],[16427537,2168925,11583516,245778,0,32,0,0,0,0,0]],CURVE_BB:[[[2821309,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[2821308,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[2821308,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[8398178,7,32768,0,0,0,0,0,0,0,0]],[[8398177,7,32768,0,0,0,0,0,0,0,0],[2821308,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[2821309,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[2821308,12625459,13532689,837894,4183790,6738628,6584931,11582943,7350797,8,9216]],[[8398178,7,32768,0,0,0,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0],[8398177,7,32768,0,0,0,0,0,0,0,0]],[[12587698,3,16384,0,0,0,0,0,0,0,0],[19138,15,65536,0,0,0,0,0,0,0,0],[7010826,12625455,13516305,837894,4183790,6738628,6584931,11582943,7350797,8,9216],[12587698,3,16384,0,0,0,0,0,0,0,0]]],USE_GLV:!0,USE_GS_G2:!0,USE_GS_GT:!0,GT_STRONG:!1},BRAINPOOL:{Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[15280900,8454654,2452197,11480905,9694148,7780287,7552267,16672423,14175908,6407216,26156],CURVE_Order:[4740775,950935,16224286,11887014,3766947,9269644,9477507,4089354,15641020,5757857,43515],CURVE_Gx:[1246708,9524782,2849185,8040380,10568388,6375855,11680357,7545363,13625271,15416513,41960],CURVE_Gy:[2476478,15266651,7595,3788839,12367582,4292201,14763588,8354594,3786093,7111220,11673]},C25519:{Curve_Cof_I:8,CURVE_A:486662,CURVE_B_I:0,CURVE_B:[0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[16110573,6494812,14047250,10680220,14612958,20,0,0,0,0,4096],CURVE_Gx:[9,0,0,0,0,0,0,0,0,0,0],CURVE_Gy:[0,0,0,0,0,0,0,0,0,0,0]},C41417:{Curve_Cof_I:8,CURVE_A:1,CURVE_B_I:3617,CURVE_B:[3617,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[438137,432004,110823,1635270,211117,900208,393771,340956,3983652,4194220,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,32767],CURVE_Gx:[771477,2116559,806867,1367833,3406504,311401,1489425,2806619,1349796,1441741,257151,2609456,869942,637311,405955,34352,1327920,2364496,107316],CURVE_Gy:[34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},ED25519:{Curve_Cof_I:8,CURVE_A:-1,CURVE_B_I:0,CURVE_B:[5863587,5098003,11236843,4276696,7342669,15243264,7960441,9226048,7339635,7138859,20995],CURVE_Order:[16110573,6494812,14047250,10680220,14612958,20,0,0,0,0,4096],CURVE_Gx:[2479386,2973839,11716950,9774503,2934624,14441577,3276246,12625122,7230462,3593165,8553],CURVE_Gy:[6710872,6710886,6710886,6710886,6710886,6710886,6710886,6710886,6710886,6710886,26214]},GOLDILOCKS:{Curve_Cof_I:4,CURVE_A:1,CURVE_B_I:-39081,CURVE_B:[8349526,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8257535,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,2047],CURVE_Order:[5784819,337238,5541347,7220346,4990760,5375021,7058829,2583972,2353604,8321428,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,511],CURVE_Gx:[5592405,2796202,5592405,2796202,5592405,2796202,5592405,2796202,5592405,5417642,2796202,5592405,2796202,5592405,2796202,5592405,2796202,5592405,2796202,1365],CURVE_Gy:[1279725,7838677,3107755,945411,4926445,1251191,5147276,3322561,4503565,6624689,6262197,4353725,7996248,28122,2207916,7016488,897881,1420809,1549709,1392]},HIFIVE:{Curve_Cof_I:8,CURVE_A:1,CURVE_B_I:11111,CURVE_B:[11111,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[2074629,2829949,2747582,4180445,775864,5442072,4523390,3,0,0,0,0,0,0,2048],CURVE_Gx:[12,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Gy:[8291890,854539,7097083,5249838,5596428,3595115,2080013,6406286,3230534,7382947,5796865,815328,5656622,3719894,771]},NIST256:{Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[13787211,3948071,16137166,13390768,1902256,8830053,5600920,11791293,3838951,3528874,23238],CURVE_Order:[6497617,13288188,8713145,10950558,15137453,16777148,16777215,16777215,0,16776960,65535],CURVE_Gx:[10011286,3753432,10548385,3009331,228737,4256375,15033252,16301286,2900551,13759201,27415],CURVE_Gy:[12538357,4220983,13552566,7024990,13513559,10360363,4881423,9365483,1736603,4383486,20451]},NIST384:{Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[7088879,1170343,7645719,5338764,6527192,7035082,5506273,656455,4264451,6159618,6321777,4286664,5684799,1249728,1030649,1561585,45873],CURVE_Order:[4532595,3331481,7058352,4556091,2153252,3926787,8195531,3253952,8388551,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],CURVE_Gx:[7735991,3961060,3205457,8038731,3089883,4655776,2135306,8102128,1808473,4527951,3699949,355235,7466802,7460408,2277709,6623583,43655],CURVE_Gy:[6950495,3864865,7727372,7074828,728289,1573196,7175214,7149705,1342697,8016180,6541430,1499471,784681,7058387,625435,7284043,13847]},NIST521:{Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:0,CURVE_B:[5259008,4171990,4701460,6906279,4061315,6350510,5172335,2711646,1276694,2349309,5792997,544522,1644783,7804561,7128444,3747276,7250650,7146113,6850178,5307540,1630665,2610988,5221],CURVE_Order:[3695625,7224610,3861950,5038653,6069128,3802998,4047465,6684836,1469311,491103,4594206,8388562,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,32767],CURVE_Gx:[6667622,8151941,7333369,2839060,736280,1820265,6864874,974995,5843198,7331790,339321,6942165,7734964,4130069,5238088,4234370,4365412,4664168,8072600,5139697,7356494,3260630,12705],CURVE_Gy:[5334608,2682175,140026,1283602,4655210,7087783,5237569,2645120,2506949,3325416,6273482,7549284,5337715,194039,6738202,2237611,5871861,5831223,2719440,8932,631740,2436431,17934]},NUMS256E:{Curve_Cof_I:4,CURVE_A:1,CURVE_B_I:-15342,CURVE_B:[16761685,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,65535],CURVE_Order:[14502645,11636974,10164807,3103043,9788069,65,0,0,0,0,16384],CURVE_Gx:[15537114,12619822,8823006,14878773,3770894,10212876,6252832,13442621,15344509,1375082,35445],CURVE_Gy:[9079270,1501049,13840294,1082734,6250968,8392817,14263883,13538917,14230983,4104153,17621]},NUMS256W:{Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:152961,CURVE_B:[152961,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[5351461,2107719,6299819,15345244,3965557,16777188,16777215,16777215,16777215,16777215,65535],CURVE_Gx:[1748145,15605426,3849298,251079,5741321,13306243,10506050,2718357,11197281,14071386,48286],CURVE_Gy:[8707743,12176161,12288181,1388815,5620689,14693833,16219652,7554187,10073766,12644659,53391]},NUMS384E:{Curve_Cof_I:4,CURVE_A:1,CURVE_B_I:-11556,CURVE_B:[8376735,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],CURVE_Order:[2328957,3770829,6587111,5877315,4543914,3796028,2956024,2329870,8388578,8388607,8388607,8388607,8388607,8388607,8388607,8388607,16383],CURVE_Gx:[2124766,116952,5063509,2763936,2698006,6819326,3984472,3276756,4980823,904060,4992977,2813357,2173358,1578708,6965659,589218,25009],CURVE_Gy:[7508882,508896,7501364,3629638,2822036,4808718,8229221,511099,6248067,6939268,5944841,552632,1720891,1107734,6929324,2044892,33432]},NUMS384W:{Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:-34568,CURVE_B:[8353723,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],CURVE_Order:[942521,257270,6914358,6405907,2741204,1062875,3856218,1005455,8388566,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],CURVE_Gx:[1578282,7604289,7319154,8064547,7262464,6834757,4889393,6198413,7992563,1832707,562951,3116336,2237456,593945,6014471,2848856,30073],CURVE_Gy:[1574678,7461068,1667538,8365417,7032251,7329690,4490912,1065406,7576761,7336190,4198821,2522101,5439576,1768551,6742926,7451760,44254]},NUMS512E:{Curve_Cof_I:4,CURVE_A:1,CURVE_B_I:-78296,CURVE_B:[8309743,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,63],CURVE_Order:[7263341,1698359,8232218,7307111,6313862,6202696,6040993,2092132,1161886,5922719,5489037,8388605,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,15],CURVE_Gx:[7100414,5657395,5707494,6694784,5395495,1417724,1417793,6218953,7540600,1957004,1607429,6031930,7070323,4518959,7416032,7589798,3354577,1157002,6499810,3466192,5318875,7456301,55],CURVE_Gy:[6485473,4030851,8178103,6262400,7157929,4169804,703280,852803,3498592,6673196,207183,7608841,3758345,5580141,616264,8098668,7267446,5264458,4445662,5475525,3789980,2177022,27]},NUMS512W:{Curve_Cof_I:1,CURVE_A:-3,CURVE_B_I:121243,CURVE_B:[121243,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[3364189,8286728,997460,255634,6861670,3721066,6681647,6368374,203599,7809487,7139987,8388602,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,63],CURVE_Gx:[2862679,994073,750090,7043823,5636407,3171243,611717,3973443,3514003,2232022,4228741,3592138,795952,2662620,4226465,7085530,5413066,4225654,2998282,5545681,7422416,5768840,14],CURVE_Gy:[3483558,966768,2395778,6809727,3523044,4217317,2922133,1102880,7203265,3479069,659543,686245,6342589,1173860,7286499,7204693,19351,4708194,3914609,3513968,2267861,477849,37]},SECP256K1:{CURVE_Cof_I:1,CURVE_A:0,CURVE_B_I:7,CURVE_B:[7,0,0,0,0,0,0,0,0,0,0],CURVE_Order:[3555649,6196432,3915730,11487392,11459814,16776890,16777215,16777215,16777215,16777215,65535],CURVE_Gx:[16258968,8477462,14244338,3001896,10222811,722690,9817735,5611618,14465964,6717177,31166],CURVE_Gy:[1103032,13668347,1678407,10913108,1553480,567549,16518673,6137083,10732645,14317350,18490]}},o={25519:{Modulus:[16777197,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,32767],R2modp:[10747904,5,0,0,0,0,0,0,0,0,0],MConst:19},"256PM":{Modulus:[16777027,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,65535],R2modp:[8978432,139,0,0,0,0,0,0,0,0,0],MConst:189},"384PM":{Modulus:[8388291,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],R2modp:[2244608,196,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:317},"512PM":{Modulus:[8388039,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,63],R2modp:[0,362496,79,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:569},ANSSI:{Modulus:[7248899,15946712,7203068,11258058,6401468,4414265,15257154,1053293,3855759,1543179,61949],R2modp:[11332835,9584998,11603918,7142326,556738,4056125,13815655,10911198,11350258,772782,57240],MConst:5116245},BLS383:{Modulus:[2797739,3852555,3107036,5448745,4453016,2002769,5920841,1629184,2429356,5891787,177432,5542949,6046206,3411381,2808749,2837170,21861],R2modp:[2427460,6878831,932980,7935858,3483107,925205,3499542,5568036,5275753,2565731,4869296,3510931,5989747,651903,6202292,6356269,20839],MConst:3421693,Fra:[1170113,3037798,24907,7551903,1263631,1643629,3757110,2832933,1738370,2391924,3748275,5937032,8137745,422259,2087471,7004033,8876],Frb:[1627626,814757,3082129,6285450,3189384,359140,2163731,7184859,690985,3499863,4817765,7994524,6297068,2989121,721278,4221745,12984]},BLS24:{Modulus:[398635,183956,7069971,4286854,3145262,3593416,4658991,1656247,6227594,943169,1114502,323833,3364494,4853550,3174048,1522674,7241791,472536,3348202,245790,349632],R2modp:[2283258,8037017,4993150,6874897,8234158,3685571,1180812,72573,3974162,2941985,4797100,2597638,3410794,26222,4154741,3113532,658918,1277637,3658940,4760910,311947],MConst:1441405,Fra:[7958301,5150071,7255410,6841215,4325259,4647123,8026264,8155812,2393095,7240153,5654942,5158015,2608086,3393122,5150534,796568,3765577,4872987,6066358,4049523,310216],Frb:[828942,3422492,8203168,5834246,7208610,7334900,5021334,1889042,3834498,2091624,3848167,3554425,756407,1460428,6412122,726105,3476214,3988157,5670451,4584874,39415]},BLS48:{Modulus:[7777291,4988921,6798299,5452015,1470473,4524037,6406992,6331348,486190,4210957,1478740,3489281,1315585,6746993,3880282,7162501,3601413,2655242,4541107,2843699,2688122,746606,786239,6864578,15],R2modp:[6243010,5861e3,3070202,1427824,2431156,2782695,6475347,4398160,3994887,6426180,880589,137853,2087487,434329,341127,5500607,5563088,4735869,2241496,6498671,2223649,6362135,6397237,1287706,11],MConst:5931101,Fra:[2473865,7994150,5699976,3774996,5275299,489877,4122682,5434537,4076660,6233619,3046576,2449213,3860472,3034870,3923604,503898,1296444,8124004,2093695,7331970,3880654,1278227,7217154,5004291,2],Frb:[2473865,7994150,5699976,3774996,5275299,489877,4122682,5434537,4076660,6233619,3046576,2449213,3860472,3034870,3923604,503898,1296444,8124004,2093695,7331970,3880654,1278227,7217154,5004291,2]},BLS381:{Modulus:[8366763,8388607,8316923,696319,4194283,4490197,4041789,1599824,1228647,648970,1170734,6121147,8086580,4809588,6289830,587036,6657],R2modp:[4245222,924200,4004972,7152712,1814801,5156776,2268300,5041749,4641453,8104060,7374901,2364369,6750947,3735830,892479,4970076,2467],MConst:8191997,Fra:[2318264,7068452,7746589,2046985,6968278,3710671,6368942,1188331,6246267,8026490,4151311,6318328,7029250,7882295,3064217,6938497,6404],Frb:[6048499,1320155,570334,7037942,5614612,779525,6061455,411492,3370988,1011087,5408030,8191426,1057329,5315901,3225612,2037147,252]},BLS461:{Modulus:[2796203,341,2796208,2796117,85,524292,5595072,1267016,1884175,4191416,2951843,5809188,2935367,4610839,7297991,674223,5625492,3451572,1398069,2796202,1],R2modp:[6427800,3889247,267912,7305229,1557049,1412490,4790930,7568881,141830,4588131,2580466,5543619,7162578,3832646,3826467,1516465,7741515,6749478,5141566,1828462,0],MConst:8388605,Fra:[76346,3112759,15812,5426402,1860360,753428,4424148,5428008,5821535,3513488,1950412,6382978,8151531,7016901,6566940,4332336,5111546,3976132,1236954,1515560,1],Frb:[2719857,5276190,2780395,5758323,6528332,8159471,1170923,4227616,4451247,677927,1001431,7814818,3172443,5982545,731050,4730495,513945,7864048,161114,1280642,0]},FP256BN:{Modulus:[13840403,3005358,8573737,1218570,14444027,10788620,6221425,4646386,16576717,16777215,65535],R2modp:[3098625,16218577,4095854,11807290,13179337,12741640,1816341,13250262,5515582,939918,30954],MConst:3663333,Fra:[9711878,207023,9401462,1981106,10580305,6803257,9296648,2955886,7892789,7758538,15713],Frb:[4128525,2798335,15949491,16014679,3863721,3985363,13701993,1690499,8683928,9018677,49822]},FP512BN:{Modulus:[3010355,5247557,2020268,8020771,2448613,8139309,2803931,4600559,1620196,4020605,4528956,490026,3936539,7870332,3331265,381164,8323526,8385496,8388607,8388607,8388607,8388607,63],R2modp:[2352733,5724727,4267216,2711475,6555241,3628137,598933,7570578,7867757,1822109,4291754,3000059,8301819,3305539,8335303,992908,7591731,2181065,2804947,3336952,3877918,870050,48],MConst:5004293,Fra:[3619506,3105769,4706904,1054070,1381622,5258286,3469153,5222464,2931637,5586186,6531042,1061916,4771630,3499223,2473444,5293353,4623182,2969999,450118,8160429,1897915,6218581,7],Frb:[7779457,2141787,5701972,6966700,1066991,2881023,7723386,7766702,7077166,6823026,6386521,7816717,7553516,4371108,857821,3476419,3700343,5415497,7938489,228178,6490692,2170026,56]},BN254:{Modulus:[19,0,1287936,0,2162688,2145,8388608,12203085,1,6586944,9507],R2modp:[3091111,5468231,16314740,12837732,11242524,3940405,431433,3641991,3925545,7692666,8007],MConst:9713125,Fra:[2780649,15122543,12771709,5062519,619666,9781125,5285958,11946395,3046540,7739681,6967],Frb:[13996586,1654672,5293442,11714696,1543021,6998236,3102649,256690,13730677,15624478,2539]},BN254CX:{Modulus:[1791411,2355036,14794342,1575230,4183790,6738724,6584931,11582943,7350797,8,9216],R2modp:[9365053,7479262,13371537,1098379,872282,4987131,9451258,4162655,10815460,7924521,5511],MConst:7904901,Fra:[13110947,537429,2186201,15823864,6779686,1611880,9088167,11526539,3801444,536486,4953],Frb:[5457680,1817606,12608141,2528582,14181319,5126843,14273980,56403,3549353,16240738,4262]},BRAINPOOL:{Modulus:[7230327,4726047,2629651,13968928,3929635,9269870,9477507,4089354,15641020,5757857,43515],R2modp:[3520537,11547688,15511311,3691684,4853461,2367978,11163180,1023045,14528088,4411645,21176],MConst:16615865},C41417:{Modulus:[4194287,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,4194303,262143],R2modp:[73984,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:17},GOLDILOCKS:{Modulus:[8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8257535,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,2047],R2modp:[0,4,0,0,0,0,0,0,0,0,786432,0,0,0,0,0,0,0,0,0],MConst:1},HIFIVE:{Modulus:[8388605,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,16383],R2modp:[2359296,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:3},NIST256:{Modulus:[16777215,16777215,16777215,16777215,0,0,0,0,1,16776960,65535],R2modp:[196608,0,0,16776960,16515071,16777215,16777214,16777215,16646143,16777215,4],MConst:1},NIST384:{Modulus:[8388607,511,0,0,8388592,8380415,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,65535],R2modp:[16384,0,8388606,511,524288,0,0,8372224,4194303,0,512,131072,0,0,0,0,0],MConst:1},NIST521:{Modulus:[8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,8388607,32767],R2modp:[65536,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],MConst:1},SECP256K1:{Modulus:[16776239,16776959,16777215,16777215,16777215,16777215,16777215,16777215,16777215,16777215,65535],R2modp:[10551296,3728,1954,256,0,0,0,0,0,0,0],MConst:2438449}};function r(r){var s,h=this;if(s={ED25519:{BITS:"256",FIELD:"25519",CURVE:"ED25519","@NB":32,"@BASE":24,"@NBT":255,"@M8":5,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},C25519:{BITS:"256",FIELD:"25519",CURVE:"C25519","@NB":32,"@BASE":24,"@NBT":255,"@M8":5,"@MT":1,"@CT":2,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},SECP256K1:{BITS:"256",FIELD:"SECP256K1",CURVE:"SECP256K1","@NB":32,"@BASE":24,"@NBT":256,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},NIST256:{BITS:"256",FIELD:"NIST256",CURVE:"NIST256","@NB":32,"@BASE":24,"@NBT":256,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},NIST384:{BITS:"384",FIELD:"NIST384",CURVE:"NIST384","@NB":48,"@BASE":23,"@NBT":384,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":48,"@AK":24},BRAINPOOL:{BITS:"256",FIELD:"BRAINPOOL",CURVE:"BRAINPOOL","@NB":32,"@BASE":24,"@NBT":256,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},ANSSI:{BITS:"256",FIELD:"ANSSI",CURVE:"ANSSI","@NB":32,"@BASE":24,"@NBT":256,"@M8":7,"@MT":0,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},HIFIVE:{BITS:"336",FIELD:"HIFIVE",CURVE:"HIFIVE","@NB":42,"@BASE":23,"@NBT":336,"@M8":5,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":48,"@AK":24},GOLDILOCKS:{BITS:"448",FIELD:"GOLDILOCKS",CURVE:"GOLDILOCKS","@NB":56,"@BASE":23,"@NBT":448,"@M8":7,"@MT":2,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},C41417:{BITS:"416",FIELD:"C41417",CURVE:"C41417","@NB":52,"@BASE":22,"@NBT":414,"@M8":7,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},NIST521:{BITS:"528",FIELD:"NIST521",CURVE:"NIST521","@NB":66,"@BASE":23,"@NBT":521,"@M8":7,"@MT":1,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},NUMS256W:{BITS:"256",FIELD:"256PM",CURVE:"NUMS256W","@NB":32,"@BASE":24,"@NBT":256,"@M8":3,"@MT":1,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},NUMS256E:{BITS:"256",FIELD:"256PM",CURVE:"NUMS256E","@NB":32,"@BASE":24,"@NBT":256,"@M8":3,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":32,"@AK":16},NUMS384W:{BITS:"384",FIELD:"384PM",CURVE:"NUMS384W","@NB":48,"@BASE":23,"@NBT":384,"@M8":3,"@MT":1,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":48,"@AK":24},NUMS384E:{BITS:"384",FIELD:"384PM",CURVE:"NUMS384E","@NB":48,"@BASE":23,"@NBT":384,"@M8":3,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":48,"@AK":24},NUMS512W:{BITS:"512",FIELD:"512PM",CURVE:"NUMS512W","@NB":64,"@BASE":23,"@NBT":512,"@M8":7,"@MT":1,"@CT":0,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},NUMS512E:{BITS:"512",FIELD:"512PM",CURVE:"NUMS512E","@NB":64,"@BASE":23,"@NBT":512,"@M8":7,"@MT":1,"@CT":1,"@PF":0,"@ST":0,"@SX":0,"@HT":64,"@AK":32},FP256BN:{BITS:"256",FIELD:"FP256BN",CURVE:"FP256BN","@NB":32,"@BASE":24,"@NBT":256,"@M8":3,"@MT":0,"@CT":0,"@PF":1,"@ST":1,"@SX":1,"@HT":32,"@AK":16},FP512BN:{BITS:"512",FIELD:"FP512BN",CURVE:"FP512BN","@NB":64,"@BASE":23,"@NBT":512,"@M8":3,"@MT":0,"@CT":0,"@PF":1,"@ST":1,"@SX":0,"@HT":32,"@AK":16},BN254:{BITS:"256",FIELD:"BN254",CURVE:"BN254","@NB":32,"@BASE":24,"@NBT":254,"@M8":3,"@MT":0,"@CT":0,"@PF":1,"@ST":0,"@SX":1,"@HT":32,"@AK":16},BN254CX:{BITS:"256",FIELD:"BN254CX",CURVE:"BN254CX","@NB":32,"@BASE":24,"@NBT":254,"@M8":3,"@MT":0,"@CT":0,"@PF":1,"@ST":0,"@SX":1,"@HT":32,"@AK":16},BLS383:{BITS:"384",FIELD:"BLS383",CURVE:"BLS383","@NB":48,"@BASE":23,"@NBT":383,"@M8":3,"@MT":0,"@CT":0,"@PF":2,"@ST":1,"@SX":0,"@HT":32,"@AK":16},BLS24:{BITS:"480",FIELD:"BLS24",CURVE:"BLS24","@NB":60,"@BASE":23,"@NBT":479,"@M8":3,"@MT":0,"@CT":0,"@PF":3,"@ST":1,"@SX":0,"@HT":48,"@AK":24},BLS48:{BITS:"560",FIELD:"BLS48",CURVE:"BLS48","@NB":70,"@BASE":23,"@NBT":556,"@M8":3,"@MT":0,"@CT":0,"@PF":4,"@ST":1,"@SX":0,"@HT":64,"@AK":32},BLS381:{BITS:"381",FIELD:"BLS381",CURVE:"BLS381","@NB":48,"@BASE":23,"@NBT":381,"@M8":3,"@MT":0,"@CT":0,"@PF":2,"@ST":1,"@SX":1,"@HT":32,"@AK":16},BLS461:{BITS:"464",FIELD:"BLS461",CURVE:"BLS461","@NB":58,"@BASE":23,"@NBT":461,"@M8":3,"@MT":0,"@CT":0,"@PF":2,"@ST":1,"@SX":1,"@HT":32,"@AK":16},RSA2048:{BITS:"1024",TFF:"2048","@NB":128,"@BASE":22,"@ML":2},RSA3072:{BITS:"384",TFF:"3072","@NB":48,"@BASE":23,"@ML":8},RSA4096:{BITS:"512",TFF:"4096","@NB":64,"@BASE":23,"@ML":8}},h.AES=function(){var t=function(){this.Nk=0,this.Nr=0,this.mode=0,this.fkey=[],this.rkey=[],this.f=[]};return t.ECB=0,t.CBC=1,t.CFB1=2,t.CFB2=3,t.CFB4=5,t.OFB1=14,t.OFB2=15,t.OFB4=17,t.OFB8=21,t.OFB16=29,t.CTR1=30,t.CTR2=31,t.CTR4=33,t.CTR8=37,t.CTR16=45,t.prototype={reset:function(n,i){var e;for(this.mode=n,e=0;e<16;e++)this.f[e]=0;if(this.mode!=t.ECB&&null!==i)for(e=0;e<16;e++)this.f[e]=i[e]},getreg:function(){var t,n=[];for(t=0;t<16;t++)n[t]=this.f[t];return n},increment:function(){var t;for(t=0;t<16&&(this.f[t]++,!(255&this.f[t]));t++);},init:function(n,i,e,o){var r,s,h,c,u,a=[],f=[];if(4!=(i/=4)&&6!=i&&8!=i)return!1;for(u=6+i,this.Nk=i,this.Nr=u,this.reset(n,o),c=4*(u+1),r=s=0;r<i;r++,s+=4){for(h=0;h<4;h++)f[h]=e[s+h];a[r]=t.pack(f)}for(r=0;r<i;r++)this.fkey[r]=a[r];for(s=i,h=0;s<c;s+=i,h++)for(this.fkey[s]=this.fkey[s-i]^t.SubByte(t.ROTL24(this.fkey[s-1]))^255&t.rco[h],r=1;r<i&&r+s<c;r++)this.fkey[r+s]=this.fkey[r+s-i]^this.fkey[r+s-1];for(s=0;s<4;s++)this.rkey[s+c-4]=this.fkey[s];for(r=4;r<c-4;r+=4)for(h=c-4-r,s=0;s<4;s++)this.rkey[h+s]=t.InvMixCol(this.fkey[r+s]);for(s=c-4;s<c;s++)this.rkey[s-c+4]=this.fkey[s]},ecb_encrypt:function(n){var i,e,o,r,s=[],h=[],c=[];for(e=o=0;e<4;e++,o+=4){for(r=0;r<4;r++)s[r]=n[o+r];h[e]=t.pack(s),h[e]^=this.fkey[e]}for(r=4,e=1;e<this.Nr;e++)for(c[0]=this.fkey[r]^t.ftable[255&h[0]]^t.ROTL8(t.ftable[h[1]>>>8&255])^t.ROTL16(t.ftable[h[2]>>>16&255])^t.ROTL24(t.ftable[h[3]>>>24&255]),c[1]=this.fkey[r+1]^t.ftable[255&h[1]]^t.ROTL8(t.ftable[h[2]>>>8&255])^t.ROTL16(t.ftable[h[3]>>>16&255])^t.ROTL24(t.ftable[h[0]>>>24&255]),c[2]=this.fkey[r+2]^t.ftable[255&h[2]]^t.ROTL8(t.ftable[h[3]>>>8&255])^t.ROTL16(t.ftable[h[0]>>>16&255])^t.ROTL24(t.ftable[h[1]>>>24&255]),c[3]=this.fkey[r+3]^t.ftable[255&h[3]]^t.ROTL8(t.ftable[h[0]>>>8&255])^t.ROTL16(t.ftable[h[1]>>>16&255])^t.ROTL24(t.ftable[h[2]>>>24&255]),r+=4,o=0;o<4;o++)i=h[o],h[o]=c[o],c[o]=i;for(c[0]=this.fkey[r]^255&t.fbsub[255&h[0]]^t.ROTL8(255&t.fbsub[h[1]>>>8&255])^t.ROTL16(255&t.fbsub[h[2]>>>16&255])^t.ROTL24(255&t.fbsub[h[3]>>>24&255]),c[1]=this.fkey[r+1]^255&t.fbsub[255&h[1]]^t.ROTL8(255&t.fbsub[h[2]>>>8&255])^t.ROTL16(255&t.fbsub[h[3]>>>16&255])^t.ROTL24(255&t.fbsub[h[0]>>>24&255]),c[2]=this.fkey[r+2]^255&t.fbsub[255&h[2]]^t.ROTL8(255&t.fbsub[h[3]>>>8&255])^t.ROTL16(255&t.fbsub[h[0]>>>16&255])^t.ROTL24(255&t.fbsub[h[1]>>>24&255]),c[3]=this.fkey[r+3]^255&t.fbsub[255&h[3]]^t.ROTL8(255&t.fbsub[h[0]>>>8&255])^t.ROTL16(255&t.fbsub[h[1]>>>16&255])^t.ROTL24(255&t.fbsub[h[2]>>>24&255]),e=o=0;e<4;e++,o+=4)for(s=t.unpack(c[e]),r=0;r<4;r++)n[o+r]=s[r]},ecb_decrypt:function(n){var i,e,o,r,s=[],h=[],c=[];for(e=o=0;e<4;e++,o+=4){for(r=0;r<4;r++)s[r]=n[o+r];h[e]=t.pack(s),h[e]^=this.rkey[e]}for(r=4,e=1;e<this.Nr;e++)for(c[0]=this.rkey[r]^t.rtable[255&h[0]]^t.ROTL8(t.rtable[h[3]>>>8&255])^t.ROTL16(t.rtable[h[2]>>>16&255])^t.ROTL24(t.rtable[h[1]>>>24&255]),c[1]=this.rkey[r+1]^t.rtable[255&h[1]]^t.ROTL8(t.rtable[h[0]>>>8&255])^t.ROTL16(t.rtable[h[3]>>>16&255])^t.ROTL24(t.rtable[h[2]>>>24&255]),c[2]=this.rkey[r+2]^t.rtable[255&h[2]]^t.ROTL8(t.rtable[h[1]>>>8&255])^t.ROTL16(t.rtable[h[0]>>>16&255])^t.ROTL24(t.rtable[h[3]>>>24&255]),c[3]=this.rkey[r+3]^t.rtable[255&h[3]]^t.ROTL8(t.rtable[h[2]>>>8&255])^t.ROTL16(t.rtable[h[1]>>>16&255])^t.ROTL24(t.rtable[h[0]>>>24&255]),r+=4,o=0;o<4;o++)i=h[o],h[o]=c[o],c[o]=i;for(c[0]=this.rkey[r]^255&t.rbsub[255&h[0]]^t.ROTL8(255&t.rbsub[h[3]>>>8&255])^t.ROTL16(255&t.rbsub[h[2]>>>16&255])^t.ROTL24(255&t.rbsub[h[1]>>>24&255]),c[1]=this.rkey[r+1]^255&t.rbsub[255&h[1]]^t.ROTL8(255&t.rbsub[h[0]>>>8&255])^t.ROTL16(255&t.rbsub[h[3]>>>16&255])^t.ROTL24(255&t.rbsub[h[2]>>>24&255]),c[2]=this.rkey[r+2]^255&t.rbsub[255&h[2]]^t.ROTL8(255&t.rbsub[h[1]>>>8&255])^t.ROTL16(255&t.rbsub[h[0]>>>16&255])^t.ROTL24(255&t.rbsub[h[3]>>>24&255]),c[3]=this.rkey[r+3]^255&t.rbsub[255&h[3]]^t.ROTL8(255&t.rbsub[h[2]>>>8&255])^t.ROTL16(255&t.rbsub[h[1]>>>16&255])^t.ROTL24(255&t.rbsub[h[0]>>>24&255]),e=o=0;e<4;e++,o+=4)for(s=t.unpack(c[e]),r=0;r<4;r++)n[o+r]=s[r]},encrypt:function(n){var i,e,o,r=[];switch(e=0,this.mode){case t.ECB:return this.ecb_encrypt(n),0;case t.CBC:for(o=0;o<16;o++)n[o]^=this.f[o];for(this.ecb_encrypt(n),o=0;o<16;o++)this.f[o]=n[o];return 0;case t.CFB1:case t.CFB2:case t.CFB4:for(i=this.mode-t.CFB1+1,o=0;o<i;o++)e=e<<8|this.f[o];for(o=0;o<16;o++)r[o]=this.f[o];for(o=i;o<16;o++)this.f[o-i]=this.f[o];for(this.ecb_encrypt(r),o=0;o<i;o++)n[o]^=r[o],this.f[16-i+o]=n[o];return e;case t.OFB1:case t.OFB2:case t.OFB4:case t.OFB8:case t.OFB16:for(i=this.mode-t.OFB1+1,this.ecb_encrypt(this.f),o=0;o<i;o++)n[o]^=this.f[o];return 0;case t.CTR1:case t.CTR2:case t.CTR4:case t.CTR8:case t.CTR16:for(i=this.mode-t.CTR1+1,o=0;o<16;o++)r[o]=this.f[o];for(this.ecb_encrypt(r),o=0;o<i;o++)n[o]^=r[o];return this.increment(),0;default:return 0}},decrypt:function(n){var i,e,o,r=[];switch(e=0,this.mode){case t.ECB:return this.ecb_decrypt(n),0;case t.CBC:for(o=0;o<16;o++)r[o]=this.f[o],this.f[o]=n[o];for(this.ecb_decrypt(n),o=0;o<16;o++)n[o]^=r[o],r[o]=0;return 0;case t.CFB1:case t.CFB2:case t.CFB4:for(i=this.mode-t.CFB1+1,o=0;o<i;o++)e=e<<8|this.f[o];for(o=0;o<16;o++)r[o]=this.f[o];for(o=i;o<16;o++)this.f[o-i]=this.f[o];for(this.ecb_encrypt(r),o=0;o<i;o++)this.f[16-i+o]=n[o],n[o]^=r[o];return e;case t.OFB1:case t.OFB2:case t.OFB4:case t.OFB8:case t.OFB16:for(i=this.mode-t.OFB1+1,this.ecb_encrypt(this.f),o=0;o<i;o++)n[o]^=this.f[o];return 0;case t.CTR1:case t.CTR2:case t.CTR4:case t.CTR8:case t.CTR16:for(i=this.mode-t.CTR1+1,o=0;o<16;o++)r[o]=this.f[o];for(this.ecb_encrypt(r),o=0;o<i;o++)n[o]^=r[o];return this.increment(),0;default:return 0}},end:function(){var t;for(t=0;t<4*(this.Nr+1);t++)this.fkey[t]=this.rkey[t]=0;for(t=0;t<16;t++)this.f[t]=0}},t.ROTL8=function(t){return t<<8|t>>>24},t.ROTL16=function(t){return t<<16|t>>>16},t.ROTL24=function(t){return t<<24|t>>>8},t.pack=function(t){return(255&t[3])<<24|(255&t[2])<<16|(255&t[1])<<8|255&t[0]},t.unpack=function(t){var n=[];return n[0]=255&t,n[1]=t>>>8&255,n[2]=t>>>16&255,n[3]=t>>>24&255,n},t.bmul=function(n,i){var e=255&i,o=255&t.ltab[255&n],r=255&t.ltab[e];return 0!==n&&0!==i?t.ptab[(o+r)%255]:0},t.SubByte=function(n){var i=t.unpack(n);return i[0]=t.fbsub[255&i[0]],i[1]=t.fbsub[255&i[1]],i[2]=t.fbsub[255&i[2]],i[3]=t.fbsub[255&i[3]],t.pack(i)},t.product=function(n,i){var e=t.unpack(n),o=t.unpack(i);return 255&(t.bmul(e[0],o[0])^t.bmul(e[1],o[1])^t.bmul(e[2],o[2])^t.bmul(e[3],o[3]))},t.InvMixCol=function(n){var i,e=[];return i=t.pack(t.InCo),e[3]=t.product(i,n),i=t.ROTL24(i),e[2]=t.product(i,n),i=t.ROTL24(i),e[1]=t.product(i,n),i=t.ROTL24(i),e[0]=t.product(i,n),t.pack(e)},t.InCo=[11,13,9,14],t.rco=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47],t.ptab=[1,3,5,15,17,51,85,255,26,46,114,150,161,248,19,53,95,225,56,72,216,115,149,164,247,2,6,10,30,34,102,170,229,52,92,228,55,89,235,38,106,190,217,112,144,171,230,49,83,245,4,12,20,60,68,204,79,209,104,184,211,110,178,205,76,212,103,169,224,59,77,215,98,166,241,8,24,40,120,136,131,158,185,208,107,189,220,127,129,152,179,206,73,219,118,154,181,196,87,249,16,48,80,240,11,29,39,105,187,214,97,163,254,25,43,125,135,146,173,236,47,113,147,174,233,32,96,160,251,22,58,78,210,109,183,194,93,231,50,86,250,21,63,65,195,94,226,61,71,201,64,192,91,237,44,116,156,191,218,117,159,186,213,100,172,239,42,126,130,157,188,223,122,142,137,128,155,182,193,88,232,35,101,175,234,37,111,177,200,67,197,84,252,31,33,99,165,244,7,9,27,45,119,153,176,203,70,202,69,207,74,222,121,139,134,145,168,227,62,66,198,81,243,14,18,54,90,238,41,123,141,140,143,138,133,148,167,242,13,23,57,75,221,124,132,151,162,253,28,36,108,180,199,82,246,1],t.ltab=[0,255,25,1,50,2,26,198,75,199,27,104,51,238,223,3,100,4,224,14,52,141,129,239,76,113,8,200,248,105,28,193,125,194,29,181,249,185,39,106,77,228,166,114,154,201,9,120,101,47,138,5,33,15,225,36,18,240,130,69,53,147,218,142,150,143,219,189,54,208,206,148,19,92,210,241,64,70,131,56,102,221,253,48,191,6,139,98,179,37,226,152,34,136,145,16,126,110,72,195,163,182,30,66,58,107,40,84,250,133,61,186,43,121,10,21,155,159,94,202,78,212,172,229,243,115,167,87,175,88,168,80,244,234,214,116,79,174,233,213,231,230,173,232,44,215,117,122,235,22,11,245,89,203,95,176,156,169,81,160,127,12,246,111,23,196,73,236,216,67,31,45,164,118,123,183,204,187,62,90,251,96,177,134,59,82,161,108,170,85,41,157,151,178,135,144,97,190,220,252,188,149,207,205,55,63,91,209,83,57,132,60,65,162,109,71,20,42,158,93,86,242,211,171,68,17,146,217,35,32,46,137,180,124,184,38,119,153,227,165,103,74,237,222,197,49,254,24,13,99,140,128,192,247,112,7],t.fbsub=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],t.rbsub=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],t.ftable=[2774754246,2222750968,2574743534,2373680118,234025727,3177933782,2976870366,1422247313,1345335392,50397442,2842126286,2099981142,436141799,1658312629,3870010189,2591454956,1170918031,2642575903,1086966153,2273148410,368769775,3948501426,3376891790,200339707,3970805057,1742001331,4255294047,3937382213,3214711843,4154762323,2524082916,1539358875,3266819957,486407649,2928907069,1780885068,1513502316,1094664062,49805301,1338821763,1546925160,4104496465,887481809,150073849,2473685474,1943591083,1395732834,1058346282,201589768,1388824469,1696801606,1589887901,672667696,2711000631,251987210,3046808111,151455502,907153956,2608889883,1038279391,652995533,1764173646,3451040383,2675275242,453576978,2659418909,1949051992,773462580,756751158,2993581788,3998898868,4221608027,4132590244,1295727478,1641469623,3467883389,2066295122,1055122397,1898917726,2542044179,4115878822,1758581177,0,753790401,1612718144,536673507,3367088505,3982187446,3194645204,1187761037,3653156455,1262041458,3729410708,3561770136,3898103984,1255133061,1808847035,720367557,3853167183,385612781,3309519750,3612167578,1429418854,2491778321,3477423498,284817897,100794884,2172616702,4031795360,1144798328,3131023141,3819481163,4082192802,4272137053,3225436288,2324664069,2912064063,3164445985,1211644016,83228145,3753688163,3249976951,1977277103,1663115586,806359072,452984805,250868733,1842533055,1288555905,336333848,890442534,804056259,3781124030,2727843637,3427026056,957814574,1472513171,4071073621,2189328124,1195195770,2892260552,3881655738,723065138,2507371494,2690670784,2558624025,3511635870,2145180835,1713513028,2116692564,2878378043,2206763019,3393603212,703524551,3552098411,1007948840,2044649127,3797835452,487262998,1994120109,1004593371,1446130276,1312438900,503974420,3679013266,168166924,1814307912,3831258296,1573044895,1859376061,4021070915,2791465668,2828112185,2761266481,937747667,2339994098,854058965,1137232011,1496790894,3077402074,2358086913,1691735473,3528347292,3769215305,3027004632,4199962284,133494003,636152527,2942657994,2390391540,3920539207,403179536,3585784431,2289596656,1864705354,1915629148,605822008,4054230615,3350508659,1371981463,602466507,2094914977,2624877800,555687742,3712699286,3703422305,2257292045,2240449039,2423288032,1111375484,3300242801,2858837708,3628615824,84083462,32962295,302911004,2741068226,1597322602,4183250862,3501832553,2441512471,1489093017,656219450,3114180135,954327513,335083755,3013122091,856756514,3144247762,1893325225,2307821063,2811532339,3063651117,572399164,2458355477,552200649,1238290055,4283782570,2015897680,2061492133,2408352771,4171342169,2156497161,386731290,3669999461,837215959,3326231172,3093850320,3275833730,2962856233,1999449434,286199582,3417354363,4233385128,3602627437,974525996],t.rtable=[1353184337,1399144830,3282310938,2522752826,3412831035,4047871263,2874735276,2466505547,1442459680,4134368941,2440481928,625738485,4242007375,3620416197,2151953702,2409849525,1230680542,1729870373,2551114309,3787521629,41234371,317738113,2744600205,3338261355,3881799427,2510066197,3950669247,3663286933,763608788,3542185048,694804553,1154009486,1787413109,2021232372,1799248025,3715217703,3058688446,397248752,1722556617,3023752829,407560035,2184256229,1613975959,1165972322,3765920945,2226023355,480281086,2485848313,1483229296,436028815,2272059028,3086515026,601060267,3791801202,1468997603,715871590,120122290,63092015,2591802758,2768779219,4068943920,2997206819,3127509762,1552029421,723308426,2461301159,4042393587,2715969870,3455375973,3586000134,526529745,2331944644,2639474228,2689987490,853641733,1978398372,971801355,2867814464,111112542,1360031421,4186579262,1023860118,2919579357,1186850381,3045938321,90031217,1876166148,4279586912,620468249,2548678102,3426959497,2006899047,3175278768,2290845959,945494503,3689859193,1191869601,3910091388,3374220536,0,2206629897,1223502642,2893025566,1316117100,4227796733,1446544655,517320253,658058550,1691946762,564550760,3511966619,976107044,2976320012,266819475,3533106868,2660342555,1338359936,2720062561,1766553434,370807324,179999714,3844776128,1138762300,488053522,185403662,2915535858,3114841645,3366526484,2233069911,1275557295,3151862254,4250959779,2670068215,3170202204,3309004356,880737115,1982415755,3703972811,1761406390,1676797112,3403428311,277177154,1076008723,538035844,2099530373,4164795346,288553390,1839278535,1261411869,4080055004,3964831245,3504587127,1813426987,2579067049,4199060497,577038663,3297574056,440397984,3626794326,4019204898,3343796615,3251714265,4272081548,906744984,3481400742,685669029,646887386,2764025151,3835509292,227702864,2613862250,1648787028,3256061430,3904428176,1593260334,4121936770,3196083615,2090061929,2838353263,3004310991,999926984,2809993232,1852021992,2075868123,158869197,4095236462,28809964,2828685187,1701746150,2129067946,147831841,3873969647,3650873274,3459673930,3557400554,3598495785,2947720241,824393514,815048134,3227951669,935087732,2798289660,2966458592,366520115,1251476721,4158319681,240176511,804688151,2379631990,1303441219,1414376140,3741619940,3820343710,461924940,3089050817,2136040774,82468509,1563790337,1937016826,776014843,1511876531,1389550482,861278441,323475053,2355222426,2047648055,2383738969,2302415851,3995576782,902390199,3991215329,1018251130,1507840668,1064563285,2043548696,3208103795,3939366739,1537932639,342834655,2262516856,2180231114,1053059257,741614648,1598071746,1925389590,203809468,2336832552,1100287487,1895934009,3736275976,2632234200,2428589668,1636092795,1890988757,1952214088,1113045200],t}(),h.GCM=function(t){var n=function(){this.table=new Array(128);for(var n=0;n<128;n++)this.table[n]=new Array(4);this.stateX=[],this.Y_0=[],this.counter=0,this.lenA=[],this.lenC=[],this.status=0,this.a=new t.AES};return n.ACCEPTING_HEADER=0,n.ACCEPTING_CIPHER=1,n.NOT_ACCEPTING_MORE=2,n.FINISHED=3,n.ENCRYPTING=0,n.DECRYPTING=1,n.prototype={precompute:function(t){var i,e,o,r=[];for(i=e=0;i<4;i++,e+=4)r[0]=t[e],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3],this.table[0][i]=n.pack(r);for(i=1;i<128;i++){for(o=0,e=0;e<4;e++)this.table[i][e]=o|this.table[i-1][e]>>>1,o=this.table[i-1][e]<<31;0!==o&&(this.table[i][0]^=3774873600)}},gf2mul:function(){var t,i,e,o,r,s=[],h=[];for(s[0]=s[1]=s[2]=s[3]=0,i=8,e=0,t=0;t<128;t++){for(r=1+~(r=this.stateX[e]>>>--i&1),o=0;o<4;o++)s[o]^=this.table[t][o]&r;if(0===i&&(i=8,16==++e))break}for(t=i=0;t<4;t++,i+=4)h=n.unpack(s[t]),this.stateX[i]=h[0],this.stateX[i+1]=h[1],this.stateX[i+2]=h[2],this.stateX[i+3]=h[3]},wrap:function(){var t,i,e=[],o=[],r=[];for(e[0]=this.lenA[0]<<3|(3758096384&this.lenA[1])>>>29,e[1]=this.lenA[1]<<3,e[2]=this.lenC[0]<<3|(3758096384&this.lenC[1])>>>29,e[3]=this.lenC[1]<<3,t=i=0;t<4;t++,i+=4)r=n.unpack(e[t]),o[i]=r[0],o[i+1]=r[1],o[i+2]=r[2],o[i+3]=r[3];for(t=0;t<16;t++)this.stateX[t]^=o[t];this.gf2mul()},init:function(i,e,o,r){var s,h=[],c=[];for(s=0;s<16;s++)h[s]=0,this.stateX[s]=0;if(this.a.init(t.AES.ECB,i,e,r),this.a.ecb_encrypt(h),this.precompute(h),this.lenA[0]=this.lenC[0]=this.lenA[1]=this.lenC[1]=0,12==o){for(s=0;s<12;s++)this.a.f[s]=r[s];for(c=n.unpack(1),this.a.f[12]=c[0],this.a.f[13]=c[1],this.a.f[14]=c[2],this.a.f[15]=c[3],s=0;s<16;s++)this.Y_0[s]=this.a.f[s]}else{for(this.status=n.ACCEPTING_CIPHER,this.ghash(r,o),this.wrap(),s=0;s<16;s++)this.a.f[s]=this.stateX[s],this.Y_0[s]=this.a.f[s],this.stateX[s]=0;this.lenA[0]=this.lenC[0]=this.lenA[1]=this.lenC[1]=0}this.status=n.ACCEPTING_HEADER},add_header:function(t,i){var e,o=0;if(this.status!=n.ACCEPTING_HEADER)return!1;for(;o<i;){for(e=0;e<16&&o<i;e++)this.stateX[e]^=t[o++],this.lenA[1]++,this.lenA[1]|=0,0===this.lenA[1]&&this.lenA[0]++;this.gf2mul()}return i%16!=0&&(this.status=n.ACCEPTING_CIPHER),!0},ghash:function(t,i){var e,o=0;if(this.status==n.ACCEPTING_HEADER&&(this.status=n.ACCEPTING_CIPHER),this.status!=n.ACCEPTING_CIPHER)return!1;for(;o<i;){for(e=0;e<16&&o<i;e++)this.stateX[e]^=t[o++],this.lenC[1]++,this.lenC[1]|=0,0===this.lenC[1]&&this.lenC[0]++;this.gf2mul()}return i%16!=0&&(this.status=n.NOT_ACCEPTING_MORE),!0},add_plain:function(t,i){var e,o=[],r=[],s=[],h=0;if(this.status==n.ACCEPTING_HEADER&&(this.status=n.ACCEPTING_CIPHER),this.status!=n.ACCEPTING_CIPHER)return s;for(;h<i;){for(r[0]=this.a.f[12],r[1]=this.a.f[13],r[2]=this.a.f[14],r[3]=this.a.f[15],this.counter=n.pack(r),this.counter++,r=n.unpack(this.counter),this.a.f[12]=r[0],this.a.f[13]=r[1],this.a.f[14]=r[2],this.a.f[15]=r[3],e=0;e<16;e++)o[e]=this.a.f[e];for(this.a.ecb_encrypt(o),e=0;e<16&&h<i;e++)s[h]=t[h]^o[e],this.stateX[e]^=s[h++],this.lenC[1]++,this.lenC[1]|=0,0===this.lenC[1]&&this.lenC[0]++;this.gf2mul()}return i%16!=0&&(this.status=n.NOT_ACCEPTING_MORE),s},add_cipher:function(t,i){var e,o,r=[],s=[],h=[],c=0;if(this.status==n.ACCEPTING_HEADER&&(this.status=n.ACCEPTING_CIPHER),this.status!=n.ACCEPTING_CIPHER)return h;for(;c<i;){for(s[0]=this.a.f[12],s[1]=this.a.f[13],s[2]=this.a.f[14],s[3]=this.a.f[15],this.counter=n.pack(s),this.counter++,s=n.unpack(this.counter),this.a.f[12]=s[0],this.a.f[13]=s[1],this.a.f[14]=s[2],this.a.f[15]=s[3],e=0;e<16;e++)r[e]=this.a.f[e];for(this.a.ecb_encrypt(r),e=0;e<16&&c<i;e++)o=t[c],h[c]=t[c]^r[e],this.stateX[e]^=o,c++,this.lenC[1]++,this.lenC[1]|=0,0===this.lenC[1]&&this.lenC[0]++;this.gf2mul()}return i%16!=0&&(this.status=n.NOT_ACCEPTING_MORE),h},finish:function(t){var i,e=[];if(this.wrap(),t){for(this.a.ecb_encrypt(this.Y_0),i=0;i<16;i++)this.Y_0[i]^=this.stateX[i];for(i=0;i<16;i++)e[i]=this.Y_0[i],this.Y_0[i]=this.stateX[i]=0}return this.status=n.FINISHED,this.a.end(),e}},n.pack=function(t){return(255&t[0])<<24|(255&t[1])<<16|(255&t[2])<<8|255&t[3]},n.unpack=function(t){var n=[];return n[3]=255&t,n[2]=t>>>8&255,n[1]=t>>>16&255,n[0]=t>>>24&255,n},n.hex2bytes=function(t){var n,i=t.length,e=[];for(n=0;n<i;n+=2)e[n/2]=parseInt(t.substr(n,2),16);return e},n}(h),h.UInt64=function(){var t=function(t,n){this.top=t,this.bot=n};return t.prototype={add:function(t){var n=(this.bot>>>0)+(t.bot>>>0),i=n>>>0,e=(this.top>>>0)+(t.top>>>0);return this.bot=i,this.top=i!=n?e+1>>>0:e,this},copy:function(){return new t(this.top,this.bot)},shlb:function(){var t=this.bot>>>24;return this.top=t+(this.top<<8),this.bot<<=8,this}},t}(),h.HASH256=function(){var t=function(){this.length=[],this.h=[],this.w=[],this.init()};return t.prototype={transform:function(){var n,i,e,o,r,s,h,c,u,a,f;for(f=16;f<64;f++)this.w[f]=t.theta1(this.w[f-2])+this.w[f-7]+t.theta0(this.w[f-15])+this.w[f-16]|0;for(n=this.h[0],i=this.h[1],e=this.h[2],o=this.h[3],r=this.h[4],s=this.h[5],h=this.h[6],c=this.h[7],f=0;f<64;f++)u=c+t.Sig1(r)+t.Ch(r,s,h)+t.HK[f]+this.w[f]|0,a=t.Sig0(n)+t.Maj(n,i,e)|0,c=h,h=s,s=r,r=o+u|0,o=e,e=i,i=n,n=u+a|0;this.h[0]+=n,this.h[1]+=i,this.h[2]+=e,this.h[3]+=o,this.h[4]+=r,this.h[5]+=s,this.h[6]+=h,this.h[7]+=c},init:function(){var n;for(n=0;n<64;n++)this.w[n]=0;this.length[0]=this.length[1]=0,this.h[0]=t.H[0],this.h[1]=t.H[1],this.h[2]=t.H[2],this.h[3]=t.H[3],this.h[4]=t.H[4],this.h[5]=t.H[5],this.h[6]=t.H[6],this.h[7]=t.H[7]},process:function(t){var n;n=(this.length[0]>>>5)%16,this.w[n]<<=8,this.w[n]|=255&t,this.length[0]+=8,4294967295&this.length[0]||(this.length[1]++,this.length[0]=0),this.length[0]%512==0&&this.transform()},process_array:function(t){for(var n=0;n<t.length;n++)this.process(t[n])},process_num:function(t){this.process(t>>24&255),this.process(t>>16&255),this.process(t>>8&255),this.process(255&t)},hash:function(){var n,i,e,o=[];for(n=this.length[0],i=this.length[1],this.process(128);this.length[0]%512!=448;)this.process(0);for(this.w[14]=i,this.w[15]=n,this.transform(),e=0;e<t.len;e++)o[e]=this.h[e>>>2]>>8*(3-e%4)&255;return this.init(),o}},t.S=function(t,n){return n>>>t|n<<32-t},t.R=function(t,n){return n>>>t},t.Ch=function(t,n,i){return t&n^~t&i},t.Maj=function(t,n,i){return t&n^t&i^n&i},t.Sig0=function(n){return t.S(2,n)^t.S(13,n)^t.S(22,n)},t.Sig1=function(n){return t.S(6,n)^t.S(11,n)^t.S(25,n)},t.theta0=function(n){return t.S(7,n)^t.S(18,n)^t.R(3,n)},t.theta1=function(n){return t.S(17,n)^t.S(19,n)^t.R(10,n)},t.len=32,t.H=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],t.HK=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],t}(),h.HASH384=function(t){var n=function(){this.length=[],this.h=[],this.w=[],this.init()};return n.prototype={transform:function(){var t,i,e,o,r,s,h,c,u,a,f;for(f=16;f<80;f++)this.w[f]=n.theta1(this.w[f-2]).add(this.w[f-7]).add(n.theta0(this.w[f-15])).add(this.w[f-16]);for(t=this.h[0].copy(),i=this.h[1].copy(),e=this.h[2].copy(),o=this.h[3].copy(),r=this.h[4].copy(),s=this.h[5].copy(),h=this.h[6].copy(),c=this.h[7].copy(),f=0;f<80;f++)(u=c.copy()).add(n.Sig1(r)).add(n.Ch(r,s,h)).add(n.HK[f]).add(this.w[f]),(a=n.Sig0(t)).add(n.Maj(t,i,e)),c=h,h=s,s=r,(r=o.copy()).add(u),o=e,e=i,i=t,(t=u.copy()).add(a);this.h[0].add(t),this.h[1].add(i),this.h[2].add(e),this.h[3].add(o),this.h[4].add(r),this.h[5].add(s),this.h[6].add(h),this.h[7].add(c)},init:function(){var i;for(i=0;i<80;i++)this.w[i]=new t.UInt64(0,0);this.length[0]=new t.UInt64(0,0),this.length[1]=new t.UInt64(0,0),this.h[0]=n.H[0].copy(),this.h[1]=n.H[1].copy(),this.h[2]=n.H[2].copy(),this.h[3]=n.H[3].copy(),this.h[4]=n.H[4].copy(),this.h[5]=n.H[5].copy(),this.h[6]=n.H[6].copy(),this.h[7]=n.H[7].copy()},process:function(n){var i,e;i=(this.length[0].bot>>>6)%16,this.w[i].shlb(),this.w[i].bot|=255&n,e=new t.UInt64(0,8),this.length[0].add(e),0===this.length[0].top&&0==this.length[0].bot&&(e=new t.UInt64(0,1),this.length[1].add(e)),this.length[0].bot%1024==0&&this.transform()},process_array:function(t){for(var n=0;n<t.length;n++)this.process(t[n])},process_num:function(t){this.process(t>>24&255),this.process(t>>16&255),this.process(t>>8&255),this.process(255&t)},hash:function(){var t,i,e,o=[];for(t=this.length[0].copy(),i=this.length[1].copy(),this.process(128);this.length[0].bot%1024!=896;)this.process(0);for(this.w[14]=i,this.w[15]=t,this.transform(),e=0;e<n.len;e++)o[e]=255&n.R(8*(7-e%8),this.h[e>>>3]).bot;return this.init(),o}},n.S=function(n,i){return 0==n?i:n<32?new t.UInt64(i.top>>>n|i.bot<<32-n,i.bot>>>n|i.top<<32-n):new t.UInt64(i.bot>>>n-32|i.top<<64-n,i.top>>>n-32|i.bot<<64-n)},n.R=function(n,i){return 0==n?i:n<32?new t.UInt64(i.top>>>n,i.bot>>>n|i.top<<32-n):new t.UInt64(0,i.top>>>n-32)},n.Ch=function(n,i,e){return new t.UInt64(n.top&i.top^~n.top&e.top,n.bot&i.bot^~n.bot&e.bot)},n.Maj=function(n,i,e){return new t.UInt64(n.top&i.top^n.top&e.top^i.top&e.top,n.bot&i.bot^n.bot&e.bot^i.bot&e.bot)},n.Sig0=function(i){var e=n.S(28,i),o=n.S(34,i),r=n.S(39,i);return new t.UInt64(e.top^o.top^r.top,e.bot^o.bot^r.bot)},n.Sig1=function(i){var e=n.S(14,i),o=n.S(18,i),r=n.S(41,i);return new t.UInt64(e.top^o.top^r.top,e.bot^o.bot^r.bot)},n.theta0=function(i){var e=n.S(1,i),o=n.S(8,i),r=n.R(7,i);return new t.UInt64(e.top^o.top^r.top,e.bot^o.bot^r.bot)},n.theta1=function(i){var e=n.S(19,i),o=n.S(61,i),r=n.R(6,i);return new t.UInt64(e.top^o.top^r.top,e.bot^o.bot^r.bot)},n.len=48,n.H=[new t.UInt64(3418070365,3238371032),new t.UInt64(1654270250,914150663),new t.UInt64(2438529370,812702999),new t.UInt64(355462360,4144912697),new t.UInt64(1731405415,4290775857),new t.UInt64(2394180231,1750603025),new t.UInt64(3675008525,1694076839),new t.UInt64(1203062813,3204075428)],n.HK=[new t.UInt64(1116352408,3609767458),new t.UInt64(1899447441,602891725),new t.UInt64(3049323471,3964484399),new t.UInt64(3921009573,2173295548),new t.UInt64(961987163,4081628472),new t.UInt64(1508970993,3053834265),new t.UInt64(2453635748,2937671579),new t.UInt64(2870763221,3664609560),new t.UInt64(3624381080,2734883394),new t.UInt64(310598401,1164996542),new t.UInt64(607225278,1323610764),new t.UInt64(1426881987,3590304994),new t.UInt64(1925078388,4068182383),new t.UInt64(2162078206,991336113),new t.UInt64(2614888103,633803317),new t.UInt64(3248222580,3479774868),new t.UInt64(3835390401,2666613458),new t.UInt64(4022224774,944711139),new t.UInt64(264347078,2341262773),new t.UInt64(604807628,2007800933),new t.UInt64(770255983,1495990901),new t.UInt64(1249150122,1856431235),new t.UInt64(1555081692,3175218132),new t.UInt64(1996064986,2198950837),new t.UInt64(2554220882,3999719339),new t.UInt64(2821834349,766784016),new t.UInt64(2952996808,2566594879),new t.UInt64(3210313671,3203337956),new t.UInt64(3336571891,1034457026),new t.UInt64(3584528711,2466948901),new t.UInt64(113926993,3758326383),new t.UInt64(338241895,168717936),new t.UInt64(666307205,1188179964),new t.UInt64(773529912,1546045734),new t.UInt64(1294757372,1522805485),new t.UInt64(1396182291,2643833823),new t.UInt64(1695183700,2343527390),new t.UInt64(1986661051,1014477480),new t.UInt64(2177026350,1206759142),new t.UInt64(2456956037,344077627),new t.UInt64(2730485921,1290863460),new t.UInt64(2820302411,3158454273),new t.UInt64(3259730800,3505952657),new t.UInt64(3345764771,106217008),new t.UInt64(3516065817,3606008344),new t.UInt64(3600352804,1432725776),new t.UInt64(4094571909,1467031594),new t.UInt64(275423344,851169720),new t.UInt64(430227734,3100823752),new t.UInt64(506948616,1363258195),new t.UInt64(659060556,3750685593),new t.UInt64(883997877,3785050280),new t.UInt64(958139571,3318307427),new t.UInt64(1322822218,3812723403),new t.UInt64(1537002063,2003034995),new t.UInt64(1747873779,3602036899),new t.UInt64(1955562222,1575990012),new t.UInt64(2024104815,1125592928),new t.UInt64(2227730452,2716904306),new t.UInt64(2361852424,442776044),new t.UInt64(2428436474,593698344),new t.UInt64(2756734187,3733110249),new t.UInt64(3204031479,2999351573),new t.UInt64(3329325298,3815920427),new t.UInt64(3391569614,3928383900),new t.UInt64(3515267271,566280711),new t.UInt64(3940187606,3454069534),new t.UInt64(4118630271,4000239992),new t.UInt64(116418474,1914138554),new t.UInt64(174292421,2731055270),new t.UInt64(289380356,3203993006),new t.UInt64(460393269,320620315),new t.UInt64(685471733,587496836),new t.UInt64(852142971,1086792851),new t.UInt64(1017036298,365543100),new t.UInt64(1126000580,2618297676),new t.UInt64(1288033470,3409855158),new t.UInt64(1501505948,4234509866),new t.UInt64(1607167915,987167468),new t.UInt64(1816402316,1246189591)],n}(h),h.HASH512=function(t){var n=function(){this.length=[],this.h=[],this.w=[],this.init()};return n.prototype={transform:function(){var t,i,e,o,r,s,h,c,u,a,f;for(f=16;f<80;f++)this.w[f]=n.theta1(this.w[f-2]).add(this.w[f-7]).add(n.theta0(this.w[f-15])).add(this.w[f-16]);for(t=this.h[0].copy(),i=this.h[1].copy(),e=this.h[2].copy(),o=this.h[3].copy(),r=this.h[4].copy(),s=this.h[5].copy(),h=this.h[6].copy(),c=this.h[7].copy(),f=0;f<80;f++)(u=c.copy()).add(n.Sig1(r)).add(n.Ch(r,s,h)).add(n.HK[f]).add(this.w[f]),(a=n.Sig0(t)).add(n.Maj(t,i,e)),c=h,h=s,s=r,(r=o.copy()).add(u),o=e,e=i,i=t,(t=u.copy()).add(a);this.h[0].add(t),this.h[1].add(i),this.h[2].add(e),this.h[3].add(o),this.h[4].add(r),this.h[5].add(s),this.h[6].add(h),this.h[7].add(c)},init:function(){var i;for(i=0;i<80;i++)this.w[i]=new t.UInt64(0,0);this.length[0]=new t.UInt64(0,0),this.length[1]=new t.UInt64(0,0),this.h[0]=n.H[0].copy(),this.h[1]=n.H[1].copy(),this.h[2]=n.H[2].copy(),this.h[3]=n.H[3].copy(),this.h[4]=n.H[4].copy(),this.h[5]=n.H[5].copy(),this.h[6]=n.H[6].copy(),this.h[7]=n.H[7].copy()},process:function(n){var i,e;i=(this.length[0].bot>>>6)%16,this.w[i].shlb(),this.w[i].bot|=255&n,e=new t.UInt64(0,8),this.length[0].add(e),0===this.length[0].top&&0==this.length[0].bot&&(e=new t.UInt64(0,1),this.length[1].add(e)),this.length[0].bot%1024==0&&this.transform()},process_array:function(t){for(var n=0;n<t.length;n++)this.process(t[n])},process_num:function(t){this.process(t>>24&255),this.process(t>>16&255),this.process(t>>8&255),this.process(255&t)},hash:function(){var t,i,e,o=[];for(t=this.length[0].copy(),i=this.length[1].copy(),this.process(128);this.length[0].bot%1024!=896;)this.process(0);for(this.w[14]=i,this.w[15]=t,this.transform(),e=0;e<n.len;e++)o[e]=255&n.R(8*(7-e%8),this.h[e>>>3]).bot;return this.init(),o}},n.S=function(n,i){return 0==n?i:n<32?new t.UInt64(i.top>>>n|i.bot<<32-n,i.bot>>>n|i.top<<32-n):new t.UInt64(i.bot>>>n-32|i.top<<64-n,i.top>>>n-32|i.bot<<64-n)},n.R=function(n,i){return 0==n?i:n<32?new t.UInt64(i.top>>>n,i.bot>>>n|i.top<<32-n):new t.UInt64(0,i.top>>>n-32)},n.Ch=function(n,i,e){return new t.UInt64(n.top&i.top^~n.top&e.top,n.bot&i.bot^~n.bot&e.bot)},n.Maj=function(n,i,e){return new t.UInt64(n.top&i.top^n.top&e.top^i.top&e.top,n.bot&i.bot^n.bot&e.bot^i.bot&e.bot)},n.Sig0=function(i){var e=n.S(28,i),o=n.S(34,i),r=n.S(39,i);return new t.UInt64(e.top^o.top^r.top,e.bot^o.bot^r.bot)},n.Sig1=function(i){var e=n.S(14,i),o=n.S(18,i),r=n.S(41,i);return new t.UInt64(e.top^o.top^r.top,e.bot^o.bot^r.bot)},n.theta0=function(i){var e=n.S(1,i),o=n.S(8,i),r=n.R(7,i);return new t.UInt64(e.top^o.top^r.top,e.bot^o.bot^r.bot)},n.theta1=function(i){var e=n.S(19,i),o=n.S(61,i),r=n.R(6,i);return new t.UInt64(e.top^o.top^r.top,e.bot^o.bot^r.bot)},n.len=64,n.H=[new t.UInt64(1779033703,4089235720),new t.UInt64(3144134277,2227873595),new t.UInt64(1013904242,4271175723),new t.UInt64(2773480762,1595750129),new t.UInt64(1359893119,2917565137),new t.UInt64(2600822924,725511199),new t.UInt64(528734635,4215389547),new t.UInt64(1541459225,327033209)],n.HK=[new t.UInt64(1116352408,3609767458),new t.UInt64(1899447441,602891725),new t.UInt64(3049323471,3964484399),new t.UInt64(3921009573,2173295548),new t.UInt64(961987163,4081628472),new t.UInt64(1508970993,3053834265),new t.UInt64(2453635748,2937671579),new t.UInt64(2870763221,3664609560),new t.UInt64(3624381080,2734883394),new t.UInt64(310598401,1164996542),new t.UInt64(607225278,1323610764),new t.UInt64(1426881987,3590304994),new t.UInt64(1925078388,4068182383),new t.UInt64(2162078206,991336113),new t.UInt64(2614888103,633803317),new t.UInt64(3248222580,3479774868),new t.UInt64(3835390401,2666613458),new t.UInt64(4022224774,944711139),new t.UInt64(264347078,2341262773),new t.UInt64(604807628,2007800933),new t.UInt64(770255983,1495990901),new t.UInt64(1249150122,1856431235),new t.UInt64(1555081692,3175218132),new t.UInt64(1996064986,2198950837),new t.UInt64(2554220882,3999719339),new t.UInt64(2821834349,766784016),new t.UInt64(2952996808,2566594879),new t.UInt64(3210313671,3203337956),new t.UInt64(3336571891,1034457026),new t.UInt64(3584528711,2466948901),new t.UInt64(113926993,3758326383),new t.UInt64(338241895,168717936),new t.UInt64(666307205,1188179964),new t.UInt64(773529912,1546045734),new t.UInt64(1294757372,1522805485),new t.UInt64(1396182291,2643833823),new t.UInt64(1695183700,2343527390),new t.UInt64(1986661051,1014477480),new t.UInt64(2177026350,1206759142),new t.UInt64(2456956037,344077627),new t.UInt64(2730485921,1290863460),new t.UInt64(2820302411,3158454273),new t.UInt64(3259730800,3505952657),new t.UInt64(3345764771,106217008),new t.UInt64(3516065817,3606008344),new t.UInt64(3600352804,1432725776),new t.UInt64(4094571909,1467031594),new t.UInt64(275423344,851169720),new t.UInt64(430227734,3100823752),new t.UInt64(506948616,1363258195),new t.UInt64(659060556,3750685593),new t.UInt64(883997877,3785050280),new t.UInt64(958139571,3318307427),new t.UInt64(1322822218,3812723403),new t.UInt64(1537002063,2003034995),new t.UInt64(1747873779,3602036899),new t.UInt64(1955562222,1575990012),new t.UInt64(2024104815,1125592928),new t.UInt64(2227730452,2716904306),new t.UInt64(2361852424,442776044),new t.UInt64(2428436474,593698344),new t.UInt64(2756734187,3733110249),new t.UInt64(3204031479,2999351573),new t.UInt64(3329325298,3815920427),new t.UInt64(3391569614,3928383900),new t.UInt64(3515267271,566280711),new t.UInt64(3940187606,3454069534),new t.UInt64(4118630271,4000239992),new t.UInt64(116418474,1914138554),new t.UInt64(174292421,2731055270),new t.UInt64(289380356,3203993006),new t.UInt64(460393269,320620315),new t.UInt64(685471733,587496836),new t.UInt64(852142971,1086792851),new t.UInt64(1017036298,365543100),new t.UInt64(1126000580,2618297676),new t.UInt64(1288033470,3409855158),new t.UInt64(1501505948,4234509866),new t.UInt64(1607167915,987167468),new t.UInt64(1816402316,1246189591)],n}(h),h.SHA3=function(t){var n=function(t){this.length=0,this.rate=0,this.len=0,this.S=[],this.init(t)};return n.prototype={transform:function(){var i,e,o,r=[],s=[],h=[];for(o=0;o<n.ROUNDS;o++){for(r[0]=new t.UInt64(this.S[0][0].top^this.S[0][1].top^this.S[0][2].top^this.S[0][3].top^this.S[0][4].top,this.S[0][0].bot^this.S[0][1].bot^this.S[0][2].bot^this.S[0][3].bot^this.S[0][4].bot),r[1]=new t.UInt64(this.S[1][0].top^this.S[1][1].top^this.S[1][2].top^this.S[1][3].top^this.S[1][4].top,this.S[1][0].bot^this.S[1][1].bot^this.S[1][2].bot^this.S[1][3].bot^this.S[1][4].bot),r[2]=new t.UInt64(this.S[2][0].top^this.S[2][1].top^this.S[2][2].top^this.S[2][3].top^this.S[2][4].top,this.S[2][0].bot^this.S[2][1].bot^this.S[2][2].bot^this.S[2][3].bot^this.S[2][4].bot),r[3]=new t.UInt64(this.S[3][0].top^this.S[3][1].top^this.S[3][2].top^this.S[3][3].top^this.S[3][4].top,this.S[3][0].bot^this.S[3][1].bot^this.S[3][2].bot^this.S[3][3].bot^this.S[3][4].bot),r[4]=new t.UInt64(this.S[4][0].top^this.S[4][1].top^this.S[4][2].top^this.S[4][3].top^this.S[4][4].top,this.S[4][0].bot^this.S[4][1].bot^this.S[4][2].bot^this.S[4][3].bot^this.S[4][4].bot),s[0]=n.xor(r[4],n.rotl(r[1],1)),s[1]=n.xor(r[0],n.rotl(r[2],1)),s[2]=n.xor(r[1],n.rotl(r[3],1)),s[3]=n.xor(r[2],n.rotl(r[4],1)),s[4]=n.xor(r[3],n.rotl(r[0],1)),i=0;i<5;i++)for(h[i]=[],e=0;e<5;e++)h[i][e]=new t.UInt64(0,0),this.S[i][e]=n.xor(this.S[i][e],s[i]);for(h[0][0]=this.S[0][0].copy(),h[1][3]=n.rotl(this.S[0][1],36),h[2][1]=n.rotl(this.S[0][2],3),h[3][4]=n.rotl(this.S[0][3],41),h[4][2]=n.rotl(this.S[0][4],18),h[0][2]=n.rotl(this.S[1][0],1),h[1][0]=n.rotl(this.S[1][1],44),h[2][3]=n.rotl(this.S[1][2],10),h[3][1]=n.rotl(this.S[1][3],45),h[4][4]=n.rotl(this.S[1][4],2),h[0][4]=n.rotl(this.S[2][0],62),h[1][2]=n.rotl(this.S[2][1],6),h[2][0]=n.rotl(this.S[2][2],43),h[3][3]=n.rotl(this.S[2][3],15),h[4][1]=n.rotl(this.S[2][4],61),h[0][1]=n.rotl(this.S[3][0],28),h[1][4]=n.rotl(this.S[3][1],55),h[2][2]=n.rotl(this.S[3][2],25),h[3][0]=n.rotl(this.S[3][3],21),h[4][3]=n.rotl(this.S[3][4],56),h[0][3]=n.rotl(this.S[4][0],27),h[1][1]=n.rotl(this.S[4][1],20),h[2][4]=n.rotl(this.S[4][2],39),h[3][2]=n.rotl(this.S[4][3],8),h[4][0]=n.rotl(this.S[4][4],14),i=0;i<5;i++)for(e=0;e<5;e++)this.S[i][e]=n.xor(h[i][e],n.and(n.not(h[(i+1)%5][e]),h[(i+2)%5][e]));this.S[0][0]=n.xor(this.S[0][0],n.RC[o])}},init:function(n){var i,e;for(i=0;i<5;i++)for(this.S[i]=[],e=0;e<5;e++)this.S[i][e]=new t.UInt64(0,0);this.length=0,this.len=n,this.rate=200-2*n},process:function(i){var e,o,r,s,h,c;for(s=(h=this.length%this.rate)%8,e=(h>>=3)%5,o=Math.floor(h/5),c=new t.UInt64(0,i),r=0;r<s;r++)c.shlb();this.S[e][o]=n.xor(this.S[e][o],c),this.length++,this.length%this.rate==0&&this.transform()},squeeze:function(t,i){var e,o,r,s,h,c=0;for(e=!1;;){for(r=0;r<5;r++){for(o=0;o<5;o++){for(h=this.S[o][r].copy(),s=0;s<8;s++){if(t[c++]=255&h.bot,c>=i||c%this.rate==0){e=!0;break}h=n.rotl(h,56)}if(e)break}if(e)break}if(c>=i)break;e=!1,this.transform()}},hash:function(t){if(1==this.rate-this.length%this.rate)this.process(134);else{for(this.process(6);this.length%this.rate!=this.rate-1;)this.process(0);this.process(128)}this.squeeze(t,this.len)},shake:function(t,n){if(1==this.rate-this.length%this.rate)this.process(159);else{for(this.process(31);this.length%this.rate!=this.rate-1;)this.process(0);this.process(128)}this.squeeze(t,n)}},n.rotl=function(n,i){return 0==i?n:i<32?new t.UInt64(n.top<<i|n.bot>>>32-i,n.bot<<i|n.top>>>32-i):new t.UInt64(n.bot<<i-32|n.top>>>64-i,n.top<<i-32|n.bot>>>64-i)},n.xor=function(n,i){return new t.UInt64(n.top^i.top,n.bot^i.bot)},n.and=function(n,i){return new t.UInt64(n.top&i.top,n.bot&i.bot)},n.not=function(n){return new t.UInt64(~n.top,~n.bot)},n.ROUNDS=24,n.HASH224=28,n.HASH256=32,n.HASH384=48,n.HASH512=64,n.SHAKE128=16,n.SHAKE256=32,n.RC=[new t.UInt64(0,1),new t.UInt64(0,32898),new t.UInt64(2147483648,32906),new t.UInt64(2147483648,2147516416),new t.UInt64(0,32907),new t.UInt64(0,2147483649),new t.UInt64(2147483648,2147516545),new t.UInt64(2147483648,32777),new t.UInt64(0,138),new t.UInt64(0,136),new t.UInt64(0,2147516425),new t.UInt64(0,2147483658),new t.UInt64(0,2147516555),new t.UInt64(2147483648,139),new t.UInt64(2147483648,32905),new t.UInt64(2147483648,32771),new t.UInt64(2147483648,32770),new t.UInt64(2147483648,128),new t.UInt64(0,32778),new t.UInt64(2147483648,2147483658),new t.UInt64(2147483648,2147516545),new t.UInt64(2147483648,32896),new t.UInt64(0,2147483649),new t.UInt64(2147483648,2147516424)],n}(h),h.RAND=function(t){var n=function(){this.ira=[],this.rndptr=0,this.borrow=0,this.pool_ptr=0,this.pool=[],this.clean()};return n.prototype={NK:21,NJ:6,NV:8,clean:function(){var t;for(t=0;t<32;t++)this.pool[t]=0;for(t=0;t<this.NK;t++)this.ira[t]=0;this.rndptr=0,this.borrow=0,this.pool_ptr=0},sbrand:function(){var t,n,i,e;if(this.rndptr++,this.rndptr<this.NK)return this.ira[this.rndptr];for(this.rndptr=0,t=0,n=this.NK-this.NJ;t<this.NK;t++,n++)n==this.NK&&(n=0),i=(e=this.ira[n]>>>0)-this.ira[t]-this.borrow|0,(i>>>=0)<e&&(this.borrow=0),i>e&&(this.borrow=1),this.ira[t]=0|i;return this.ira[0]},sirand:function(t){var n,i,e,o=1;for(this.borrow=0,this.rndptr=0,t>>>=0,this.ira[0]^=t,n=1;n<this.NK;n++)i=this.NV*n%this.NK,this.ira[i]^=o,e=o,o=t-o|0,t=e;for(n=0;n<1e4;n++)this.sbrand()},fill_pool:function(){var n,i=new t.HASH256;for(n=0;n<128;n++)i.process(this.sbrand());this.pool=i.hash(),this.pool_ptr=0},seed:function(i,e){var o,r=new t.HASH256,s=[],h=[];for(this.pool_ptr=0,o=0;o<this.NK;o++)this.ira[o]=0;if(i>0){for(o=0;o<i;o++)r.process(e[o]);for(s=r.hash(),o=0;o<8;o++)h[0]=s[4*o],h[1]=s[4*o+1],h[2]=s[4*o+2],h[3]=s[4*o+3],this.sirand(n.pack(h))}this.fill_pool()},getByte:function(){var t=this.pool[this.pool_ptr++];return this.pool_ptr>=32&&this.fill_pool(),255&t}},n.pack=function(t){return(255&t[3])<<24|(255&t[2])<<16|(255&t[1])<<8|255&t[0]},n}(h),h.NHS=function(t){var n={round:function(t,n){return Math.floor((t+(n>>1))/n)},nabs:function(t){var n=t>>31;return t+n^n},redc:function(t){return(((67108863&t)*n.ND&67108863)*n.PRIME+t)*n.MODINV},nres:function(t){return n.redc(t*n.R2MODP)},modmul:function(t,i){return n.redc(t*i)},ntt:function(t){var i,e,o,r,s,h,c,u=n.DEGREE/2,a=n.PRIME;for(o=0;o<n.DEGREE;o++)t[o]=n.nres(t[o]);for(i=1;i<n.DEGREE;){for(r=0,e=0;e<i;e++){for(s=n.roots[i+e],o=r;o<r+u;o++)h=t[o],c=n.modmul(t[o+u],s),t[o]=h+c,t[o+u]=h+2*a-c;r+=2*u}u/=2,i*=2}},intt:function(t){var i,e,o,r,s,h,c,u,a=n.PRIME,f=1;for(i=n.DEGREE/2;i>1;){for(r=0,e=0;e<i;e++){for(s=n.iroots[i+e],o=r;o<r+f;o++)h=t[o],c=t[o+f],t[o]=h+c,u=h+n.DEGREE*a-c,t[o+f]=n.modmul(u,s);r+=2*f}f*=2,i/=2}for(f=n.DEGREE/2,o=0;o<f;o++)h=t[o],c=t[o+f],u=h+n.DEGREE*a-c,t[o+f]=n.modmul(u,n.invpr),t[o]=n.modmul(h+c,n.inv);for(o=0;o<n.DEGREE;o++)t[o]=n.redc(t[o]),t[o]-=a,t[o]+=t[o]>>n.WL-1&a},Encode:function(t,i){var e,o,r,s,h,c;for(c=n.PRIME/2,e=o=0;e<256;)for(h=t[o++],s=0;s<8;s++)r=1&h,i[e]=r*c,i[e+256]=r*c,i[e+512]=r*c,i[e+768]=r*c,h>>=1,e++},Decode:function(t,i){var e,o,r,s,h=n.PRIME/2;for(e=0;e<32;e++)i[e]=0;for(e=o=0;e<256;){for(r=0;r<8;r++)s=(s=n.nabs(t[e]-h)+n.nabs(t[e+256]-h)+n.nabs(t[e+512]-h)+n.nabs(t[e+768]-h)-n.PRIME)>>31&1,i[o]=((255&i[o])>>1)+(s<<7),e++;o++}},Parse:function(i,e){var o,r,s,h=new t.SHA3(t.SHA3.SHAKE128),c=[];for(o=0;o<32;o++)h.process(i[o]);for(h.shake(c,4*n.DEGREE),o=r=0;o<n.DEGREE;o++)s=127&c[r],s<<=8,s+=255&c[r+1],s<<=8,s+=255&c[r+2],s<<=8,s+=255&c[r+3],r+=4,e[o]=n.nres(s)},pack:function(t,i){var e,o,r,s,h,c;for(e=o=0;e<n.DEGREE;)r=t[e++],s=t[e++],h=t[e++],c=t[e++],i[o++]=255&r,i[o++]=255&(r>>8|s<<6),i[o++]=s>>2&255,i[o++]=255&(s>>10|h<<4),i[o++]=h>>4&255,i[o++]=255&(h>>12|c<<2),i[o++]=c>>6},unpack:function(t,i){var e,o,r,s,h,c,u,a,f;for(e=o=0;e<n.DEGREE;)r=255&t[o++],s=255&t[o++],h=255&t[o++],c=255&t[o++],u=255&t[o++],a=255&t[o++],f=255&t[o++],i[e++]=r|(63&s)<<8,i[e++]=s>>6|h<<2|(15&c)<<10,i[e++]=c>>4|u<<4|(3&a)<<12,i[e++]=a>>2|f<<6},Compress:function(t,i){var e,o,r,s=0;for(e=o=0;e<n.DEGREE;){for(r=0;r<8;r++)s=(s<<3)+(7&n.round(8*t[e],n.PRIME)),e++;i[o]=255&s,i[o+1]=s>>>8&255,i[o+2]=s>>>16&255,o+=3,s=0}},Decompress:function(t,i){var e,o,r,s,h=0;for(e=o=0;e<n.DEGREE;)for(h=((h=((h=255&t[o+2])<<8)+(255&t[o+1]))<<8)+(255&t[o]),o+=3,r=0;r<8;r++)s=(14680064&h)>>>21,h<<=3,i[e]=n.round(s*n.PRIME,8),e++},Error:function(t,i){var e,o,r,s,h;for(s=0;s<n.DEGREE;s++){for(e=t.getByte()+(t.getByte()<<8),o=t.getByte()+(t.getByte()<<8),r=0,h=0;h<16;h++)r+=(1&e)-(1&o),e>>=1,o>>=1;i[s]=r+n.PRIME}},redc_it:function(t){var i;for(i=0;i<n.DEGREE;i++)t[i]=n.redc(t[i])},nres_it:function(t){var i;for(i=0;i<n.DEGREE;i++)t[i]=n.nres(t[i])},poly_mul:function(t,i,e){var o;for(o=0;o<n.DEGREE;o++)t[o]=n.modmul(i[o],e[o])},poly_add:function(t,i,e){var o;for(o=0;o<n.DEGREE;o++)t[o]=i[o]+e[o]},poly_sub:function(t,i,e){var o;for(o=0;o<n.DEGREE;o++)t[o]=i[o]+n.PRIME-e[o]},poly_soft_reduce:function(t){var i,e;for(i=0;i<n.DEGREE;i++)e=t[i]-n.PRIME,t[i]=e+(e>>n.WL-1&n.PRIME)},poly_hard_reduce:function(t){var i,e;for(i=0;i<n.DEGREE;i++)e=n.modmul(t[i],n.ONE),e-=n.PRIME,t[i]=e+(e>>n.WL-1&n.PRIME)},bytestostring:function(t){var n,i,e="",o=t.length;for(i=0;i<o;i++)e+=((n=t[i])>>>4&15).toString(16),e+=(15&n).toString(16);return e},SERVER_1:function(t,i,e){var o,r=new Uint8Array(32),s=new Uint8Array(1792),h=new Int32Array(n.DEGREE),c=new Int32Array(n.DEGREE),u=new Int32Array(n.DEGREE);for(o=0;o<32;o++)r[o]=t.getByte();for(n.Parse(r,u),n.Error(t,c),n.Error(t,h),n.ntt(h),n.ntt(c),n.poly_mul(u,u,h),n.poly_add(u,u,c),n.poly_hard_reduce(u),n.redc_it(u),n.pack(u,s),o=0;o<32;o++)i[o]=r[o];for(o=0;o<1792;o++)i[o+32]=s[o];for(n.poly_hard_reduce(h),n.pack(h,s),o=0;o<1792;o++)e[o]=s[o]},CLIENT:function(i,e,o,r){var s,h=new t.SHA3(t.SHA3.HASH256),c=new Uint8Array(32),u=new Uint8Array(1792),a=new Uint8Array(32),f=new Uint8Array(384),E=new Int32Array(n.DEGREE),B=new Int32Array(n.DEGREE),y=new Int32Array(n.DEGREE),I=new Int32Array(n.DEGREE),p=new Int32Array(n.DEGREE);for(n.Error(i,E),n.Error(i,B),n.ntt(E),n.ntt(B),s=0;s<32;s++)c[s]=e[s];for(s=0;s<1792;s++)u[s]=e[s+32];for(n.Parse(c,y),n.poly_mul(y,y,E),n.poly_add(y,y,B),n.poly_hard_reduce(y),s=0;s<32;s++)a[s]=i.getByte();for(s=0;s<32;s++)h.process(a[s]);for(h.hash(a),n.Encode(a,I),n.unpack(u,p),n.nres_it(p),n.poly_mul(p,p,E),n.intt(p),n.Error(i,B),n.poly_add(p,p,B),n.poly_add(p,p,I),n.Compress(p,f),h.init(t.SHA3.HASH256),s=0;s<32;s++)h.process(a[s]);for(h.hash(a),s=0;s<32;s++)r[s]=a[s];for(n.redc_it(y),n.pack(y,u),s=0;s<1792;s++)o[s]=u[s];for(s=0;s<384;s++)o[s+1792]=f[s]},SERVER_2:function(i,e,o){var r,s=new t.SHA3(t.SHA3.HASH256),h=new Int32Array(n.DEGREE),c=new Int32Array(n.DEGREE),u=new Int32Array(n.DEGREE),a=new Uint8Array(1792),f=new Uint8Array(32),E=new Uint8Array(384);for(r=0;r<1792;r++)a[r]=e[r];for(n.unpack(a,u),n.nres_it(u),r=0;r<384;r++)E[r]=e[r+1792];for(n.Decompress(E,h),r=0;r<1792;r++)a[r]=i[r];for(n.unpack(a,c),n.poly_mul(u,u,c),n.intt(u),n.poly_sub(u,h,u),n.poly_soft_reduce(u),n.Decode(u,f),r=0;r<32;r++)s.process(f[r]);for(s.hash(f),r=0;r<32;r++)o[r]=f[r]},PRIME:12289,LGN:10,ND:50343935,ONE:10924,R2MODP:7586};return n.MODINV=Math.pow(2,-26),n.DEGREE=1024,n.WL=26,n.inv=4091,n.invpr=4401,n.roots=[10924,3439,7271,11355,11709,9879,10742,2259,7036,2539,8427,9802,10192,4635,1420,1239,6050,10731,7026,5040,6577,5505,10953,9704,9373,11614,867,8052,8079,8356,11442,11524,5127,11769,941,9207,6770,2705,895,3507,8981,1510,2703,8477,3501,7979,11817,9904,8201,12253,10369,921,1414,10113,10933,2417,9035,7667,7466,5597,6765,10100,2047,7870,560,7412,6155,2904,6540,11072,4731,7581,4991,4e3,324,75,12204,2825,7295,437,3820,3160,4680,9276,4234,5304,233,11774,251,9730,10988,7095,4248,9176,1923,6931,8295,8406,5916,4,1634,4247,9401,7069,10180,10094,1727,1879,11798,1138,7441,5705,10500,3796,1733,5294,12024,10976,11900,10037,4486,1266,6075,10623,7623,6885,10819,11266,3798,11120,7291,6353,8366,1709,9220,4410,8350,795,5533,1167,3593,7090,5367,901,452,7387,8918,8664,12,6830,11982,11649,3414,1473,4826,2255,5637,7108,6327,6585,8638,4958,10454,10385,8712,6113,10609,2342,8475,255,1311,2693,225,11317,9605,289,3623,11876,10744,11590,3250,10538,829,2809,2950,11834,8504,6520,8996,3903,11536,7677,5059,1740,6777,4641,9487,2765,4095,1972,1616,6291,3717,8029,4828,11586,3470,4672,4226,4847,4534,4008,2831,3500,6428,4674,490,341,9994,2541,11867,9688,8748,2025,8115,4268,10521,9604,3043,9466,9197,1560,11648,1786,5134,1416,853,4180,9924,7759,5761,8047,7251,4068,2763,5760,12264,108,5722,4283,11321,6148,4502,2180,9762,1577,6849,8754,12187,3390,8447,4800,10220,90,672,1521,7386,1027,7848,5913,8135,11555,1514,9681,182,1180,2759,11676,8270,8514,4584,3792,5616,1300,2623,3907,7653,11671,5443,11387,9242,8739,12216,9655,6988,12086,9954,256,9557,9836,11792,10012,1450,6025,8601,10525,4232,8262,7841,3977,7290,7832,311,7013,9453,3895,11971,3340,1991,4671,2862,6807,6659,7117,946,1812,10617,2799,11068,11665,3587,3675,8124,3246,1074,9124,2845,7372,8118,12120,10842,1827,11417,11632,10,9788,9985,3563,11528,7220,8204,7816,918,6357,7237,196,6332,11479,5956,2289,7260,3046,10889,6048,519,6606,8228,9187,10651,1669,11183,1337,11593,9397,5517,253,10901,589,2739,4389,4857,5562,1704,11318,1767,4164,878,4072,4397,10007,9376,7177,3613,2088,759,8027,4011,3318,4914,7282,9859,5582,6867,6710,588,2867,9535,5507,7529,10732,2983,12183,5855,4200,2798,3151,5436,9451,8397,5016,9062,4601,3703,4157,9738,206,2794,9067,11025,1528,3663,1872,5481,4341,10318,2616,11782,224,3754,2462,9371,2283,11159,12255,10689,6912,12259,7503,2111,11526,270,6207,10170,306,4031,10605,5450,1034,10087,173,3081,2420,10273,7726,10450,4012,964,12057,3540,11743,7747,7824,11721,4420,10435,1619,3900,7730,10826,913,4387,219,11680,3614,1639,9141,8249,2706,5458,1491,5786,7939,4930,8196,7005,11521,11931,1055,11207,2708,208,11882,11064,5292,10020,954,1724,6316,11685,8508,11356,3539,2734,11784,1741,5751,8229,7708,1460,3524,96,5484,9833,7169,9899,7867,9940,8673,5483,1383,26,10702,9172,1668,2937,6483,4166,7564,6069,7208,7397,9336,6360,6934,11311,8649,6587,3004,10523,6646,6265,12260,1422,10570,6632,10183,12218,6697,8985,7883,8251,12037,11138,6447,9898,9346,2797,4630,1800,4513,3106,2312,10488,9255,2040,5934,3920,2728,6218,8039,8913,3770,8539,3911,10359,3422,2268,525,11694,7486,1909,3059,2162,9831,8182,3487,5060,261,1631,8684,1757,6665,3182,509,5158,2787,1172,11650,8909,9686,4545,28,11438,5151,4362,327,9815,9213,12089,864,8852,7966,2931,3068,12055,1994,12131,191,10434,3098,9566,8814,6824,8862,5658,627,4205,11328,1999,5128,2008,4106,1881,7604,9406,11963,3095,6292,9294,5565,1864,8169,573,474,702,6307,3164,2553,981,11492,84,10943,10140,7809,11609,10311,9204,3496,2592,600,7422,9228,11310,10128,11733,11250,11828,5924,529,4105,10169,1785,9177,6562,1575,5485,5790,2023,783,9398,1474,7396,10461,32,5803,7374,8361,9104,10372,8773,1527,2743,7018,4583,10835,12180,10572,7909,4964,7066,4087,1515,11312,7170,1441,7047,9218,7368,12001,8126,5004,9351,7160,3478,7528,12211,8129,8140,3430,2387,8513,5498,9335,6371,12080,1886,7649,5298,12202,5783,9012,4817,2934,10920,7802,213,11360,9912,5971,4682,8023,5157,3460,7173,1601,3898,7052,3453,12114,756,3187,5403,5513,6169,6936,2971,6889,11039,11076,12122,11575,11441,9973,9022,10095,630,4704,10647,2546,7189,5780,4524,7789,7151,10598,6322,1274,8260,7024,7998,8734,10442,7510,1966,2445,9100,6072,2771,4415,7963,1234,5975,3249,12017,11778,6140,12049,10868,8233,1792,5454,7407,8810,8639,10150,5308,11051,12230,5046,8678,5731,3261,1874,5668,2177,12224,4726,2687,10063,11091,1648,8119,7745,10782,9746,663,6622,395,585,7304,3742,7921,531,1147,7712,10433,7518,2423,7626,2448,7670,11106,2160,500,6185,7690,70,7071,8450,363,6962,1384,8272,5556,6426,7632,1503,1372,7457,6619,4825,3734,1664,9033,2489,5469,3633,9375,8440,2864,823,11683,4547,9359,7417,4334,1752,1771,2573,4123,6884,6145,9421,2067,11928,5492,80,4570,6146,3926,6201,8604,4187,1083,713,2327,5313,7033,3499,10937,9820,1818,7568,2207,11202,10103,4116,7780,5300,1682,3547,1390,8592,11547,4118,4822,7297,9768,1185,4712,9623,10534,1989,7629,1343,4521,6721,1442,7269,2024,3441,10696,1063,815,1500,5809,10781,6023,8740,1568,1700,4945,4152,3692,4379,12051,1089,11517,12079,3365,2488,6948,1890,6582,9745,2142,3639,501,1283,7238,9164,1211,9278,4651,10466,4926,11705,3506,6748,10665,202,8467,5073,5612,8313,6362,11600,11333,2722,4954,2048,6391,6131,1533,8026,720,11473,2542,8587,6653,1339,10437,3635,6417,9932,8216,12168,6913,9783,7385,4715,6667,1456,9440,3714,177,8695,6678,12068,7345,8061,10400,5758,195],n.iroots=[10924,8850,934,5018,10030,1547,2410,580,11050,10869,7654,2097,2487,3862,9750,5253,765,847,3933,4210,4237,11422,675,2916,2585,1336,6784,5712,7249,5263,1558,6239,4419,10242,2189,5524,6692,4823,4622,3254,9872,1356,2176,10875,11368,1920,36,4088,2385,472,4310,8788,3812,9586,10779,3308,8782,11394,9584,5519,3082,11348,520,7162,1023,1470,5404,4666,1666,6214,11023,7803,2252,389,1313,265,6995,10556,8493,1789,6584,4848,11151,491,10410,10562,2195,2109,5220,2888,8042,10655,12285,6373,3883,3994,5358,10366,3113,8041,5194,1301,2559,12038,515,12056,6985,8055,3013,7609,9129,8469,11852,4994,9464,85,12214,11965,8289,7298,4708,7558,1217,5749,9385,6134,4877,11729,10712,2527,10109,7787,6141,968,8006,6567,12181,25,6529,9526,8221,5038,4242,6528,4530,2365,8109,11436,10873,7155,10503,641,10729,3092,2823,9246,2685,1768,8021,4174,10264,3541,2601,422,9748,2295,11948,11799,7615,5861,8789,9458,8281,7755,7442,8063,7617,8819,703,7461,4260,8572,5998,10673,10317,8194,9524,2802,7648,5512,10549,7230,4612,753,8386,3293,5769,3785,455,9339,9480,11460,1751,9039,699,1545,413,8666,12e3,2684,972,12064,9596,10978,12034,3814,9947,1680,6176,3577,1904,1835,7331,3651,5704,5962,5181,6652,10034,7463,10816,8875,640,307,5459,12277,3625,3371,4902,11837,11388,6922,5199,8696,11122,6756,11494,3939,7879,3069,10580,3923,5936,4998,1169,8491,8750,933,3781,604,5973,10565,11335,2269,6997,1225,407,12081,9581,1082,11234,358,768,5284,4093,7359,4350,6503,10798,6831,9583,4040,3148,10650,8675,609,12070,7902,11376,1463,4559,8389,10670,1854,7869,568,4465,4542,546,8749,232,11325,8277,1839,4563,2016,9869,9208,12116,2202,11255,6839,1684,8258,11983,2119,6082,12019,763,10178,4786,30,5377,1600,34,1130,10006,2918,9827,8535,12065,507,9673,1971,7948,6808,10417,8626,10761,1264,3222,9495,12083,2551,8132,8586,7688,3227,7273,3892,2838,6853,9138,9491,8089,6434,106,9306,1557,4760,6782,2754,9422,11701,5579,5422,6707,2430,5007,7375,8971,8278,4262,11530,10201,8676,5112,2913,2282,7892,8217,11411,8125,10522,971,10585,6727,7432,7900,9550,11700,1388,12036,6772,2892,696,10952,1106,10620,1638,3102,4061,5683,11770,6241,1400,9243,5029,1e4,6333,810,5957,12093,5052,5932,11371,4473,4085,5069,761,8726,2304,2501,12279,657,872,10462,1447,169,4171,4917,9444,3165,11215,9043,4165,8614,8702,624,1221,9490,1672,10477,11343,5172,5630,5482,9427,7618,10298,8949,318,8394,2836,5276,11978,4457,4999,8312,4448,4027,8057,1764,3688,6264,10839,2277,497,2453,2732,12033,2335,203,5301,2634,73,3550,3047,902,6846,618,4636,8382,9666,10989,6673,8497,7705,3775,4019,613,9530,11109,12107,2608,10775,734,4154,6376,4441,11262,4903,10768,11617,12199,2069,7489,3842,8899,102,3535,5440,12094,6531,1889,4228,4944,221,5611,3594,12112,8575,2849,10833,5622,7574,4904,2506,5376,121,4073,2357,5872,8654,1852,10950,5636,3702,9747,816,11569,4263,10756,6158,5898,10241,7335,9567,956,689,5927,3976,6677,7216,3822,12087,1624,5541,8783,584,7363,1823,7638,3011,11078,3125,5051,11006,11788,8650,10147,2544,5707,10399,5341,9801,8924,210,772,11200,238,7910,8597,8137,7344,10589,10721,3549,6266,1508,6480,10789,11474,11226,1593,8848,10265,5020,10847,5568,7768,10946,4660,10300,1755,2666,7577,11104,2521,4992,7467,8171,742,3697,10899,8742,10607,6989,4509,8173,2186,1087,10082,4721,10471,2469,1352,8790,5256,6976,9962,11576,11206,8102,3685,6088,8363,6143,7719,12209,6797,361,10222,2868,6144,5405,8166,9716,10518,10537,7955,4872,2930,7742,606,11466,9425,3849,2914,8656,6820,9800,3256,10625,8555,7464,5670,4832,10917,10786,4657,5863,6733,4017,10905,5327,11926,3839,5218,12219,4599,6104,11789,10129,1183,4619,9841,4663,9866,4771,1856,4577,11142,11758,4368,8547,4985,11704,11894,5667,11626,2543,1507,4544,4170,10641,1198,2226,9602,7563,65,10112,6621,10415,9028,6558,3611,7243,59,1238,6981,2139,3650,3479,4882,6835,10497,4056,1421,240,6149,511,272,9040,6314,11055,4326,7874,9518,6217,3189,9844,10323,4779,1847,3555,4291,5265,4029,11015,5967,1691,5138,4500,7765,6509,5100,9743,1642,7585,11659,2194,3267,2316,848,714,167,1213,1250,5400,9318,5353,6120,6776,6886,9102,11533,175,8836,5237,8391,10688,5116,8829,7132,4266,7607,6318,2377,929,12076,4487,1369,9355,7472,3277,6506,87,6991,4640,10403,209,5918,2954,6791,3776,9902,8859,4149,4160,78,4761,8811,5129,2938,7285,4163,288,4921,3071,5242,10848,5119,977,10774,8202,5223,7325,4380,1717,109,1454,7706,5271,9546,10762,3516,1917,3185,3928,4915,6486,12257,1828,4893,10815,2891,11506,10266,6499,6804,10714,5727,3112,10504,2120,8184,11760,6365,461,1039,556,2161,979,3061,4867,11689,9697,8793,3085,1978,680,4480,2149,1346,12205,797,11308,9736,9125,5982,11587,11815,11716,4120,10425,6724,2995,5997,9194,326,2883,4685,10408,8183,10281,7161,10290,961,8084,11662,6631,3427,5465,3475,2723,9191,1855,12098,158,10295,234,9221,9358,4323,3437,11425,200,3076,2474,11962,7927,7138,851,12261,7744,2603,3380,639,11117,9502,7131,11780,9107,5624,10532,3605,10658,12028,7229,8802,4107,2458,10127,9230,10380,4803,595,11764,10021,8867,1930,8378,3750,8519,3376,4250,6071,9561,8369,6355,10249,3034,1801,9977,9183,7776,10489,7659,9492,2943,2391,5842,1151,252,4038,4406,3304,5592,71,2106,5657,1719,10867,29,6024,5643,1766,9285,5702,3640,978,5355,5929,2953,4892,5081,6220,4725,8123,5806,9352,10621,3117,1587,12263,10906,6806,3616,2349,4422,2390,5120,2456,6805,12193,8765,10829,4581,4060,6538,10548,505,9555],n}(h),void 0!==r)return h.config=s[r],h.BIG=function(t){var n=function(t){switch(this.w=new Array(n.NLEN),typeof t){case"object":this.copy(t);break;case"number":this.zero(),this.w[0]=t;break;default:this.zero()}};return n.CHUNK=32,n.MODBYTES=t.config["@NB"],n.BASEBITS=t.config["@BASE"],n.NLEN=1+Math.floor((8*n.MODBYTES-1)/n.BASEBITS),n.DNLEN=2*n.NLEN,n.BMASK=(1<<n.BASEBITS)-1,n.BIGBITS=8*n.MODBYTES,n.NEXCESS=1<<n.CHUNK-n.BASEBITS-1,n.MODINV=Math.pow(2,-n.BASEBITS),n.prototype={zero:function(){var t;for(t=0;t<n.NLEN;t++)this.w[t]=0;return this},one:function(){var t;for(this.w[0]=1,t=1;t<n.NLEN;t++)this.w[t]=0;return this},get:function(t){return this.w[t]},set:function(t,n){this.w[t]=n},iszilch:function(){var t;for(t=0;t<n.NLEN;t++)if(0!==this.w[t])return!1;return!0},isunity:function(){var t;for(t=1;t<n.NLEN;t++)if(0!==this.w[t])return!1;return 1==this.w[0]},cswap:function(t,i){var e,o,r=i;for(r=~(r-1),o=0;o<n.NLEN;o++)e=r&(this.w[o]^t.w[o]),this.w[o]^=e,t.w[o]^=e},cmove:function(t,i){var e,o=i;for(o=~(o-1),e=0;e<n.NLEN;e++)this.w[e]^=(this.w[e]^t.w[e])&o},copy:function(t){var i;for(i=0;i<n.NLEN;i++)this.w[i]=t.w[i];return this},hcopy:function(t){var i;for(i=0;i<n.NLEN;i++)this.w[i]=t.w[i];return this},rcopy:function(t){var i;for(i=0;i<n.NLEN;i++)this.w[i]=t[i];return this},xortop:function(t){this.w[n.NLEN-1]^=t},ortop:function(t){this.w[n.NLEN-1]|=t},norm:function(){var t,i,e=0;for(i=0;i<n.NLEN-1;i++)t=this.w[i]+e,this.w[i]=t&n.BMASK,e=t>>n.BASEBITS;return this.w[n.NLEN-1]=this.w[n.NLEN-1]+e,this.w[n.NLEN-1]>>8*n.MODBYTES%n.BASEBITS},fshr:function(t){var i,e;for(i=this.w[0]&(1<<t)-1,e=0;e<n.NLEN-1;e++)this.w[e]=this.w[e]>>t|this.w[e+1]<<n.BASEBITS-t&n.BMASK;return this.w[n.NLEN-1]=this.w[n.NLEN-1]>>t,i},shr:function(t){var i,e=t%n.BASEBITS,o=Math.floor(t/n.BASEBITS);for(i=0;i<n.NLEN-o-1;i++)this.w[i]=this.w[o+i]>>e|this.w[o+i+1]<<n.BASEBITS-e&n.BMASK;for(this.w[n.NLEN-o-1]=this.w[n.NLEN-1]>>e,i=n.NLEN-o;i<n.NLEN;i++)this.w[i]=0;return this},fshl:function(t){var i;for(this.w[n.NLEN-1]=this.w[n.NLEN-1]<<t|this.w[n.NLEN-2]>>n.BASEBITS-t,i=n.NLEN-2;i>0;i--)this.w[i]=this.w[i]<<t&n.BMASK|this.w[i-1]>>n.BASEBITS-t;return this.w[0]=this.w[0]<<t&n.BMASK,this.w[n.NLEN-1]>>8*n.MODBYTES%n.BASEBITS},shl:function(t){var i,e=t%n.BASEBITS,o=Math.floor(t/n.BASEBITS);for(this.w[n.NLEN-1]=this.w[n.NLEN-1-o]<<e,n.NLEN>o+2&&(this.w[n.NLEN-1]|=this.w[n.NLEN-o-2]>>n.BASEBITS-e),i=n.NLEN-2;i>o;i--)this.w[i]=this.w[i-o]<<e&n.BMASK|this.w[i-o-1]>>n.BASEBITS-e;for(this.w[o]=this.w[0]<<e&n.BMASK,i=0;i<o;i++)this.w[i]=0;return this},nbits:function(){var t,i,e=n.NLEN-1;for(this.norm();e>=0&&0===this.w[e];)e--;if(e<0)return 0;for(t=n.BASEBITS*e,i=this.w[e];0!==i;)i=Math.floor(i/2),t++;return t},toString:function(){var t,i,e="",o=this.nbits();for(o%4==0?o=Math.floor(o/4):(o=Math.floor(o/4),o++),o<2*n.MODBYTES&&(o=2*n.MODBYTES),i=o-1;i>=0;i--)(t=new n(0)).copy(this),t.shr(4*i),e+=(15&t.w[0]).toString(16);return e},add:function(t){var i;for(i=0;i<n.NLEN;i++)this.w[i]+=t.w[i];return this},or:function(t){var i;for(i=0;i<n.NLEN;i++)this.w[i]|=t.w[i];return this},plus:function(t){var i,e=new n(0);for(i=0;i<n.NLEN;i++)e.w[i]=this.w[i]+t.w[i];return e},inc:function(t){return this.norm(),this.w[0]+=t,this},sub:function(t){var i;for(i=0;i<n.NLEN;i++)this.w[i]-=t.w[i];return this},rsub:function(t){var i;for(i=0;i<n.NLEN;i++)this.w[i]=t.w[i]-this.w[i];return this},dec:function(t){return this.norm(),this.w[0]-=t,this},minus:function(t){var i,e=new n(0);for(i=0;i<n.NLEN;i++)e.w[i]=this.w[i]-t.w[i];return e},imul:function(t){var i;for(i=0;i<n.NLEN;i++)this.w[i]*=t;return this},tobytearray:function(t,i){var e,o=new n(0);for(this.norm(),o.copy(this),e=n.MODBYTES-1;e>=0;e--)t[e+i]=255&o.w[0],o.fshr(8);return this},toBytes:function(t){this.tobytearray(t,0)},muladd:function(t,i,e,o){var r=t*i+e+this.w[o];return this.w[o]=r&n.BMASK,(r-this.w[o])*n.MODINV},pmul:function(t){var i,e,o=0;for(e=0;e<n.NLEN;e++)i=this.w[e],this.w[e]=0,o=this.muladd(i,t,o,e);return o},pxmul:function(i){var e,o=new t.DBIG(0),r=0;for(e=0;e<n.NLEN;e++)r=o.muladd(this.w[e],i,r,e);return o.w[n.NLEN]=r,o},div3:function(){var t,i,e,o=0;for(this.norm(),i=1<<n.BASEBITS,e=n.NLEN-1;e>=0;e--)t=o*i+this.w[e],this.w[e]=Math.floor(t/3),o=t%3;return o},mod2m:function(t){var i,e,o;for(e=Math.floor(t/n.BASEBITS),o=(1<<t%n.BASEBITS)-1,this.w[e]&=o,i=e+1;i<n.NLEN;i++)this.w[i]=0},invmod2m:function(){var t,i,e,o=new n(0),r=new n(0),s=new n(0);for(o.inc(n.invmod256(this.lastbits(8))),t=8;t<n.BIGBITS;t<<=1)o.norm(),r.copy(this),r.mod2m(t),(i=n.smul(o,r)).shr(t),s.copy(this),s.shr(t),s.mod2m(t),(e=n.smul(o,s)).mod2m(t),i.add(e),i.norm(),r=n.smul(i,o),i.copy(r),i.mod2m(t),e.one(),e.shl(t),i.rsub(e),i.norm(),i.shl(t),o.add(i);o.mod2m(n.BIGBITS),this.copy(o),this.norm()},mod:function(t){var i=0,e=new n(0);if(this.norm(),!(n.comp(this,t)<0)){do{t.fshl(1),i++}while(n.comp(this,t)>=0);for(;i>0;)t.fshr(1),e.copy(this),e.sub(t),e.norm(),this.cmove(e,1-(e.w[n.NLEN-1]>>n.CHUNK-1&1)),i--}},div:function(t){var i=0,e=0,o=new n(1),r=new n(0),s=new n(0);for(this.norm(),r.copy(this),this.zero();n.comp(r,t)>=0;)o.fshl(1),t.fshl(1),i++;for(;i>0;)t.fshr(1),o.fshr(1),s.copy(r),s.sub(t),s.norm(),e=1-(s.w[n.NLEN-1]>>n.CHUNK-1&1),r.cmove(s,e),s.copy(this),s.add(o),s.norm(),this.cmove(s,e),i--},parity:function(){return this.w[0]%2},bit:function(t){return(this.w[Math.floor(t/n.BASEBITS)]&1<<t%n.BASEBITS)>0?1:0},lastbits:function(t){var n=(1<<t)-1;return this.norm(),this.w[0]&n},isok:function(){var t,i=!0;for(t=0;t<n.NLEN;t++)this.w[t]>>n.BASEBITS&&(i=!1);return i},jacobi:function(t){var i,e,o=0,r=new n(0),s=new n(0),h=new n(0),c=new n(0),u=new n(1);if(0===t.parity()||0===n.comp(this,c)||n.comp(t,u)<=0)return 0;for(this.norm(),s.copy(this),h.copy(t),s.mod(t);n.comp(h,u)>0;){if(0===n.comp(s,c))return 0;for(i=h.lastbits(3),e=0;0===s.parity();)e++,s.shr(1);e%2==1&&(o+=(i*i-1)/8),o+=(i-1)*(s.lastbits(2)-1)/4,r.copy(h),r.mod(s),h.copy(s),s.copy(r),o%=2}return 0===o?1:-1},invmodp:function(t){var i=new n(0),e=new n(0),o=new n(1),r=new n(0),s=new n(0),h=new n(1);for(this.mod(t),i.copy(this),e.copy(t);0!==n.comp(i,h)&&0!==n.comp(e,h);){for(;0===i.parity();)i.fshr(1),0!==o.parity()&&(o.add(t),o.norm()),o.fshr(1);for(;0===e.parity();)e.fshr(1),0!==r.parity()&&(r.add(t),r.norm()),r.fshr(1);n.comp(i,e)>=0?(i.sub(e),i.norm(),n.comp(o,r)>=0?o.sub(r):(s.copy(t),s.sub(r),o.add(s)),o.norm()):(e.sub(i),e.norm(),n.comp(r,o)>=0?r.sub(o):(s.copy(t),s.sub(o),r.add(s)),r.norm())}0===n.comp(i,h)?this.copy(o):this.copy(r)},powmod:function(t,i){var e,o=new n(1),r=new n(0),s=new n(0);for(this.norm(),t.norm(),r.copy(t),s.copy(this);e=r.parity(),r.fshr(1),1==e&&(o=n.modmul(o,s,i)),!r.iszilch();)s=n.modsqr(s,i);return o}},n.frombytearray=function(t,i){var e,o=new n(0);for(e=0;e<n.MODBYTES;e++)o.fshl(8),o.w[0]+=255&t[e+i];return o},n.fromBytes=function(t){return n.frombytearray(t,0)},n.smul=function(t,i){var e,o,r,s=new n(0);for(o=0;o<n.NLEN;o++)for(e=0,r=0;r<n.NLEN;r++)o+r<n.NLEN&&(e=s.muladd(t.w[o],i.w[r],e,o+r));return s},n.comp=function(t,i){var e;for(e=n.NLEN-1;e>=0;e--)if(t.w[e]!=i.w[e])return t.w[e]>i.w[e]?1:-1;return 0},n.random=function(t){var i,e,o=new n(0),r=0,s=0;for(i=0;i<8*n.MODBYTES;i++)0===r?s=t.getByte():s>>=1,e=1&s,o.shl(1),o.w[0]+=e,r++,r&=7;return o},n.randomnum=function(n,i){var e,o,r=new t.DBIG(0),s=0,h=0;for(e=0;e<2*n.nbits();e++)0===s?h=i.getByte():h>>=1,o=1&h,r.shl(1),r.w[0]+=o,s++,s&=7;return r.mod(n)},n.mul=function(i,e){var o,r,s,h,c,u,a=new t.DBIG(0),f=[];for(h=0;h<n.NLEN;h++)f[h]=i.w[h]*e.w[h];for(s=r=f[0],a.w[0]=s,c=1;c<n.NLEN;c++){for(s=r+=f[c],h=c;h>=1+Math.floor(c/2);h--)s+=(i.w[h]-i.w[c-h])*(e.w[c-h]-e.w[h]);a.w[c]=s}for(c=n.NLEN;c<2*n.NLEN-1;c++){for(s=r-=f[c-n.NLEN],h=n.NLEN-1;h>=1+Math.floor(c/2);h--)s+=(i.w[h]-i.w[c-h])*(e.w[c-h]-e.w[h]);a.w[c]=s}for(u=0,h=0;h<n.DNLEN-1;h++)o=a.w[h]+u,a.w[h]=o&n.BMASK,u=(o-a.w[h])*n.MODINV;return a.w[n.DNLEN-1]=u,a},n.sqr=function(i){var e,o,r,s,h,c=new t.DBIG(0);for(c.w[0]=i.w[0]*i.w[0],r=1;r<n.NLEN-1;){for(o=i.w[r]*i.w[0],s=1;s<r+1>>1;s++)o+=i.w[r-s]*i.w[s];for(o+=o,c.w[r]=o,r++,o=i.w[r]*i.w[0],s=1;s<r+1>>1;s++)o+=i.w[r-s]*i.w[s];o+=o,o+=i.w[r>>1]*i.w[r>>1],c.w[r]=o,r++}for(r=n.NLEN-1+n.NLEN%2;r<n.DNLEN-3;){for(o=i.w[n.NLEN-1]*i.w[r-n.NLEN+1],s=r-n.NLEN+2;s<r+1>>1;s++)o+=i.w[r-s]*i.w[s];for(o+=o,c.w[r]=o,r++,o=i.w[n.NLEN-1]*i.w[r-n.NLEN+1],s=r-n.NLEN+2;s<r+1>>1;s++)o+=i.w[r-s]*i.w[s];o+=o,o+=i.w[r>>1]*i.w[r>>1],c.w[r]=o,r++}for(o=i.w[n.NLEN-2]*i.w[n.NLEN-1],o+=o,c.w[n.DNLEN-3]=o,o=i.w[n.NLEN-1]*i.w[n.NLEN-1],c.w[n.DNLEN-2]=o,h=0,s=0;s<n.DNLEN-1;s++)e=c.w[s]+h,c.w[s]=e&n.BMASK,h=(e-c.w[s])*n.MODINV;return c.w[n.DNLEN-1]=h,c},n.monty=function(t,i,e){var o,r,s,h,c,u=new n(0),a=[],f=[];for(s=e.w[0],a[0]=(s&n.BMASK)*i&n.BMASK,s+=a[0]*t.w[0],r=e.w[1]+s*n.MODINV,o=0,c=1;c<n.NLEN;c++){for(s=r+o+a[0]*t.w[c],h=c-1;h>Math.floor(c/2);h--)s+=(a[c-h]-a[h])*(t.w[h]-t.w[c-h]);a[c]=(s&n.BMASK)*i&n.BMASK,r=(s+=a[c]*t.w[0])*n.MODINV+e.w[c+1],f[c]=a[c]*t.w[c],o+=f[c]}for(c=n.NLEN;c<2*n.NLEN-1;c++){for(s=r+o,h=n.NLEN-1;h>=1+Math.floor(c/2);h--)s+=(a[c-h]-a[h])*(t.w[h]-t.w[c-h]);u.w[c-n.NLEN]=s&n.BMASK,r=(s-u.w[c-n.NLEN])*n.MODINV+e.w[c+1],o-=f[c-n.NLEN+1]}return u.w[n.NLEN-1]=r&n.BMASK,u},n.modmul=function(t,i,e){return t.mod(e),i.mod(e),n.mul(t,i).mod(e)},n.modsqr=function(t,i){return t.mod(i),n.sqr(t).mod(i)},n.modneg=function(t,n){return t.mod(n),n.minus(t)},n.invmod256=function(t){var n,i;return i=0,i+=t>>1&1,i=2-(i&=1),i=(n=1+(i<<=1))*(3&t),i>>=2,i+=n*(t>>2&3)&3,i*=n,i=4-(i&=3),i=(n+=i<<=2)*(15&t),i>>=4,i+=n*(t>>4&15)&15,i*=n,n+((i=16-(i&=15))<<4)},n}(h),h.DBIG=function(t){var n=function(t){this.w=[],this.zero(),this.w[0]=t};return n.prototype={zero:function(){for(var n=0;n<t.BIG.DNLEN;n++)this.w[n]=0;return this},copy:function(n){for(var i=0;i<t.BIG.DNLEN;i++)this.w[i]=n.w[i];return this},hcopy:function(n){var i;for(i=0;i<t.BIG.NLEN;i++)this.w[i]=n.w[i];for(i=t.BIG.NLEN;i<t.BIG.DNLEN;i++)this.w[i]=0;return this},ucopy:function(n){var i;for(i=0;i<t.BIG.NLEN;i++)this.w[i]=0;for(i=t.BIG.NLEN;i<t.BIG.DNLEN;i++)this.w[i]=n.w[i-t.BIG.NLEN];return this},norm:function(){var n,i,e=0;for(i=0;i<t.BIG.DNLEN-1;i++)n=this.w[i]+e,this.w[i]=n&t.BIG.BMASK,e=n>>t.BIG.BASEBITS;return this.w[t.BIG.DNLEN-1]=this.w[t.BIG.DNLEN-1]+e,this},muladd:function(n,i,e,o){var r=n*i+e+this.w[o];return this.w[o]=r&t.BIG.BMASK,(r-this.w[o])*t.BIG.MODINV},shr:function(n){var i,e=n%t.BIG.BASEBITS,o=Math.floor(n/t.BIG.BASEBITS);for(i=0;i<t.BIG.DNLEN-o-1;i++)this.w[i]=this.w[o+i]>>e|this.w[o+i+1]<<t.BIG.BASEBITS-e&t.BIG.BMASK;for(this.w[t.BIG.DNLEN-o-1]=this.w[t.BIG.DNLEN-1]>>e,i=t.BIG.DNLEN-o;i<t.BIG.DNLEN;i++)this.w[i]=0;return this},shl:function(n){var i,e=n%t.BIG.BASEBITS,o=Math.floor(n/t.BIG.BASEBITS);for(this.w[t.BIG.DNLEN-1]=this.w[t.BIG.DNLEN-1-o]<<e|this.w[t.BIG.DNLEN-o-2]>>t.BIG.BASEBITS-e,i=t.BIG.DNLEN-2;i>o;i--)this.w[i]=this.w[i-o]<<e&t.BIG.BMASK|this.w[i-o-1]>>t.BIG.BASEBITS-e;for(this.w[o]=this.w[0]<<e&t.BIG.BMASK,i=0;i<o;i++)this.w[i]=0;return this},cmove:function(n,i){var e,o=i;for(o=~(o-1),e=0;e<t.BIG.DNLEN;e++)this.w[e]^=(this.w[e]^n.w[e])&o},add:function(n){for(var i=0;i<t.BIG.DNLEN;i++)this.w[i]+=n.w[i]},sub:function(n){for(var i=0;i<t.BIG.DNLEN;i++)this.w[i]-=n.w[i]},rsub:function(n){for(var i=0;i<t.BIG.DNLEN;i++)this.w[i]=n.w[i]-this.w[i]},nbits:function(){var n,i,e=t.BIG.DNLEN-1;for(this.norm();e>=0&&0===this.w[e];)e--;if(e<0)return 0;for(n=t.BIG.BASEBITS*e,i=this.w[e];0!==i;)i=Math.floor(i/2),n++;return n},toString:function(){var t,i,e="",o=this.nbits();for(o%4==0?o=Math.floor(o/4):(o=Math.floor(o/4),o++),i=o-1;i>=0;i--)(t=new n(0)).copy(this),t.shr(4*i),e+=(15&t.w[0]).toString(16);return e},mod:function(i){var e=0,o=new n(0),r=new n(0),s=new t.BIG(0);if(this.norm(),o.hcopy(i),s.hcopy(this),n.comp(this,o)<0)return s;do{o.shl(1),e++}while(n.comp(this,o)>=0);for(;e>0;)o.shr(1),r.copy(this),r.sub(o),r.norm(),this.cmove(r,1-(r.w[t.BIG.DNLEN-1]>>t.BIG.CHUNK-1&1)),e--;return s.hcopy(this),s},div:function(i){var e=0,o=0,r=new n(0),s=new n(0),h=new t.BIG(0),c=new t.BIG(0),u=new t.BIG(1);for(r.hcopy(i),this.norm();n.comp(this,r)>=0;)u.fshl(1),r.shl(1),o++;for(;o>0;)r.shr(1),u.shr(1),s.copy(this),s.sub(r),s.norm(),e=1-(s.w[t.BIG.DNLEN-1]>>t.BIG.CHUNK-1&1),this.cmove(s,e),h.copy(c),h.add(u),h.norm(),c.cmove(h,e),o--;return c},split:function(n){var i,e,o=new t.BIG(0),r=n%t.BIG.BASEBITS,s=this.w[t.BIG.DNLEN-1]<<t.BIG.BASEBITS-r;for(e=t.BIG.DNLEN-2;e>=t.BIG.NLEN-1;e--)i=this.w[e]>>r|s,s=this.w[e]<<t.BIG.BASEBITS-r&t.BIG.BMASK,o.w[e-t.BIG.NLEN+1]=i;return this.w[t.BIG.NLEN-1]&=(1<<r)-1,o}},n.comp=function(n,i){var e;for(e=t.BIG.DNLEN-1;e>=0;e--)if(n.w[e]!=i.w[e])return n.w[e]>i.w[e]?1:-1;return 0},n}(h),void 0!==h.config.TFF?(h.FF=function(t){var n=function(n){this.v=new Array(n),this.length=n;for(var i=0;i<n;i++)this.v[i]=new t.BIG(0)};return n.FFLEN=t.config["@ML"],n.P_MBITS=8*t.BIG.MODBYTES,n.P_OMASK=-1<<n.P_MBITS%t.BIG.BASEBITS,n.P_FEXCESS=1<<t.BIG.BASEBITS*t.BIG.NLEN-n.P_MBITS-1,n.P_TBITS=n.P_MBITS%t.BIG.BASEBITS,n.FF_BITS=t.BIG.BIGBITS*n.FFLEN,n.HFLEN=n.FFLEN/2,n.prototype={P_EXCESS:function(){return 1+((this.v[this.length-1].get(t.BIG.NLEN-1)&n.P_OMASK)>>n.P_TBITS)},zero:function(){for(var t=0;t<this.length;t++)this.v[t].zero();return this},getlen:function(){return this.length},set:function(n){this.zero(),this.v[0].set(0,n&t.BIG.BMASK),this.v[0].set(1,n>>t.BIG.BASEBITS)},copy:function(t){for(var n=0;n<this.length;n++)this.v[n].copy(t.v[n])},rcopy:function(t){for(var n=0;n<this.length;n++)this.v[n].rcopy(t[n])},dsucopy:function(t){for(var n=0;n<t.length;n++)this.v[t.length+n].copy(t.v[n]),this.v[n].zero()},dscopy:function(t){for(var n=0;n<t.length;n++)this.v[n].copy(t.v[n]),this.v[t.length+n].zero()},sducopy:function(t){for(var n=0;n<this.length;n++)this.v[n].copy(t.v[this.length+n])},one:function(){this.v[0].one();for(var t=1;t<this.length;t++)this.v[t].zero()},iszilch:function(){for(var t=0;t<this.length;t++)if(!this.v[t].iszilch())return!1;return!0},shrw:function(t){for(var n=0;n<t;n++)this.v[n].copy(this.v[n+t]),this.v[n+t].zero()},shlw:function(t){for(var n=0;n<t;n++)this.v[t+n].copy(this.v[n]),this.v[n].zero()},parity:function(){return this.v[0].parity()},lastbits:function(t){return this.v[0].lastbits(t)},radd:function(t,n,i,e,o,r){for(var s=0;s<r;s++)this.v[t+s].copy(n.v[i+s]),this.v[t+s].add(e.v[o+s])},rinc:function(t,n,i,e){for(var o=0;o<e;o++)this.v[t+o].add(n.v[i+o])},rsub:function(t,n,i,e,o,r){for(var s=0;s<r;s++)this.v[t+s].copy(n.v[i+s]),this.v[t+s].sub(e.v[o+s])},rdec:function(t,n,i,e){for(var o=0;o<e;o++)this.v[t+o].sub(n.v[i+o])},add:function(t){for(var n=0;n<this.length;n++)this.v[n].add(t.v[n])},sub:function(t){for(var n=0;n<this.length;n++)this.v[n].sub(t.v[n])},revsub:function(t){for(var n=0;n<this.length;n++)this.v[n].rsub(t.v[n])},inc:function(t){this.v[0].inc(t),this.norm()},dec:function(t){this.v[0].dec(t),this.norm()},rnorm:function(t,i){var e,o,r=!1;for(i<0&&(i=-i,r=!0),e=0;e<i-1;e++)o=this.v[t+e].norm(),this.v[t+e].xortop(o<<n.P_TBITS),this.v[t+e+1].inc(o);return o=this.v[t+i-1].norm(),r&&this.v[t+i-1].xortop(o<<n.P_TBITS),this},norm:function(){this.rnorm(0,this.length)},shl:function(){var t,i,e=0;for(t=0;t<this.length-1;t++)i=this.v[t].fshl(1),this.v[t].inc(e),this.v[t].xortop(i<<n.P_TBITS),e=i;this.v[this.length-1].fshl(1),this.v[this.length-1].inc(e)},shr:function(){var t,i;for(t=this.length-1;t>0;t--)i=this.v[t].fshr(1),this.v[t-1].ortop(i<<n.P_TBITS);this.v[0].fshr(1)},toString:function(){var t,n="";for(this.norm(),t=this.length-1;t>=0;t--)n+=this.v[t].toString();return n},toBytes:function(n){var i;for(i=0;i<this.length;i++)this.v[i].tobytearray(n,(this.length-i-1)*t.BIG.MODBYTES)},karmul:function(n,i,e,o,r,s,h,c){var u,a;if(1===c)return i.v[e].norm(),o.v[r].norm(),a=t.BIG.mul(i.v[e],o.v[r]),this.v[n+1]=a.split(8*t.BIG.MODBYTES),void this.v[n].copy(a);u=c/2,this.radd(n,i,e,i,e+u,u),this.rnorm(n,u),this.radd(n+u,o,r,o,r+u,u),this.rnorm(n+u,u),s.karmul(h,this,n,this,n+u,s,h+c,u),this.karmul(n,i,e,o,r,s,h+c,u),this.karmul(n+c,i,e+u,o,r+u,s,h+c,u),s.rdec(h,this,n,c),s.rdec(h,this,n+c,c),this.rinc(n+u,s,h,c),this.rnorm(n,2*c)},karsqr:function(n,i,e,o,r,s){var h,c;if(1===s)return i.v[e].norm(),c=t.BIG.sqr(i.v[e]),this.v[n+1].copy(c.split(8*t.BIG.MODBYTES)),void this.v[n].copy(c);h=s/2,this.karsqr(n,i,e,o,r+s,h),this.karsqr(n+s,i,e+h,o,r+s,h),o.karmul(r,i,e,i,e+h,o,r+s,h),this.rinc(n+h,o,r,s),this.rinc(n+h,o,r,s),this.rnorm(n+h,s)},karmul_lower:function(n,i,e,o,r,s,h,c){var u;1!==c?(u=c/2,this.karmul(n,i,e,o,r,s,h+c,u),s.karmul_lower(h,i,e+u,o,r,s,h+c,u),this.rinc(n+u,s,h,u),s.karmul_lower(h,i,e,o,r+u,s,h+c,u),this.rinc(n+u,s,h,u),this.rnorm(n+u,-u)):this.v[n].copy(t.BIG.smul(i.v[e],o.v[r]))},karmul_upper:function(t,n,i,e){var o;o=e/2,this.radd(e,t,0,t,o,o),this.radd(e+o,n,0,n,o,o),this.rnorm(e,o),this.rnorm(e+o,o),i.karmul(0,this,e+o,this,e,i,e,o),this.karmul(e,t,o,n,o,i,e,o),i.rdec(0,this,e,e),this.rinc(o,this,0,o),this.rdec(o,i,0,o),this.rnorm(0,-e),i.rdec(0,this,0,e),this.rinc(o,i,0,e),this.rnorm(o,e)},lmul:function(t){var i=this.length,e=new n(2*i),o=new n(i);o.copy(this),this.karmul_lower(0,o,0,t,0,e,0,i)},mod:function(t){var i=0;if(this.norm(),!(n.comp(this,t)<0)){do{t.shl(),i++}while(n.comp(this,t)>=0);for(;i>0;)t.shr(),n.comp(this,t)>=0&&(this.sub(t),this.norm()),i--}},reduce:function(t,i){var e=t.length,o=new n(2*e),r=new n(e),s=new n(e);return r.sducopy(this),s.karmul_lower(0,this,0,i,0,o,0,e),this.karmul_upper(t,s,o,e),s.sducopy(this),r.add(t),r.sub(s),r.norm(),r},dmod:function(i){var e,o=i.length,r=new n(2*o),s=new n(2*o),h=new n(o);for(s.copy(this),s.norm(),r.dsucopy(i),e=t.BIG.BIGBITS*o;n.comp(s,r)>=0;)s.sub(r),s.norm();for(;e>0;)r.shr(),n.comp(s,r)>=0&&(s.sub(r),s.norm()),e--;return h.copy(s),h.mod(i),h},invmodp:function(t){var i=t.length,e=new n(i),o=new n(i),r=new n(i),s=new n(i),h=new n(i),c=new n(i);for(c.one(),e.copy(this),o.copy(t),r.copy(c),s.zero();0!==n.comp(e,c)&&0!==n.comp(o,c);){for(;0===e.parity();)e.shr(),0!==r.parity()&&(r.add(t),r.norm()),r.shr();for(;0===o.parity();)o.shr(),0!==s.parity()&&(s.add(t),s.norm()),s.shr();n.comp(e,o)>=0?(e.sub(o),e.norm(),n.comp(r,s)>=0?r.sub(s):(h.copy(t),h.sub(s),r.add(h)),r.norm()):(o.sub(e),o.norm(),n.comp(s,r)>=0?s.sub(r):(h.copy(t),h.sub(r),s.add(h)),s.norm())}0===n.comp(e,c)?this.copy(r):this.copy(s)},nres:function(i){var e,o=i.length;1===o?((e=new t.DBIG(0)).hcopy(this.v[0]),e.shl(t.BIG.NLEN*t.BIG.BASEBITS),this.v[0].copy(e.mod(i.v[0]))):((e=new n(2*o)).dsucopy(this),this.copy(e.dmod(i)))},redc:function(i,e){var o,r=i.length;1===r?((o=new t.DBIG(0)).hcopy(this.v[0]),this.v[0].copy(t.BIG.monty(i.v[0],(1<<t.BIG.BASEBITS)-e.v[0].w[0],o))):(o=new n(2*r),this.mod(i),o.dscopy(this),this.copy(o.reduce(i,e)),this.mod(i))},mod2m:function(t){for(var n=t;n<this.length;n++)this.v[n].zero()},invmod2m:function(){var t,i,e=this.length,o=new n(e),r=new n(e),s=new n(e);for(s.zero(),s.v[0].copy(this.v[0]),s.v[0].invmod2m(),i=1;i<e;i<<=1)o.copy(this),o.mod2m(i),(t=n.mul(s,o)).shrw(i),o.copy(t),r.copy(this),r.shrw(i),r.mod2m(i),r.lmul(s),r.mod2m(i),o.add(r),o.norm(),o.lmul(s),o.mod2m(i),r.one(),r.shlw(i),o.revsub(r),o.norm(),o.shlw(i),s.add(o);return s.norm(),s},random:function(n){var i,e=this.length;for(i=0;i<e;i++)this.v[i].copy(t.BIG.random(n));for(;this.v[e-1].nbits()<8*t.BIG.MODBYTES;)this.v[e-1].copy(t.BIG.random(n))},randomnum:function(i,e){var o,r=this.length,s=new n(2*r);for(o=0;o<2*r;o++)s.v[o].copy(t.BIG.random(e));this.copy(s.dmod(i))},modmul:function(i,e,o){var r,s=this.P_EXCESS(),h=i.P_EXCESS(),c=e.length;s+1>=Math.floor((n.P_FEXCESS-1)/(h+1))&&this.mod(e),1===c?(r=t.BIG.mul(this.v[0],i.v[0]),this.v[0].copy(t.BIG.monty(e.v[0],(1<<t.BIG.BASEBITS)-o.v[0].w[0],r))):(r=n.mul(this,i),this.copy(r.reduce(e,o)))},modsqr:function(i,e){var o,r=this.P_EXCESS();r+1>=Math.floor((n.P_FEXCESS-1)/(r+1))&&this.mod(i),1===i.length?(o=t.BIG.sqr(this.v[0]),this.v[0].copy(t.BIG.monty(i.v[0],(1<<t.BIG.BASEBITS)-e.v[0].w[0],o))):(o=n.sqr(this),this.copy(o.reduce(i,e)))},skpow:function(i,e){var o,r,s=e.length,h=new n(s),c=new n(s),u=e.invmod2m();for(this.mod(e),h.one(),c.copy(this),h.nres(e),c.nres(e),o=8*t.BIG.MODBYTES*s-1;o>=0;o--)r=i.v[Math.floor(o/t.BIG.BIGBITS)].bit(o%t.BIG.BIGBITS),this.copy(h),this.modmul(c,e,u),n.cswap(h,c,r),h.modsqr(e,u),c.copy(this),n.cswap(h,c,r);this.copy(h),this.redc(e,u)},skspow:function(i,e){var o,r,s=e.length,h=new n(s),c=new n(s),u=e.invmod2m();for(this.mod(e),h.one(),c.copy(this),h.nres(e),c.nres(e),o=8*t.BIG.MODBYTES-1;o>=0;o--)r=i.bit(o),this.copy(h),this.modmul(c,e,u),n.cswap(h,c,r),h.modsqr(e,u),c.copy(this),n.cswap(h,c,r);this.copy(h),this.redc(e,u)},power:function(t,i){var e=i.length,o=!0,r=new n(e),s=i.invmod2m();if(r.copy(this),r.nres(i),2==t)this.copy(r),this.modsqr(i,s);else for(;t%2==1&&(o?this.copy(r):this.modmul(r,i,s),o=!1),0!=(t>>=1);)r.modsqr(i,s);this.redc(i,s)},pow:function(i,e){var o,r=e.length,s=new n(r),h=e.invmod2m();for(s.copy(this),this.one(),this.nres(e),s.nres(e),o=8*t.BIG.MODBYTES*r-1;o>=0;o--)this.modsqr(e,h),1===i.v[Math.floor(o/t.BIG.BIGBITS)].bit(o%t.BIG.BIGBITS)&&this.modmul(s,e,h);this.redc(e,h)},pow2:function(i,e,o,r){var s,h,c,u=r.length,a=new n(u),f=new n(u),E=new n(u),B=r.invmod2m();for(a.copy(this),f.copy(e),a.nres(r),f.nres(r),E.copy(a),E.modmul(f,r,B),this.one(),this.nres(r),s=8*t.BIG.MODBYTES-1;s>=0;s--)h=i.bit(s),c=o.bit(s),this.modsqr(r,B),1==h?1==c?this.modmul(E,r,B):this.modmul(a,r,B):1==c&&this.modmul(f,r,B);this.redc(r,B)},cfactor:function(t){var i,e=this.length,o=new n(e),r=new n(e);r.set(t),o.copy(this),o.norm();do{for(o.sub(r),o.norm();!o.iszilch()&&0===o.parity();)o.shr()}while(n.comp(o,r)>0);return i=o.v[0].get(0),n.igcd(t,i)>1}},n.comp=function(n,i){var e,o;for(e=n.length-1;e>=0;e--)if(0!==(o=t.BIG.comp(n.v[e],i.v[e])))return o;return 0},n.fromBytes=function(n,i){var e;for(e=0;e<n.length;e++)n.v[e]=t.BIG.frombytearray(i,(n.length-e-1)*t.BIG.MODBYTES)},n.cswap=function(t,n,i){var e;for(e=0;e<t.length;e++)t.v[e].cswap(n.v[e],i)},n.mul=function(t,i){var e=t.length,o=new n(2*e),r=new n(2*e);return o.karmul(0,t,0,i,0,r,0,e),o},n.sqr=function(t){var i=t.length,e=new n(2*i),o=new n(2*i);return e.karsqr(0,t,0,o,0,i),e},n.igcd=function(t,n){var i;if(0===n)return t;for(;0!=(i=t%n);)t=n,n=i;return n},n.prime=function(t,i){var e,o,r,s=t.length,h=0,c=new n(s),u=new n(s),a=new n(s),f=new n(s);if(t.norm(),t.cfactor(4849845))return!1;for(a.one(),f.copy(t),f.sub(a),f.norm(),c.copy(f);0===c.parity();)c.shr(),h++;if(0===h)return!1;for(o=0;o<10;o++)if(u.randomnum(t,i),u.pow(c,t),0!==n.comp(u,a)&&0!==n.comp(u,f)){for(e=!1,r=1;r<h;r++){if(u.power(2,t),0===n.comp(u,a))return!1;if(0===n.comp(u,f)){e=!0;break}}if(!e)return!1}return!0},n}(h),h.RSA=function(t){var n={RFS:t.BIG.MODBYTES*t.FF.FFLEN,SHA256:32,SHA384:48,SHA512:64,HASH_TYPE:32,SHA256ID:[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],SHA384ID:[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],SHA512ID:[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],bytestohex:function(t){var n,i,e="",o=t.length;for(i=0;i<o;i++)e+=((n=t[i])>>>4&15).toString(16),e+=(15&n).toString(16);return e},bytestostring:function(t){var n,i="";for(n=0;n<t.length;n++)i+=String.fromCharCode(t[n]);return i},stringtobytes:function(t){var n,i=[];for(n=0;n<t.length;n++)i.push(t.charCodeAt(n));return i},hashit:function(n,i,e){var o,r=[];return n==this.SHA256?(o=new t.HASH256,null!=i&&o.process_array(i),e>=0&&o.process_num(e),r=o.hash()):n==this.SHA384?(o=new t.HASH384,null!=i&&o.process_array(i),e>=0&&o.process_num(e),r=o.hash()):n==this.SHA512&&(o=new t.HASH512,null!=i&&o.process_array(i),e>=0&&o.process_num(e),r=o.hash()),r},KEY_PAIR:function(n,i,e,o){for(var r=o.n.length>>1,s=new t.FF(r),h=new t.FF(r),c=new t.FF(r);;){for(e.p.random(n);3!=e.p.lastbits(2);)e.p.inc(1);for(;!t.FF.prime(e.p,n);)e.p.inc(4);if(h.copy(e.p),h.dec(1),!h.cfactor(i))break}for(;;){for(e.q.random(n);3!=e.q.lastbits(2);)e.q.inc(1);for(;!t.FF.prime(e.q,n);)e.q.inc(4);if(c.copy(e.q),c.dec(1),!c.cfactor(i))break}o.n=t.FF.mul(e.p,e.q),o.e=i,s.copy(h),s.shr(),e.dp.set(i),e.dp.invmodp(s),0===e.dp.parity()&&e.dp.add(s),e.dp.norm(),s.copy(c),s.shr(),e.dq.set(i),e.dq.invmodp(s),0===e.dq.parity()&&e.dq.add(s),e.dq.norm(),e.c.copy(e.p),e.c.invmodp(e.q)},MGF1:function(t,n,i,e){var o,r,s,h=t,c=[],u=0;for(s=0;s<e.length;s++)e[s]=0;for(r=Math.floor(i/h),i%h!=0&&r++,o=0;o<r;o++)if(c=this.hashit(t,n,o),u+h>i)for(s=0;s<i%h;s++)e[u++]=c[s];else for(s=0;s<h;s++)e[u++]=c[s]},PKCS15:function(n,i,e){var o,r,s,h=t.FF.FF_BITS/8,c=n;if(h<19+c+10)return!1;for(o=this.hashit(n,i,-1),r=0;r<e.length;r++)e[r]=0;for(r=0,e[r++]=0,e[r++]=1,s=0;s<h-19-c-3;s++)e[r++]=255;if(e[r++]=0,c==this.SHA256)for(s=0;s<19;s++)e[r++]=this.SHA256ID[s];else if(c==this.SHA384)for(s=0;s<19;s++)e[r++]=this.SHA384ID[s];else if(c==this.SHA512)for(s=0;s<19;s++)e[r++]=this.SHA512ID[s];for(s=0;s<c;s++)e[r++]=o[s];return!0},OAEP_ENCODE:function(t,i,e,o){var r,s,h,c,u,a=n.RFS-1,f=i.length,E=[],B=[],y=[];if(s=r=t,f>a-r-s-1)return null;for(u=this.hashit(t,o,-1),c=0;c<r;c++)y[c]=u[c];for(h=a-f-r-s-1,c=0;c<h;c++)y[r+c]=0;for(y[r+h]=1,c=0;c<f;c++)y[r+h+1+c]=i[c];for(c=0;c<s;c++)E[c]=e.getByte();for(this.MGF1(t,E,a-s,B),c=0;c<a-s;c++)B[c]^=y[c];for(this.MGF1(t,B,s,y),c=0;c<s;c++)y[c]^=E[c];for(c=0;c<a-s;c++)y[c+s]=B[c];for(c=n.RFS-1;c>=1;c--)y[c]=y[c-1];for(c=0;c>=0;c--)y[c]=0;return y},OAEP_DECODE:function(t,i,e){var o,r,s,h,c,u,a,f,E,B,y=n.RFS-1,I=[],p=[],m=[];if(y<(s=r=t)+r+1)return null;for(a=0;a<y-s;a++)m[a]=0;if(e.length<n.RFS){for(u=n.RFS-e.length,a=n.RFS-1;a>=u;a--)e[a]=e[a-u];for(a=u-1;a>=0;a--)e[a]=0}for(E=this.hashit(t,i,-1),a=0;a<r;a++)p[a]=E[a];for(h=e[0],a=s;a<y;a++)m[a-s]=e[a+1];for(this.MGF1(t,m,s,I),a=0;a<s;a++)I[a]^=e[a+1];for(this.MGF1(t,I,y-s,e),a=0;a<y-s;a++)m[a]^=e[a];for(o=!0,a=0;a<r;a++)p[a]!=m[a]&&(o=!1);for(a=0;a<y-s-r;a++)m[a]=m[a+r];for(a=0;a<r;a++)I[a]=p[a]=0;for(f=0;;f++){if(f>=y-s-r)return null;if(0!==m[f])break}if(c=m[f],!o||0!==h||1!=c){for(a=0;a<y-s;a++)m[a]=0;return null}for(B=[],a=0;a<y-s-r-f-1;a++)B[a]=m[a+f+1];for(a=0;a<y-s;a++)m[a]=0;return B},PRIVATE_KEY_KILL:function(t){t.p.zero(),t.q.zero(),t.dp.zero(),t.dq.zero(),t.c.zero()},ENCRYPT:function(n,i,e){var o=n.n.getlen(),r=new t.FF(o);t.FF.fromBytes(r,i),r.power(n.e,n.n),r.toBytes(e)},DECRYPT:function(n,i,e){var o,r,s,h=n.p.getlen(),c=new t.FF(2*h);t.FF.fromBytes(c,i),o=c.dmod(n.p),r=c.dmod(n.q),o.skpow(n.dp,n.p),r.skpow(n.dq,n.q),c.zero(),c.dscopy(o),o.mod(n.q),t.FF.comp(o,r)>0&&r.add(n.q),r.sub(o),r.norm(),r=(s=t.FF.mul(n.c,r)).dmod(n.q),s=t.FF.mul(r,n.p),c.add(s),c.norm(),c.toBytes(e)}};return n}(h),h.rsa_public_key=function(t){return function(n){this.e=0,this.n=new t.FF(n)}}(h),void(h.rsa_private_key=function(t){return function(n){this.p=new t.FF(n),this.q=new t.FF(n),this.dp=new t.FF(n),this.dq=new t.FF(n),this.c=new t.FF(n)}}(h))):void 0!==h.config.CURVE?(h.ROM_CURVE=e[h.config.CURVE],h.ROM_FIELD=o[h.config.FIELD],h.FP=function(t){var n=function(i){i instanceof n?(this.f=new t.BIG(i.f),this.XES=i.XES):(this.f=new t.BIG(i),this.nres())};return n.NOT_SPECIAL=0,n.PSEUDO_MERSENNE=1,n.GENERALISED_MERSENNE=2,n.MONTGOMERY_FRIENDLY=3,n.MODBITS=t.config["@NBT"],n.MOD8=t.config["@M8"],n.MODTYPE=t.config["@MT"],n.FEXCESS=1<<t.config["@SH"],n.OMASK=-1<<n.TBITS,n.TBITS=n.MODBITS%t.BIG.BASEBITS,n.TMASK=(1<<n.TBITS)-1,n.prototype={zero:function(){this.XES=1,this.f.zero()},rcopy:function(t){this.f.rcopy(t),this.nres()},bcopy:function(t){this.f.copy(t),this.nres()},copy:function(t){this.XES=t.XES,this.f.copy(t.f)},cswap:function(t,n){this.f.cswap(t.f,n);var i;i=~(n-1)&(this.XES^t.XES),this.XES^=i,t.XES^=i},cmove:function(t,n){var i=n;i=~(i-1),this.f.cmove(t.f,n),this.XES^=(this.XES^t.XES)&i},nres:function(){var i,e;return n.MODTYPE!=n.PSEUDO_MERSENNE&&n.MODTYPE!=n.GENERALISED_MERSENNE?((i=new t.BIG).rcopy(t.ROM_FIELD.R2modp),e=t.BIG.mul(this.f,i),this.f.copy(n.mod(e)),this.XES=2):this.XES=1,this},redc:function(){var i,e,o=new t.BIG(0);return o.copy(this.f),n.MODTYPE!=n.PSEUDO_MERSENNE&&n.MODTYPE!=n.GENERALISED_MERSENNE&&((i=new t.DBIG(0)).hcopy(this.f),e=n.mod(i),o.copy(e)),o},toString:function(){return this.redc().toString()},iszilch:function(){return this.reduce(),this.f.iszilch()},reduce:function(){var n=new t.BIG(0);n.rcopy(t.ROM_FIELD.Modulus),this.f.mod(n),this.XES=1},one:function(){return this.f.one(),this.nres()},norm:function(){return this.f.norm()},mul:function(i){var e;return this.XES*i.XES>n.FEXCESS&&this.reduce(),e=t.BIG.mul(this.f,i.f),this.f.copy(n.mod(e)),this.XES=2,this},imul:function(t){var i,e,o=!1;return t<0&&(t=-t,o=!0),n.MODTYPE==n.PSEUDO_MERSENNE||n.MODTYPE==n.GENERALISED_MERSENNE?(i=this.f.pxmul(t),this.f.copy(n.mod(i)),this.XES=2):this.XES*t<=n.FEXCESS?(this.f.pmul(t),this.XES*=t):(e=new n(t),this.mul(e)),o&&(this.neg(),this.norm()),this},sqr:function(){var i,e;return this.XES*this.XES>n.FEXCESS&&this.reduce(),i=t.BIG.sqr(this.f),e=n.mod(i),this.f.copy(e),this.XES=2,this},add:function(t){return this.f.add(t.f),this.XES+=t.XES,this.XES>n.FEXCESS&&this.reduce(),this},neg:function(){var i,e=new t.BIG(0);return e.rcopy(t.ROM_FIELD.Modulus),i=n.logb2(this.XES-1),e.fshl(i),this.XES=1<<i,this.f.rsub(e),this.XES>n.FEXCESS&&this.reduce(),this},sub:function(t){var i=new n(0);return i.copy(t),i.neg(),this.add(i),this},rsub:function(t){var i=new n(0);i.copy(this),i.neg(),this.copy(t),this.add(i)},div2:function(){var n;return 0===this.f.parity()||((n=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),this.f.add(n),this.f.norm()),this.f.fshr(1),this},inverse:function(){var n=new t.BIG(0);return n.rcopy(t.ROM_FIELD.Modulus),n.dec(2),n.norm(),this.copy(this.pow(n)),this},equals:function(n){return n.reduce(),this.reduce(),0===t.BIG.comp(n.f,this.f)},pow:function(i){var e,o,r,s,h=[],c=[],u=new t.BIG(i);for(u.norm(),o=1+Math.floor((u.nbits()+3)/4),e=0;e<o;e++)r=u.lastbits(4),u.dec(r),u.norm(),h[e]=r,u.fshr(4);for(c[0]=new n(1),c[1]=new n(this),e=2;e<16;e++)c[e]=new n(c[e-1]),c[e].mul(this);for(s=new n(c[h[o-1]]),e=o-2;e>=0;e--)s.sqr(),s.sqr(),s.sqr(),s.sqr(),s.mul(c[h[e]]);return s.reduce(),s},jacobi:function(){var n=new t.BIG(0),i=this.redc();return n.rcopy(t.ROM_FIELD.Modulus),i.jacobi(n)},sqrt:function(){var i,e,o,r=new t.BIG(0);return this.reduce(),r.rcopy(t.ROM_FIELD.Modulus),5==n.MOD8?(r.dec(5),r.norm(),r.shr(3),(i=new n(0)).copy(this),i.f.shl(1),e=i.pow(r),i.mul(e),i.mul(e),i.f.dec(1),(o=new n(0)).copy(this),o.mul(e),o.mul(i),o.reduce(),o):(r.inc(1),r.norm(),r.shr(2),this.pow(r))}},n.logb2=function(t){return t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},n.mod=function(i){var e,o,r,s,h,c,u,a,f,E=new t.BIG(0);if(n.MODTYPE==n.PSEUDO_MERSENNE)return o=i.split(n.MODBITS),E.hcopy(i),r=1!=t.ROM_FIELD.MConst?o.pmul(t.ROM_FIELD.MConst):0,o.add(E),o.norm(),s=o.w[t.BIG.NLEN-1],o.w[t.BIG.NLEN-1]&=n.TMASK,o.inc(t.ROM_FIELD.MConst*((s>>n.TBITS)+(r<<t.BIG.BASEBITS-n.TBITS))),o.norm(),o;if(n.MODTYPE==n.MONTGOMERY_FRIENDLY){for(e=0;e<t.BIG.NLEN;e++)i.w[t.BIG.NLEN+e]+=i.muladd(i.w[e],t.ROM_FIELD.MConst-1,i.w[e],t.BIG.NLEN+e-1);for(e=0;e<t.BIG.NLEN;e++)E.w[e]=i.w[t.BIG.NLEN+e];E.norm()}return n.MODTYPE==n.GENERALISED_MERSENNE&&(o=i.split(n.MODBITS),E.hcopy(i),E.add(o),(f=new t.DBIG(0)).hcopy(o),f.shl(n.MODBITS/2),h=f.split(n.MODBITS),(c=new t.BIG).hcopy(f),E.add(h),E.add(c),h.shl(n.MODBITS/2),E.add(h),u=E.w[t.BIG.NLEN-1]>>n.TBITS,E.w[t.BIG.NLEN-1]&=n.TMASK,E.w[0]+=u,E.w[Math.floor(224/t.BIG.BASEBITS)]+=u<<224%t.BIG.BASEBITS,E.norm()),n.MODTYPE==n.NOT_SPECIAL&&((a=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),E.copy(t.BIG.monty(a,t.ROM_FIELD.MConst,i))),E},n}(h),h.ECP=function(t){var n=function(){this.x=new t.FP(0),this.y=new t.FP(1),n.CURVETYPE!=n.EDWARDS?this.z=new t.FP(0):this.z=new t.FP(1)};return n.WEIERSTRASS=0,n.EDWARDS=1,n.MONTGOMERY=2,n.NOT=0,n.BN=1,n.BLS=2,n.D_TYPE=0,n.M_TYPE=1,n.POSITIVEX=0,n.NEGATIVEX=1,n.CURVETYPE=t.config["@CT"],n.CURVE_PAIRING_TYPE=t.config["@PF"],n.SEXTIC_TWIST=t.config["@ST"],n.SIGN_OF_X=t.config["@SX"],n.HASH_TYPE=t.config["@HT"],n.AESKEY=t.config["@AK"],n.prototype={is_infinity:function(){return this.x.reduce(),this.z.reduce(),n.CURVETYPE==n.EDWARDS?(this.y.reduce(),this.x.iszilch()&&this.y.equals(this.z)):n.CURVETYPE==n.WEIERSTRASS?(this.y.reduce(),this.x.iszilch()&&this.z.iszilch()):n.CURVETYPE!=n.MONTGOMERY||this.z.iszilch()},cswap:function(t,i){this.x.cswap(t.x,i),n.CURVETYPE!=n.MONTGOMERY&&this.y.cswap(t.y,i),this.z.cswap(t.z,i)},cmove:function(t,i){this.x.cmove(t.x,i),n.CURVETYPE!=n.MONTGOMERY&&this.y.cmove(t.y,i),this.z.cmove(t.z,i)},select:function(t,i){var e=new n,o=i>>31,r=(i^o)-o;r=(r-1)/2,this.cmove(t[0],n.teq(r,0)),this.cmove(t[1],n.teq(r,1)),this.cmove(t[2],n.teq(r,2)),this.cmove(t[3],n.teq(r,3)),this.cmove(t[4],n.teq(r,4)),this.cmove(t[5],n.teq(r,5)),this.cmove(t[6],n.teq(r,6)),this.cmove(t[7],n.teq(r,7)),e.copy(this),e.neg(),this.cmove(e,1&o)},equals:function(i){var e,o;return e=new t.FP(0),o=new t.FP(0),e.copy(this.x),e.mul(i.z),e.reduce(),o.copy(i.x),o.mul(this.z),o.reduce(),!(!e.equals(o)||n.CURVETYPE!=n.MONTGOMERY&&(e.copy(this.y),e.mul(i.z),e.reduce(),o.copy(i.y),o.mul(this.z),o.reduce(),!e.equals(o)))},copy:function(t){this.x.copy(t.x),n.CURVETYPE!=n.MONTGOMERY&&this.y.copy(t.y),this.z.copy(t.z)},neg:function(){n.CURVETYPE==n.WEIERSTRASS?(this.y.neg(),this.y.norm()):n.CURVETYPE==n.EDWARDS&&(this.x.neg(),this.x.norm())},inf:function(){this.x.zero(),n.CURVETYPE!=n.MONTGOMERY&&this.y.one(),n.CURVETYPE!=n.EDWARDS?this.z.zero():this.z.one()},setxy:function(i,e){var o,r;this.x=new t.FP(0),this.x.bcopy(i),this.y=new t.FP(0),this.y.bcopy(e),this.z=new t.FP(1),o=n.RHS(this.x),n.CURVETYPE==n.MONTGOMERY?1!=o.jacobi()&&this.inf():((r=new t.FP(0)).copy(this.y),r.sqr(),r.equals(o)||this.inf())},setxi:function(i,e){var o,r;this.x=new t.FP(0),this.x.bcopy(i),o=n.RHS(this.x),this.z=new t.FP(1),1==o.jacobi()?((r=o.sqrt()).redc().parity()!=e&&r.neg(),this.y=r):this.inf()},setx:function(i){var e;this.x=new t.FP(0),this.x.bcopy(i),e=n.RHS(this.x),this.z=new t.FP(1),1==e.jacobi()?n.CURVETYPE!=n.MONTGOMERY&&(this.y=e.sqrt()):this.inf()},affine:function(){var i;this.is_infinity()||(i=new t.FP(1),this.z.equals(i)||(this.z.inverse(),n.CURVETYPE!=n.EDWARDS&&n.CURVETYPE!=n.WEIERSTRASS||(this.x.mul(this.z),this.x.reduce(),this.y.mul(this.z),this.y.reduce(),this.z=i),n.CURVETYPE==n.MONTGOMERY&&(this.x.mul(this.z),this.x.reduce(),this.z=i)))},getX:function(){return this.affine(),this.x.redc()},getY:function(){return this.affine(),this.y.redc()},getS:function(){return this.affine(),this.getY().parity()},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},toBytes:function(i){var e,o=[];for(n.CURVETYPE!=n.MONTGOMERY?i[0]=4:i[0]=2,this.affine(),this.x.redc().toBytes(o),e=0;e<t.BIG.MODBYTES;e++)i[e+1]=o[e];if(n.CURVETYPE!=n.MONTGOMERY)for(this.y.redc().toBytes(o),e=0;e<t.BIG.MODBYTES;e++)i[e+t.BIG.MODBYTES+1]=o[e]},toString:function(){return this.is_infinity()?"infinity":(this.affine(),n.CURVETYPE==n.MONTGOMERY?"("+this.x.redc().toString()+")":"("+this.x.redc().toString()+","+this.y.redc().toString()+")")},dbl:function(){var i,e,o,r,s,h,c,u,a,f,E,B,y,I,p,m;n.CURVETYPE==n.WEIERSTRASS&&(0==t.ROM_CURVE.CURVE_A?((i=new t.FP(0)).copy(this.y),i.sqr(),(e=new t.FP(0)).copy(this.y),e.mul(this.z),(o=new t.FP(0)).copy(this.z),o.sqr(),this.z.copy(i),this.z.add(i),this.z.norm(),this.z.add(this.z),this.z.add(this.z),this.z.norm(),o.imul(3*t.ROM_CURVE.CURVE_B_I),(s=new t.FP(0)).copy(o),s.mul(this.z),(h=new t.FP(0)).copy(i),h.add(o),h.norm(),this.z.mul(e),e.copy(o),e.add(o),o.add(e),i.sub(o),i.norm(),h.mul(i),h.add(s),e.copy(this.x),e.mul(this.y),this.x.copy(i),this.x.norm(),this.x.mul(e),this.x.add(this.x),this.x.norm(),this.y.copy(h),this.y.norm()):((i=new t.FP(0)).copy(this.x),(e=new t.FP(0)).copy(this.y),(o=new t.FP(0)).copy(this.z),(r=new t.FP(0)).copy(this.x),(c=new t.FP(0)).copy(this.z),h=new t.FP(0),s=new t.FP(0),u=new t.FP(0),0==t.ROM_CURVE.CURVE_B_I&&u.rcopy(t.ROM_CURVE.CURVE_B),i.sqr(),e.sqr(),o.sqr(),r.mul(this.y),r.add(r),r.norm(),c.mul(this.x),c.add(c),c.norm(),h.copy(o),0==t.ROM_CURVE.CURVE_B_I?h.mul(u):h.imul(t.ROM_CURVE.CURVE_B_I),h.sub(c),s.copy(h),s.add(h),s.norm(),h.add(s),s.copy(e),s.sub(h),s.norm(),h.add(e),h.norm(),h.mul(s),s.mul(r),r.copy(o),r.add(o),o.add(r),0==t.ROM_CURVE.CURVE_B_I?c.mul(u):c.imul(t.ROM_CURVE.CURVE_B_I),c.sub(o),c.sub(i),c.norm(),r.copy(c),r.add(c),c.add(r),c.norm(),r.copy(i),r.add(i),i.add(r),i.sub(o),i.norm(),i.mul(c),h.add(i),i.copy(this.y),i.mul(this.z),i.add(i),i.norm(),c.mul(i),s.sub(c),i.add(i),i.norm(),e.add(e),e.norm(),c.copy(i),c.mul(e),this.x.copy(s),this.x.norm(),this.y.copy(h),this.y.norm(),this.z.copy(c),this.z.norm())),n.CURVETYPE==n.EDWARDS&&((a=new t.FP(0)).copy(this.x),(f=new t.FP(0)).copy(this.y),(E=new t.FP(0)).copy(this.z),B=new t.FP(0),this.x.mul(this.y),this.x.add(this.x),this.x.norm(),a.sqr(),f.sqr(),-1==t.ROM_CURVE.CURVE_A&&a.neg(),this.y.copy(a),this.y.add(f),this.y.norm(),E.sqr(),E.add(E),this.z.copy(this.y),B.copy(this.y),B.sub(E),B.norm(),this.x.mul(B),a.sub(f),a.norm(),this.y.mul(a),this.z.mul(B)),n.CURVETYPE==n.MONTGOMERY&&((y=new t.FP(0)).copy(this.x),(I=new t.FP(0)).copy(this.x),p=new t.FP(0),m=new t.FP(0),a=new t.FP(0),y.add(this.z),y.norm(),p.copy(y),p.sqr(),I.sub(this.z),I.norm(),m.copy(I),m.sqr(),a.copy(p),a.sub(m),a.norm(),this.x.copy(p),this.x.mul(m),y.copy(a),y.imul(t.ROM_CURVE.CURVE_A+2>>2),m.add(y),m.norm(),this.z.copy(m),this.z.mul(a))},add:function(i){var e,o,r,s,h,c,u,a,f,E,B,y,I,p,m,d;n.CURVETYPE==n.WEIERSTRASS&&(0==t.ROM_CURVE.CURVE_A?(e=3*t.ROM_CURVE.CURVE_B_I,(o=new t.FP(0)).copy(this.x),o.mul(i.x),(r=new t.FP(0)).copy(this.y),r.mul(i.y),(s=new t.FP(0)).copy(this.z),s.mul(i.z),(h=new t.FP(0)).copy(this.x),h.add(this.y),h.norm(),(c=new t.FP(0)).copy(i.x),c.add(i.y),c.norm(),h.mul(c),c.copy(o),c.add(r),h.sub(c),h.norm(),c.copy(this.y),c.add(this.z),c.norm(),(u=new t.FP(0)).copy(i.y),u.add(i.z),u.norm(),c.mul(u),u.copy(r),u.add(s),c.sub(u),c.norm(),u.copy(this.x),u.add(this.z),u.norm(),(a=new t.FP(0)).copy(i.x),a.add(i.z),a.norm(),u.mul(a),a.copy(o),a.add(s),a.rsub(u),a.norm(),u.copy(o),u.add(o),o.add(u),o.norm(),s.imul(e),(f=new t.FP(0)).copy(r),f.add(s),f.norm(),r.sub(s),r.norm(),a.imul(e),u.copy(a),u.mul(c),s.copy(h),s.mul(r),u.rsub(s),a.mul(o),r.mul(f),a.add(r),o.mul(h),f.mul(c),f.add(o),this.x.copy(u),this.x.norm(),this.y.copy(a),this.y.norm(),this.z.copy(f),this.z.norm()):((o=new t.FP(0)).copy(this.x),(r=new t.FP(0)).copy(this.y),(s=new t.FP(0)).copy(this.z),(h=new t.FP(0)).copy(this.x),(c=new t.FP(0)).copy(i.x),f=new t.FP(0),(a=new t.FP(0)).copy(i.x),(u=new t.FP(0)).copy(i.y),e=new t.FP(0),0==t.ROM_CURVE.CURVE_B_I&&e.rcopy(t.ROM_CURVE.CURVE_B),o.mul(i.x),r.mul(i.y),s.mul(i.z),h.add(this.y),h.norm(),c.add(i.y),c.norm(),h.mul(c),c.copy(o),c.add(r),h.sub(c),h.norm(),c.copy(this.y),c.add(this.z),c.norm(),u.add(i.z),u.norm(),c.mul(u),u.copy(r),u.add(s),c.sub(u),c.norm(),u.copy(this.x),u.add(this.z),u.norm(),a.add(i.z),a.norm(),u.mul(a),a.copy(o),a.add(s),a.rsub(u),a.norm(),f.copy(s),0==t.ROM_CURVE.CURVE_B_I?f.mul(e):f.imul(t.ROM_CURVE.CURVE_B_I),u.copy(a),u.sub(f),u.norm(),f.copy(u),f.add(u),u.add(f),f.copy(r),f.sub(u),f.norm(),u.add(r),u.norm(),0==t.ROM_CURVE.CURVE_B_I?a.mul(e):a.imul(t.ROM_CURVE.CURVE_B_I),r.copy(s),r.add(s),s.add(r),a.sub(s),a.sub(o),a.norm(),r.copy(a),r.add(a),a.add(r),a.norm(),r.copy(o),r.add(o),o.add(r),o.sub(s),o.norm(),r.copy(c),r.mul(a),s.copy(o),s.mul(a),a.copy(u),a.mul(f),a.add(s),u.mul(h),u.sub(r),f.mul(c),r.copy(h),r.mul(o),f.add(r),this.x.copy(u),this.x.norm(),this.y.copy(a),this.y.norm(),this.z.copy(f),this.z.norm())),n.CURVETYPE==n.EDWARDS&&((E=new t.FP(0)).copy(this.z),B=new t.FP(0),(y=new t.FP(0)).copy(this.x),(I=new t.FP(0)).copy(this.y),p=new t.FP(0),m=new t.FP(0),d=new t.FP(0),E.mul(i.z),B.copy(E),B.sqr(),y.mul(i.x),I.mul(i.y),p.copy(y),p.mul(I),0==t.ROM_CURVE.CURVE_B_I?((e=new t.FP(0)).rcopy(t.ROM_CURVE.CURVE_B),p.mul(e)):p.imul(t.ROM_CURVE.CURVE_B_I),m.copy(B),m.sub(p),d.copy(B),d.add(p),1==t.ROM_CURVE.CURVE_A&&(p.copy(I),p.sub(y)),y.add(I),B.copy(this.x),B.add(this.y),I.copy(i.x),I.add(i.y),B.norm(),I.norm(),B.mul(I),B.sub(y),B.norm(),m.norm(),B.mul(m),this.x.copy(E),this.x.mul(B),d.norm(),1==t.ROM_CURVE.CURVE_A&&(p.norm(),y.copy(p),y.mul(d)),-1==t.ROM_CURVE.CURVE_A&&(y.norm(),y.mul(d)),this.y.copy(E),this.y.mul(y),this.z.copy(m),this.z.mul(d))},dadd:function(n,i){var e,o,r,s,h,c;(e=new t.FP(0)).copy(this.x),(o=new t.FP(0)).copy(this.x),(r=new t.FP(0)).copy(n.x),(s=new t.FP(0)).copy(n.x),h=new t.FP(0),c=new t.FP(0),e.add(this.z),o.sub(this.z),r.add(n.z),s.sub(n.z),s.norm(),e.norm(),h.copy(s),h.mul(e),r.norm(),o.norm(),c.copy(r),c.mul(o),e.copy(h),e.add(c),e.norm(),e.sqr(),o.copy(h),o.sub(c),o.norm(),o.sqr(),this.x.copy(e),this.z.copy(i.x),this.z.mul(o)},sub:function(t){t.neg(),this.add(t),t.neg()},pinmul:function(i,e){var o,r,s,h,c;if(n.CURVETYPE==n.MONTGOMERY)return this.mul(new t.BIG(i));for(s=new n,h=new n,(c=new n).copy(this),o=e-1;o>=0;o--)r=i>>o&1,s.copy(c),s.add(h),h.cswap(c,r),c.copy(s),h.dbl(),h.cswap(c,r);return s.copy(h),s.affine(),s},cfp:function(){var n=t.ROM_CURVE.CURVE_Cof_I,i=new t.BIG(0);if(1!=n){if(4==n)return this.dbl(),this.dbl(),void this.affine();if(8==n)return this.dbl(),this.dbl(),this.dbl(),void this.affine();i.rcopy(t.ROM_CURVE.CURVE_Cof),this.copy(this.mul(i))}},mul:function(i){var e,o,r,s,h,c,u,a,f,E,B,y,I,p,m;if(i.iszilch()||this.is_infinity())return new n;if(e=new n,n.CURVETYPE==n.MONTGOMERY){for(o=new n,(r=new n).copy(this),(s=new n).copy(this),s.dbl(),o.copy(this),o.affine(),B=(I=i.nbits())-2;B>=0;B--)y=i.bit(B),e.copy(s),e.dadd(r,o),r.cswap(s,y),s.copy(e),r.dbl(),r.cswap(s,y);e.copy(r)}else{for(h=new t.BIG,c=new t.BIG,u=new n,a=new n,f=[],E=[],this.affine(),u.copy(this),u.dbl(),f[0]=new n,f[0].copy(this),B=1;B<8;B++)f[B]=new n,f[B].copy(f[B-1]),f[B].add(u);for(c.copy(i),p=c.parity(),c.inc(1),c.norm(),m=c.parity(),h.copy(c),h.inc(1),h.norm(),c.cmove(h,p),u.cmove(this,m),a.copy(u),I=1+Math.floor((c.nbits()+3)/4),B=0;B<I;B++)E[B]=c.lastbits(5)-16,c.dec(E[B]),c.norm(),c.fshr(4);for(E[I]=c.lastbits(5),e.copy(f[Math.floor((E[I]-1)/2)]),B=I-1;B>=0;B--)u.select(f,E[B]),e.dbl(),e.dbl(),e.dbl(),e.dbl(),e.add(u);e.sub(a)}return e.affine(),e},mul2:function(i,e,o){var r,s,h,c,u,a,f=new t.BIG,E=new t.BIG,B=new t.BIG,y=new n,I=new n,p=new n,m=[],d=[];for(this.affine(),e.affine(),f.copy(i),E.copy(o),m[1]=new n,m[1].copy(this),m[1].sub(e),m[2]=new n,m[2].copy(this),m[2].add(e),y.copy(e),y.dbl(),m[0]=new n,m[0].copy(m[1]),m[0].sub(y),m[3]=new n,m[3].copy(m[2]),m[3].add(y),I.copy(this),I.dbl(),m[5]=new n,m[5].copy(m[1]),m[5].add(I),m[6]=new n,m[6].copy(m[2]),m[6].add(I),m[4]=new n,m[4].copy(m[5]),m[4].sub(y),m[7]=new n,m[7].copy(m[6]),m[7].add(y),s=f.parity(),f.inc(1),f.norm(),h=f.parity(),B.copy(f),B.inc(1),B.norm(),f.cmove(B,s),I.cmove(this,h),p.copy(I),s=E.parity(),E.inc(1),E.norm(),h=E.parity(),B.copy(E),B.inc(1),B.norm(),E.cmove(B,s),y.cmove(e,h),p.add(y),B.copy(f),B.add(E),B.norm(),c=1+Math.floor((B.nbits()+1)/2),r=0;r<c;r++)u=f.lastbits(3)-4,f.dec(u),f.norm(),f.fshr(2),a=E.lastbits(3)-4,E.dec(a),E.norm(),E.fshr(2),d[r]=4*u+a;for(d[c]=4*f.lastbits(3)+E.lastbits(3),y.copy(m[Math.floor((d[c]-1)/2)]),r=c-1;r>=0;r--)I.select(m,d[r]),y.dbl(),y.dbl(),y.add(I);return y.sub(p),y.affine(),y}},n.generator=function(){var i=new n,e=new t.BIG(0),o=new t.BIG(0);return e.rcopy(t.ROM_CURVE.CURVE_Gx),t.ECP.CURVETYPE!=t.ECP.MONTGOMERY?(o.rcopy(t.ROM_CURVE.CURVE_Gy),i.setxy(e,o)):i.setx(e),i},n.teq=function(t,n){var i=t^n;return(i-=1)>>31&1},n.fromBytes=function(i){var e,o,r,s=[],h=new n,c=new t.BIG(0);for(c.rcopy(t.ROM_FIELD.Modulus),r=0;r<t.BIG.MODBYTES;r++)s[r]=i[r+1];if(e=t.BIG.fromBytes(s),t.BIG.comp(e,c)>=0)return h;if(4==i[0]){for(r=0;r<t.BIG.MODBYTES;r++)s[r]=i[r+t.BIG.MODBYTES+1];return o=t.BIG.fromBytes(s),t.BIG.comp(o,c)>=0||h.setxy(e,o),h}return h.setx(e),h},n.RHS=function(i){var e,o,r,s,h=new t.FP(0);return i.norm(),h.copy(i),h.sqr(),n.CURVETYPE==n.WEIERSTRASS?((e=new t.FP(0)).rcopy(t.ROM_CURVE.CURVE_B),h.mul(i),-3==t.ROM_CURVE.CURVE_A&&((o=new t.FP(0)).copy(i),o.imul(3),o.neg(),o.norm(),h.add(o)),h.add(e)):n.CURVETYPE==n.EDWARDS?((e=new t.FP(0)).rcopy(t.ROM_CURVE.CURVE_B),r=new t.FP(1),e.mul(h),e.sub(r),e.norm(),-1==t.ROM_CURVE.CURVE_A&&h.neg(),h.sub(r),h.norm(),e.inverse(),h.mul(e)):n.CURVETYPE==n.MONTGOMERY&&((s=new t.FP(0)).copy(h),s.mul(i),h.imul(t.ROM_CURVE.CURVE_A),h.add(s),h.add(i)),h.reduce(),h},n.mapit=function(i){var e=new t.BIG(0),o=t.BIG.fromBytes(i),r=new n;for(e.rcopy(t.ROM_FIELD.Modulus),o.mod(e);;){for(;n.CURVETYPE!=n.MONTGOMERY?r.setxi(o,0):r.setx(o),o.inc(1),o.norm(),r.is_infinity(););if(r.cfp(),!r.is_infinity())break}return r},n}(h),h.ECDH=function(t){return{INVALID_PUBLIC_KEY:-2,ERROR:-3,INVALID:-4,EFS:t.BIG.MODBYTES,EGS:t.BIG.MODBYTES,SHA256:32,SHA384:48,SHA512:64,inttobytes:function(t,n){var i,e=[];for(i=0;i<n;i++)e[i]=0;for(i=n;t>0&&i>0;)e[--i]=255&t,t=Math.floor(t/256);return e},bytestostring:function(t){var n,i,e="",o=t.length;for(i=0;i<o;i++)n=t[i],e+=String.fromCharCode(n);return e},stringtobytes:function(t){var n,i=[];for(n=0;n<t.length;n++)i.push(t.charCodeAt(n));return i},hashit:function(n,i,e,o,r){var s,h,c,u;if(n==this.SHA256?h=new t.HASH256:n==this.SHA384?h=new t.HASH384:n==this.SHA512&&(h=new t.HASH512),e>0&&h.process_num(e),null!=o&&h.process_array(o),0==(s=h.hash()).length)return null;if(0==r)return s;if(c=[],n>=r)for(u=0;u<r;u++)c[u]=s[u];else{for(u=0;u<n;u++)c[u+r-n]=s[u];for(u=0;u<r-n;u++)c[u]=0}return c},KDF1:function(t,n,i){var e,o,r,s=t,h=[],c=[],u=0;for(r=0;r<h.length;r++)h[r]=0;for(o=Math.floor(i/s),i%s!=0&&o++,e=0;e<o;e++)if(c=this.hashit(t,n,e,null,0),u+s>i)for(r=0;r<i%s;r++)h[u++]=c[r];else for(r=0;r<s;r++)h[u++]=c[r];return h},KDF2:function(t,n,i,e){var o,r,s,h=t,c=[],u=[],a=0;for(s=0;s<c.length;s++)c[s]=0;for(r=Math.floor(e/h),e%h!=0&&r++,o=1;o<=r;o++)if(u=this.hashit(t,n,o,i,0),a+h>e)for(s=0;s<e%h;s++)c[a++]=u[s];else for(s=0;s<h;s++)c[a++]=u[s];return c},PBKDF2:function(t,n,i,e,o){var r,s,h,c,u,a,f=new Array(t),E=[],B=[],y=[],I=0;for(c=Math.floor(o/t),o%t!=0&&c++,I=0,r=1;r<=c;r++){for(s=0;s<i.length;s++)B[s]=i[s];for(u=this.inttobytes(r,4),s=0;s<4;s++)B[i.length+s]=u[s];for(this.HMAC(t,B,n,f),s=0;s<t;s++)E[s]=f[s];for(s=2;s<=e;s++)for(this.HMAC(t,E,n,E),h=0;h<t;h++)f[h]^=E[h];for(s=0;s<t;s++)y[I++]=f[s]}for(a=[],r=0;r<o;r++)a[r]=y[r];return a},HMAC:function(t,n,i,e){var o,r,s=e.length,h=[],c=64;if(t>32&&(c=128),o=new Array(c),s<4)return 0;for(r=0;r<c;r++)o[r]=0;if(i.length>c)for(h=this.hashit(t,i,0,null,0),r=0;r<t;r++)o[r]=h[r];else for(r=0;r<i.length;r++)o[r]=i[r];for(r=0;r<c;r++)o[r]^=54;for(h=this.hashit(t,o,0,n,0),r=0;r<c;r++)o[r]^=106;for(h=this.hashit(t,o,0,h,s),r=0;r<s;r++)e[r]=h[r];return 1},AES_CBC_IV0_ENCRYPT:function(n,i){var e,o,r,s,h,c,u=new t.AES,a=[],f=[];for(u.init(t.AES.CBC,n.length,n,null),h=c=0,e=!1;;){for(r=0;r<16;r++){if(!(h<i.length)){e=!0;break}a[r]=i[h++]}if(e)break;for(u.encrypt(a),r=0;r<16;r++)f[c++]=a[r]}for(o=16-r,s=r;s<16;s++)a[s]=o;for(u.encrypt(a),r=0;r<16;r++)f[c++]=a[r];return u.end(),f},AES_CBC_IV0_DECRYPT:function(n,i){var e,o,r,s,h,c,u=new t.AES,a=[],f=[],E=0,B=0;if(u.init(t.AES.CBC,n.length,n,null),0===i.length)return[];for(o=i[E++],r=!1;;){for(c=0;c<16;c++){if(a[c]=o,E>=i.length){r=!0;break}o=i[E++]}if(u.decrypt(a),r)break;for(c=0;c<16;c++)f[B++]=a[c]}if(u.end(),s=!1,h=a[15],(15!=c||h<1||h>16)&&(s=!0),h>=2&&h<=16)for(c=16-h;c<16;c++)a[c]!=h&&(s=!0);if(!s)for(c=0;c<16-h;c++)f[B++]=a[c];if(e=[],s)return e;for(c=0;c<B;c++)e[c]=f[c];return e},KEY_PAIR_GENERATE:function(n,i,e){var o,r,s;return s=t.ECP.generator(),(o=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),null===n?(r=t.BIG.fromBytes(i)).mod(o):r=t.BIG.randomnum(o,n),r.toBytes(i),s.mul(r).toBytes(e,!1),0},PUBLIC_KEY_VALIDATE:function(n){var i,e,o,r,s=t.ECP.fromBytes(n),h=0;if((i=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),s.is_infinity()&&(h=this.INVALID_PUBLIC_KEY),0===h){for((e=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),o=e.nbits(),(r=new t.BIG(1)).shl(Math.floor((o+4)/2)),r.add(e),r.div(i);0==r.parity();)r.shr(1),s.dbl();r.isunity()||(s=s.mul(r)),s.is_infinity()&&(h=this.INVALID_PUBLIC_KEY)}return h},ECPSVDP_DH:function(n,i,e){var o,r,s,h,c=[],u=0;if(r=t.BIG.fromBytes(n),(h=t.ECP.fromBytes(i)).is_infinity()&&(u=this.ERROR),0===u)if((o=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),r.mod(o),(h=h.mul(r)).is_infinity())u=this.ERROR;else for(h.getX().toBytes(c),s=0;s<this.EFS;s++)e[s]=c[s];return u},ECPSP_DSA:function(n,i,e,o,r,s){var h,c,u,a,f,E,B,y,I,p,m,d,l=[];d=this.hashit(n,o,0,null,t.BIG.MODBYTES),p=t.ECP.generator(),(c=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),u=t.BIG.fromBytes(e),a=t.BIG.fromBytes(d),f=new t.BIG(0),E=new t.BIG(0),m=new t.ECP;do{B=t.BIG.randomnum(c,i),I=t.BIG.randomnum(c,i),m.copy(p),y=(m=m.mul(B)).getX(),f.copy(y),f.mod(c),f.iszilch()||((B=t.BIG.modmul(B,I,c)).invmodp(c),(E=t.BIG.modmul(u,f,c)).add(a),E=t.BIG.modmul(E,I,c),E=t.BIG.modmul(B,E,c))}while(E.iszilch());for(f.toBytes(l),h=0;h<this.EFS;h++)r[h]=l[h];for(E.toBytes(l),h=0;h<this.EFS;h++)s[h]=l[h];return 0},ECPVP_DSA:function(n,i,e,o,r){var s,h,c,u,a,f,E,B,y,I=0;return s=this.hashit(n,e,0,null,t.BIG.MODBYTES),E=t.ECP.generator(),(h=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),u=t.BIG.fromBytes(o),a=t.BIG.fromBytes(r),c=t.BIG.fromBytes(s),(u.iszilch()||t.BIG.comp(u,h)>=0||a.iszilch()||t.BIG.comp(a,h)>=0)&&(I=this.INVALID),0===I&&(a.invmodp(h),c=t.BIG.modmul(c,a,h),f=t.BIG.modmul(u,a,h),(B=t.ECP.fromBytes(i)).is_infinity()?I=this.ERROR:((y=new t.ECP).copy(B),(y=y.mul2(f,E,c)).is_infinity()?I=this.INVALID:((a=y.getX()).mod(h),0!==t.BIG.comp(a,u)&&(I=this.INVALID)))),I},ECIES_ENCRYPT:function(n,i,e,o,r,s,h,c){var u,a,f,E,B=[],y=[],I=[],p=[],m=[],d=[];if(0!==this.KEY_PAIR_GENERATE(o,m,h))return d;if(0!==this.ECPSVDP_DH(m,r,B))return d;for(E=0;E<2*this.EFS+1;E++)y[E]=h[E];for(E=0;E<this.EFS;E++)y[2*this.EFS+1+E]=B[E];for(u=this.KDF2(n,y,i,2*t.ECP.AESKEY),E=0;E<t.ECP.AESKEY;E++)I[E]=u[E],p[E]=u[t.ECP.AESKEY+E];for(d=this.AES_CBC_IV0_ENCRYPT(I,s),a=this.inttobytes(e.length,8),f=[],E=0;E<d.length;E++)f[E]=d[E];for(E=0;E<e.length;E++)f[d.length+E]=e[E];for(E=0;E<8;E++)f[d.length+e.length+E]=a[E];return this.HMAC(n,f,p,c),d},ECIES_DECRYPT:function(n,i,e,o,r,s,h){var c,u,a,f,E,B=[],y=[],I=[],p=[],m=new Array(s.length),d=[];if(0!==this.ECPSVDP_DH(h,o,B))return d;for(E=0;E<2*this.EFS+1;E++)y[E]=o[E];for(E=0;E<this.EFS;E++)y[2*this.EFS+1+E]=B[E];for(c=this.KDF2(n,y,i,2*t.ECP.AESKEY),E=0;E<t.ECP.AESKEY;E++)I[E]=c[E],p[E]=c[t.ECP.AESKEY+E];if(0===(d=this.AES_CBC_IV0_DECRYPT(I,r)).length)return d;for(u=this.inttobytes(e.length,8),a=[],E=0;E<r.length;E++)a[E]=r[E];for(E=0;E<e.length;E++)a[r.length+E]=e[E];for(E=0;E<8;E++)a[r.length+e.length+E]=u[E];for(this.HMAC(n,a,p,m),f=!0,E=0;E<s.length;E++)s[E]!=m[E]&&(f=!1);return f?d:[]}}}(h),1!=h.config["@PF"]&&2!=h.config["@PF"]||(h.FP2=t(h),h.FP4=n(h),h.FP12=function(t){var n=function(i,e,o){i instanceof n?(this.a=new t.FP4(i.a),this.b=new t.FP4(i.b),this.c=new t.FP4(i.c)):(this.a=new t.FP4(i),this.b=new t.FP4(e),this.c=new t.FP4(o))};return n.prototype={reduce:function(){this.a.reduce(),this.b.reduce(),this.c.reduce()},norm:function(){this.a.norm(),this.b.norm(),this.c.norm()},iszilch:function(){return this.reduce(),this.a.iszilch()&&this.b.iszilch()&&this.c.iszilch()},isunity:function(){var n=new t.FP4(1);return this.a.equals(n)&&this.b.iszilch()&&this.c.iszilch()},cmove:function(t,n){this.a.cmove(t.a,n),this.b.cmove(t.b,n),this.c.cmove(t.c,n)},select:function(t,i){var e,o,r=new n(0);o=((o=(i^(e=i>>31))-e)-1)/2,this.cmove(t[0],n.teq(o,0)),this.cmove(t[1],n.teq(o,1)),this.cmove(t[2],n.teq(o,2)),this.cmove(t[3],n.teq(o,3)),this.cmove(t[4],n.teq(o,4)),this.cmove(t[5],n.teq(o,5)),this.cmove(t[6],n.teq(o,6)),this.cmove(t[7],n.teq(o,7)),r.copy(this),r.conj(),this.cmove(r,1&e)},geta:function(){return this.a},getb:function(){return this.b},getc:function(){return this.c},equals:function(t){return this.a.equals(t.a)&&this.b.equals(t.b)&&this.c.equals(t.c)},copy:function(t){this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c)},one:function(){this.a.one(),this.b.zero(),this.c.zero()},conj:function(){this.a.conj(),this.b.nconj(),this.c.conj()},set:function(t,n,i){this.a.copy(t),this.b.copy(n),this.c.copy(i)},seta:function(t){this.a.copy(t),this.b.zero(),this.c.zero()},usqr:function(){var n=new t.FP4(this.a),i=new t.FP4(this.c),e=new t.FP4(this.b),o=new t.FP4(0);this.a.sqr(),o.copy(this.a),o.add(this.a),this.a.add(o),n.nconj(),n.add(n),this.a.add(n),i.sqr(),i.times_i(),o.copy(i),o.add(i),i.add(o),e.sqr(),o.copy(e),o.add(e),e.add(o),this.b.conj(),this.b.add(this.b),this.c.nconj(),this.c.add(this.c),this.b.add(i),this.c.add(e),this.reduce()},sqr:function(){var n=new t.FP4(this.a),i=new t.FP4(this.b),e=new t.FP4(this.c),o=new t.FP4(this.a);n.sqr(),i.mul(this.c),i.add(i),e.sqr(),o.mul(this.b),o.add(o),this.c.add(this.a),this.c.add(this.b),this.c.norm(),this.c.sqr(),this.a.copy(n),n.add(i),n.add(e),n.add(o),n.neg(),i.times_i(),e.times_i(),this.a.add(i),this.b.copy(e),this.b.add(o),this.c.add(n),this.norm()},mul:function(n){var i=new t.FP4(this.a),e=new t.FP4(0),o=new t.FP4(this.b),r=new t.FP4(0),s=new t.FP4(this.a),h=new t.FP4(n.a);i.mul(n.a),o.mul(n.b),s.add(this.b),h.add(n.b),s.norm(),h.norm(),e.copy(s),e.mul(h),s.copy(this.b),s.add(this.c),h.copy(n.b),h.add(n.c),s.norm(),h.norm(),r.copy(s),r.mul(h),s.copy(i),s.neg(),h.copy(o),h.neg(),e.add(s),this.b.copy(e),this.b.add(h),r.add(h),o.add(s),s.copy(this.a),s.add(this.c),h.copy(n.a),h.add(n.c),s.norm(),h.norm(),s.mul(h),o.add(s),s.copy(this.c),s.mul(n.c),h.copy(s),h.neg(),this.c.copy(o),this.c.add(h),r.add(h),s.times_i(),this.b.add(s),r.times_i(),this.a.copy(i),this.a.add(r),this.norm()},smul:function(n,i){var e,o,r,s,h,c;i==t.ECP.D_TYPE&&(e=new t.FP4(this.a),r=new t.FP4(this.b),s=new t.FP4(this.b),h=new t.FP4(0),c=new t.FP4(n.a),e.mul(n.a),r.pmul(n.b.real()),this.b.add(this.a),c.real().add(n.b.real()),this.b.norm(),c.norm(),this.b.mul(c),s.add(this.c),s.norm(),s.pmul(n.b.real()),h.copy(e),h.neg(),c.copy(r),c.neg(),this.b.add(h),this.b.add(c),s.add(c),r.add(h),h.copy(this.a),h.add(this.c),h.norm(),h.mul(n.a),this.c.copy(r),this.c.add(h),s.times_i(),this.a.copy(e),this.a.add(s)),i==t.ECP.M_TYPE&&(e=new t.FP4(this.a),o=new t.FP4(0),r=new t.FP4(0),s=new t.FP4(0),h=new t.FP4(this.a),c=new t.FP4(0),e.mul(n.a),h.add(this.b),h.norm(),o.copy(h),o.mul(n.a),h.copy(this.b),h.add(this.c),h.norm(),s.copy(h),s.pmul(n.c.getb()),s.times_i(),h.copy(e),h.neg(),o.add(h),this.b.copy(o),r.copy(h),h.copy(this.a),h.add(this.c),c.copy(n.a),c.add(n.c),h.norm(),c.norm(),h.mul(c),r.add(h),h.copy(this.c),h.pmul(n.c.getb()),h.times_i(),c.copy(h),c.neg(),this.c.copy(r),this.c.add(c),s.add(c),h.times_i(),this.b.add(h),s.norm(),s.times_i(),this.a.copy(e),this.a.add(s)),this.norm()},inverse:function(){var n=new t.FP4(this.a),i=new t.FP4(this.b),e=new t.FP4(this.a),o=new t.FP4(0);n.sqr(),i.mul(this.c),i.times_i(),n.sub(i),n.norm(),i.copy(this.c),i.sqr(),i.times_i(),e.mul(this.b),i.sub(e),i.norm(),e.copy(this.b),e.sqr(),o.copy(this.a),o.mul(this.c),e.sub(o),e.norm(),o.copy(this.b),o.mul(e),o.times_i(),this.a.mul(n),o.add(this.a),this.c.mul(i),this.c.times_i(),o.add(this.c),o.norm(),o.inverse(),this.a.copy(n),this.a.mul(o),this.b.copy(i),this.b.mul(o),this.c.copy(e),this.c.mul(o)},frob:function(n){var i=new t.FP2(n),e=new t.FP2(n);i.sqr(),e.mul(i),this.a.frob(e),this.b.frob(e),this.c.frob(e),this.b.pmul(n),this.c.pmul(i)},trace:function(){var n=new t.FP4(0);return n.copy(this.a),n.imul(3),n.reduce(),n},toString:function(){return"["+this.a.toString()+","+this.b.toString()+","+this.c.toString()+"]"},toBytes:function(n){var i,e=[];for(this.a.geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i]=e[i];for(this.a.geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+t.BIG.MODBYTES]=e[i];for(this.a.getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+2*t.BIG.MODBYTES]=e[i];for(this.a.getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+3*t.BIG.MODBYTES]=e[i];for(this.b.geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+4*t.BIG.MODBYTES]=e[i];for(this.b.geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+5*t.BIG.MODBYTES]=e[i];for(this.b.getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+6*t.BIG.MODBYTES]=e[i];for(this.b.getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+7*t.BIG.MODBYTES]=e[i];for(this.c.geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+8*t.BIG.MODBYTES]=e[i];for(this.c.geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+9*t.BIG.MODBYTES]=e[i];for(this.c.getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+10*t.BIG.MODBYTES]=e[i];for(this.c.getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+11*t.BIG.MODBYTES]=e[i]},pow:function(i){var e,o,r,s;for(this.norm(),i.norm(),(e=new t.BIG(i)).pmul(3),e.norm(),o=new n(this),r=e.nbits()-2;r>=1;r--)o.usqr(),1==(s=e.bit(r)-i.bit(r))&&o.mul(this),-1==s&&(this.conj(),o.mul(this),this.conj());return o.reduce(),o},pinpow:function(t,i){var e,o,r=[];for(r[0]=new n(1),r[1]=new n(this),e=i-1;e>=0;e--)r[1-(o=t>>e&1)].mul(r[o]),r[o].usqr();this.copy(r[0])},compow:function(i,e){var o,r,s,h,c,u,a,f,E,B,y,I,p;return(o=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(r=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),s=new t.FP2(o,r),(h=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),(c=new t.BIG(h)).mod(e),(u=new t.BIG(i)).mod(c),(a=new t.BIG(i)).div(c),f=new n(0),E=new n(0),f.copy(this),B=f.trace(),a.iszilch()?B=B.xtr_pow(i):(E.copy(f),E.frob(s),y=E.trace(),f.conj(),E.mul(f),I=E.trace(),E.mul(f),p=E.trace(),B=B.xtr_pow2(y,I,p,u,a))}},n.fromBytes=function(i){var e,o,r,s,h,c,u,a,f=[];for(e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e];for(o=t.BIG.fromBytes(f),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+t.BIG.MODBYTES];for(r=t.BIG.fromBytes(f),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+2*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(f),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+3*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(f),h=new t.FP2(o,r),c=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+4*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(f),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+5*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(f),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+6*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(f),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+7*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(f),h=new t.FP2(o,r),u=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+8*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(f),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+9*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(f),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+10*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(f),e=0;e<t.BIG.MODBYTES;e++)f[e]=i[e+11*t.BIG.MODBYTES];return r=t.BIG.fromBytes(f),h=new t.FP2(o,r),a=new t.FP4(s,h),new n(c,u,a)},n.teq=function(t,n){var i=t^n;return(i-=1)>>31&1},n.pow4=function(i,e){var o,r,s,h,c,u,a=[],f=new n(0),E=new n(0),B=[],y=new t.BIG(0),I=[],p=[];for(o=0;o<4;o++)B[o]=new t.BIG(e[o]),B[o].norm();for(a[0]=new n(i[0]),a[1]=new n(a[0]),a[1].mul(i[1]),a[2]=new n(a[0]),a[2].mul(i[2]),a[3]=new n(a[1]),a[3].mul(i[2]),a[4]=new n(i[0]),a[4].mul(i[3]),a[5]=new n(a[1]),a[5].mul(i[3]),a[6]=new n(a[2]),a[6].mul(i[3]),a[7]=new n(a[3]),a[7].mul(i[3]),u=1-B[0].parity(),B[0].inc(u),B[0].norm(),y.zero(),o=0;o<4;o++)y.or(B[o]);for(p[(h=1+y.nbits())-1]=1,o=0;o<h-1;o++)B[0].fshr(1),p[o]=2*B[0].parity()-1;for(o=0;o<h;o++)for(I[o]=0,s=1,r=1;r<4;r++)c=p[o]*B[r].parity(),B[r].fshr(1),B[r].dec(c>>1),B[r].norm(),I[o]+=c*s,s*=2;for(E.select(a,2*I[h-1]+1),o=h-2;o>=0;o--)E.usqr(),f.select(a,2*I[o]+p[o]),E.mul(f);return f.copy(i[0]),f.conj(),f.mul(E),E.cmove(f,u),E.reduce(),E},n}(h),h.ECP2=function(t){var n=function(){this.x=new t.FP2(0),this.y=new t.FP2(1),this.z=new t.FP2(0)};return n.prototype={is_infinity:function(){return this.x.reduce(),this.y.reduce(),this.z.reduce(),this.x.iszilch()&&this.z.iszilch()},copy:function(t){this.x.copy(t.x),this.y.copy(t.y),this.z.copy(t.z)},inf:function(){this.x.zero(),this.y.one(),this.z.zero()},cmove:function(t,n){this.x.cmove(t.x,n),this.y.cmove(t.y,n),this.z.cmove(t.z,n)},select:function(t,i){var e,o,r=new n;o=((o=(i^(e=i>>31))-e)-1)/2,this.cmove(t[0],n.teq(o,0)),this.cmove(t[1],n.teq(o,1)),this.cmove(t[2],n.teq(o,2)),this.cmove(t[3],n.teq(o,3)),this.cmove(t[4],n.teq(o,4)),this.cmove(t[5],n.teq(o,5)),this.cmove(t[6],n.teq(o,6)),this.cmove(t[7],n.teq(o,7)),r.copy(this),r.neg(),this.cmove(r,1&e)},equals:function(n){var i,e;return(i=new t.FP2(0)).copy(this.x),(e=new t.FP2(0)).copy(n.x),i.copy(this.x),i.mul(n.z),i.reduce(),e.copy(n.x),e.mul(this.z),e.reduce(),!!i.equals(e)&&(i.copy(this.y),i.mul(n.z),i.reduce(),e.copy(n.y),e.mul(this.z),e.reduce(),!!i.equals(e))},neg:function(){this.y.norm(),this.y.neg(),this.y.norm()},affine:function(){var n;if(!this.is_infinity()){if(n=new t.FP2(1),this.z.equals(n))return this.x.reduce(),void this.y.reduce();this.z.inverse(),this.x.mul(this.z),this.x.reduce(),this.y.mul(this.z),this.y.reduce(),this.z.copy(n)}},getX:function(){return this.affine(),this.x},getY:function(){return this.affine(),this.y},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},toBytes:function(n){var i,e=[];for(this.affine(),this.x.getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i]=e[i];for(this.x.getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+t.BIG.MODBYTES]=e[i];for(this.y.getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+2*t.BIG.MODBYTES]=e[i];for(this.y.getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+3*t.BIG.MODBYTES]=e[i]},toString:function(){return this.is_infinity()?"infinity":(this.affine(),"("+this.x.toString()+","+this.y.toString()+")")},setxy:function(i,e){var o,r;this.x.copy(i),this.y.copy(e),this.z.one(),o=n.RHS(this.x),(r=new t.FP2(this.y)).sqr(),r.equals(o)||this.inf()},setx:function(t){var i;this.x.copy(t),this.z.one(),(i=n.RHS(this.x)).sqrt()?this.y.copy(i):this.inf()},frob:function(n){var i;(i=new t.FP2(n)).sqr(),this.x.conj(),this.y.conj(),this.z.conj(),this.z.reduce(),this.x.mul(i),this.y.mul(i),this.y.mul(n)},dbl:function(){var n,i,e,o,r,s;return(n=new t.FP2(0)).copy(this.y),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(n.mul_ip(),n.norm()),(i=new t.FP2(0)).copy(this.y),i.sqr(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&i.mul_ip(),(e=new t.FP2(0)).copy(n),e.mul(this.z),(o=new t.FP2(0)).copy(this.z),o.sqr(),this.z.copy(i),this.z.add(i),this.z.norm(),this.z.add(this.z),this.z.add(this.z),this.z.norm(),o.imul(3*t.ROM_CURVE.CURVE_B_I),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(o.mul_ip(),o.norm()),(r=new t.FP2(0)).copy(o),r.mul(this.z),(s=new t.FP2(0)).copy(i),s.add(o),s.norm(),this.z.mul(e),e.copy(o),e.add(o),o.add(e),o.norm(),i.sub(o),i.norm(),s.mul(i),s.add(r),e.copy(this.x),e.mul(n),this.x.copy(i),this.x.norm(),this.x.mul(e),this.x.add(this.x),this.x.norm(),this.y.copy(s),this.y.norm(),1},add:function(n){var i,e,o,r,s,h,c,u,a;return i=3*t.ROM_CURVE.CURVE_B_I,(e=new t.FP2(0)).copy(this.x),e.mul(n.x),(o=new t.FP2(0)).copy(this.y),o.mul(n.y),(r=new t.FP2(0)).copy(this.z),r.mul(n.z),(s=new t.FP2(0)).copy(this.x),s.add(this.y),s.norm(),(h=new t.FP2(0)).copy(n.x),h.add(n.y),h.norm(),s.mul(h),h.copy(e),h.add(o),s.sub(h),s.norm(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(s.mul_ip(),s.norm()),h.copy(this.y),h.add(this.z),h.norm(),(c=new t.FP2(0)).copy(n.y),c.add(n.z),c.norm(),h.mul(c),c.copy(o),c.add(r),h.sub(c),h.norm(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(h.mul_ip(),h.norm()),c.copy(this.x),c.add(this.z),c.norm(),(u=new t.FP2(0)).copy(n.x),u.add(n.z),u.norm(),c.mul(u),u.copy(e),u.add(r),u.rsub(c),u.norm(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(e.mul_ip(),e.norm(),o.mul_ip(),o.norm()),c.copy(e),c.add(e),e.add(c),e.norm(),r.imul(i),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&r.mul_ip(),(a=new t.FP2(0)).copy(o),a.add(r),a.norm(),o.sub(r),o.norm(),u.imul(i),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(u.mul_ip(),u.norm()),c.copy(u),c.mul(h),r.copy(s),r.mul(o),c.rsub(r),u.mul(e),o.mul(a),u.add(o),e.mul(s),a.mul(h),a.add(e),this.x.copy(c),this.x.norm(),this.y.copy(u),this.y.norm(),this.z.copy(a),this.z.norm(),0},sub:function(t){var n;return t.neg(),n=this.add(t),t.neg(),n},mul:function(i){var e,o,r,s,h=new t.BIG,c=new t.BIG,u=new n,a=new n,f=new n,E=[],B=[];if(this.is_infinity())return new n;for(this.affine(),f.copy(this),f.dbl(),E[0]=new n,E[0].copy(this),e=1;e<8;e++)E[e]=new n,E[e].copy(E[e-1]),E[e].add(f);for(c.copy(i),r=c.parity(),c.inc(1),c.norm(),s=c.parity(),h.copy(c),h.inc(1),h.norm(),c.cmove(h,r),f.cmove(this,s),u.copy(f),o=1+Math.floor((c.nbits()+3)/4),e=0;e<o;e++)B[e]=c.lastbits(5)-16,c.dec(B[e]),c.norm(),c.fshr(4);for(B[o]=c.lastbits(5),a.copy(E[Math.floor((B[o]-1)/2)]),e=o-1;e>=0;e--)f.select(E,B[e]),a.dbl(),a.dbl(),a.dbl(),a.dbl(),a.add(f);return a.sub(u),a.affine(),a}},n.generator=function(){var i,e,o=new n,r=new t.BIG(0),s=new t.BIG(0);return r.rcopy(t.ROM_CURVE.CURVE_Pxa),s.rcopy(t.ROM_CURVE.CURVE_Pxb),(i=new t.FP2(0)).bset(r,s),r.rcopy(t.ROM_CURVE.CURVE_Pya),s.rcopy(t.ROM_CURVE.CURVE_Pyb),(e=new t.FP2(0)).bset(r,s),o.setxy(i,e),o},n.fromBytes=function(i){var e,o,r,s,h,c,u=[];for(r=0;r<t.BIG.MODBYTES;r++)u[r]=i[r];for(e=t.BIG.fromBytes(u),r=0;r<t.BIG.MODBYTES;r++)u[r]=i[r+t.BIG.MODBYTES];for(o=t.BIG.fromBytes(u),s=new t.FP2(e,o),r=0;r<t.BIG.MODBYTES;r++)u[r]=i[r+2*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(u),r=0;r<t.BIG.MODBYTES;r++)u[r]=i[r+3*t.BIG.MODBYTES];return o=t.BIG.fromBytes(u),h=new t.FP2(e,o),(c=new n).setxy(s,h),c},n.RHS=function(n){var i,e,o;return n.norm(),(i=new t.FP2(n)).sqr(),(e=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_B),o=new t.FP2(e),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&o.div_ip(),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(o.norm(),o.mul_ip(),o.norm()),i.mul(n),i.add(o),i.reduce(),i},n.mul4=function(i,e){var o,r,s,h,c,u,a=new n,f=new n,E=[],B=new t.BIG,y=[],I=[],p=[];for(o=0;o<4;o++)y[o]=new t.BIG(e[o]),y[o].norm(),i[o].affine();for(E[0]=new n,E[0].copy(i[0]),E[1]=new n,E[1].copy(E[0]),E[1].add(i[1]),E[2]=new n,E[2].copy(E[0]),E[2].add(i[2]),E[3]=new n,E[3].copy(E[1]),E[3].add(i[2]),E[4]=new n,E[4].copy(E[0]),E[4].add(i[3]),E[5]=new n,E[5].copy(E[1]),E[5].add(i[3]),E[6]=new n,E[6].copy(E[2]),E[6].add(i[3]),E[7]=new n,E[7].copy(E[3]),E[7].add(i[3]),u=1-y[0].parity(),y[0].inc(u),y[0].norm(),B.zero(),o=0;o<4;o++)B.or(y[o]);for(p[(h=1+B.nbits())-1]=1,o=0;o<h-1;o++)y[0].fshr(1),p[o]=2*y[0].parity()-1;for(o=0;o<h;o++)for(I[o]=0,s=1,r=1;r<4;r++)c=p[o]*y[r].parity(),y[r].fshr(1),y[r].dec(c>>1),y[r].norm(),I[o]+=c*s,s*=2;for(f.select(E,2*I[h-1]+1),o=h-2;o>=0;o--)f.dbl(),a.select(E,2*I[o]+p[o]),f.add(a);return a.copy(f),a.sub(i[0]),f.cmove(a,u),f.affine(),f},n.teq=function(t,n){var i=t^n;return(i-=1)>>31&1},n.mapit=function(i){var e,o,r,s,h,c,u,a,f,E=new t.BIG(0),B=new t.BIG(0);for((e=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),o=t.BIG.fromBytes(i),r=new t.BIG(1),o.mod(e);u=new t.FP2(r,o),(s=new n).setx(u),s.is_infinity();)o.inc(1),o.norm();return E.rcopy(t.ROM_FIELD.Fra),B.rcopy(t.ROM_FIELD.Frb),u=new t.FP2(E,B),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(u.inverse(),u.norm()),(o=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),t.ECP.CURVE_PAIRING_TYPE==t.ECP.BN&&((h=new n).copy(s),h=h.mul(o),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&h.neg(),(c=new n).copy(h),c.dbl(),c.add(h),c.frob(u),s.frob(u),s.frob(u),s.frob(u),s.add(h),s.add(c),h.frob(u),h.frob(u),s.add(h)),t.ECP.CURVE_PAIRING_TYPE==t.ECP.BLS&&(f=(a=s.mul(o)).mul(o),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&a.neg(),f.sub(a),f.sub(s),a.sub(s),a.frob(u),s.dbl(),s.frob(u),s.frob(u),s.add(f),s.add(a)),s.affine(),s},n}(h),h.PAIR=function(t){var n={line:function(n,i,e,o){var r,s,h,c,u,a,f,E,B,y,I,p=new t.FP12(1),m=new t.FP4(0);return n==i?(r=new t.FP2(n.getx()),s=new t.FP2(n.gety()),h=new t.FP2(n.getz()),(c=new t.FP2(s)).mul(h),r.sqr(),s.sqr(),h.sqr(),c.imul(4),c.neg(),c.norm(),c.pmul(o),r.imul(6),r.pmul(e),u=3*t.ROM_CURVE.CURVE_B_I,h.imul(u),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&h.div_ip2(),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(h.mul_ip(),h.add(h),c.mul_ip(),c.norm()),h.norm(),s.add(s),h.sub(s),h.norm(),y=new t.FP4(c,h),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(I=new t.FP4(r),m=new t.FP4(0)),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(I=new t.FP4(0),(m=new t.FP4(r)).times_i()),n.dbl()):(a=new t.FP2(n.getx()),f=new t.FP2(n.gety()),E=new t.FP2(n.getz()),B=new t.FP2(n.getz()),E.mul(i.gety()),B.mul(i.getx()),a.sub(B),a.norm(),f.sub(E),f.norm(),E.copy(a),a.pmul(o),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(a.mul_ip(),a.norm()),E.mul(i.gety()),B.copy(f),B.mul(i.getx()),B.sub(E),B.norm(),f.pmul(e),f.neg(),f.norm(),y=new t.FP4(a,B),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(I=new t.FP4(f),m=new t.FP4(0)),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(I=new t.FP4(0),(m=new t.FP4(f)).times_i()),n.add(i)),p.set(y,I,m),p},ate:function(i,e){var o,r,s,h,c,u,a,f,E,B,y,I,p,m;for((h=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),c=new t.BIG(h),a=new t.ECP2,t.ECP.CURVE_PAIRING_TYPE==t.ECP.BN?((o=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(r=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),s=new t.FP2(o,r),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(s.inverse(),s.norm()),c.pmul(6),t.ECP.SIGN_OF_X==t.ECP.POSITIVEX?c.inc(2):c.dec(2)):c.copy(h),c.norm(),(u=new t.BIG(c)).pmul(3),u.norm(),E=new t.FP(e.getx()),B=new t.FP(e.gety()),y=new t.ECP2,I=new t.FP12(1),y.copy(i),m=u.nbits()-2;m>=1;m--)I.sqr(),f=n.line(y,y,E,B),I.smul(f,t.ECP.SEXTIC_TWIST),1==(p=u.bit(m)-c.bit(m))&&(f=n.line(y,i,E,B),I.smul(f,t.ECP.SEXTIC_TWIST)),-1==p&&(i.neg(),f=n.line(y,i,E,B),I.smul(f,t.ECP.SEXTIC_TWIST),i.neg());return t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&I.conj(),t.ECP.CURVE_PAIRING_TYPE==t.ECP.BN&&(t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&y.neg(),a.copy(i),a.frob(s),f=n.line(y,a,E,B),I.smul(f,t.ECP.SEXTIC_TWIST),a.frob(s),a.neg(),f=n.line(y,a,E,B),I.smul(f,t.ECP.SEXTIC_TWIST)),I},ate2:function(i,e,o,r){var s,h,c,u,a,f,E,B,y,I,p,m,d,l,w,_,S;for((u=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),a=new t.BIG(u),E=new t.ECP2,t.ECP.CURVE_PAIRING_TYPE==t.ECP.BN?((s=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(h=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),c=new t.FP2(s,h),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(c.inverse(),c.norm()),a.pmul(6),t.ECP.SIGN_OF_X==t.ECP.POSITIVEX?a.inc(2):a.dec(2)):a.copy(u),a.norm(),(f=new t.BIG(a)).pmul(3),f.norm(),y=new t.FP(e.getx()),I=new t.FP(e.gety()),p=new t.FP(r.getx()),m=new t.FP(r.gety()),d=new t.ECP2,l=new t.ECP2,w=new t.FP12(1),d.copy(i),l.copy(o),S=f.nbits()-2;S>=1;S--)w.sqr(),B=n.line(d,d,y,I),w.smul(B,t.ECP.SEXTIC_TWIST),B=n.line(l,l,p,m),w.smul(B,t.ECP.SEXTIC_TWIST),1==(_=f.bit(S)-a.bit(S))&&(B=n.line(d,i,y,I),w.smul(B,t.ECP.SEXTIC_TWIST),B=n.line(l,o,p,m),w.smul(B,t.ECP.SEXTIC_TWIST)),-1==_&&(i.neg(),B=n.line(d,i,y,I),w.smul(B,t.ECP.SEXTIC_TWIST),i.neg(),o.neg(),B=n.line(l,o,p,m),w.smul(B,t.ECP.SEXTIC_TWIST),o.neg());return t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&w.conj(),t.ECP.CURVE_PAIRING_TYPE==t.ECP.BN&&(t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&(d.neg(),l.neg()),E.copy(i),E.frob(c),B=n.line(d,E,y,I),w.smul(B,t.ECP.SEXTIC_TWIST),E.frob(c),E.neg(),B=n.line(d,E,y,I),w.smul(B,t.ECP.SEXTIC_TWIST),E.copy(o),E.frob(c),B=n.line(l,E,p,m),w.smul(B,t.ECP.SEXTIC_TWIST),E.frob(c),E.neg(),B=n.line(l,E,p,m),w.smul(B,t.ECP.SEXTIC_TWIST)),w},fexp:function(n){var i,e,o,r,s,h,c,u,a,f,E,B,y,I,p,m;return(i=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(e=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),o=new t.FP2(i,e),(r=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),s=new t.FP12(n),(h=new t.FP12(s)).inverse(),s.conj(),s.mul(h),h.copy(s),s.frob(o),s.frob(o),s.mul(h),t.ECP.CURVE_PAIRING_TYPE==t.ECP.BN?(h.copy(s),h.frob(o),(c=new t.FP12(h)).frob(o),h.mul(s),c.mul(h),c.frob(o),(u=new t.FP12(s)).conj(),E=s.pow(r),t.ECP.SIGN_OF_X==t.ECP.POSITIVEX&&E.conj(),(f=new t.FP12(E)).frob(o),a=E.pow(r),t.ECP.SIGN_OF_X==t.ECP.POSITIVEX&&a.conj(),(B=new t.FP12(a)).conj(),h=a.pow(r),t.ECP.SIGN_OF_X==t.ECP.POSITIVEX&&h.conj(),a.frob(o),s.copy(a),s.conj(),E.mul(s),a.frob(o),s.copy(h),s.frob(o),h.mul(s),h.usqr(),h.mul(E),h.mul(B),s.copy(f),s.mul(B),s.mul(h),h.mul(a),s.usqr(),s.mul(h),s.usqr(),h.copy(s),h.mul(u),s.mul(c),h.usqr(),s.mul(h),s.reduce()):((y=new t.FP12(s)).usqr(),I=y.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&I.conj(),r.fshr(1),p=I.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&p.conj(),r.fshl(1),(m=new t.FP12(s)).conj(),I.mul(m),I.conj(),I.mul(p),p=I.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&p.conj(),m=p.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&m.conj(),I.conj(),m.mul(I),I.conj(),I.frob(o),I.frob(o),I.frob(o),p.frob(o),p.frob(o),I.mul(p),p=m.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&p.conj(),p.mul(y),p.mul(s),I.mul(p),p.copy(m),p.frob(o),I.mul(p),s.copy(I),s.reduce()),s},glv:function(n){var i,e,o,r,s,h,c,u,a=[];if(t.ECP.CURVE_PAIRING_TYPE==t.ECP.BN){for(i=new t.BIG(0),o=[],(e=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),c=0;c<2;c++)i.rcopy(t.ROM_CURVE.CURVE_W[c]),r=t.BIG.mul(i,n),o[c]=new t.BIG(r.div(e)),a[c]=new t.BIG(0);for(a[0].copy(n),c=0;c<2;c++)for(u=0;u<2;u++)i.rcopy(t.ROM_CURVE.CURVE_SB[u][c]),i.copy(t.BIG.modmul(o[u],i,e)),a[c].add(e),a[c].sub(i),a[c].mod(e)}else(e=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),(s=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),h=t.BIG.smul(s,s),a[0]=new t.BIG(n),a[0].mod(h),a[1]=new t.BIG(n),a[1].div(h),a[1].rsub(e);return a},gs:function(n){var i,e,o,r,s,h,c,u,a=[];if(t.ECP.CURVE_PAIRING_TYPE==t.ECP.BN){for(o=new t.BIG(0),(r=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),s=[],i=0;i<4;i++)o.rcopy(t.ROM_CURVE.CURVE_WB[i]),h=t.BIG.mul(o,n),s[i]=new t.BIG(h.div(r)),a[i]=new t.BIG(0);for(a[0].copy(n),i=0;i<4;i++)for(e=0;e<4;e++)o.rcopy(t.ROM_CURVE.CURVE_BB[e][i]),o.copy(t.BIG.modmul(s[e],o,r)),a[i].add(r),a[i].sub(o),a[i].mod(r)}else{for((c=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),(r=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),u=new t.BIG(n),i=0;i<3;i++)a[i]=new t.BIG(u),a[i].mod(c),u.div(c);a[3]=new t.BIG(u),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&(a[1].copy(t.BIG.modneg(a[1],r)),a[3].copy(t.BIG.modneg(a[3],r)))}return a},G1mul:function(i,e){var o,r,s,h,c,u,a,f;return t.ROM_CURVE.USE_GLV?(i.affine(),(o=new t.ECP).copy(i),(r=new t.ECP).copy(i),(s=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),(h=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Cru),c=new t.FP(h),u=new t.BIG(0),a=n.glv(e),r.getx().mul(c),f=a[0].nbits(),u.copy(t.BIG.modneg(a[0],s)),u.nbits()<f&&(a[0].copy(u),o.neg()),f=a[1].nbits(),u.copy(t.BIG.modneg(a[1],s)),u.nbits()<f&&(a[1].copy(u),r.neg()),a[0].norm(),a[1].norm(),o=o.mul2(a[0],r,a[1])):o=i.mul(e),o},G2mul:function(i,e){var o,r,s,h,c,u,a,f,E,B;if(t.ROM_CURVE.USE_GS_G2){for(r=[],(s=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(h=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),c=new t.FP2(s,h),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(c.inverse(),c.norm()),(u=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),a=n.gs(e),f=new t.BIG(0),i.affine(),r[0]=new t.ECP2,r[0].copy(i),E=1;E<4;E++)r[E]=new t.ECP2,r[E].copy(r[E-1]),r[E].frob(c);for(E=0;E<4;E++)B=a[E].nbits(),f.copy(t.BIG.modneg(a[E],u)),f.nbits()<B&&(a[E].copy(f),r[E].neg()),a[E].norm();o=t.ECP2.mul4(r,a)}else o=i.mul(e);return o},GTpow:function(i,e){var o,r,s,h,c,u,a,f,E,B;if(t.ROM_CURVE.USE_GS_GT){for(r=[],(s=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(h=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),c=new t.FP2(s,h),(u=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),a=new t.BIG(0),f=n.gs(e),r[0]=new t.FP12(i),E=1;E<4;E++)r[E]=new t.FP12(0),r[E].copy(r[E-1]),r[E].frob(c);for(E=0;E<4;E++)B=f[E].nbits(),a.copy(t.BIG.modneg(f[E],u)),a.nbits()<B&&(f[E].copy(a),r[E].conj()),f[E].norm();o=t.FP12.pow4(r,f)}else o=i.pow(e);return o}};return n}(h),h.MPIN=function(t){return{BAD_PARAMS:-11,INVALID_POINT:-14,WRONG_ORDER:-18,BAD_PIN:-19,MAXPIN:1e4,PBLEN:14,TS:12,TRAP:2e3,EFS:t.BIG.MODBYTES,EGS:t.BIG.MODBYTES,SHA256:32,SHA384:48,SHA512:64,today:function(){var t=new Date;return Math.floor(t.getTime()/864e5)},bytestostring:function(t){var n,i,e="",o=t.length;for(i=0;i<o;i++)e+=((n=t[i])>>>4&15).toString(16),e+=(15&n).toString(16);return e},stringtobytes:function(t){var n,i=[];for(n=0;n<t.length;n++)i.push(t.charCodeAt(n));return i},comparebytes:function(t,n){if(t.length!=n.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!=n[i])return!1;return!0},mpin_hash:function(n,i,e){var o,r,s,h,c=[],u=[];for(i.geta().getA().toBytes(u),h=0;h<this.EFS;h++)c[h]=u[h];for(i.geta().getB().toBytes(u),h=this.EFS;h<2*this.EFS;h++)c[h]=u[h-this.EFS];for(i.getb().getA().toBytes(u),h=2*this.EFS;h<3*this.EFS;h++)c[h]=u[h-2*this.EFS];for(i.getb().getB().toBytes(u),h=3*this.EFS;h<4*this.EFS;h++)c[h]=u[h-3*this.EFS];for(e.getX().toBytes(u),h=4*this.EFS;h<5*this.EFS;h++)c[h]=u[h-4*this.EFS];for(e.getY().toBytes(u),h=5*this.EFS;h<6*this.EFS;h++)c[h]=u[h-5*this.EFS];if(n==this.SHA256?r=new t.HASH256:n==this.SHA384?r=new t.HASH384:n==this.SHA512&&(r=new t.HASH512),r.process_array(c),0==(o=r.hash()).length)return null;for(s=[],h=0;h<t.ECP.AESKEY;h++)s[h]=o[h];return s},hashit:function(n,i,e){var o,r,s,h,c;if(n==this.SHA256?r=new t.HASH256:n==this.SHA384?r=new t.HASH384:n==this.SHA512&&(r=new t.HASH512),i>0&&r.process_num(i),r.process_array(e),0==(o=r.hash()).length)return null;if(s=[],n>=(c=t.BIG.MODBYTES))for(h=0;h<c;h++)s[h]=o[h];else{for(h=0;h<n;h++)s[h+c-n]=o[h];for(h=0;h<c-n;h++)s[h]=0}return s},map:function(n,i){var e=new t.ECP,o=new t.BIG(n),r=new t.BIG(0);for(r.rcopy(t.ROM_FIELD.Modulus),o.mod(r);e.setxi(o,i),e.is_infinity();)o.inc(1),o.norm();return e},unmap:function(n,i){var e=i.getS(),o=new t.ECP,r=0,s=i.getX();for(n.copy(s);n.dec(1),n.norm(),r++,o.setxi(n,e),o.is_infinity(););return r},ENCODING:function(n,i){var e,o,r,s,h,c,u,a,f,E,B=[];for(e=0;e<this.EFS;e++)B[e]=i[e+1];for(c=t.BIG.fromBytes(B),e=0;e<this.EFS;e++)B[e]=i[e+this.EFS+1];if(u=t.BIG.fromBytes(B),(a=new t.ECP(0)).setxy(c,u),a.is_infinity())return this.INVALID_POINT;for((f=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),c=t.BIG.randomnum(f,n),(s=n.getByte())<0&&(s=-s),s%=2,E=this.map(c,s),a.sub(E),h=a.getS(),o=this.unmap(u,a),(r=n.getByte())<0&&(r=-r),r%=o,u.inc(r+1),i[0]=s+2*h,c.toBytes(B),e=0;e<this.EFS;e++)i[e+1]=B[e];for(u.toBytes(B),e=0;e<this.EFS;e++)i[e+this.EFS+1]=B[e];return 0},DECODING:function(n){var i,e,o,r,s,h,c,u=[];if(4&n[0])return this.INVALID_POINT;for(i=0;i<this.EFS;i++)u[i]=n[i+1];for(r=t.BIG.fromBytes(u),i=0;i<this.EFS;i++)u[i]=n[i+this.EFS+1];for(s=t.BIG.fromBytes(u),e=1&n[0],o=n[0]>>1&1,h=this.map(r,e),(c=this.map(s,o)).add(h),r=c.getX(),s=c.getY(),n[0]=4,r.toBytes(u),i=0;i<this.EFS;i++)n[i+1]=u[i];for(s.toBytes(u),i=0;i<this.EFS;i++)n[i+this.EFS+1]=u[i];return 0},RECOMBINE_G1:function(n,i,e){var o=t.ECP.fromBytes(n),r=t.ECP.fromBytes(i);return o.is_infinity()||r.is_infinity()?this.INVALID_POINT:(o.add(r),o.toBytes(e),0)},RECOMBINE_G2:function(n,i,e){var o=t.ECP2.fromBytes(n),r=t.ECP2.fromBytes(i);return o.is_infinity()||r.is_infinity()?this.INVALID_POINT:(o.add(r),o.toBytes(e),0)},HASH_ID:function(t,n){return this.hashit(t,0,n)},RANDOM_GENERATE:function(n,i){var e=new t.BIG(0);return e.rcopy(t.ROM_CURVE.CURVE_Order),t.BIG.randomnum(e,n).toBytes(i),0},EXTRACT_PIN:function(t,n,i,e){return this.EXTRACT_FACTOR(t,n,i%this.MAXPIN,this.PBLEN,e)},EXTRACT_FACTOR:function(n,i,e,o,r){var s,h,c;return(s=t.ECP.fromBytes(r)).is_infinity()?this.INVALID_POINT:(c=this.hashit(n,0,i),h=(h=t.ECP.mapit(c)).pinmul(e,o),s.sub(h),s.toBytes(r),0)},RESTORE_FACTOR:function(n,i,e,o,r){var s,h,c;return(s=t.ECP.fromBytes(r)).is_infinity()?this.INVALID_POINT:(c=this.hashit(n,0,i),h=(h=t.ECP.mapit(c)).pinmul(e,o),s.add(h),s.toBytes(r),0)},GET_SERVER_SECRET:function(n,i){var e,o;return o=t.ECP2.generator(),e=t.BIG.fromBytes(n),(o=t.PAIR.G2mul(o,e)).toBytes(i),0},GET_G1_MULTIPLE:function(n,i,e,o,r){var s,h,c=new t.BIG(0);if(c.rcopy(t.ROM_CURVE.CURVE_Order),null!=n?(s=t.BIG.randomnum(c,n)).toBytes(e):s=t.BIG.fromBytes(e),0==i){if((h=t.ECP.fromBytes(o)).is_infinity())return this.INVALID_POINT}else h=t.ECP.mapit(o);return t.PAIR.G1mul(h,s).toBytes(r),0},GET_CLIENT_SECRET:function(t,n,i){return this.GET_G1_MULTIPLE(null,1,t,n,i)},GET_CLIENT_PERMIT:function(n,i,e,o,r){var s=this.hashit(n,i,o),h=t.ECP.mapit(s),c=t.BIG.fromBytes(e);return(h=t.PAIR.G1mul(h,c)).toBytes(r),0},CLIENT_1:function(n,i,e,o,r,s,h,c,u,a,f){var E,B,y,I,p,m=new t.BIG(0);if(m.rcopy(t.ROM_CURVE.CURVE_Order),null!==o?(E=t.BIG.randomnum(m,o)).toBytes(r):E=t.BIG.fromBytes(r),p=this.hashit(n,0,e),B=t.ECP.mapit(p),(y=t.ECP.fromBytes(h)).is_infinity())return this.INVALID_POINT;if(s%=this.MAXPIN,I=B.pinmul(s,this.PBLEN),y.add(I),0!=i){if((I=t.ECP.fromBytes(f)).is_infinity())return this.INVALID_POINT;y.add(I),p=this.hashit(n,i,p),I=t.ECP.mapit(p),null!=u?((B=t.PAIR.G1mul(B,E)).toBytes(u),I=t.PAIR.G1mul(I,E),B.add(I)):(B.add(I),B=t.PAIR.G1mul(B,E)),null!=a&&B.toBytes(a)}else null!=u&&(B=t.PAIR.G1mul(B,E)).toBytes(u);return y.toBytes(c),0},CLIENT_2:function(n,i,e){var o,r,s,h=new t.BIG(0);return h.rcopy(t.ROM_CURVE.CURVE_Order),(o=t.ECP.fromBytes(e)).is_infinity()?this.INVALID_POINT:(r=t.BIG.fromBytes(n),s=t.BIG.fromBytes(i),r.add(s),r.mod(h),(o=t.PAIR.G1mul(o,r)).neg(),o.toBytes(e),0)},SERVER_1:function(n,i,e,o,r){var s,h=this.hashit(n,0,e),c=t.ECP.mapit(h);c.toBytes(o),0!==i&&(h=this.hashit(n,i,h),s=t.ECP.mapit(h),c.add(s),c.toBytes(r))},SERVER_2:function(n,i,e,o,r,s,h,c,u,a,f){var E,B,y,I,p,m;if(void 0===f||null==f)E=t.ECP2.generator();else if((E=t.ECP2.fromBytes(f)).is_infinity())return this.INVALID_POINT;if((B=t.ECP2.fromBytes(r)).is_infinity())return this.INVALID_POINT;if(0!==n)y=t.ECP.fromBytes(h);else{if(null==s)return this.BAD_PARAMS;y=t.ECP.fromBytes(s)}if(y.is_infinity())return this.INVALID_POINT;if(I=t.BIG.fromBytes(o),0!=n)p=t.ECP.fromBytes(e);else{if(null==i)return this.BAD_PARAMS;p=t.ECP.fromBytes(i)}if(p.is_infinity())return this.INVALID_POINT;if((p=t.PAIR.G1mul(p,I)).add(y),p.affine(),(y=t.ECP.fromBytes(c)).is_infinity())return this.INVALID_POINT;if(m=t.PAIR.ate2(E,y,B,p),!(m=t.PAIR.fexp(m)).isunity()){if(null!=i&&null!=s&&null!=u&&null!=a){if(m.toBytes(u),0!==n){if((p=t.ECP.fromBytes(i)).is_infinity())return this.INVALID_POINT;if((y=t.ECP.fromBytes(s)).is_infinity())return this.INVALID_POINT;(p=t.PAIR.G1mul(p,I)).add(y),p.affine()}m=t.PAIR.ate(E,p),(m=t.PAIR.fexp(m)).toBytes(a)}return this.BAD_PIN}return 0},KANGAROO:function(n,i){var e,o,r,s,h,c,u,a,f=t.FP12.fromBytes(n),E=t.FP12.fromBytes(i),B=[],y=new t.FP12(E),I=[];for(s=1,r=0;r<this.TS;r++)B[r]=s,I[r]=new t.FP12(y),s*=2,y.usqr();for(y.one(),h=0,o=0;o<this.TRAP;o++)e=y.geta().geta().getA().lastbits(20)%this.TS,y.mul(I[e]),h+=B[e];for(E.copy(y),E.conj(),a=0,c=0,u=0;c-h<this.MAXPIN&&!(++a>4*this.TRAP);){if(e=f.geta().geta().getA().lastbits(20)%this.TS,f.mul(I[e]),c+=B[e],f.equals(y)){u=c-h;break}if(f.equals(E)){u=h-c;break}}return(a>4*this.TRAP||c-h>=this.MAXPIN)&&(u=0),u},GET_TIME:function(){var t=new Date;return Math.floor(t.getTime()/1e3)},GET_Y:function(n,i,e,o){var r=new t.BIG(0),s=this.hashit(n,i,e),h=t.BIG.fromBytes(s);return r.rcopy(t.ROM_CURVE.CURVE_Order),h.mod(r),h.toBytes(o),0},CLIENT:function(t,n,i,e,o,r,s,h,c,u,a,f,E,B){var y,I,p=0,m=[];if(0==n?y=c:(y=u,c=null),0!=(p=this.CLIENT_1(t,n,i,e,o,r,s,h,c,u,a)))return p;if(m=y.slice(),void 0!==B||null!=B)for(I=0;I<B.length;I++)m.push(B[I]);return this.GET_Y(t,f,m,E),0!=(p=this.CLIENT_2(o,E,h))?p:0},SERVER:function(t,n,i,e,o,r,s,h,c,u,a,f,E,B,y){var I,p,m,d=[];if(p=0==n?s:h,this.SERVER_1(t,n,f,i,e),d=p.slice(),void 0!==B||null!=B)for(m=0;m<B.length;m++)d.push(B[m]);return this.GET_Y(t,E,d,o),0!=(I=this.SERVER_2(n,i,e,o,r,s,h,c,u,a,y))?I:0},PRECOMPUTE:function(n,i,e,o){var r,s,h,c;return(s=t.ECP.fromBytes(n)).is_infinity()?this.INVALID_POINT:(r=t.ECP.mapit(i),c=t.ECP2.generator(),h=t.PAIR.ate(c,s),(h=t.PAIR.fexp(h)).toBytes(e),h=t.PAIR.ate(c,r),(h=t.PAIR.fexp(h)).toBytes(o),0)},HASH_ALL:function(t,n,i,e,o,r,s,h){var c,u=0,a=[];for(c=0;c<n.length;c++)a[c]=n[c];if(u+=n.length,null!=e){for(c=0;c<e.length;c++)a[c+u]=e[c];u+=e.length}else{for(c=0;c<i.length;c++)a[c+u]=i[c];u+=i.length}for(c=0;c<o.length;c++)a[c+u]=o[c];for(u+=o.length,c=0;c<r.length;c++)a[c+u]=r[c];for(u+=r.length,c=0;c<s.length;c++)a[c+u]=s[c];for(u+=s.length,c=0;c<h.length;c++)a[c+u]=h[c];return u+=h.length,this.hashit(t,0,a)},CLIENT_KEY:function(n,i,e,o,r,s,h,c,u){var a,f,E,B,y=t.FP12.fromBytes(i),I=t.FP12.fromBytes(e),p=t.BIG.fromBytes(r),m=t.BIG.fromBytes(s),d=t.BIG.fromBytes(h),l=t.ECP.fromBytes(c);if(l.is_infinity())return this.INVALID_POINT;for(l=t.PAIR.G1mul(l,m),(f=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),p.add(d),p.mod(f),I.pinpow(o,this.PBLEN),y.mul(I),E=y.compow(p,f),a=this.mpin_hash(n,E,l),B=0;B<t.ECP.AESKEY;B++)u[B]=a[B];return 0},SERVER_KEY:function(n,i,e,o,r,s,h,c,u){var a,f,E,B,y,I,p,m,d,l;if((f=t.ECP2.fromBytes(e)).is_infinity())return this.INVALID_POINT;if((E=t.ECP.fromBytes(i)).is_infinity())return this.INVALID_POINT;if((B=t.ECP.fromBytes(s)).is_infinity())return this.INVALID_POINT;if((y=null!=c?t.ECP.fromBytes(c):t.ECP.fromBytes(h)).is_infinity())return this.INVALID_POINT;for(I=t.BIG.fromBytes(o),p=t.BIG.fromBytes(r),B=t.PAIR.G1mul(B,p),E.add(B),E.affine(),y=t.PAIR.G1mul(y,I),m=t.PAIR.ate(f,E),d=(m=t.PAIR.fexp(m)).trace(),a=this.mpin_hash(n,d,y),l=0;l<t.ECP.AESKEY;l++)u[l]=a[l];return 0},GET_DVS_KEYPAIR:function(n,i,e){var o,r,s=new t.BIG(0);return s.rcopy(t.ROM_CURVE.CURVE_Order),null!=n?(o=t.BIG.randomnum(s,n)).toBytes(i):o=t.BIG.fromBytes(i),o.invmodp(s),r=t.ECP2.generator(),(r=t.PAIR.G2mul(r,o)).toBytes(e),0}}}(h)),3==h.config["@PF"]&&(h.FP2=t(h),h.FP4=n(h),h.FP8=i(h),h.FP24=function(t){var n=function(i,e,o){i instanceof n?(this.a=new t.FP8(i.a),this.b=new t.FP8(i.b),this.c=new t.FP8(i.c)):(this.a=new t.FP8(i),this.b=new t.FP8(e),this.c=new t.FP8(o))};return n.prototype={reduce:function(){this.a.reduce(),this.b.reduce(),this.c.reduce()},norm:function(){this.a.norm(),this.b.norm(),this.c.norm()},iszilch:function(){return this.reduce(),this.a.iszilch()&&this.b.iszilch()&&this.c.iszilch()},isunity:function(){var n=new t.FP8(1);return this.a.equals(n)&&this.b.iszilch()&&this.c.iszilch()},cmove:function(t,n){this.a.cmove(t.a,n),this.b.cmove(t.b,n),this.c.cmove(t.c,n)},select:function(t,i){var e,o,r=new n(0);o=((o=(i^(e=i>>31))-e)-1)/2,this.cmove(t[0],n.teq(o,0)),this.cmove(t[1],n.teq(o,1)),this.cmove(t[2],n.teq(o,2)),this.cmove(t[3],n.teq(o,3)),this.cmove(t[4],n.teq(o,4)),this.cmove(t[5],n.teq(o,5)),this.cmove(t[6],n.teq(o,6)),this.cmove(t[7],n.teq(o,7)),r.copy(this),r.conj(),this.cmove(r,1&e)},geta:function(){return this.a},getb:function(){return this.b},getc:function(){return this.c},equals:function(t){return this.a.equals(t.a)&&this.b.equals(t.b)&&this.c.equals(t.c)},copy:function(t){this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c)},one:function(){this.a.one(),this.b.zero(),this.c.zero()},conj:function(){this.a.conj(),this.b.nconj(),this.c.conj()},set:function(t,n,i){this.a.copy(t),this.b.copy(n),this.c.copy(i)},seta:function(t){this.a.copy(t),this.b.zero(),this.c.zero()},usqr:function(){var n=new t.FP8(this.a),i=new t.FP8(this.c),e=new t.FP8(this.b),o=new t.FP8(0);this.a.sqr(),o.copy(this.a),o.add(this.a),this.a.add(o),n.nconj(),n.add(n),this.a.add(n),i.sqr(),i.times_i(),o.copy(i),o.add(i),i.add(o),e.sqr(),o.copy(e),o.add(e),e.add(o),this.b.conj(),this.b.add(this.b),this.c.nconj(),this.c.add(this.c),this.b.add(i),this.c.add(e),this.reduce()},sqr:function(){var n=new t.FP8(this.a),i=new t.FP8(this.b),e=new t.FP8(this.c),o=new t.FP8(this.a);n.sqr(),i.mul(this.c),i.add(i),e.sqr(),o.mul(this.b),o.add(o),this.c.add(this.a),this.c.add(this.b),this.c.norm(),this.c.sqr(),this.a.copy(n),n.add(i),n.add(e),n.add(o),n.neg(),i.times_i(),e.times_i(),this.a.add(i),this.b.copy(e),this.b.add(o),this.c.add(n),this.norm()},mul:function(n){var i=new t.FP8(this.a),e=new t.FP8(0),o=new t.FP8(this.b),r=new t.FP8(0),s=new t.FP8(this.a),h=new t.FP8(n.a);i.mul(n.a),o.mul(n.b),s.add(this.b),h.add(n.b),s.norm(),h.norm(),e.copy(s),e.mul(h),s.copy(this.b),s.add(this.c),h.copy(n.b),h.add(n.c),s.norm(),h.norm(),r.copy(s),r.mul(h),s.copy(i),s.neg(),h.copy(o),h.neg(),e.add(s),this.b.copy(e),this.b.add(h),r.add(h),o.add(s),s.copy(this.a),s.add(this.c),h.copy(n.a),h.add(n.c),s.norm(),h.norm(),s.mul(h),o.add(s),s.copy(this.c),s.mul(n.c),h.copy(s),h.neg(),this.c.copy(o),this.c.add(h),r.add(h),s.times_i(),this.b.add(s),r.times_i(),this.a.copy(i),this.a.add(r),this.norm()},smul:function(n,i){var e,o,r,s,h,c;i==t.ECP.D_TYPE&&(e=new t.FP8(this.a),r=new t.FP8(this.b),s=new t.FP8(this.b),h=new t.FP8(0),c=new t.FP8(n.a),e.mul(n.a),r.pmul(n.b.real()),this.b.add(this.a),c.real().add(n.b.real()),this.b.norm(),c.norm(),this.b.mul(c),s.add(this.c),s.norm(),s.pmul(n.b.real()),h.copy(e),h.neg(),c.copy(r),c.neg(),this.b.add(h),this.b.add(c),s.add(c),r.add(h),h.copy(this.a),h.add(this.c),h.norm(),h.mul(n.a),this.c.copy(r),this.c.add(h),s.times_i(),this.a.copy(e),this.a.add(s)),i==t.ECP.M_TYPE&&(e=new t.FP8(this.a),o=new t.FP8(0),r=new t.FP8(0),s=new t.FP8(0),h=new t.FP8(this.a),c=new t.FP8(0),e.mul(n.a),h.add(this.b),h.norm(),o.copy(h),o.mul(n.a),h.copy(this.b),h.add(this.c),h.norm(),s.copy(h),s.pmul(n.c.getb()),s.times_i(),h.copy(e),h.neg(),o.add(h),this.b.copy(o),r.copy(h),h.copy(this.a),h.add(this.c),c.copy(n.a),c.add(n.c),h.norm(),c.norm(),h.mul(c),r.add(h),h.copy(this.c),h.pmul(n.c.getb()),h.times_i(),c.copy(h),c.neg(),this.c.copy(r),this.c.add(c),s.add(c),h.times_i(),this.b.add(h),s.norm(),s.times_i(),this.a.copy(e),this.a.add(s)),this.norm()},inverse:function(){var n=new t.FP8(this.a),i=new t.FP8(this.b),e=new t.FP8(this.a),o=new t.FP8(0);n.sqr(),i.mul(this.c),i.times_i(),n.sub(i),n.norm(),i.copy(this.c),i.sqr(),i.times_i(),e.mul(this.b),i.sub(e),i.norm(),e.copy(this.b),e.sqr(),o.copy(this.a),o.mul(this.c),e.sub(o),e.norm(),o.copy(this.b),o.mul(e),o.times_i(),this.a.mul(n),o.add(this.a),this.c.mul(i),this.c.times_i(),o.add(this.c),o.norm(),o.inverse(),this.a.copy(n),this.a.mul(o),this.b.copy(i),this.b.mul(o),this.c.copy(e),this.c.mul(o)},frob:function(n,i){var e,o=new t.FP2(n),r=new t.FP2(n);for(o.sqr(),r.mul(o),r.mul_ip(),r.norm(),e=0;e<i;e++)this.a.frob(r),this.b.frob(r),this.c.frob(r),this.b.qmul(n),this.b.times_i2(),this.c.qmul(o),this.c.times_i2(),this.c.times_i2()},trace:function(){var n=new t.FP8(0);return n.copy(this.a),n.imul(3),n.reduce(),n},toString:function(){return"["+this.a.toString()+","+this.b.toString()+","+this.c.toString()+"]"},toBytes:function(n){var i,e=[];for(this.a.geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i]=e[i];for(this.a.geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+t.BIG.MODBYTES]=e[i];for(this.a.geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+2*t.BIG.MODBYTES]=e[i];for(this.a.geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+3*t.BIG.MODBYTES]=e[i];for(this.a.getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+4*t.BIG.MODBYTES]=e[i];for(this.a.getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+5*t.BIG.MODBYTES]=e[i];for(this.a.getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+6*t.BIG.MODBYTES]=e[i];for(this.a.getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+7*t.BIG.MODBYTES]=e[i];for(this.b.geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+8*t.BIG.MODBYTES]=e[i];for(this.b.geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+9*t.BIG.MODBYTES]=e[i];for(this.b.geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+10*t.BIG.MODBYTES]=e[i];for(this.b.geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+11*t.BIG.MODBYTES]=e[i];for(this.b.getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+12*t.BIG.MODBYTES]=e[i];for(this.b.getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+13*t.BIG.MODBYTES]=e[i];for(this.b.getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+14*t.BIG.MODBYTES]=e[i];for(this.b.getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+15*t.BIG.MODBYTES]=e[i];for(this.c.geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+16*t.BIG.MODBYTES]=e[i];for(this.c.geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+17*t.BIG.MODBYTES]=e[i];for(this.c.geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+18*t.BIG.MODBYTES]=e[i];for(this.c.geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+19*t.BIG.MODBYTES]=e[i];for(this.c.getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+20*t.BIG.MODBYTES]=e[i];for(this.c.getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+21*t.BIG.MODBYTES]=e[i];for(this.c.getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+22*t.BIG.MODBYTES]=e[i];for(this.c.getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+23*t.BIG.MODBYTES]=e[i]},pow:function(i){var e,o,r,s;for(this.norm(),i.norm(),(e=new t.BIG(i)).pmul(3),e.norm(),o=new n(this),r=e.nbits()-2;r>=1;r--)o.usqr(),1==(s=e.bit(r)-i.bit(r))&&o.mul(this),-1==s&&(this.conj(),o.mul(this),this.conj());return o.reduce(),o},pinpow:function(t,i){var e,o,r=[];for(r[0]=new n(1),r[1]=new n(this),e=i-1;e>=0;e--)r[1-(o=t>>e&1)].mul(r[o]),r[o].usqr();this.copy(r[0])},compow:function(i,e){var o,r,s,h,c,u,a,f,E,B,y,I,p;return(o=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(r=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),s=new t.FP2(o,r),(h=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),(c=new t.BIG(h)).mod(e),(u=new t.BIG(i)).mod(c),(a=new t.BIG(i)).div(c),f=new n(0),E=new n(0),f.copy(this),B=f.trace(),a.iszilch()?B=B.xtr_pow(i):(E.copy(f),E.frob(s,1),y=E.trace(),f.conj(),E.mul(f),I=E.trace(),E.mul(f),p=E.trace(),B=B.xtr_pow2(y,I,p,u,a))}},n.fromBytes=function(i){var e,o,r,s,h,c,u,a,f,E,B=[];for(e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+2*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+3*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),h=new t.FP2(o,r),f=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+4*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+5*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+6*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+7*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),h=new t.FP2(o,r),E=new t.FP4(s,h),c=new t.FP8(f,E),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+8*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+9*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+10*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+11*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),h=new t.FP2(o,r),f=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+12*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+13*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+14*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+15*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),h=new t.FP2(o,r),E=new t.FP4(s,h),u=new t.FP8(f,E),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+16*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+17*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+18*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+19*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),h=new t.FP2(o,r),f=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+20*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+21*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(B),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+22*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),e=0;e<t.BIG.MODBYTES;e++)B[e]=i[e+23*t.BIG.MODBYTES];return r=t.BIG.fromBytes(B),h=new t.FP2(o,r),E=new t.FP4(s,h),a=new t.FP8(f,E),new n(c,u,a)},n.teq=function(t,n){var i=t^n;return(i-=1)>>31&1},n.pow8=function(i,e){var o,r,s,h,c,u,a,f,E=[],B=[],y=new n(0),I=new n(0),p=[],m=new t.BIG(0),d=new t.BIG(0),l=new t.BIG(0),w=[],_=[],S=[],P=[];for(o=0;o<8;o++)p[o]=new t.BIG(e[o]),p[o].norm();for(E[0]=new n(i[0]),E[1]=new n(E[0]),E[1].mul(i[1]),E[2]=new n(E[0]),E[2].mul(i[2]),E[3]=new n(E[1]),E[3].mul(i[2]),E[4]=new n(i[0]),E[4].mul(i[3]),E[5]=new n(E[1]),E[5].mul(i[3]),E[6]=new n(E[2]),E[6].mul(i[3]),E[7]=new n(E[3]),E[7].mul(i[3]),d.rcopy(t.ROM_FIELD.Fra),l.rcopy(t.ROM_FIELD.Frb),f=new t.FP2(d,l),o=0;o<8;o++)B[o]=new n(E[o]),B[o].frob(f,4);for(u=1-p[0].parity(),p[0].inc(u),p[0].norm(),a=1-p[4].parity(),p[4].inc(a),p[4].norm(),m.zero(),o=0;o<8;o++)m.or(p[o]);for(_[(h=1+m.nbits())-1]=1,P[h-1]=1,o=0;o<h-1;o++)p[0].fshr(1),_[o]=2*p[0].parity()-1,p[4].fshr(1),P[o]=2*p[4].parity()-1;for(o=0;o<h;o++){for(w[o]=0,s=1,r=1;r<4;r++)c=_[o]*p[r].parity(),p[r].fshr(1),p[r].dec(c>>1),p[r].norm(),w[o]+=c*s,s*=2;for(S[o]=0,s=1,r=5;r<8;r++)c=P[o]*p[r].parity(),p[r].fshr(1),p[r].dec(c>>1),p[r].norm(),S[o]+=c*s,s*=2}for(I.select(E,2*w[h-1]+1),y.select(B,2*S[h-1]+1),I.mul(y),o=h-2;o>=0;o--)I.usqr(),y.select(E,2*w[o]+_[o]),I.mul(y),y.select(B,2*S[o]+P[o]),I.mul(y);return y.copy(i[0]),y.conj(),y.mul(I),I.cmove(y,u),y.copy(i[4]),y.conj(),y.mul(I),I.cmove(y,a),I.reduce(),I},n}(h),h.ECP4=function(t){var n=function(){this.x=new t.FP4(0),this.y=new t.FP4(1),this.z=new t.FP4(0)};return n.prototype={is_infinity:function(){return this.x.reduce(),this.y.reduce(),this.z.reduce(),this.x.iszilch()&&this.z.iszilch()},copy:function(t){this.x.copy(t.x),this.y.copy(t.y),this.z.copy(t.z)},inf:function(){this.x.zero(),this.y.one(),this.z.zero()},cmove:function(t,n){this.x.cmove(t.x,n),this.y.cmove(t.y,n),this.z.cmove(t.z,n)},select:function(t,i){var e=new n,o=i>>31,r=(i^o)-o;r=(r-1)/2,this.cmove(t[0],n.teq(r,0)),this.cmove(t[1],n.teq(r,1)),this.cmove(t[2],n.teq(r,2)),this.cmove(t[3],n.teq(r,3)),this.cmove(t[4],n.teq(r,4)),this.cmove(t[5],n.teq(r,5)),this.cmove(t[6],n.teq(r,6)),this.cmove(t[7],n.teq(r,7)),e.copy(this),e.neg(),this.cmove(e,1&o)},equals:function(n){var i,e;return i=new t.FP4(this.x),e=new t.FP4(n.x),i.mul(n.z),e.mul(this.z),!!i.equals(e)&&(i.copy(this.y),i.mul(n.z),e.copy(n.y),e.mul(this.z),!!i.equals(e))},neg:function(){this.y.norm(),this.y.neg(),this.y.norm()},affine:function(){var n;if(!this.is_infinity()){if(n=new t.FP4(1),this.z.equals(n))return this.x.reduce(),void this.y.reduce();this.z.inverse(),this.x.mul(this.z),this.x.reduce(),this.y.mul(this.z),this.y.reduce(),this.z.copy(n)}},getX:function(){return this.affine(),this.x},getY:function(){return this.affine(),this.y},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},toBytes:function(n){var i,e=[];for(this.affine(),this.x.geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i]=e[i];for(this.x.geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+t.BIG.MODBYTES]=e[i];for(this.x.getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+2*t.BIG.MODBYTES]=e[i];for(this.x.getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+3*t.BIG.MODBYTES]=e[i];for(this.y.geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+4*t.BIG.MODBYTES]=e[i];for(this.y.geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+5*t.BIG.MODBYTES]=e[i];for(this.y.getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+6*t.BIG.MODBYTES]=e[i];for(this.y.getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+7*t.BIG.MODBYTES]=e[i]},toString:function(){return this.is_infinity()?"infinity":(this.affine(),"("+this.x.toString()+","+this.y.toString()+")")},setxy:function(i,e){var o,r;this.x.copy(i),this.y.copy(e),this.z.one(),o=n.RHS(this.x),(r=new t.FP4(this.y)).sqr(),r.equals(o)||this.inf()},setx:function(t){var i;this.x.copy(t),this.z.one(),(i=n.RHS(this.x)).sqrt()?this.y.copy(i):this.inf()},frob:function(t,n){for(var i=0;i<n;i++)this.x.frob(t[2]),this.x.pmul(t[0]),this.y.frob(t[2]),this.y.pmul(t[1]),this.y.times_i(),this.z.frob(t[2])},dbl:function(){var n,i,e,o,r,s;return n=new t.FP4(this.y),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(n.times_i(),n.norm()),(i=new t.FP4(this.y)).sqr(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&i.times_i(),(e=new t.FP4(n)).mul(this.z),(o=new t.FP4(this.z)).sqr(),this.z.copy(i),this.z.add(i),this.z.norm(),this.z.add(this.z),this.z.add(this.z),this.z.norm(),o.imul(3*t.ROM_CURVE.CURVE_B_I),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&o.times_i(),(r=new t.FP4(o)).mul(this.z),(s=new t.FP4(i)).add(o),s.norm(),this.z.mul(e),e.copy(o),e.add(o),o.add(e),o.norm(),i.sub(o),i.norm(),s.mul(i),s.add(r),e.copy(this.x),e.mul(n),this.x.copy(i),this.x.norm(),this.x.mul(e),this.x.add(this.x),this.x.norm(),this.y.copy(s),this.y.norm(),1},add:function(n){var i,e,o,r,s,h,c,u,a;return i=3*t.ROM_CURVE.CURVE_B_I,(e=new t.FP4(this.x)).mul(n.x),(o=new t.FP4(this.y)).mul(n.y),(r=new t.FP4(this.z)).mul(n.z),(s=new t.FP4(this.x)).add(this.y),s.norm(),(h=new t.FP4(n.x)).add(n.y),h.norm(),s.mul(h),h.copy(e),h.add(o),s.sub(h),s.norm(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&s.times_i(),h.copy(this.y),h.add(this.z),h.norm(),(c=new t.FP4(n.y)).add(n.z),c.norm(),h.mul(c),c.copy(o),c.add(r),h.sub(c),h.norm(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&h.times_i(),c.copy(this.x),c.add(this.z),c.norm(),(u=new t.FP4(n.x)).add(n.z),u.norm(),c.mul(u),u.copy(e),u.add(r),u.rsub(c),u.norm(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(e.times_i(),o.times_i()),c.copy(e),c.add(e),e.add(c),e.norm(),r.imul(i),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&r.times_i(),(a=new t.FP4(o)).add(r),a.norm(),o.sub(r),o.norm(),u.imul(i),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&u.times_i(),c.copy(u),c.mul(h),r.copy(s),r.mul(o),c.rsub(r),u.mul(e),o.mul(a),u.add(o),e.mul(s),a.mul(h),a.add(e),this.x.copy(c),this.x.norm(),this.y.copy(u),this.y.norm(),this.z.copy(a),this.z.norm(),0},sub:function(t){var n;return t.neg(),n=this.add(t),t.neg(),n},mul:function(i){var e,o,r,s,h=new t.BIG,c=new t.BIG,u=new n,a=new n,f=new n,E=[],B=[];if(this.is_infinity())return new n;for(this.affine(),f.copy(this),f.dbl(),E[0]=new n,E[0].copy(this),e=1;e<8;e++)E[e]=new n,E[e].copy(E[e-1]),E[e].add(f);for(c.copy(i),r=c.parity(),c.inc(1),c.norm(),s=c.parity(),h.copy(c),h.inc(1),h.norm(),c.cmove(h,r),f.cmove(this,s),u.copy(f),o=1+Math.floor((c.nbits()+3)/4),e=0;e<o;e++)B[e]=c.lastbits(5)-16,c.dec(B[e]),c.norm(),c.fshr(4);for(B[o]=c.lastbits(5),a.copy(E[Math.floor((B[o]-1)/2)]),e=o-1;e>=0;e--)f.select(E,B[e]),a.dbl(),a.dbl(),a.dbl(),a.dbl(),a.add(f);return a.sub(u),a.affine(),a}},n.generator=function(){var i,e,o,r,s,h,c=new n,u=new t.BIG(0),a=new t.BIG(0);return u.rcopy(t.ROM_CURVE.CURVE_Pxaa),a.rcopy(t.ROM_CURVE.CURVE_Pxab),i=new t.FP2(u,a),u.rcopy(t.ROM_CURVE.CURVE_Pxba),a.rcopy(t.ROM_CURVE.CURVE_Pxbb),e=new t.FP2(u,a),o=new t.FP4(i,e),u.rcopy(t.ROM_CURVE.CURVE_Pyaa),a.rcopy(t.ROM_CURVE.CURVE_Pyab),r=new t.FP2(u,a),u.rcopy(t.ROM_CURVE.CURVE_Pyba),a.rcopy(t.ROM_CURVE.CURVE_Pybb),s=new t.FP2(u,a),h=new t.FP4(r,s),c.setxy(o,h),c},n.fromBytes=function(i){var e,o,r,s,h,c,u,a,f=[];for(h=0;h<t.BIG.MODBYTES;h++)f[h]=i[h];for(e=t.BIG.fromBytes(f),h=0;h<t.BIG.MODBYTES;h++)f[h]=i[h+t.BIG.MODBYTES];for(o=t.BIG.fromBytes(f),r=new t.FP2(e,o),h=0;h<t.BIG.MODBYTES;h++)f[h]=i[h+2*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(f),h=0;h<t.BIG.MODBYTES;h++)f[h]=i[h+3*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(f),s=new t.FP2(e,o),c=new t.FP4(r,s),h=0;h<t.BIG.MODBYTES;h++)f[h]=i[h+4*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(f),h=0;h<t.BIG.MODBYTES;h++)f[h]=i[h+5*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(f),r=new t.FP2(e,o),h=0;h<t.BIG.MODBYTES;h++)f[h]=i[h+6*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(f),h=0;h<t.BIG.MODBYTES;h++)f[h]=i[h+7*t.BIG.MODBYTES];return o=t.BIG.fromBytes(f),s=new t.FP2(e,o),u=new t.FP4(r,s),(a=new n).setxy(c,u),a},n.RHS=function(n){var i,e,o;return n.norm(),(i=new t.FP4(n)).sqr(),(e=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_B),o=new t.FP4(e),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&o.div_i(),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&o.times_i(),i.mul(n),i.add(o),i.reduce(),i},n.mul8=function(i,e){var o,r,s,h,c,u,a,f=new n,E=new n,B=[],y=[],I=new t.BIG,p=[],m=[],d=[],l=[],w=[],_=n.frob_constants();for(o=0;o<8;o++)p[o]=new t.BIG(e[o]),p[o].norm(),i[o].affine();for(B[0]=new n,B[0].copy(i[0]),B[1]=new n,B[1].copy(B[0]),B[1].add(i[1]),B[2]=new n,B[2].copy(B[0]),B[2].add(i[2]),B[3]=new n,B[3].copy(B[1]),B[3].add(i[2]),B[4]=new n,B[4].copy(B[0]),B[4].add(i[3]),B[5]=new n,B[5].copy(B[1]),B[5].add(i[3]),B[6]=new n,B[6].copy(B[2]),B[6].add(i[3]),B[7]=new n,B[7].copy(B[3]),B[7].add(i[3]),o=0;o<8;o++)y[o]=new n,y[o].copy(B[o]),y[o].frob(_,4);for(u=1-p[0].parity(),p[0].inc(u),p[0].norm(),a=1-p[4].parity(),p[4].inc(a),p[4].norm(),I.zero(),o=0;o<8;o++)I.or(p[o]);for(d[(h=1+I.nbits())-1]=1,w[h-1]=1,o=0;o<h-1;o++)p[0].fshr(1),d[o]=2*p[0].parity()-1,p[4].fshr(1),w[o]=2*p[4].parity()-1;for(o=0;o<h;o++){for(m[o]=0,s=1,r=1;r<4;r++)c=d[o]*p[r].parity(),p[r].fshr(1),p[r].dec(c>>1),p[r].norm(),m[o]+=c*s,s*=2;for(l[o]=0,s=1,r=5;r<8;r++)c=w[o]*p[r].parity(),p[r].fshr(1),p[r].dec(c>>1),p[r].norm(),l[o]+=c*s,s*=2}for(E.select(B,2*m[h-1]+1),f.select(y,2*l[h-1]+1),E.add(f),o=h-2;o>=0;o--)E.dbl(),f.select(B,2*m[o]+d[o]),E.add(f),f.select(y,2*l[o]+w[o]),E.add(f);return f.copy(E),f.sub(i[0]),E.cmove(f,u),f.copy(E),f.sub(i[4]),E.cmove(f,a),E.affine(),E},n.teq=function(t,n){var i=t^n;return(i-=1)>>31&1},n.mapit=function(i){var e,o,r,s,h,c,u,a,f,E,B=n.frob_constants();for((e=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),o=t.BIG.fromBytes(i),r=new t.BIG(1),o.mod(e);c=new t.FP2(r,o),h=new t.FP4(c),(s=new n).setx(h),s.is_infinity();)o.inc(1),o.norm();return(o=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),E=(f=(a=(u=s.mul(o)).mul(o)).mul(o)).mul(o),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&(u.neg(),f.neg()),E.sub(f),E.sub(s),f.sub(a),f.frob(B,1),a.sub(u),a.frob(B,2),u.sub(s),u.frob(B,3),s.dbl(),s.frob(B,4),s.add(E),s.add(f),s.add(a),s.add(u),s.affine(),s},n.frob_constants=function(){var n,i,e,o,r=new t.BIG(0),s=new t.BIG(0),h=[];return r.rcopy(t.ROM_FIELD.Fra),s.rcopy(t.ROM_FIELD.Frb),n=new t.FP2(r,s),(i=new t.FP2(n)).sqr(),(o=new t.FP2(i)).mul_ip(),o.norm(),(e=new t.FP2(o)).sqr(),o.mul(e),e.copy(n),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(e.mul_ip(),e.inverse(),i.copy(e),i.sqr()),i.mul_ip(),i.norm(),e.mul(i),h[0]=new t.FP2(i),h[1]=new t.FP2(e),h[2]=new t.FP2(o),h},n}(h),h.PAIR192=function(t){var n={line:function(n,i,e,o){var r,s,h,c,u,a,f,E,B,y,I,p,m=new t.FP24(1);return n==i?(r=new t.FP4(n.getx()),s=new t.FP4(n.gety()),h=new t.FP4(n.getz()),(c=new t.FP4(s)).mul(h),r.sqr(),s.sqr(),h.sqr(),c.imul(4),c.neg(),c.norm(),c.qmul(o),r.imul(6),r.qmul(e),u=3*t.ROM_CURVE.CURVE_B_I,h.imul(u),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&h.div_2i(),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(h.times_i(),h.add(h),c.times_i(),c.norm()),h.norm(),s.add(s),h.sub(s),h.norm(),y=new t.FP8(c,h),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(I=new t.FP8(r),p=new t.FP8(0)),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(I=new t.FP8(0),(p=new t.FP8(r)).times_i()),n.dbl()):(a=new t.FP4(n.getx()),f=new t.FP4(n.gety()),E=new t.FP4(n.getz()),B=new t.FP4(n.getz()),E.mul(i.gety()),B.mul(i.getx()),a.sub(B),a.norm(),f.sub(E),f.norm(),E.copy(a),a.qmul(o),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(a.times_i(),a.norm()),E.mul(i.gety()),B.copy(f),B.mul(i.getx()),B.sub(E),B.norm(),f.qmul(e),f.neg(),f.norm(),y=new t.FP8(a,B),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(I=new t.FP8(f),p=new t.FP8(0)),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(I=new t.FP8(0),(p=new t.FP8(f)).times_i()),n.add(i)),m.set(y,I,p),m},ate:function(i,e){var o,r,s,h,c,u,a,f,E,B;for((o=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),r=new t.BIG(o),(s=new t.BIG(r)).pmul(3),s.norm(),c=new t.FP(e.getx()),u=new t.FP(e.gety()),a=new t.ECP4,f=new t.FP24(1),a.copy(i),B=s.nbits()-2;B>=1;B--)f.sqr(),h=n.line(a,a,c,u),f.smul(h,t.ECP.SEXTIC_TWIST),1==(E=s.bit(B)-r.bit(B))&&(h=n.line(a,i,c,u),f.smul(h,t.ECP.SEXTIC_TWIST)),-1==E&&(i.neg(),h=n.line(a,i,c,u),f.smul(h,t.ECP.SEXTIC_TWIST),i.neg());return t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&f.conj(),f},ate2:function(i,e,o,r){var s,h,c,u,a,f,E,B,y,I,p,m,d;for((s=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),h=new t.BIG(s),(c=new t.BIG(h)).pmul(3),c.norm(),a=new t.FP(e.getx()),f=new t.FP(e.gety()),E=new t.FP(r.getx()),B=new t.FP(r.gety()),y=new t.ECP4,I=new t.ECP4,p=new t.FP24(1),y.copy(i),I.copy(o),d=c.nbits()-2;d>=1;d--)p.sqr(),u=n.line(y,y,a,f),p.smul(u,t.ECP.SEXTIC_TWIST),u=n.line(I,I,E,B),p.smul(u,t.ECP.SEXTIC_TWIST),1==(m=c.bit(d)-h.bit(d))&&(u=n.line(y,i,a,f),p.smul(u,t.ECP.SEXTIC_TWIST),u=n.line(I,o,E,B),p.smul(u,t.ECP.SEXTIC_TWIST)),-1==m&&(i.neg(),u=n.line(y,i,a,f),p.smul(u,t.ECP.SEXTIC_TWIST),i.neg(),o.neg(),u=n.line(I,o,E,B),p.smul(u,t.ECP.SEXTIC_TWIST),o.neg());return t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&p.conj(),p},fexp:function(n){var i,e,o,r,s,h,c,u,a,f,E,B,y,I;return(i=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(e=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),o=new t.FP2(i,e),(r=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),s=new t.FP24(n),(h=new t.FP24(s)).inverse(),s.conj(),s.mul(h),h.copy(s),s.frob(o,4),s.mul(h),(I=new t.FP24(s)).usqr(),u=I.pow(r),r.fshr(1),a=u.pow(r),r.fshl(1),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&u.conj(),(f=new t.FP24(u)).conj(),a.mul(f),a.mul(s),B=(E=(f=a.pow(r)).pow(r)).pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&(f.conj(),B.conj()),f.frob(o,6),E.frob(o,5),f.mul(E),y=B.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&y.conj(),B.frob(o,4),f.mul(B),(c=new t.FP24(a)).conj(),y.mul(c),B.copy(y),B.frob(o,3),f.mul(B),B=y.pow(r),y=B.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&B.conj(),c.copy(B),c.frob(o,2),f.mul(c),c.copy(y),c.frob(o,1),f.mul(c),B=y.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&B.conj(),a.frob(o,7),B.mul(I),f.mul(a),f.mul(B),s.mul(f),s.reduce(),s},glv:function(n){var i,e,o,r=[];return(i=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),(e=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),o=t.BIG.smul(e,e),e=t.BIG.smul(o,o),r[0]=new t.BIG(n),r[0].mod(e),r[1]=new t.BIG(n),r[1].div(e),r[1].rsub(i),r},gs:function(n){var i,e,o,r,s=[];for((o=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),(e=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),r=new t.BIG(n),i=0;i<7;i++)s[i]=new t.BIG(r),s[i].mod(o),r.div(o);return s[7]=new t.BIG(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&(s[1].copy(t.BIG.modneg(s[1],e)),s[3].copy(t.BIG.modneg(s[3],e)),s[5].copy(t.BIG.modneg(s[5],e)),s[7].copy(t.BIG.modneg(s[7],e))),s},G1mul:function(i,e){var o,r,s,h,c,u,a,f;return t.ROM_CURVE.USE_GLV?(i.affine(),(o=new t.ECP).copy(i),(r=new t.ECP).copy(i),(s=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),(h=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Cru),c=new t.FP(h),u=new t.BIG(0),a=n.glv(e),r.getx().mul(c),f=a[0].nbits(),u.copy(t.BIG.modneg(a[0],s)),u.nbits()<f&&(a[0].copy(u),o.neg()),f=a[1].nbits(),u.copy(t.BIG.modneg(a[1],s)),u.nbits()<f&&(a[1].copy(u),r.neg()),a[0].norm(),a[1].norm(),o=o.mul2(a[0],r,a[1])):o=i.mul(e),o},G2mul:function(i,e){var o,r,s,h,c,u,a,f;if(t.ROM_CURVE.USE_GS_G2){for(r=[],s=t.ECP4.frob_constants(),(h=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),c=n.gs(e),u=new t.BIG(0),i.affine(),r[0]=new t.ECP4,r[0].copy(i),a=1;a<8;a++)r[a]=new t.ECP4,r[a].copy(r[a-1]),r[a].frob(s,1);for(a=0;a<8;a++)f=c[a].nbits(),u.copy(t.BIG.modneg(c[a],h)),u.nbits()<f&&(c[a].copy(u),r[a].neg()),c[a].norm();o=t.ECP4.mul8(r,c)}else o=i.mul(e);return o},GTpow:function(i,e){var o,r,s,h,c,u,a,f,E,B;if(t.ROM_CURVE.USE_GS_GT){for(r=[],(s=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(h=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),c=new t.FP2(s,h),(u=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),a=new t.BIG(0),f=n.gs(e),r[0]=new t.FP24(i),E=1;E<8;E++)r[E]=new t.FP24(0),r[E].copy(r[E-1]),r[E].frob(c,1);for(E=0;E<8;E++)B=f[E].nbits(),a.copy(t.BIG.modneg(f[E],u)),a.nbits()<B&&(f[E].copy(a),r[E].conj()),f[E].norm();o=t.FP24.pow8(r,f)}else o=i.pow(e);return o}};return n}(h),h.MPIN192=function(t){return{BAD_PARAMS:-11,INVALID_POINT:-14,WRONG_ORDER:-18,BAD_PIN:-19,MAXPIN:1e4,PBLEN:14,TS:12,TRAP:2e3,EFS:t.BIG.MODBYTES,EGS:t.BIG.MODBYTES,SHA256:32,SHA384:48,SHA512:64,today:function(){var t=new Date;return Math.floor(t.getTime()/864e5)},bytestostring:function(t){var n,i,e="",o=t.length;for(i=0;i<o;i++)e+=((n=t[i])>>>4&15).toString(16),e+=(15&n).toString(16);return e},stringtobytes:function(t){var n,i=[];for(n=0;n<t.length;n++)i.push(t.charCodeAt(n));return i},comparebytes:function(t,n){if(t.length!=n.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!=n[i])return!1;return!0},mpin_hash:function(n,i,e){var o,r,s,h,c=[],u=[];for(i.geta().geta().getA().toBytes(u),h=0;h<this.EFS;h++)c[h]=u[h];for(i.geta().geta().getB().toBytes(u),h=this.EFS;h<2*this.EFS;h++)c[h]=u[h-this.EFS];for(i.geta().getb().getA().toBytes(u),h=2*this.EFS;h<3*this.EFS;h++)c[h]=u[h-2*this.EFS];for(i.geta().getb().getB().toBytes(u),h=3*this.EFS;h<4*this.EFS;h++)c[h]=u[h-3*this.EFS];for(i.getb().geta().getA().toBytes(u),h=4*this.EFS;h<5*this.EFS;h++)c[h]=u[h-4*this.EFS];for(i.getb().geta().getB().toBytes(u),h=5*this.EFS;h<6*this.EFS;h++)c[h]=u[h-5*this.EFS];for(i.getb().getb().getA().toBytes(u),h=6*this.EFS;h<7*this.EFS;h++)c[h]=u[h-6*this.EFS];for(i.getb().getb().getB().toBytes(u),h=7*this.EFS;h<8*this.EFS;h++)c[h]=u[h-7*this.EFS];for(e.getX().toBytes(u),h=8*this.EFS;h<9*this.EFS;h++)c[h]=u[h-8*this.EFS];for(e.getY().toBytes(u),h=9*this.EFS;h<10*this.EFS;h++)c[h]=u[h-9*this.EFS];if(n==this.SHA256?r=new t.HASH256:n==this.SHA384?r=new t.HASH384:n==this.SHA512&&(r=new t.HASH512),r.process_array(c),0==(o=r.hash()).length)return null;for(s=[],h=0;h<t.ECP.AESKEY;h++)s[h]=o[h];return s},hashit:function(n,i,e){var o,r,s,h,c;if(n==this.SHA256?r=new t.HASH256:n==this.SHA384?r=new t.HASH384:n==this.SHA512&&(r=new t.HASH512),i>0&&r.process_num(i),r.process_array(e),0==(o=r.hash()).length)return null;if(s=[],n>=(c=t.BIG.MODBYTES))for(h=0;h<c;h++)s[h]=o[h];else{for(h=0;h<n;h++)s[h+c-n]=o[h];for(h=0;h<c-n;h++)s[h]=0}return s},map:function(n,i){var e=new t.ECP,o=new t.BIG(n),r=new t.BIG(0);for(r.rcopy(t.ROM_FIELD.Modulus),o.mod(r);e.setxi(o,i),e.is_infinity();)o.inc(1),o.norm();return e},unmap:function(n,i){var e=i.getS(),o=new t.ECP,r=0,s=i.getX();for(n.copy(s);n.dec(1),n.norm(),r++,o.setxi(n,e),o.is_infinity(););return r},ENCODING:function(n,i){var e,o,r,s,h,c,u,a,f,E,B=[];for(e=0;e<this.EFS;e++)B[e]=i[e+1];for(c=t.BIG.fromBytes(B),e=0;e<this.EFS;e++)B[e]=i[e+this.EFS+1];if(u=t.BIG.fromBytes(B),(a=new t.ECP(0)).setxy(c,u),a.is_infinity())return this.INVALID_POINT;for((f=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),c=t.BIG.randomnum(f,n),(s=n.getByte())<0&&(s=-s),s%=2,E=this.map(c,s),a.sub(E),h=a.getS(),o=this.unmap(u,a),(r=n.getByte())<0&&(r=-r),r%=o,u.inc(r+1),i[0]=s+2*h,c.toBytes(B),e=0;e<this.EFS;e++)i[e+1]=B[e];for(u.toBytes(B),e=0;e<this.EFS;e++)i[e+this.EFS+1]=B[e];return 0},DECODING:function(n){var i,e,o,r,s,h,c,u=[];if(4&n[0])return this.INVALID_POINT;for(i=0;i<this.EFS;i++)u[i]=n[i+1];for(r=t.BIG.fromBytes(u),i=0;i<this.EFS;i++)u[i]=n[i+this.EFS+1];for(s=t.BIG.fromBytes(u),e=1&n[0],o=n[0]>>1&1,h=this.map(r,e),(c=this.map(s,o)).add(h),r=c.getX(),s=c.getY(),n[0]=4,r.toBytes(u),i=0;i<this.EFS;i++)n[i+1]=u[i];for(s.toBytes(u),i=0;i<this.EFS;i++)n[i+this.EFS+1]=u[i];return 0},RECOMBINE_G1:function(n,i,e){var o=t.ECP.fromBytes(n),r=t.ECP.fromBytes(i);return o.is_infinity()||r.is_infinity()?this.INVALID_POINT:(o.add(r),o.toBytes(e,!1),0)},RECOMBINE_G2:function(n,i,e){var o=t.ECP4.fromBytes(n),r=t.ECP4.fromBytes(i);return o.is_infinity()||r.is_infinity()?this.INVALID_POINT:(o.add(r),o.toBytes(e),0)},HASH_ID:function(t,n){return this.hashit(t,0,n)},RANDOM_GENERATE:function(n,i){var e=new t.BIG(0);return e.rcopy(t.ROM_CURVE.CURVE_Order),t.BIG.randomnum(e,n).toBytes(i),0},EXTRACT_PIN:function(t,n,i,e){return this.EXTRACT_FACTOR(t,n,i%this.MAXPIN,this.PBLEN,e)},EXTRACT_FACTOR:function(n,i,e,o,r){var s,h,c;return(s=t.ECP.fromBytes(r)).is_infinity()?this.INVALID_POINT:(c=this.hashit(n,0,i),h=(h=t.ECP.mapit(c)).pinmul(e,o),s.sub(h),s.toBytes(r,!1),0)},RESTORE_FACTOR:function(n,i,e,o,r){var s,h,c;return(s=t.ECP.fromBytes(r)).is_infinity()?this.INVALID_POINT:(c=this.hashit(n,0,i),h=(h=t.ECP.mapit(c)).pinmul(e,o),s.add(h),s.toBytes(r,!1),0)},GET_SERVER_SECRET:function(n,i){var e,o;return o=t.ECP4.generator(),e=t.BIG.fromBytes(n),(o=t.PAIR192.G2mul(o,e)).toBytes(i),0},GET_G1_MULTIPLE:function(n,i,e,o,r){var s,h,c=new t.BIG(0);if(c.rcopy(t.ROM_CURVE.CURVE_Order),null!=n?(s=t.BIG.randomnum(c,n)).toBytes(e):s=t.BIG.fromBytes(e),0==i){if((h=t.ECP.fromBytes(o)).is_infinity())return this.INVALID_POINT}else h=t.ECP.mapit(o);return t.PAIR192.G1mul(h,s).toBytes(r,!1),0},GET_CLIENT_SECRET:function(t,n,i){return this.GET_G1_MULTIPLE(null,1,t,n,i)},GET_CLIENT_PERMIT:function(n,i,e,o,r){var s=this.hashit(n,i,o),h=t.ECP.mapit(s),c=t.BIG.fromBytes(e);return(h=t.PAIR192.G1mul(h,c)).toBytes(r,!1),0},CLIENT_1:function(n,i,e,o,r,s,h,c,u,a,f){var E,B,y,I,p,m=new t.BIG(0);if(m.rcopy(t.ROM_CURVE.CURVE_Order),null!==o?(E=t.BIG.randomnum(m,o)).toBytes(r):E=t.BIG.fromBytes(r),p=this.hashit(n,0,e),B=t.ECP.mapit(p),(y=t.ECP.fromBytes(h)).is_infinity())return this.INVALID_POINT;if(s%=this.MAXPIN,I=B.pinmul(s,this.PBLEN),y.add(I),0!=i){if((I=t.ECP.fromBytes(f)).is_infinity())return this.INVALID_POINT;y.add(I),p=this.hashit(n,i,p),I=t.ECP.mapit(p),null!=u?((B=t.PAIR192.G1mul(B,E)).toBytes(u,!1),I=t.PAIR192.G1mul(I,E),B.add(I)):(B.add(I),B=t.PAIR192.G1mul(B,E)),null!=a&&B.toBytes(a,!1)}else null!=u&&(B=t.PAIR192.G1mul(B,E)).toBytes(u,!1);return y.toBytes(c,!1),0},CLIENT_2:function(n,i,e){var o,r,s,h=new t.BIG(0);return h.rcopy(t.ROM_CURVE.CURVE_Order),(o=t.ECP.fromBytes(e)).is_infinity()?this.INVALID_POINT:(r=t.BIG.fromBytes(n),s=t.BIG.fromBytes(i),r.add(s),r.mod(h),(o=t.PAIR192.G1mul(o,r)).neg(),o.toBytes(e,!1),0)},SERVER_1:function(n,i,e,o,r){var s,h=this.hashit(n,0,e),c=t.ECP.mapit(h);c.toBytes(o,!1),0!==i&&(h=this.hashit(n,i,h),s=t.ECP.mapit(h),c.add(s),c.toBytes(r,!1))},SERVER_2:function(n,i,e,o,r,s,h,c,u,a,f){var E,B,y,I,p,m;if(void 0===f||null==f)E=t.ECP4.generator();else if((E=t.ECP4.fromBytes(f)).is_infinity())return this.INVALID_POINT;if((B=t.ECP4.fromBytes(r)).is_infinity())return this.INVALID_POINT;if(0!==n)y=t.ECP.fromBytes(h);else{if(null==s)return this.BAD_PARAMS;y=t.ECP.fromBytes(s)}if(y.is_infinity())return this.INVALID_POINT;if(I=t.BIG.fromBytes(o),0!=n)p=t.ECP.fromBytes(e);else{if(null==i)return this.BAD_PARAMS;p=t.ECP.fromBytes(i)}if(p.is_infinity())return this.INVALID_POINT;if((p=t.PAIR192.G1mul(p,I)).add(y),p.affine(),(y=t.ECP.fromBytes(c)).is_infinity())return this.INVALID_POINT;if(m=t.PAIR192.ate2(E,y,B,p),!(m=t.PAIR192.fexp(m)).isunity()){if(null!=i&&null!=s&&null!=u&&null!=a){if(m.toBytes(u),0!==n){if((p=t.ECP.fromBytes(i)).is_infinity())return this.INVALID_POINT;if((y=t.ECP.fromBytes(s)).is_infinity())return this.INVALID_POINT;(p=t.PAIR192.G1mul(p,I)).add(y),p.affine()}m=t.PAIR192.ate(E,p),(m=t.PAIR192.fexp(m)).toBytes(a)}return this.BAD_PIN}return 0},KANGAROO:function(n,i){var e,o,r,s,h,c,u,a,f=t.FP24.fromBytes(n),E=t.FP24.fromBytes(i),B=[],y=new t.FP24(E),I=[];for(s=1,r=0;r<this.TS;r++)B[r]=s,I[r]=new t.FP24(y),s*=2,y.usqr();for(y.one(),h=0,o=0;o<this.TRAP;o++)e=y.geta().geta().geta().getA().lastbits(20)%this.TS,y.mul(I[e]),h+=B[e];for(E.copy(y),E.conj(),a=0,c=0,u=0;c-h<this.MAXPIN&&!(++a>4*this.TRAP);){if(e=f.geta().geta().geta().getA().lastbits(20)%this.TS,f.mul(I[e]),c+=B[e],f.equals(y)){u=c-h;break}if(f.equals(E)){u=h-c;break}}return(a>4*this.TRAP||c-h>=this.MAXPIN)&&(u=0),u},GET_TIME:function(){var t=new Date;return Math.floor(t.getTime()/1e3)},GET_Y:function(n,i,e,o){var r=new t.BIG(0),s=this.hashit(n,i,e),h=t.BIG.fromBytes(s);return r.rcopy(t.ROM_CURVE.CURVE_Order),h.mod(r),h.toBytes(o),0},CLIENT:function(t,n,i,e,o,r,s,h,c,u,a,f,E,B){var y,I,p=0,m=[];if(0==n?y=c:(y=u,c=null),0!=(p=this.CLIENT_1(t,n,i,e,o,r,s,h,c,u,a)))return p;if(m=y.slice(),void 0!==B||null!=B)for(I=0;I<B.length;I++)m.push(B[I]);return this.GET_Y(t,f,m,E),0!=(p=this.CLIENT_2(o,E,h))?p:0},SERVER:function(t,n,i,e,o,r,s,h,c,u,a,f,E,B,y){var I,p,m,d=[];if(p=0==n?s:h,this.SERVER_1(t,n,f,i,e),d=p.slice(),void 0!==B||null!=B)for(m=0;m<B.length;m++)d.push(B[m]);return this.GET_Y(t,E,d,o),0!=(I=this.SERVER_2(n,i,e,o,r,s,h,c,u,a,y))?I:0},PRECOMPUTE:function(n,i,e,o){var r,s,h,c;return(s=t.ECP.fromBytes(n)).is_infinity()?this.INVALID_POINT:(r=t.ECP.mapit(i),c=t.ECP4.generator(),h=t.PAIR192.ate(c,s),(h=t.PAIR192.fexp(h)).toBytes(e),h=t.PAIR192.ate(c,r),(h=t.PAIR192.fexp(h)).toBytes(o),0)},HASH_ALL:function(t,n,i,e,o,r,s,h){var c,u=0,a=[];for(c=0;c<n.length;c++)a[c]=n[c];if(u+=n.length,null!=e){for(c=0;c<e.length;c++)a[c+u]=e[c];u+=e.length}else{for(c=0;c<i.length;c++)a[c+u]=i[c];u+=i.length}for(c=0;c<o.length;c++)a[c+u]=o[c];for(u+=o.length,c=0;c<r.length;c++)a[c+u]=r[c];for(u+=r.length,c=0;c<s.length;c++)a[c+u]=s[c];for(u+=s.length,c=0;c<h.length;c++)a[c+u]=h[c];return u+=h.length,this.hashit(t,0,a)},CLIENT_KEY:function(n,i,e,o,r,s,h,c,u){var a,f,E,B,y=t.FP24.fromBytes(i),I=t.FP24.fromBytes(e),p=t.BIG.fromBytes(r),m=t.BIG.fromBytes(s),d=t.BIG.fromBytes(h),l=t.ECP.fromBytes(c);if(l.is_infinity())return this.INVALID_POINT;for(l=t.PAIR192.G1mul(l,m),(f=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),p.add(d),p.mod(f),I.pinpow(o,this.PBLEN),y.mul(I),E=y.compow(p,f),a=this.mpin_hash(n,E,l),B=0;B<t.ECP.AESKEY;B++)u[B]=a[B];return 0},SERVER_KEY:function(n,i,e,o,r,s,h,c,u){var a,f,E,B,y,I,p,m,d,l;if((f=t.ECP4.fromBytes(e)).is_infinity())return this.INVALID_POINT;if((E=t.ECP.fromBytes(i)).is_infinity())return this.INVALID_POINT;if((B=t.ECP.fromBytes(s)).is_infinity())return this.INVALID_POINT;if((y=null!=c?t.ECP.fromBytes(c):t.ECP.fromBytes(h)).is_infinity())return this.INVALID_POINT;for(I=t.BIG.fromBytes(o),p=t.BIG.fromBytes(r),B=t.PAIR192.G1mul(B,p),E.add(B),E.affine(),y=t.PAIR192.G1mul(y,I),m=t.PAIR192.ate(f,E),d=(m=t.PAIR192.fexp(m)).trace(),a=this.mpin_hash(n,d,y),l=0;l<t.ECP.AESKEY;l++)u[l]=a[l];return 0},GET_DVS_KEYPAIR:function(n,i,e){var o,r,s=new t.BIG(0);return s.rcopy(t.ROM_CURVE.CURVE_Order),null!=n?(o=t.BIG.randomnum(s,n)).toBytes(i):o=t.BIG.fromBytes(i),o.invmodp(s),r=t.ECP4.generator(),(r=t.PAIR192.G2mul(r,o)).toBytes(e),0}}}(h)),void(4==h.config["@PF"]&&(h.FP2=t(h),h.FP4=n(h),h.FP8=i(h),h.FP16=function(t){var n=function(i,e){i instanceof n?(this.a=new t.FP8(i.a),this.b=new t.FP8(i.b)):(this.a=new t.FP8(i),this.b=new t.FP8(e))};return n.prototype={reduce:function(){this.a.reduce(),this.b.reduce()},norm:function(){this.a.norm(),this.b.norm()},iszilch:function(){return this.reduce(),this.a.iszilch()&&this.b.iszilch()},isunity:function(){var n=new t.FP8(1);return this.a.equals(n)&&this.b.iszilch()},cmove:function(t,n){this.a.cmove(t.a,n),this.b.cmove(t.b,n)},isreal:function(){return this.b.iszilch()},real:function(){return this.a},geta:function(){return this.a},getb:function(){return this.b},equals:function(t){return this.a.equals(t.a)&&this.b.equals(t.b)},copy:function(t){this.a.copy(t.a),this.b.copy(t.b)},zero:function(){this.a.zero(),this.b.zero()},one:function(){this.a.one(),this.b.zero()},set:function(t,n){this.a.copy(t),this.b.copy(n)},seta:function(t){this.a.copy(t),this.b.zero()},neg:function(){var n=new t.FP8(this.a),i=new t.FP8(0);this.norm(),n.add(this.b),n.neg(),i.copy(n),i.add(this.b),this.b.copy(n),this.b.add(this.a),this.a.copy(i),this.norm()},conj:function(){this.b.neg(),this.norm()},nconj:function(){this.a.neg(),this.norm()},add:function(t){this.a.add(t.a),this.b.add(t.b)},sub:function(t){var i=new n(t);i.neg(),this.add(i)},pmul:function(t){this.a.mul(t),this.b.mul(t)},qmul:function(t){this.a.qmul(t),this.b.qmul(t)},imul:function(t){this.a.imul(t),this.b.imul(t)},sqr:function(){var n=new t.FP8(this.a),i=new t.FP8(this.b),e=new t.FP8(this.a);e.mul(this.b),n.add(this.b),n.norm(),i.times_i(),i.add(this.a),i.norm(),this.a.copy(n),this.a.mul(i),i.copy(e),i.times_i(),i.add(e),i.neg(),this.a.add(i),this.b.copy(e),this.b.add(e),this.norm()},mul:function(n){var i=new t.FP8(this.a),e=new t.FP8(this.b),o=new t.FP8(0),r=new t.FP8(this.b);i.mul(n.a),e.mul(n.b),o.copy(n.b),o.add(n.a),r.add(this.a),o.norm(),r.norm(),r.mul(o),o.copy(i),o.neg(),r.add(o),o.copy(e),o.neg(),this.b.copy(r),this.b.add(o),e.times_i(),this.a.copy(e),this.a.add(i),this.norm()},toString:function(){return"["+this.a.toString()+","+this.b.toString()+"]"},inverse:function(){this.norm();var n=new t.FP8(this.a),i=new t.FP8(this.b);n.sqr(),i.sqr(),i.times_i(),i.norm(),n.sub(i),n.inverse(),this.a.mul(n),n.neg(),n.norm(),this.b.mul(n)},times_i:function(){var n=new t.FP8(this.b),i=new t.FP8(this.a);n.times_i(),this.b.copy(i),this.a.copy(n),this.norm()},times_i2:function(){this.a.times_i(),this.b.times_i()},times_i4:function(){this.a.times_i2(),this.b.times_i2()},frob:function(n){var i=new t.FP2(n);i.sqr(),i.norm(),this.a.frob(i),this.b.frob(i),this.b.qmul(n),this.b.times_i()},pow:function(i){this.norm(),i.norm();for(var e,o=new n(this),r=new t.BIG(i),s=new n(1);e=r.parity(),r.fshr(1),1===e&&s.mul(o),!r.iszilch();)o.sqr();return s.reduce(),s},xtr_A:function(t,i,e){var o=new n(t),r=new n(t);o.sub(i),o.norm(),o.pmul(this.a),r.add(i),r.norm(),r.pmul(this.b),r.times_i(),this.copy(o),this.add(r),this.add(e),this.reduce()},xtr_D:function(){var t=new n(this);this.sqr(),t.conj(),t.add(t),this.sub(t),this.reduce()},xtr_pow:function(i){var e,o,r,s=new n(3),h=new n(this),c=new n(h),u=new n(0),a=new n(0);for(c.xtr_D(),i.norm(),e=i.parity(),(o=new t.BIG(i)).fshr(1),0===e&&(o.dec(1),o.norm()),r=o.nbits()-1;r>=0;r--)1!=o.bit(r)?(u.copy(h),this.conj(),c.conj(),h.xtr_A(s,this,c),this.conj(),c.copy(u),c.xtr_D(),s.xtr_D()):(u.copy(s),u.conj(),s.copy(h),s.xtr_D(),h.xtr_A(c,this,u),c.xtr_D());return 0===e?a.copy(c):a.copy(h),a.reduce(),a},xtr_pow2:function(i,e,o,r,s){r.norm(),s.norm();for(var h,c=new t.BIG(r),u=new t.BIG(s),a=new t.BIG(0),f=new n(i),E=new n(this),B=new n(e),y=new n(o),I=new n(0),p=new n(0),m=0;0===u.parity()&&0===c.parity();)u.fshr(1),c.fshr(1),m++;for(;0!==t.BIG.comp(u,c);)t.BIG.comp(u,c)>0&&(a.copy(c),a.imul(4),a.norm(),t.BIG.comp(u,a)<=0?(a.copy(u),u.copy(c),c.rsub(a),c.norm(),p.copy(E),p.xtr_A(f,B,y),y.copy(B),y.conj(),B.copy(E),E.copy(f),f.copy(p)):0===u.parity()?(u.fshr(1),I.copy(y),I.conj(),p.copy(B),p.xtr_A(f,E,I),y.copy(B),y.xtr_D(),B.copy(p),f.xtr_D()):1==c.parity()?(u.sub(c),u.norm(),u.fshr(1),p.copy(E),p.xtr_A(f,B,y),f.xtr_D(),y.copy(E),y.xtr_D(),y.conj(),E.copy(p)):(a.copy(u),u.copy(c),u.fshr(1),c.copy(a),p.copy(B),p.xtr_D(),B.copy(y),B.conj(),y.copy(p),y.conj(),p.copy(E),p.xtr_D(),E.copy(f),f.copy(p))),t.BIG.comp(u,c)<0&&(a.copy(u),a.imul(4),a.norm(),t.BIG.comp(c,a)<=0?(c.sub(u),c.norm(),p.copy(E),p.xtr_A(f,B,y),y.copy(B),B.copy(f),f.copy(p)):0===c.parity()?(a.copy(u),u.copy(c),u.fshr(1),c.copy(a),p.copy(B),p.xtr_D(),B.copy(y),B.conj(),y.copy(p),y.conj(),p.copy(E),p.xtr_D(),E.copy(f),f.copy(p)):1==u.parity()?(a.copy(c),c.copy(u),a.sub(u),a.norm(),u.copy(a),u.fshr(1),p.copy(E),p.xtr_A(f,B,y),B.conj(),y.copy(f),y.xtr_D(),y.conj(),f.copy(E),f.xtr_D(),E.copy(p)):(u.fshr(1),I.copy(y),I.conj(),p.copy(B),p.xtr_A(f,E,I),y.copy(B),y.xtr_D(),B.copy(p),f.xtr_D()));for(I.copy(E),I.xtr_A(f,B,y),h=0;h<m;h++)I.xtr_D();return I.xtr_pow(u)}},n}(h),h.FP48=function(t){var n=function(i,e,o){i instanceof n?(this.a=new t.FP16(i.a),this.b=new t.FP16(i.b),this.c=new t.FP16(i.c)):(this.a=new t.FP16(i),this.b=new t.FP16(e),this.c=new t.FP16(o))};return n.prototype={reduce:function(){this.a.reduce(),this.b.reduce(),this.c.reduce()},norm:function(){this.a.norm(),this.b.norm(),this.c.norm()},iszilch:function(){return this.reduce(),this.a.iszilch()&&this.b.iszilch()&&this.c.iszilch()},isunity:function(){var n=new t.FP16(1);return this.a.equals(n)&&this.b.iszilch()&&this.c.iszilch()},cmove:function(t,n){this.a.cmove(t.a,n),this.b.cmove(t.b,n),this.c.cmove(t.c,n)},select:function(t,i){var e,o,r=new n(0);o=((o=(i^(e=i>>31))-e)-1)/2,this.cmove(t[0],n.teq(o,0)),this.cmove(t[1],n.teq(o,1)),this.cmove(t[2],n.teq(o,2)),this.cmove(t[3],n.teq(o,3)),this.cmove(t[4],n.teq(o,4)),this.cmove(t[5],n.teq(o,5)),this.cmove(t[6],n.teq(o,6)),this.cmove(t[7],n.teq(o,7)),r.copy(this),r.conj(),this.cmove(r,1&e)},geta:function(){return this.a},getb:function(){return this.b},getc:function(){return this.c},equals:function(t){return this.a.equals(t.a)&&this.b.equals(t.b)&&this.c.equals(t.c)},copy:function(t){this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c)},one:function(){this.a.one(),this.b.zero(),this.c.zero()},conj:function(){this.a.conj(),this.b.nconj(),this.c.conj()},set:function(t,n,i){this.a.copy(t),this.b.copy(n),this.c.copy(i)},seta:function(t){this.a.copy(t),this.b.zero(),this.c.zero()},usqr:function(){var n=new t.FP16(this.a),i=new t.FP16(this.c),e=new t.FP16(this.b),o=new t.FP16(0);this.a.sqr(),o.copy(this.a),o.add(this.a),this.a.add(o),n.nconj(),n.add(n),this.a.add(n),i.sqr(),i.times_i(),o.copy(i),o.add(i),i.add(o),e.sqr(),o.copy(e),o.add(e),e.add(o),this.b.conj(),this.b.add(this.b),this.c.nconj(),this.c.add(this.c),this.b.add(i),this.c.add(e),this.reduce()},sqr:function(){var n=new t.FP16(this.a),i=new t.FP16(this.b),e=new t.FP16(this.c),o=new t.FP16(this.a);n.sqr(),i.mul(this.c),i.add(i),e.sqr(),o.mul(this.b),o.add(o),this.c.add(this.a),this.c.add(this.b),this.c.norm(),this.c.sqr(),this.a.copy(n),n.add(i),n.add(e),n.add(o),n.neg(),i.times_i(),e.times_i(),this.a.add(i),this.b.copy(e),this.b.add(o),this.c.add(n),this.norm()},mul:function(n){var i=new t.FP16(this.a),e=new t.FP16(0),o=new t.FP16(this.b),r=new t.FP16(0),s=new t.FP16(this.a),h=new t.FP16(n.a);i.mul(n.a),o.mul(n.b),s.add(this.b),h.add(n.b),s.norm(),h.norm(),e.copy(s),e.mul(h),s.copy(this.b),s.add(this.c),h.copy(n.b),h.add(n.c),s.norm(),h.norm(),r.copy(s),r.mul(h),s.copy(i),s.neg(),h.copy(o),h.neg(),e.add(s),this.b.copy(e),this.b.add(h),r.add(h),o.add(s),s.copy(this.a),s.add(this.c),h.copy(n.a),h.add(n.c),s.norm(),h.norm(),s.mul(h),o.add(s),s.copy(this.c),s.mul(n.c),h.copy(s),h.neg(),this.c.copy(o),this.c.add(h),r.add(h),s.times_i(),this.b.add(s),r.times_i(),this.a.copy(i),this.a.add(r),this.norm()},smul:function(n,i){var e,o,r,s,h,c;i==t.ECP.D_TYPE&&(e=new t.FP16(this.a),r=new t.FP16(this.b),s=new t.FP16(this.b),h=new t.FP16(0),c=new t.FP16(n.a),e.mul(n.a),r.pmul(n.b.real()),this.b.add(this.a),c.real().add(n.b.real()),this.b.norm(),c.norm(),this.b.mul(c),s.add(this.c),s.norm(),s.pmul(n.b.real()),h.copy(e),h.neg(),c.copy(r),c.neg(),this.b.add(h),this.b.add(c),s.add(c),r.add(h),h.copy(this.a),h.add(this.c),h.norm(),h.mul(n.a),this.c.copy(r),this.c.add(h),s.times_i(),this.a.copy(e),this.a.add(s)),i==t.ECP.M_TYPE&&(e=new t.FP16(this.a),o=new t.FP16(0),r=new t.FP16(0),s=new t.FP16(0),h=new t.FP16(this.a),c=new t.FP16(0),e.mul(n.a),h.add(this.b),h.norm(),o.copy(h),o.mul(n.a),h.copy(this.b),h.add(this.c),h.norm(),s.copy(h),s.pmul(n.c.getb()),s.times_i(),h.copy(e),h.neg(),o.add(h),this.b.copy(o),r.copy(h),h.copy(this.a),h.add(this.c),c.copy(n.a),c.add(n.c),h.norm(),c.norm(),h.mul(c),r.add(h),h.copy(this.c),h.pmul(n.c.getb()),h.times_i(),c.copy(h),c.neg(),this.c.copy(r),this.c.add(c),s.add(c),h.times_i(),this.b.add(h),s.norm(),s.times_i(),this.a.copy(e),this.a.add(s)),this.norm()},inverse:function(){var n=new t.FP16(this.a),i=new t.FP16(this.b),e=new t.FP16(this.a),o=new t.FP16(0);n.sqr(),i.mul(this.c),i.times_i(),n.sub(i),n.norm(),i.copy(this.c),i.sqr(),i.times_i(),e.mul(this.b),i.sub(e),i.norm(),e.copy(this.b),e.sqr(),o.copy(this.a),o.mul(this.c),e.sub(o),e.norm(),o.copy(this.b),o.mul(e),o.times_i(),this.a.mul(n),o.add(this.a),this.c.mul(i),this.c.times_i(),o.add(this.c),o.norm(),o.inverse(),this.a.copy(n),this.a.mul(o),this.b.copy(i),this.b.mul(o),this.c.copy(e),this.c.mul(o)},frob:function(n,i){var e,o=new t.FP2(n),r=new t.FP2(n);for(o.sqr(),r.mul(o),r.mul_ip(),r.norm(),r.mul_ip(),r.norm(),e=0;e<i;e++)this.a.frob(r),this.b.frob(r),this.c.frob(r),this.b.qmul(n),this.b.times_i4(),this.b.times_i2(),this.c.qmul(o),this.c.times_i4(),this.c.times_i4(),this.c.times_i4()},trace:function(){var n=new t.FP16(0);return n.copy(this.a),n.imul(3),n.reduce(),n},toString:function(){return"["+this.a.toString()+","+this.b.toString()+","+this.c.toString()+"]"},toBytes:function(n){var i,e=[];for(this.a.geta().geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i]=e[i];for(this.a.geta().geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+t.BIG.MODBYTES]=e[i];for(this.a.geta().geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+2*t.BIG.MODBYTES]=e[i];for(this.a.geta().geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+3*t.BIG.MODBYTES]=e[i];for(this.a.geta().getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+4*t.BIG.MODBYTES]=e[i];for(this.a.geta().getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+5*t.BIG.MODBYTES]=e[i];for(this.a.geta().getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+6*t.BIG.MODBYTES]=e[i];for(this.a.geta().getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+7*t.BIG.MODBYTES]=e[i];for(this.a.getb().geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+8*t.BIG.MODBYTES]=e[i];for(this.a.getb().geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+9*t.BIG.MODBYTES]=e[i];for(this.a.getb().geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+10*t.BIG.MODBYTES]=e[i];for(this.a.getb().geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+11*t.BIG.MODBYTES]=e[i];for(this.a.getb().getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+12*t.BIG.MODBYTES]=e[i];for(this.a.getb().getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+13*t.BIG.MODBYTES]=e[i];for(this.a.getb().getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+14*t.BIG.MODBYTES]=e[i];for(this.a.getb().getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+15*t.BIG.MODBYTES]=e[i];for(this.b.geta().geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+16*t.BIG.MODBYTES]=e[i];for(this.b.geta().geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+17*t.BIG.MODBYTES]=e[i];for(this.b.geta().geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+18*t.BIG.MODBYTES]=e[i];for(this.b.geta().geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+19*t.BIG.MODBYTES]=e[i];for(this.b.geta().getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+20*t.BIG.MODBYTES]=e[i];for(this.b.geta().getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+21*t.BIG.MODBYTES]=e[i];for(this.b.geta().getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+22*t.BIG.MODBYTES]=e[i];for(this.b.geta().getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+23*t.BIG.MODBYTES]=e[i];for(this.b.getb().geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+24*t.BIG.MODBYTES]=e[i];for(this.b.getb().geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+25*t.BIG.MODBYTES]=e[i];for(this.b.getb().geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+26*t.BIG.MODBYTES]=e[i];for(this.b.getb().geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+27*t.BIG.MODBYTES]=e[i];for(this.b.getb().getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+28*t.BIG.MODBYTES]=e[i];for(this.b.getb().getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+29*t.BIG.MODBYTES]=e[i];for(this.b.getb().getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+30*t.BIG.MODBYTES]=e[i];for(this.b.getb().getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+31*t.BIG.MODBYTES]=e[i];for(this.c.geta().geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+32*t.BIG.MODBYTES]=e[i];for(this.c.geta().geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+33*t.BIG.MODBYTES]=e[i];for(this.c.geta().geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+34*t.BIG.MODBYTES]=e[i];for(this.c.geta().geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+35*t.BIG.MODBYTES]=e[i];for(this.c.geta().getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+36*t.BIG.MODBYTES]=e[i];for(this.c.geta().getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+37*t.BIG.MODBYTES]=e[i];for(this.c.geta().getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+38*t.BIG.MODBYTES]=e[i];for(this.c.geta().getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+39*t.BIG.MODBYTES]=e[i];for(this.c.getb().geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+40*t.BIG.MODBYTES]=e[i];for(this.c.getb().geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+41*t.BIG.MODBYTES]=e[i];for(this.c.getb().geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+42*t.BIG.MODBYTES]=e[i];for(this.c.getb().geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+43*t.BIG.MODBYTES]=e[i];for(this.c.getb().getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+44*t.BIG.MODBYTES]=e[i];for(this.c.getb().getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+45*t.BIG.MODBYTES]=e[i];for(this.c.getb().getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+46*t.BIG.MODBYTES]=e[i];for(this.c.getb().getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+47*t.BIG.MODBYTES]=e[i]},pow:function(i){var e,o,r,s;for(this.norm(),i.norm(),(e=new t.BIG(i)).pmul(3),e.norm(),o=new n(this),r=e.nbits()-2;r>=1;r--)o.usqr(),1==(s=e.bit(r)-i.bit(r))&&o.mul(this),-1==s&&(this.conj(),o.mul(this),this.conj());return o.reduce(),o},pinpow:function(t,i){var e,o,r=[];for(r[0]=new n(1),r[1]=new n(this),e=i-1;e>=0;e--)r[1-(o=t>>e&1)].mul(r[o]),r[o].usqr();this.copy(r[0])},compow:function(i,e){var o,r,s,h,c,u,a,f,E,B,y,I,p;return(o=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(r=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),s=new t.FP2(o,r),(h=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),(c=new t.BIG(h)).mod(e),(u=new t.BIG(i)).mod(c),(a=new t.BIG(i)).div(c),f=new n(0),E=new n(0),f.copy(this),B=f.trace(),a.iszilch()?B=B.xtr_pow(i):(E.copy(f),E.frob(s,1),y=E.trace(),f.conj(),E.mul(f),I=E.trace(),E.mul(f),p=E.trace(),B=B.xtr_pow2(y,I,p,u,a))}},n.fromBytes=function(i){var e,o,r,s,h,c,u,a,f,E,B,y,I=[];for(e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+2*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+3*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),f=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+4*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+5*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+6*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+7*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),E=new t.FP4(s,h),B=new t.FP8(f,E),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+8*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+9*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+10*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+11*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),f=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+12*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+13*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+14*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+15*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),E=new t.FP4(s,h),y=new t.FP8(f,E),c=new t.FP16(B,y),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+16*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+17*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+18*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+19*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),f=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+20*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+21*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+22*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+23*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),E=new t.FP4(s,h),B=new t.FP8(f,E),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+24*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+25*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+26*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+27*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),f=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+28*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+29*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+30*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+31*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),E=new t.FP4(s,h),y=new t.FP8(f,E),u=new t.FP16(B,y),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+32*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+33*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+34*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+35*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),f=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+36*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+37*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+38*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+39*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),E=new t.FP4(s,h),B=new t.FP8(f,E),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+40*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+41*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+42*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+43*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),h=new t.FP2(o,r),f=new t.FP4(s,h),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+44*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+45*t.BIG.MODBYTES];for(r=t.BIG.fromBytes(I),s=new t.FP2(o,r),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+46*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(I),e=0;e<t.BIG.MODBYTES;e++)I[e]=i[e+47*t.BIG.MODBYTES];return r=t.BIG.fromBytes(I),h=new t.FP2(o,r),E=new t.FP4(s,h),y=new t.FP8(f,E),a=new t.FP16(B,y),new n(c,u,a)},n.teq=function(t,n){var i=t^n;return(i-=1)>>31&1},n.pow16=function(i,e){var o,r,s,h,c,u,a,f,E,B,y=[],I=[],p=[],m=[],d=new n(0),l=new n(0),w=[],_=new t.BIG(0),S=new t.BIG(0),P=new t.BIG(0),T=[],C=[],b=[],G=[],R=[],g=[],O=[],M=[];for(o=0;o<16;o++)w[o]=new t.BIG(e[o]),w[o].norm();for(y[0]=new n(i[0]),y[1]=new n(y[0]),y[1].mul(i[1]),y[2]=new n(y[0]),y[2].mul(i[2]),y[3]=new n(y[1]),y[3].mul(i[2]),y[4]=new n(i[0]),y[4].mul(i[3]),y[5]=new n(y[1]),y[5].mul(i[3]),y[6]=new n(y[2]),y[6].mul(i[3]),y[7]=new n(y[3]),y[7].mul(i[3]),S.rcopy(t.ROM_FIELD.Fra),P.rcopy(t.ROM_FIELD.Frb),B=new t.FP2(S,P),o=0;o<8;o++)I[o]=new n(y[o]),I[o].frob(B,4),p[o]=new n(I[o]),p[o].frob(B,4),m[o]=new n(p[o]),m[o].frob(B,4);for(u=1-w[0].parity(),w[0].inc(u),w[0].norm(),a=1-w[4].parity(),w[4].inc(a),w[4].norm(),f=1-w[8].parity(),w[8].inc(f),w[8].norm(),E=1-w[12].parity(),w[12].inc(E),w[12].norm(),_.zero(),o=0;o<16;o++)_.or(w[o]);for(C[(h=1+_.nbits())-1]=1,G[h-1]=1,g[h-1]=1,M[h-1]=1,o=0;o<h-1;o++)w[0].fshr(1),C[o]=2*w[0].parity()-1,w[4].fshr(1),G[o]=2*w[4].parity()-1,w[8].fshr(1),g[o]=2*w[8].parity()-1,w[12].fshr(1),M[o]=2*w[12].parity()-1;for(o=0;o<h;o++){for(T[o]=0,s=1,r=1;r<4;r++)c=C[o]*w[r].parity(),w[r].fshr(1),w[r].dec(c>>1),w[r].norm(),T[o]+=c*s,s*=2;for(b[o]=0,s=1,r=5;r<8;r++)c=G[o]*w[r].parity(),w[r].fshr(1),w[r].dec(c>>1),w[r].norm(),b[o]+=c*s,s*=2;for(R[o]=0,s=1,r=9;r<12;r++)c=g[o]*w[r].parity(),w[r].fshr(1),w[r].dec(c>>1),w[r].norm(),R[o]+=c*s,s*=2;for(O[o]=0,s=1,r=13;r<16;r++)c=M[o]*w[r].parity(),w[r].fshr(1),w[r].dec(c>>1),w[r].norm(),O[o]+=c*s,s*=2}for(l.select(y,2*T[h-1]+1),d.select(I,2*b[h-1]+1),l.mul(d),d.select(p,2*R[h-1]+1),l.mul(d),d.select(m,2*O[h-1]+1),l.mul(d),o=h-2;o>=0;o--)l.usqr(),d.select(y,2*T[o]+C[o]),l.mul(d),d.select(I,2*b[o]+G[o]),l.mul(d),d.select(p,2*R[o]+g[o]),l.mul(d),d.select(m,2*O[o]+M[o]),l.mul(d);return d.copy(i[0]),d.conj(),d.mul(l),l.cmove(d,u),d.copy(i[4]),d.conj(),d.mul(l),l.cmove(d,a),d.copy(i[8]),d.conj(),d.mul(l),l.cmove(d,f),d.copy(i[12]),d.conj(),d.mul(l),l.cmove(d,E),l.reduce(),l},n}(h),h.ECP8=function(t){var n=function(){this.x=new t.FP8(0),this.y=new t.FP8(1),this.z=new t.FP8(0)};return n.prototype={is_infinity:function(){return this.x.reduce(),this.y.reduce(),this.z.reduce(),this.x.iszilch()&&this.z.iszilch()},copy:function(t){this.x.copy(t.x),this.y.copy(t.y),this.z.copy(t.z)},inf:function(){this.x.zero(),this.y.one(),this.z.zero()},cmove:function(t,n){this.x.cmove(t.x,n),this.y.cmove(t.y,n),this.z.cmove(t.z,n)},select:function(t,i){var e=new n,o=i>>31,r=(i^o)-o;r=(r-1)/2,this.cmove(t[0],n.teq(r,0)),this.cmove(t[1],n.teq(r,1)),this.cmove(t[2],n.teq(r,2)),this.cmove(t[3],n.teq(r,3)),this.cmove(t[4],n.teq(r,4)),this.cmove(t[5],n.teq(r,5)),this.cmove(t[6],n.teq(r,6)),this.cmove(t[7],n.teq(r,7)),e.copy(this),e.neg(),this.cmove(e,1&o)},equals:function(n){var i,e;return i=new t.FP8(this.x),e=new t.FP8(n.x),i.mul(n.z),e.mul(this.z),!!i.equals(e)&&(i.copy(this.y),i.mul(n.z),e.copy(n.y),e.mul(this.z),!!i.equals(e))},neg:function(){this.y.norm(),this.y.neg(),this.y.norm()},affine:function(){var n;if(!this.is_infinity()){if(n=new t.FP8(1),this.z.equals(n))return this.x.reduce(),void this.y.reduce();this.z.inverse(),this.x.mul(this.z),this.x.reduce(),this.y.mul(this.z),this.y.reduce(),this.z.copy(n)}},getX:function(){return this.affine(),this.x},getY:function(){return this.affine(),this.y},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},toBytes:function(n){var i,e=[];for(this.affine(),this.x.geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i]=e[i];for(this.x.geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+t.BIG.MODBYTES]=e[i];for(this.x.geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+2*t.BIG.MODBYTES]=e[i];for(this.x.geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+3*t.BIG.MODBYTES]=e[i];for(this.x.getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+4*t.BIG.MODBYTES]=e[i];for(this.x.getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+5*t.BIG.MODBYTES]=e[i];for(this.x.getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+6*t.BIG.MODBYTES]=e[i];for(this.x.getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+7*t.BIG.MODBYTES]=e[i];for(this.y.geta().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+8*t.BIG.MODBYTES]=e[i];for(this.y.geta().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+9*t.BIG.MODBYTES]=e[i];for(this.y.geta().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+10*t.BIG.MODBYTES]=e[i];for(this.y.geta().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+11*t.BIG.MODBYTES]=e[i];for(this.y.getb().geta().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+12*t.BIG.MODBYTES]=e[i];for(this.y.getb().geta().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+13*t.BIG.MODBYTES]=e[i];for(this.y.getb().getb().getA().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+14*t.BIG.MODBYTES]=e[i];for(this.y.getb().getb().getB().toBytes(e),i=0;i<t.BIG.MODBYTES;i++)n[i+15*t.BIG.MODBYTES]=e[i]},toString:function(){return this.is_infinity()?"infinity":(this.affine(),"("+this.x.toString()+","+this.y.toString()+")")},setxy:function(i,e){var o,r;this.x.copy(i),this.y.copy(e),this.z.one(),o=n.RHS(this.x),(r=new t.FP8(this.y)).sqr(),r.equals(o)||this.inf()},setx:function(t){var i;this.x.copy(t),this.z.one(),(i=n.RHS(this.x)).sqrt()?this.y.copy(i):this.inf()},frob:function(n,i){for(var e=0;e<i;e++)this.x.frob(n[2]),this.x.qmul(n[0]),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&this.x.div_i2(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&this.x.times_i2(),this.y.frob(n[2]),this.y.qmul(n[1]),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&this.y.div_i(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(this.y.times_i2(),this.y.times_i2(),this.y.times_i()),this.z.frob(n[2])},dbl:function(){var n,i,e,o,r,s;return n=new t.FP8(this.y),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(n.times_i(),n.norm()),(i=new t.FP8(this.y)).sqr(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&i.times_i(),(e=new t.FP8(n)).mul(this.z),(o=new t.FP8(this.z)).sqr(),this.z.copy(i),this.z.add(i),this.z.norm(),this.z.add(this.z),this.z.add(this.z),this.z.norm(),o.imul(3*t.ROM_CURVE.CURVE_B_I),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&o.times_i(),(r=new t.FP8(o)).mul(this.z),(s=new t.FP8(i)).add(o),s.norm(),this.z.mul(e),e.copy(o),e.add(o),o.add(e),o.norm(),i.sub(o),i.norm(),s.mul(i),s.add(r),e.copy(this.x),e.mul(n),this.x.copy(i),this.x.norm(),this.x.mul(e),this.x.add(this.x),this.x.norm(),this.y.copy(s),this.y.norm(),1},add:function(n){var i,e,o,r,s,h,c,u,a;return i=3*t.ROM_CURVE.CURVE_B_I,(e=new t.FP8(this.x)).mul(n.x),(o=new t.FP8(this.y)).mul(n.y),(r=new t.FP8(this.z)).mul(n.z),(s=new t.FP8(this.x)).add(this.y),s.norm(),(h=new t.FP8(n.x)).add(n.y),h.norm(),s.mul(h),h.copy(e),h.add(o),s.sub(h),s.norm(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&s.times_i(),h.copy(this.y),h.add(this.z),h.norm(),(c=new t.FP8(n.y)).add(n.z),c.norm(),h.mul(c),c.copy(o),c.add(r),h.sub(c),h.norm(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&h.times_i(),c.copy(this.x),c.add(this.z),c.norm(),(u=new t.FP8(n.x)).add(n.z),u.norm(),c.mul(u),u.copy(e),u.add(r),u.rsub(c),u.norm(),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(e.times_i(),o.times_i()),c.copy(e),c.add(e),e.add(c),e.norm(),r.imul(i),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&r.times_i(),(a=new t.FP8(o)).add(r),a.norm(),o.sub(r),o.norm(),u.imul(i),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&u.times_i(),c.copy(u),c.mul(h),r.copy(s),r.mul(o),c.rsub(r),u.mul(e),o.mul(a),u.add(o),e.mul(s),a.mul(h),a.add(e),this.x.copy(c),this.x.norm(),this.y.copy(u),this.y.norm(),this.z.copy(a),this.z.norm(),0},sub:function(t){var n;return t.neg(),n=this.add(t),t.neg(),n},mul:function(i){var e,o,r,s,h=new t.BIG,c=new t.BIG,u=new n,a=new n,f=new n,E=[],B=[];if(this.is_infinity())return new n;for(this.affine(),f.copy(this),f.dbl(),E[0]=new n,E[0].copy(this),e=1;e<8;e++)E[e]=new n,E[e].copy(E[e-1]),E[e].add(f);for(c.copy(i),r=c.parity(),c.inc(1),c.norm(),s=c.parity(),h.copy(c),h.inc(1),h.norm(),c.cmove(h,r),f.cmove(this,s),u.copy(f),o=1+Math.floor((c.nbits()+3)/4),e=0;e<o;e++)B[e]=c.lastbits(5)-16,c.dec(B[e]),c.norm(),c.fshr(4);for(B[o]=c.lastbits(5),a.copy(E[Math.floor((B[o]-1)/2)]),e=o-1;e>=0;e--)f.select(E,B[e]),a.dbl(),a.dbl(),a.dbl(),a.dbl(),a.add(f);return a.sub(u),a.affine(),a}},n.generator=function(){var i,e,o,r,s,h,c,u,a,f,E,B,y,I,p=new n,m=new t.BIG(0),d=new t.BIG(0);return m.rcopy(t.ROM_CURVE.CURVE_Pxaaa),d.rcopy(t.ROM_CURVE.CURVE_Pxaab),i=new t.FP2(m,d),m.rcopy(t.ROM_CURVE.CURVE_Pxaba),d.rcopy(t.ROM_CURVE.CURVE_Pxabb),e=new t.FP2(m,d),o=new t.FP4(i,e),m.rcopy(t.ROM_CURVE.CURVE_Pxbaa),d.rcopy(t.ROM_CURVE.CURVE_Pxbab),r=new t.FP2(m,d),m.rcopy(t.ROM_CURVE.CURVE_Pxbba),d.rcopy(t.ROM_CURVE.CURVE_Pxbbb),s=new t.FP2(m,d),h=new t.FP4(r,s),c=new t.FP8(o,h),m.rcopy(t.ROM_CURVE.CURVE_Pyaaa),d.rcopy(t.ROM_CURVE.CURVE_Pyaab),u=new t.FP2(m,d),m.rcopy(t.ROM_CURVE.CURVE_Pyaba),d.rcopy(t.ROM_CURVE.CURVE_Pyabb),a=new t.FP2(m,d),f=new t.FP4(u,a),m.rcopy(t.ROM_CURVE.CURVE_Pybaa),d.rcopy(t.ROM_CURVE.CURVE_Pybab),E=new t.FP2(m,d),m.rcopy(t.ROM_CURVE.CURVE_Pybba),d.rcopy(t.ROM_CURVE.CURVE_Pybbb),B=new t.FP2(m,d),y=new t.FP4(E,B),I=new t.FP8(f,y),p.setxy(c,I),p},n.fromBytes=function(i){var e,o,r,s,h,c,u,a,f,E,B=[];for(u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u];for(e=t.BIG.fromBytes(B),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),r=new t.FP2(e,o),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+2*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(B),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+3*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),s=new t.FP2(e,o),h=new t.FP4(r,s),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+4*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(B),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+5*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),r=new t.FP2(e,o),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+6*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(B),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+7*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),s=new t.FP2(e,o),c=new t.FP4(r,s),a=new t.FP8(h,c),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+8*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(B),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+9*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),r=new t.FP2(e,o),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+10*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(B),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+11*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),s=new t.FP2(e,o),h=new t.FP4(r,s),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+12*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(B),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+13*t.BIG.MODBYTES];for(o=t.BIG.fromBytes(B),r=new t.FP2(e,o),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+14*t.BIG.MODBYTES];for(e=t.BIG.fromBytes(B),u=0;u<t.BIG.MODBYTES;u++)B[u]=i[u+15*t.BIG.MODBYTES];return o=t.BIG.fromBytes(B),s=new t.FP2(e,o),c=new t.FP4(r,s),f=new t.FP8(h,c),(E=new n).setxy(a,f),E},n.RHS=function(n){var i,e,o;return n.norm(),(i=new t.FP8(n)).sqr(),(e=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_B),o=new t.FP8(e),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&o.div_i(),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&o.times_i(),i.mul(n),i.add(o),i.reduce(),i},n.mul16=function(i,e){var o,r,s,h,c,u,a,f,E,B=new n,y=new n,I=[],p=[],m=[],d=[],l=new t.BIG,w=[],_=[],S=[],P=[],T=[],C=[],b=[],G=[],R=[],g=n.frob_constants();for(o=0;o<16;o++)w[o]=new t.BIG(e[o]),w[o].norm(),i[o].affine();for(I[0]=new n,I[0].copy(i[0]),I[1]=new n,I[1].copy(I[0]),I[1].add(i[1]),I[2]=new n,I[2].copy(I[0]),I[2].add(i[2]),I[3]=new n,I[3].copy(I[1]),I[3].add(i[2]),I[4]=new n,I[4].copy(I[0]),I[4].add(i[3]),I[5]=new n,I[5].copy(I[1]),I[5].add(i[3]),I[6]=new n,I[6].copy(I[2]),I[6].add(i[3]),I[7]=new n,I[7].copy(I[3]),I[7].add(i[3]),o=0;o<8;o++)p[o]=new n,p[o].copy(I[o]),p[o].frob(g,4),m[o]=new n,m[o].copy(p[o]),m[o].frob(g,4),d[o]=new n,d[o].copy(m[o]),d[o].frob(g,4);for(u=1-w[0].parity(),w[0].inc(u),w[0].norm(),a=1-w[4].parity(),w[4].inc(a),w[4].norm(),f=1-w[8].parity(),w[8].inc(f),w[8].norm(),E=1-w[12].parity(),w[12].inc(E),w[12].norm(),l.zero(),o=0;o<16;o++)l.or(w[o]);for(S[(h=1+l.nbits())-1]=1,T[h-1]=1,b[h-1]=1,R[h-1]=1,o=0;o<h-1;o++)w[0].fshr(1),S[o]=2*w[0].parity()-1,w[4].fshr(1),T[o]=2*w[4].parity()-1,w[8].fshr(1),b[o]=2*w[8].parity()-1,w[12].fshr(1),R[o]=2*w[12].parity()-1;for(o=0;o<h;o++){for(_[o]=0,s=1,r=1;r<4;r++)c=S[o]*w[r].parity(),w[r].fshr(1),w[r].dec(c>>1),w[r].norm(),_[o]+=c*s,s*=2;for(P[o]=0,s=1,r=5;r<8;r++)c=T[o]*w[r].parity(),w[r].fshr(1),w[r].dec(c>>1),w[r].norm(),P[o]+=c*s,s*=2;for(C[o]=0,s=1,r=9;r<12;r++)c=b[o]*w[r].parity(),w[r].fshr(1),w[r].dec(c>>1),w[r].norm(),C[o]+=c*s,s*=2;for(G[o]=0,s=1,r=13;r<16;r++)c=R[o]*w[r].parity(),w[r].fshr(1),w[r].dec(c>>1),w[r].norm(),G[o]+=c*s,s*=2}for(y.select(I,2*_[h-1]+1),B.select(p,2*P[h-1]+1),y.add(B),B.select(m,2*C[h-1]+1),y.add(B),B.select(d,2*G[h-1]+1),y.add(B),o=h-2;o>=0;o--)y.dbl(),B.select(I,2*_[o]+S[o]),y.add(B),B.select(p,2*P[o]+T[o]),y.add(B),B.select(m,2*C[o]+b[o]),y.add(B),B.select(d,2*G[o]+R[o]),y.add(B);return B.copy(y),B.sub(i[0]),y.cmove(B,u),B.copy(y),B.sub(i[4]),y.cmove(B,a),B.copy(y),B.sub(i[8]),y.cmove(B,f),B.copy(y),B.sub(i[12]),y.cmove(B,E),y.affine(),y},n.teq=function(t,n){var i=t^n;return(i-=1)>>31&1},n.mapit=function(i){var e,o,r,s,h,c,u,a,f,E,B,y,I,p,m,d=n.frob_constants();for((e=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),o=t.BIG.fromBytes(i),r=new t.BIG(1),o.mod(e);c=new t.FP2(r,o),u=new t.FP4(c),h=new t.FP8(u),(s=new n).setx(h),s.is_infinity();)o.inc(1),o.norm();return(o=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),m=(p=(I=(y=(B=(E=(f=(a=s.mul(o)).mul(o)).mul(o)).mul(o)).mul(o)).mul(o)).mul(o)).mul(o),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&(a.neg(),E.neg(),y.neg(),p.neg()),m.sub(p),m.sub(s),p.sub(I),p.frob(d,1),I.sub(y),I.frob(d,2),y.sub(B),y.frob(d,3),B.sub(E),B.frob(d,4),E.sub(f),E.frob(d,5),f.sub(a),f.frob(d,6),a.sub(s),a.frob(d,7),s.dbl(),s.frob(d,8),s.add(m),s.add(p),s.add(I),s.add(y),s.add(B),s.add(E),s.add(f),s.add(a),s.affine(),s},n.frob_constants=function(){var n,i,e,o,r=new t.BIG(0),s=new t.BIG(0),h=[];return r.rcopy(t.ROM_FIELD.Fra),s.rcopy(t.ROM_FIELD.Frb),n=new t.FP2(r,s),(i=new t.FP2(n)).sqr(),(o=new t.FP2(i)).mul_ip(),o.norm(),(e=new t.FP2(o)).sqr(),o.mul(e),o.mul_ip(),o.norm(),e.copy(n),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(e.mul_ip(),e.inverse(),i.copy(e),i.sqr()),i.mul_ip(),i.norm(),e.mul(i),h[0]=new t.FP2(i),h[1]=new t.FP2(e),h[2]=new t.FP2(o),h},n}(h),h.PAIR256=function(t){var n={line:function(n,i,e,o){var r,s,h,c,u,a,f,E,B,y,I,p,m=new t.FP48(1);return n==i?(r=new t.FP8(n.getx()),s=new t.FP8(n.gety()),h=new t.FP8(n.getz()),(c=new t.FP8(s)).mul(h),r.sqr(),s.sqr(),h.sqr(),c.imul(4),c.neg(),c.norm(),c.tmul(o),r.imul(6),r.tmul(e),u=3*t.ROM_CURVE.CURVE_B_I,h.imul(u),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&h.div_2i(),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(h.times_i(),h.add(h),c.times_i(),c.norm()),h.norm(),s.add(s),h.sub(s),h.norm(),y=new t.FP16(c,h),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(I=new t.FP16(r),p=new t.FP16(0)),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(I=new t.FP16(0),(p=new t.FP16(r)).times_i()),n.dbl()):(a=new t.FP8(n.getx()),f=new t.FP8(n.gety()),E=new t.FP8(n.getz()),B=new t.FP8(n.getz()),E.mul(i.gety()),B.mul(i.getx()),a.sub(B),a.norm(),f.sub(E),f.norm(),E.copy(a),a.tmul(o),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(a.times_i(),a.norm()),E.mul(i.gety()),B.copy(f),B.mul(i.getx()),B.sub(E),B.norm(),f.tmul(e),f.neg(),f.norm(),y=new t.FP16(a,B),t.ECP.SEXTIC_TWIST==t.ECP.D_TYPE&&(I=new t.FP16(f),p=new t.FP16(0)),t.ECP.SEXTIC_TWIST==t.ECP.M_TYPE&&(I=new t.FP16(0),(p=new t.FP16(f)).times_i()),n.add(i)),m.set(y,I,p),m},ate:function(i,e){var o,r,s,h,c,u,a,f,E,B;for((o=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),r=new t.BIG(o),(s=new t.BIG(r)).pmul(3),s.norm(),c=new t.FP(e.getx()),u=new t.FP(e.gety()),a=new t.ECP8,f=new t.FP48(1),a.copy(i),B=s.nbits()-2;B>=1;B--)f.sqr(),h=n.line(a,a,c,u),f.smul(h,t.ECP.SEXTIC_TWIST),1==(E=s.bit(B)-r.bit(B))&&(h=n.line(a,i,c,u),f.smul(h,t.ECP.SEXTIC_TWIST)),-1==E&&(i.neg(),h=n.line(a,i,c,u),f.smul(h,t.ECP.SEXTIC_TWIST),i.neg());return t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&f.conj(),f},ate2:function(i,e,o,r){var s,h,c,u,a,f,E,B,y,I,p,m,d;for((s=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),h=new t.BIG(s),(c=new t.BIG(h)).pmul(3),c.norm(),a=new t.FP(e.getx()),f=new t.FP(e.gety()),E=new t.FP(r.getx()),B=new t.FP(r.gety()),y=new t.ECP8,I=new t.ECP8,p=new t.FP48(1),y.copy(i),I.copy(o),d=c.nbits()-2;d>=1;d--)p.sqr(),u=n.line(y,y,a,f),p.smul(u,t.ECP.SEXTIC_TWIST),u=n.line(I,I,E,B),p.smul(u,t.ECP.SEXTIC_TWIST),1==(m=c.bit(d)-h.bit(d))&&(u=n.line(y,i,a,f),p.smul(u,t.ECP.SEXTIC_TWIST),u=n.line(I,o,E,B),p.smul(u,t.ECP.SEXTIC_TWIST)),-1==m&&(i.neg(),u=n.line(y,i,a,f),p.smul(u,t.ECP.SEXTIC_TWIST),i.neg(),o.neg(),u=n.line(I,o,E,B),p.smul(u,t.ECP.SEXTIC_TWIST),o.neg());return t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&p.conj(),p},fexp:function(n){var i,e,o,r,s,h,c,u,a,f;return(i=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(e=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),o=new t.FP2(i,e),(r=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),s=new t.FP48(n),(h=new t.FP48(s)).inverse(),s.conj(),s.mul(h),h.copy(s),s.frob(o,8),s.mul(h),(f=new t.FP48(s)).usqr(),c=f.pow(r),r.fshr(1),u=c.pow(r),r.fshl(1),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),(a=new t.FP48(c)).conj(),u.mul(a),u.mul(s),s.mul(f),c=u.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,14),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,13),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,12),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,11),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,10),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,9),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,8),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(u),a.conj(),c.mul(a),a.copy(c),a.frob(o,7),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,6),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,5),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,4),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,3),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,2),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),a.copy(c),a.frob(o,1),s.mul(a),c=c.pow(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&c.conj(),s.mul(c),u.frob(o,15),s.mul(u),s.reduce(),s},glv:function(n){var i,e,o,r=[];return(i=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),(e=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),o=t.BIG.smul(e,e),e=t.BIG.smul(o,o),o=t.BIG.smul(e,e),r[0]=new t.BIG(n),r[0].mod(o),r[1]=new t.BIG(n),r[1].div(o),r[1].rsub(i),r},gs:function(n){var i,e,o,r,s=[];for((o=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Bnx),(e=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),r=new t.BIG(n),i=0;i<15;i++)s[i]=new t.BIG(r),s[i].mod(o),r.div(o);return s[15]=new t.BIG(r),t.ECP.SIGN_OF_X==t.ECP.NEGATIVEX&&(s[1].copy(t.BIG.modneg(s[1],e)),s[3].copy(t.BIG.modneg(s[3],e)),s[5].copy(t.BIG.modneg(s[5],e)),s[7].copy(t.BIG.modneg(s[7],e)),s[9].copy(t.BIG.modneg(s[9],e)),s[11].copy(t.BIG.modneg(s[11],e)),s[13].copy(t.BIG.modneg(s[13],e)),s[15].copy(t.BIG.modneg(s[15],e))),s},G1mul:function(i,e){var o,r,s,h,c,u,a,f;return t.ROM_CURVE.USE_GLV?(i.affine(),(o=new t.ECP).copy(i),(r=new t.ECP).copy(i),(s=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),(h=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Cru),c=new t.FP(h),u=new t.BIG(0),a=n.glv(e),r.getx().mul(c),f=a[0].nbits(),u.copy(t.BIG.modneg(a[0],s)),u.nbits()<f&&(a[0].copy(u),o.neg()),f=a[1].nbits(),u.copy(t.BIG.modneg(a[1],s)),u.nbits()<f&&(a[1].copy(u),r.neg()),a[0].norm(),a[1].norm(),o=o.mul2(a[0],r,a[1])):o=i.mul(e),o},G2mul:function(i,e){var o,r,s,h,c,u,a,f;if(t.ROM_CURVE.USE_GS_G2){for(r=[],s=t.ECP8.frob_constants(),(h=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),c=n.gs(e),u=new t.BIG(0),i.affine(),r[0]=new t.ECP8,r[0].copy(i),a=1;a<16;a++)r[a]=new t.ECP8,r[a].copy(r[a-1]),r[a].frob(s,1);for(a=0;a<16;a++)f=c[a].nbits(),u.copy(t.BIG.modneg(c[a],h)),u.nbits()<f&&(c[a].copy(u),r[a].neg()),c[a].norm();o=t.ECP8.mul16(r,c)}else o=i.mul(e);return o},GTpow:function(i,e){var o,r,s,h,c,u,a,f,E,B;if(t.ROM_CURVE.USE_GS_GT){for(r=[],(s=new t.BIG(0)).rcopy(t.ROM_FIELD.Fra),(h=new t.BIG(0)).rcopy(t.ROM_FIELD.Frb),c=new t.FP2(s,h),(u=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),a=new t.BIG(0),f=n.gs(e),r[0]=new t.FP48(i),E=1;E<16;E++)r[E]=new t.FP48(0),r[E].copy(r[E-1]),r[E].frob(c,1);for(E=0;E<16;E++)B=f[E].nbits(),a.copy(t.BIG.modneg(f[E],u)),a.nbits()<B&&(f[E].copy(a),r[E].conj()),f[E].norm();o=t.FP48.pow16(r,f)}else o=i.pow(e);return o}};return n}(h),h.MPIN256=function(t){return{BAD_PARAMS:-11,INVALID_POINT:-14,WRONG_ORDER:-18,BAD_PIN:-19,MAXPIN:1e4,PBLEN:14,TS:12,TRAP:2e3,EFS:t.BIG.MODBYTES,EGS:t.BIG.MODBYTES,SHA256:32,SHA384:48,SHA512:64,today:function(){var t=new Date;return Math.floor(t.getTime()/864e5)},bytestostring:function(t){var n,i,e="",o=t.length;for(i=0;i<o;i++)e+=((n=t[i])>>>4&15).toString(16),e+=(15&n).toString(16);return e},stringtobytes:function(t){var n,i=[];for(n=0;n<t.length;n++)i.push(t.charCodeAt(n));return i},comparebytes:function(t,n){if(t.length!=n.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!=n[i])return!1;return!0},mpin_hash:function(n,i,e){var o,r,s,h,c=[],u=[];for(i.geta().geta().geta().getA().toBytes(u),h=0;h<this.EFS;h++)c[h]=u[h];for(i.geta().geta().geta().getB().toBytes(u),h=this.EFS;h<2*this.EFS;h++)c[h]=u[h-this.EFS];for(i.geta().geta().getb().getA().toBytes(u),h=2*this.EFS;h<3*this.EFS;h++)c[h]=u[h-2*this.EFS];for(i.geta().geta().getb().getB().toBytes(u),h=3*this.EFS;h<4*this.EFS;h++)c[h]=u[h-3*this.EFS];for(i.geta().getb().geta().getA().toBytes(u),h=4*this.EFS;h<5*this.EFS;h++)c[h]=u[h-4*this.EFS];for(i.geta().getb().geta().getB().toBytes(u),h=5*this.EFS;h<6*this.EFS;h++)c[h]=u[h-5*this.EFS];for(i.geta().getb().getb().getA().toBytes(u),h=6*this.EFS;h<7*this.EFS;h++)c[h]=u[h-6*this.EFS];for(i.geta().getb().getb().getB().toBytes(u),h=7*this.EFS;h<8*this.EFS;h++)c[h]=u[h-7*this.EFS];for(i.getb().geta().geta().getA().toBytes(u),h=8*this.EFS;h<9*this.EFS;h++)c[h]=u[h-8*this.EFS];for(i.getb().geta().geta().getB().toBytes(u),h=9*this.EFS;h<10*this.EFS;h++)c[h]=u[h-9*this.EFS];for(i.getb().geta().getb().getA().toBytes(u),h=10*this.EFS;h<11*this.EFS;h++)c[h]=u[h-10*this.EFS];for(i.getb().geta().getb().getB().toBytes(u),h=11*this.EFS;h<12*this.EFS;h++)c[h]=u[h-11*this.EFS];for(i.getb().getb().geta().getA().toBytes(u),h=12*this.EFS;h<13*this.EFS;h++)c[h]=u[h-12*this.EFS];for(i.getb().getb().geta().getB().toBytes(u),h=13*this.EFS;h<14*this.EFS;h++)c[h]=u[h-13*this.EFS];for(i.getb().getb().getb().getA().toBytes(u),h=14*this.EFS;h<15*this.EFS;h++)c[h]=u[h-14*this.EFS];for(i.getb().getb().getb().getB().toBytes(u),h=15*this.EFS;h<16*this.EFS;h++)c[h]=u[h-15*this.EFS];for(e.getX().toBytes(u),h=16*this.EFS;h<17*this.EFS;h++)c[h]=u[h-16*this.EFS];for(e.getY().toBytes(u),h=17*this.EFS;h<18*this.EFS;h++)c[h]=u[h-17*this.EFS];if(n==this.SHA256?r=new t.HASH256:n==this.SHA384?r=new t.HASH384:n==this.SHA512&&(r=new t.HASH512),r.process_array(c),0==(o=r.hash()).length)return null;for(s=[],h=0;h<t.ECP.AESKEY;h++)s[h]=o[h];return s},hashit:function(n,i,e){var o,r,s,h,c;if(n==this.SHA256?r=new t.HASH256:n==this.SHA384?r=new t.HASH384:n==this.SHA512&&(r=new t.HASH512),i>0&&r.process_num(i),r.process_array(e),0==(o=r.hash()).length)return null;if(s=[],n>=(c=t.BIG.MODBYTES))for(h=0;h<c;h++)s[h]=o[h];else{for(h=0;h<n;h++)s[h+c-n]=o[h];for(h=0;h<c-n;h++)s[h]=0}return s},map:function(n,i){var e=new t.ECP,o=new t.BIG(n),r=new t.BIG(0);for(r.rcopy(t.ROM_FIELD.Modulus),o.mod(r);e.setxi(o,i),e.is_infinity();)o.inc(1),o.norm();return e},unmap:function(n,i){var e=i.getS(),o=new t.ECP,r=0,s=i.getX();for(n.copy(s);n.dec(1),n.norm(),r++,o.setxi(n,e),o.is_infinity(););return r},ENCODING:function(n,i){var e,o,r,s,h,c,u,a,f,E,B=[];for(e=0;e<this.EFS;e++)B[e]=i[e+1];for(c=t.BIG.fromBytes(B),e=0;e<this.EFS;e++)B[e]=i[e+this.EFS+1];if(u=t.BIG.fromBytes(B),(a=new t.ECP(0)).setxy(c,u),a.is_infinity())return this.INVALID_POINT;for((f=new t.BIG(0)).rcopy(t.ROM_FIELD.Modulus),c=t.BIG.randomnum(f,n),(s=n.getByte())<0&&(s=-s),s%=2,E=this.map(c,s),a.sub(E),h=a.getS(),o=this.unmap(u,a),(r=n.getByte())<0&&(r=-r),r%=o,u.inc(r+1),i[0]=s+2*h,c.toBytes(B),e=0;e<this.EFS;e++)i[e+1]=B[e];for(u.toBytes(B),e=0;e<this.EFS;e++)i[e+this.EFS+1]=B[e];return 0},DECODING:function(n){var i,e,o,r,s,h,c,u=[];if(4&n[0])return this.INVALID_POINT;for(i=0;i<this.EFS;i++)u[i]=n[i+1];for(r=t.BIG.fromBytes(u),i=0;i<this.EFS;i++)u[i]=n[i+this.EFS+1];for(s=t.BIG.fromBytes(u),e=1&n[0],o=n[0]>>1&1,h=this.map(r,e),(c=this.map(s,o)).add(h),r=c.getX(),s=c.getY(),n[0]=4,r.toBytes(u),i=0;i<this.EFS;i++)n[i+1]=u[i];for(s.toBytes(u),i=0;i<this.EFS;i++)n[i+this.EFS+1]=u[i];return 0},RECOMBINE_G1:function(n,i,e){var o=t.ECP.fromBytes(n),r=t.ECP.fromBytes(i);return o.is_infinity()||r.is_infinity()?this.INVALID_POINT:(o.add(r),o.toBytes(e,!1),0)},RECOMBINE_G2:function(n,i,e){var o=t.ECP8.fromBytes(n),r=t.ECP8.fromBytes(i);return o.is_infinity()||r.is_infinity()?this.INVALID_POINT:(o.add(r),o.toBytes(e),0)},HASH_ID:function(t,n){return this.hashit(t,0,n)},RANDOM_GENERATE:function(n,i){var e=new t.BIG(0);return e.rcopy(t.ROM_CURVE.CURVE_Order),t.BIG.randomnum(e,n).toBytes(i),0},EXTRACT_PIN:function(t,n,i,e){return this.EXTRACT_FACTOR(t,n,i%this.MAXPIN,this.PBLEN,e)},EXTRACT_FACTOR:function(n,i,e,o,r){var s,h,c;return(s=t.ECP.fromBytes(r)).is_infinity()?this.INVALID_POINT:(c=this.hashit(n,0,i),h=(h=t.ECP.mapit(c)).pinmul(e,o),s.sub(h),s.toBytes(r,!1),0)},RESTORE_FACTOR:function(n,i,e,o,r){var s,h,c;return(s=t.ECP.fromBytes(r)).is_infinity()?this.INVALID_POINT:(c=this.hashit(n,0,i),h=(h=t.ECP.mapit(c)).pinmul(e,o),s.add(h),s.toBytes(r,!1),0)},GET_SERVER_SECRET:function(n,i){var e,o;return o=t.ECP8.generator(),e=t.BIG.fromBytes(n),(o=t.PAIR256.G2mul(o,e)).toBytes(i),0},GET_G1_MULTIPLE:function(n,i,e,o,r){var s,h,c=new t.BIG(0);if(c.rcopy(t.ROM_CURVE.CURVE_Order),null!=n?(s=t.BIG.randomnum(c,n)).toBytes(e):s=t.BIG.fromBytes(e),0==i){if((h=t.ECP.fromBytes(o)).is_infinity())return this.INVALID_POINT}else h=t.ECP.mapit(o);return t.PAIR256.G1mul(h,s).toBytes(r,!1),0},GET_CLIENT_SECRET:function(t,n,i){return this.GET_G1_MULTIPLE(null,1,t,n,i)},GET_CLIENT_PERMIT:function(n,i,e,o,r){var s=this.hashit(n,i,o),h=t.ECP.mapit(s),c=t.BIG.fromBytes(e);return(h=t.PAIR256.G1mul(h,c)).toBytes(r,!1),0},CLIENT_1:function(n,i,e,o,r,s,h,c,u,a,f){var E,B,y,I,p,m=new t.BIG(0);if(m.rcopy(t.ROM_CURVE.CURVE_Order),null!==o?(E=t.BIG.randomnum(m,o)).toBytes(r):E=t.BIG.fromBytes(r),p=this.hashit(n,0,e),B=t.ECP.mapit(p),(y=t.ECP.fromBytes(h)).is_infinity())return this.INVALID_POINT;if(s%=this.MAXPIN,I=B.pinmul(s,this.PBLEN),y.add(I),0!=i){if((I=t.ECP.fromBytes(f)).is_infinity())return this.INVALID_POINT;y.add(I),p=this.hashit(n,i,p),I=t.ECP.mapit(p),null!=u?((B=t.PAIR256.G1mul(B,E)).toBytes(u,!1),I=t.PAIR256.G1mul(I,E),B.add(I)):(B.add(I),B=t.PAIR256.G1mul(B,E)),null!=a&&B.toBytes(a,!1)}else null!=u&&(B=t.PAIR256.G1mul(B,E)).toBytes(u,!1);return y.toBytes(c,!1),0},CLIENT_2:function(n,i,e){var o,r,s,h=new t.BIG(0);return h.rcopy(t.ROM_CURVE.CURVE_Order),(o=t.ECP.fromBytes(e)).is_infinity()?this.INVALID_POINT:(r=t.BIG.fromBytes(n),s=t.BIG.fromBytes(i),r.add(s),r.mod(h),(o=t.PAIR256.G1mul(o,r)).neg(),o.toBytes(e,!1),0)},SERVER_1:function(n,i,e,o,r){var s,h=this.hashit(n,0,e),c=t.ECP.mapit(h);c.toBytes(o,!1),0!==i&&(h=this.hashit(n,i,h),s=t.ECP.mapit(h),c.add(s),c.toBytes(r,!1))},SERVER_2:function(n,i,e,o,r,s,h,c,u,a,f){var E,B,y,I,p,m;if(void 0===f||null==f)E=t.ECP8.generator();else if((E=t.ECP8.fromBytes(f)).is_infinity())return this.INVALID_POINT;if((B=t.ECP8.fromBytes(r)).is_infinity())return this.INVALID_POINT;if(0!==n)y=t.ECP.fromBytes(h);else{if(null==s)return this.BAD_PARAMS;y=t.ECP.fromBytes(s)}if(y.is_infinity())return this.INVALID_POINT;if(I=t.BIG.fromBytes(o),0!=n)p=t.ECP.fromBytes(e);else{if(null==i)return this.BAD_PARAMS;p=t.ECP.fromBytes(i)}if(p.is_infinity())return this.INVALID_POINT;if((p=t.PAIR256.G1mul(p,I)).add(y),p.affine(),(y=t.ECP.fromBytes(c)).is_infinity())return this.INVALID_POINT;if(m=t.PAIR256.ate2(E,y,B,p),!(m=t.PAIR256.fexp(m)).isunity()){if(null!=i&&null!=s&&null!=u&&null!=a){if(m.toBytes(u),0!==n){if((p=t.ECP.fromBytes(i)).is_infinity())return this.INVALID_POINT;if((y=t.ECP.fromBytes(s)).is_infinity())return this.INVALID_POINT;(p=t.PAIR256.G1mul(p,I)).add(y),p.affine()}m=t.PAIR256.ate(E,p),(m=t.PAIR256.fexp(m)).toBytes(a)}return this.BAD_PIN}return 0},KANGAROO:function(n,i){var e,o,r,s,h,c,u,a,f=t.FP48.fromBytes(n),E=t.FP48.fromBytes(i),B=[],y=new t.FP48(E),I=[];for(s=1,r=0;r<this.TS;r++)B[r]=s,I[r]=new t.FP48(y),s*=2,y.usqr();for(y.one(),h=0,o=0;o<this.TRAP;o++)e=y.geta().geta().geta().geta().getA().lastbits(20)%this.TS,y.mul(I[e]),h+=B[e];for(E.copy(y),E.conj(),a=0,c=0,u=0;c-h<this.MAXPIN&&!(++a>4*this.TRAP);){if(e=f.geta().geta().geta().geta().getA().lastbits(20)%this.TS,f.mul(I[e]),c+=B[e],f.equals(y)){u=c-h;break}if(f.equals(E)){u=h-c;break}}return(a>4*this.TRAP||c-h>=this.MAXPIN)&&(u=0),u},GET_TIME:function(){var t=new Date;return Math.floor(t.getTime()/1e3)},GET_Y:function(n,i,e,o){var r=new t.BIG(0),s=this.hashit(n,i,e),h=t.BIG.fromBytes(s);return r.rcopy(t.ROM_CURVE.CURVE_Order),h.mod(r),h.toBytes(o),0},CLIENT:function(t,n,i,e,o,r,s,h,c,u,a,f,E,B){var y,I,p=0,m=[];if(0==n?y=c:(y=u,c=null),0!=(p=this.CLIENT_1(t,n,i,e,o,r,s,h,c,u,a)))return p;if(m=y.slice(),void 0!==B||null!=B)for(I=0;I<B.length;I++)m.push(B[I]);return this.GET_Y(t,f,m,E),0!=(p=this.CLIENT_2(o,E,h))?p:0},SERVER:function(t,n,i,e,o,r,s,h,c,u,a,f,E,B,y){var I,p,m,d=[];if(p=0==n?s:h,this.SERVER_1(t,n,f,i,e),d=p.slice(),void 0!==B||null!=B)for(m=0;m<B.length;m++)d.push(B[m]);return this.GET_Y(t,E,d,o),0!=(I=this.SERVER_2(n,i,e,o,r,s,h,c,u,a,y))?I:0},PRECOMPUTE:function(n,i,e,o){var r,s,h,c;return(s=t.ECP.fromBytes(n)).is_infinity()?this.INVALID_POINT:(r=t.ECP.mapit(i),c=t.ECP8.generator(),h=t.PAIR256.ate(c,s),(h=t.PAIR256.fexp(h)).toBytes(e),h=t.PAIR256.ate(c,r),(h=t.PAIR256.fexp(h)).toBytes(o),0)},HASH_ALL:function(t,n,i,e,o,r,s,h){var c,u=0,a=[];for(c=0;c<n.length;c++)a[c]=n[c];if(u+=n.length,null!=e){for(c=0;c<e.length;c++)a[c+u]=e[c];u+=e.length}else{for(c=0;c<i.length;c++)a[c+u]=i[c];u+=i.length}for(c=0;c<o.length;c++)a[c+u]=o[c];for(u+=o.length,c=0;c<r.length;c++)a[c+u]=r[c];for(u+=r.length,c=0;c<s.length;c++)a[c+u]=s[c];for(u+=s.length,c=0;c<h.length;c++)a[c+u]=h[c];return u+=h.length,this.hashit(t,0,a)},CLIENT_KEY:function(n,i,e,o,r,s,h,c,u){var a,f,E,B,y=t.FP48.fromBytes(i),I=t.FP48.fromBytes(e),p=t.BIG.fromBytes(r),m=t.BIG.fromBytes(s),d=t.BIG.fromBytes(h),l=t.ECP.fromBytes(c);if(l.is_infinity())return this.INVALID_POINT;for(l=t.PAIR256.G1mul(l,m),(f=new t.BIG(0)).rcopy(t.ROM_CURVE.CURVE_Order),p.add(d),p.mod(f),I.pinpow(o,this.PBLEN),y.mul(I),E=y.compow(p,f),a=this.mpin_hash(n,E,l),B=0;B<t.ECP.AESKEY;B++)u[B]=a[B];return 0},SERVER_KEY:function(n,i,e,o,r,s,h,c,u){var a,f,E,B,y,I,p,m,d,l;if((f=t.ECP8.fromBytes(e)).is_infinity())return this.INVALID_POINT;if((E=t.ECP.fromBytes(i)).is_infinity())return this.INVALID_POINT;if((B=t.ECP.fromBytes(s)).is_infinity())return this.INVALID_POINT;if((y=null!=c?t.ECP.fromBytes(c):t.ECP.fromBytes(h)).is_infinity())return this.INVALID_POINT;for(I=t.BIG.fromBytes(o),p=t.BIG.fromBytes(r),B=t.PAIR256.G1mul(B,p),E.add(B),E.affine(),y=t.PAIR256.G1mul(y,I),m=t.PAIR256.ate(f,E),d=(m=t.PAIR256.fexp(m)).trace(),a=this.mpin_hash(n,d,y),l=0;l<t.ECP.AESKEY;l++)u[l]=a[l];return 0},GET_DVS_KEYPAIR:function(n,i,e){var o,r,s=new t.BIG(0);return s.rcopy(t.ROM_CURVE.CURVE_Order),null!=n?(o=t.BIG.randomnum(s,n)).toBytes(i):o=t.BIG.fromBytes(i),o.invmodp(s),r=t.ECP8.generator(),(r=t.PAIR256.G2mul(r,o)).toBytes(e),0}}}(h)))):void 0}var s={};function h(t){var n,i=this;i.rng=new(i._crypto().RAND),i.rng.clean(),n=i._hexToBytes(t),i.rng.seed(n.length,n)}function c(t,n,i){var e=this;if("function"!=typeof t.getItem||"function"!=typeof t.setItem)throw new Error("Invalid user storage object");if(!n)throw new Error("Project ID must be provided when configuring storage");if(!i)throw new Error("Storage key must be provided when configuring storage");e.storage=t,e.projectId=n,e.storageKey=i,e.loadData()}function u(t,n,i,e){this.requestTimeout=t,this.clientName=n,this.projectId=i,this.cors=e}function a(t){var n=this;if(!t)throw new Error("Invalid configuration");if(!t.projectId)throw new Error("Empty project ID");if(!t.userStorage)throw new Error("Invalid user storage");t.server?t.server=t.server.replace(/\/$/,""):t.server="https://api.mpin.io",(!t.defaultPinLength||t.defaultPinLength>6||t.defaultPinLength<4)&&(t.defaultPinLength=4),t.requestTimeout&&!isNaN(t.requestTimeout)||(t.requestTimeout=4e3),t.oidc||(t.oidc={}),t.clientName="MIRACL Client.js/8.6.0"+(t.applicationInfo?" "+t.applicationInfo:""),n.options=t,n.http=new u(t.requestTimeout,t.clientName,t.projectId,t.cors),n.crypto=new h(t.seed),n.users=new c(t.userStorage,t.projectId,"mfa")}h.prototype._crypto=function(t){return t||(t="BN254CX"),s[t]||(s[t]=new r(t),s[t].MPIN.MAXPIN=1e6,s[t].MPIN.PBLEN=20,s[t].MPIN.TRAP=2e3),s[t]},h.prototype.generateKeypair=function(t){var n,i=this,e=[],o=[];if(0!=(n=i._crypto(t).MPIN.GET_DVS_KEYPAIR(i.rng,e,o)))throw new Error("Could not generate key pair: "+n);return{publicKey:i._bytesToHex(o),privateKey:i._bytesToHex(e)}},h.prototype.addShares=function(t,n,i,e){var o,r,s,h,c=this,u=[];if(o=c._hexToBytes(t),r=c._hexToBytes(n),s=c._hexToBytes(i),0!==(h=c._crypto(e).MPIN.RECOMBINE_G1(r,s,u)))throw new Error("Could not combine the client secret shares: "+h);if(0!=(h=c._crypto(e).MPIN.GET_G1_MULTIPLE(null,0,o,u,u)))throw new Error("Could not combine private key with client secret: "+h);return c._bytesToHex(u)},h.prototype.extractPin=function(t,n,i,e,o){var r,s,h,c=this;if(r=c._hexToBytes(e),s=c._hexToBytes(c._mpinIdWithPublicKey(t,n)),0!==(h=c._crypto(o).MPIN.EXTRACT_PIN(c._crypto(o).MPIN.SHA256,s,i,r)))throw new Error("Could not extract PIN from client secret: "+h);return c._bytesToHex(r)},h.prototype.calculatePass1=function(t,n,i,e,o,r,s){var h,c,u=this,a=[],f=[];if(h=u._mpinIdWithPublicKey(n,i),0!==(c=u._crypto(t).MPIN.CLIENT_1(u._crypto(t).MPIN.SHA256,0,u._hexToBytes(h),u.rng,r,o,u._hexToBytes(e),s,a,f,u._hexToBytes(0))))throw new Error("Could not calculate pass 1 request data: "+c);return{UT:u._bytesToHex(f),U:u._bytesToHex(a)}},h.prototype.calculatePass2=function(t,n,i,e){var o,r=this;if(0!==(o=r._crypto(t).MPIN.CLIENT_2(n,r._hexToBytes(i),e)))throw new Error("Could not calculate pass 2 request data: "+o);return r._bytesToHex(e)},h.prototype.sign=function(t,n,i,e,o,r,s){var h,c,u=this,a=[],f=[];if(h=u._mpinIdWithPublicKey(n,i),0!=(c=u._crypto(t).MPIN.CLIENT(u._crypto(t).MPIN.SHA256,0,u._hexToBytes(h),u.rng,[],o,u._hexToBytes(e),a,f,null,null,s,[],u._hexToBytes(r))))throw new Error("Could not sign message: "+c);return{U:u._bytesToHex(f),V:u._bytesToHex(a)}},h.prototype._mpinIdWithPublicKey=function(t,n){var i,e=this,o=e._hexToBytes(t),r=e._hexToBytes(n);if(o){if(!r)return t;for(i=0;i<r.length;i++)o.push(r[i]);return e._bytesToHex(o)}},h.prototype._hexToBytes=function(t){var n,i,e;if(t){for(n=t.length,i=[],e=0;e<n;e+=2)i[e/2]=parseInt(t.substr(e,2),16);return i}},h.prototype._bytesToHex=function(t){var n,i,e="",o=t.length;for(i=0;i<o;i++)e+=((n=t[i])>>>4&15).toString(16),e+=(15&n).toString(16);return e},c.prototype.data=[],c.prototype.states={start:"STARTED",register:"REGISTERED",revoked:"REVOKED"},c.prototype.loadData=function(){var t=this;t.data=JSON.parse(t.storage.getItem(t.storageKey))||[],t.store(),t.data.sort((function(t,n){return t.lastUsed&&(!n.lastUsed||t.lastUsed>n.lastUsed)?1:n.lastUsed&&(!t.lastUsed||t.lastUsed<n.lastUsed)?-1:0}))},c.prototype.write=function(t,n){var i,e,o=this;for(o.exists(t)||o.data.push({userId:t,projectId:o.projectId,state:o.states.invalid,created:Math.round((new Date).getTime()/1e3)}),i=0;i<o.data.length;++i)if(o.data[i].userId===t&&(o.data[i].projectId===o.projectId||o.data[i].customerId===o.projectId))for(e in n)n[e]&&(o.data[i][e]=n[e]);o.store()},c.prototype.updateLastUsed=function(t){this.write(t,{lastUsed:(new Date).getTime()})},c.prototype.exists=function(t){return void 0!==this.get(t,"userId")},c.prototype.is=function(t,n){return this.get(t,"state")===n},c.prototype.get=function(t,n){var i,e=this;for(i=0;i<e.data.length;++i)if(e.data[i].userId===t&&(e.data[i].projectId===e.projectId||e.data[i].customerId===e.projectId))return n?e.data[i][n]||"":e.data[i]},c.prototype.list=function(){var t,n=this,i={};for(t=0;t<n.data.length;++t)n.data[t].projectId!==n.projectId&&n.data[t].customerId!==n.projectId||(i[n.data[t].userId]=n.data[t].state);return i},c.prototype.all=function(){var t,n=this,i=[];for(t=0;t<n.data.length;++t)n.data[t].projectId!==n.projectId&&n.data[t].customerId!==n.projectId||i.push(n.data[t]);return i},c.prototype.count=function(){return Object.keys(this.list()).length},c.prototype.remove=function(t){var n,i=this;if(i.exists(t)){for(n=0;n<i.data.length;++n)i.data[n].userId!==t||i.data[n].projectId!==i.projectId&&i.data[n].customerId!==i.projectId||i.data.splice(n,1);i.store()}},c.prototype.store=function(){var t,n=this;for(t=0;t<n.data.length;++t)delete n.data[t].csHex,delete n.data[t].regOTT;n.storage.setItem(n.storageKey,JSON.stringify(n.data))},u.prototype.request=function(t,n){var i,e,o,r=this;if("function"!=typeof n)throw new Error("Bad or missing callback");if(!t.url)throw new Error("Missing URL for request");return o=new XMLHttpRequest,i=t.url,e=t.type||"GET",o.onreadystatechange=function(){var t;if(4===o.readyState&&200===o.status){try{t=JSON.parse(o.responseText)}catch(n){t=o.responseText}n(null,t)}else if(4===o.readyState){if(0===o.status)return void n(new Error("The request was aborted"),{status:0});try{t=JSON.parse(o.responseText)}catch(t){return void n(new Error(o.statusText),{status:o.status})}n(new Error(t.info),{status:o.status,error:t.error,context:t.context})}},r.cors&&(i+=(-1!==i.indexOf("?")?"&":"?")+"project_id="+r.projectId),o.open(e,i,!0),o.timeout=r.requestTimeout,o.setRequestHeader("X-MIRACL-CID",r.projectId),o.setRequestHeader("X-MIRACL-CLIENT",r.clientName),t.authorization&&o.setRequestHeader("Authorization",t.authorization),t.data?(o.setRequestHeader("Content-Type","application/json"),o.send(JSON.stringify(t.data))):o.send(),o},a.prototype.options={},a.prototype.session={},a.prototype.setAccessId=function(t){this.session.accessId=t},a.prototype.fetchAccessId=function(t,n){var i,e=this;i={url:e.options.server+"/rps/v2/session",type:"POST",data:{projectId:e.options.projectId,userId:t}},e.http.request(i,(function(t,i){if(t)return n(t,null);e.session=i,n(null,i)}))},a.prototype.fetchStatus=function(t){var n,i=this;n={url:i.options.server+"/rps/v2/access",type:"POST",data:{webOTT:i.session.webOTT}},i.http.request(n,(function(n,i){if(n)return t(n,null);t(null,i)}))},a.prototype.sendPushNotificationForAuth=function(t,n){var i,e=this;if(!t)return n(new Error("Empty user ID"),null);i={url:e.options.server+"/pushauth?"+e._urlEncode(e.options.oidc),type:"POST",data:{prerollId:t}},e.http.request(i,(function(t,i){if(t)return i&&"NO_PUSH_TOKEN"===i.error?n(new Error("No push token",{cause:t})):n(t,null);e.session.webOTT=i.webOTT,n(null,i)}))},a.prototype.sendVerificationEmail=function(t,n){var i=this,e={};if(!t)return n(new Error("Empty user ID"),null);e.url=i.options.server+"/verification/email",e.type="POST",e.data={userId:t,mpinId:i.users.get(t,"mpinId"),projectId:i.options.projectId,accessId:i.session.accessId,deviceName:i._getDeviceName(),clientId:i.options.oidc.client_id,redirectURI:i.options.oidc.redirect_uri,scope:i.options.oidc.scope?i.options.oidc.scope.split(" "):[],state:i.options.oidc.state,nonce:i.options.oidc.nonce},i.http.request(e,(function(t,i){if(t)return i&&"REQUEST_BACKOFF"===i.error?n(new Error("Request backoff",{cause:t}),i):n(new Error("Verification fail",{cause:t}),i);n(null,i)}))},a.prototype.getActivationToken=function(t,n){var i,e=this,o={};return(i=e._parseUriParams(t)).user_id?i.code?(o.url=e.options.server+"/verification/confirmation",o.type="POST",o.data={userId:i.user_id,code:i.code},void e.http.request(o,(function(t,e){if(t)return e&&"UNSUCCESSFUL_VERIFICATION"===e.error?n(new Error("Unsuccessful verification",{cause:t}),e):n(new Error("Get activation token fail",{cause:t}),e);e.userId=i.user_id,n(null,e)}))):n(new Error("Empty verification code"),null):n(new Error("Empty user ID"),null)},a.prototype.register=function(t,n,i,e){var o,r=this;return t?n?(o=r.crypto.generateKeypair("BN254CX"),void r._createMPinID(t,n,(function(n,s){return n?s&&"INVALID_ACTIVATION_TOKEN"===s.error?e(new Error("Invalid activation token",{cause:n}),null):e(new Error("Registration fail",{cause:n}),null):s.projectId!==r.options.projectId?e(new Error("Project mismatch"),null):void r._getSecret1(s,o,(function(n,h){if(n)return e(new Error("Registration fail",{cause:n}),null);r._getSecret2(h,(function(n,c){if(n)return e(new Error("Registration fail",{cause:n}),null);var u;(u=s.pinLength)||(u=r.options.defaultPinLength),i((function(n){r._createIdentity(t,n,s,h,c,o,e)}),u)}))}))}))):e(new Error("Empty activation token"),null):e(new Error("Empty user ID"),null)},a.prototype._createMPinID=function(t,n,i){var e=this,o={};o.url=e.options.server+"/rps/v2/user",o.type="PUT",o.data={userId:t,mobile:0,deviceName:e._getDeviceName(),activateCode:n},e.http.request(o,(function(n,o){if(n)return i(n,o);e.users.write(t,{state:e.users.states.start}),i(null,o)}))},a.prototype._getDeviceName=function(){return this.options.deviceName?this.options.deviceName:"Browser"},a.prototype._getSecret1=function(t,n,i){var e;e=this.options.server+"/rps/v2/signature/",e+=t.mpinId,e+="?regOTT="+t.regOTT,e+="&publicKey="+n.publicKey,this.http.request({url:e},(function(t,n){if(t)return i(t,null);i(null,n)}))},a.prototype._getSecret2=function(t,n){this.http.request({url:t.cs2url},n)},a.prototype._createIdentity=function(t,n,i,e,o,r,s){var h,c,u,a=this;try{c=a.crypto.addShares(r.privateKey,e.dvsClientSecretShare,o.dvsClientSecret,e.curve),u=a.crypto.extractPin(i.mpinId,r.publicKey,n,c,e.curve)}catch(t){return s(t,null)}h={mpinId:i.mpinId,token:u,curve:e.curve,dtas:e.dtas,publicKey:r.publicKey,pinLength:i.pinLength,projectId:i.projectId,verificationType:i.verificationType,state:a.users.states.register,nowTime:i.nowTime,updated:Math.floor(Date.now()/1e3)},a.users.write(t,h),s(null,h)},a.prototype.authenticate=function(t,n,i){this._authentication(t,n,["jwt"],i)},a.prototype.authenticateWithQRCode=function(t,n,i,e){this.setAccessId(n.split("#").pop()),this._authentication(t,i,["oidc"],e)},a.prototype.authenticateWithAppLink=function(t,n,i,e){this.setAccessId(n.split("#").pop()),this._authentication(t,i,["oidc"],e)},a.prototype.authenticateWithNotificationPayload=function(t,n,i){if(!t||!t.userID||!t.qrURL)return i(new Error("Invalid push notification payload"),null);this.setAccessId(t.qrURL.split("#").pop()),this._authentication(t.userID,n,["oidc"],i)},a.prototype.generateQuickCode=function(t,n,i){var e=this;e._authentication(t,n,["reg-code"],(function(t,n){if(t)return i(t,null);e.http.request({url:e.options.server+"/verification/quickcode",type:"POST",data:{projectId:e.options.projectId,jwt:n.jwt,deviceName:e._getDeviceName()}},(function(t,n){if(t)return i(t,null);i(null,{code:n.code,expireTime:n.expireTime,ttlSeconds:n.ttlSeconds,OTP:n.code})}))}))},a.prototype._authentication=function(t,n,i,e){var o,r=this,s=[],h=[];return t?r.users.exists(t)?(o=r.users.get(t),void r._getPass1(o,n,i,h,s,(function(c,u){if(c)return u&&"EXPIRED_MPINID"===u.error?(r.users.write(t,{state:r.users.states.revoked}),e(new Error("Revoked",{cause:c}),null)):e(new Error("Authentication fail",{cause:c}),null);r._getPass2(o,i,u.y,h,s,(function(o,s){if(o)return e(new Error("Authentication fail",{cause:o}),null);r._finishAuthentication(t,n,i,s.authOTT,(function(n,i){if(n)return i&&"UNSUCCESSFUL_AUTHENTICATION"===i.error?e(new Error("Unsuccessful authentication",{cause:n}),null):i&&"REVOKED_MPINID"===i.error?(r.users.write(t,{state:r.users.states.revoked}),e(new Error("Revoked",{cause:n}),null)):e(new Error("Authentication fail",{cause:n}),null);e(null,i)}))}))}))):e(new Error("User not found"),null):e(new Error("Empty user ID"),null)},a.prototype._getPass1=function(t,n,i,e,o,r){var s,h,c=this;try{s=c.crypto.calculatePass1(t.curve,t.mpinId,t.publicKey,t.token,n,e,o)}catch(t){return r(t,null)}h={scope:i,mpin_id:t.mpinId,dtas:t.dtas,publicKey:t.publicKey,UT:s.UT,U:s.U},c.http.request({url:c.options.server+"/rps/v2/pass1",type:"POST",data:h},r)},a.prototype._getPass2=function(t,n,i,e,o,r){var s,h,c=this;try{s=c.crypto.calculatePass2(t.curve,e,i,o)}catch(t){return r(t,null)}h={mpin_id:t.mpinId,WID:c.session.accessId,V:s},c.http.request({url:c.options.server+"/rps/v2/pass2",type:"POST",data:h},r)},a.prototype._finishAuthentication=function(t,n,i,e,o){var r,s=this;r={authOTT:e,wam:"dvs"},s.http.request({url:s.options.server+"/rps/v2/authenticate",type:"POST",data:r},(function(e,r){if(e)return o(e,r);r.dvsRegister?s._renewSecret(t,n,r.dvsRegister,(function(e){if(e)return o(e,null);s._authentication(t,n,i,o)})):(s.users.updateLastUsed(t),o(null,r))}))},a.prototype._renewSecret=function(t,n,i,e){var o,r,s=this;o=s.users.get(t),r=s.crypto.generateKeypair(i.curve),s._getWaMSecret1(r,i.token,(function(i,h){if(i)return e(i,null);s._getSecret2(h,(function(i,c){if(i)return e(i,null);s._createIdentity(t,n,o,h,c,r,e)}))}))},a.prototype._getWaMSecret1=function(t,n,i){var e,o;o={publicKey:t.publicKey,dvsRegisterToken:n},e=this.options.server+"/rps/v2/dvsregister",this.http.request({url:e,type:"POST",data:o},i)},a.prototype.sign=function(t,n,i,e,o){var r,s=this;return t?s.users.exists(t)?i?(r=s.users.get(t)).publicKey?void this._authentication(t,n,["dvs-auth"],(function(t){var h,c;if(t)switch(t.message){case"Unsuccessful authentication":case"Revoked":return o(t,null);default:return o(new Error("Signing fail",{cause:t.cause}),null)}try{h=s.crypto.sign(r.curve,r.mpinId,r.publicKey,r.token,n,i,e)}catch(t){return o(new Error("Signing fail",{cause:t}),null)}c={hash:i,u:h.U,v:h.V,mpinId:r.mpinId,publicKey:r.publicKey,dtas:r.dtas},o(null,c)})):o(new Error("Empty public key"),null):o(new Error("Empty message"),null):o(new Error("User not found"),null):o(new Error("Empty user ID"),null)},a.prototype._urlEncode=function(t){var n,i=[];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&i.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return i.join("&")},a.prototype._parseUriParams=function(t){var n,i,e=t.split("?").pop(),o=e.split("&"),r={};if(!e.length||!o.length)return r;for(i=0;i<o.length;i++)r[(n=o[i].split("="))[0]]=decodeURIComponent(n[1].replace(/\+/g," "));return r};function f(t,...n){return new Promise(((i,e)=>{t(...n,(function(t,n){t?e(t):i(n)}))}))}return class extends a{fetchAccessId(t){return f(super.fetchAccessId.bind(this),t)}fetchStatus(){return f(super.fetchStatus.bind(this))}sendPushNotificationForAuth(t){return f(super.sendPushNotificationForAuth.bind(this),t)}sendVerificationEmail(t){return f(super.sendVerificationEmail.bind(this),t)}getActivationToken(t){return f(super.getActivationToken.bind(this),t)}register(t,n,i){return f(super.register.bind(this),t,n,i)}authenticate(t,n){return f(super.authenticate.bind(this),t,n)}authenticateWithQRCode(t,n,i){return f(super.authenticateWithQRCode.bind(this),t,n,i)}authenticateWithAppLink(t,n,i){return f(super.authenticateWithAppLink.bind(this),t,n,i)}authenticateWithNotificationPayload(t,n){return f(super.authenticateWithNotificationPayload.bind(this),t,n)}generateQuickCode(t,n){return f(super.generateQuickCode.bind(this),t,n)}sign(t,n,i,e){return f(super.sign.bind(this),t,n,i,e)}}}();
